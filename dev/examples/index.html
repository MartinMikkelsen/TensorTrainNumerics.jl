<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics</title><meta name="title" content="Examples · TensorTrainNumerics"/><meta property="og:title" content="Examples · TensorTrainNumerics"/><meta property="twitter:title" content="Examples · TensorTrainNumerics"/><meta name="description" content="Documentation for TensorTrainNumerics."/><meta property="og:description" content="Documentation for TensorTrainNumerics."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in <a href="https://arxiv.org/pdf/2505.17046">this paper</a> where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^cores)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, cores)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(cores) + id_tto(cores) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(cores) ⊗ qtt_basis_vector(cores, 1) + qtt_sin(cores) ⊗ qtt_basis_vector(cores, 2^cores)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[0.34493825023461444; 0.1388026656915342;;; -0.08851812840164346; -0.6934996369956545;;; -0.23005853579166616; -0.437801360861999;;; 0.16347230869047916; -1.405894173055104], [-0.8267224194028825 -0.6683174044547883 -0.563122216613081 1.735257826338809; -0.18403833839016612 -1.1033874672209334 -0.3822808162936629 -0.9476959114768793;;; 0.6298117811204375 -0.6073227471584997 0.11115156418848332 1.3706069915933499; -0.04387957693081498 -0.06911373012495162 0.35938912721545335 2.3439210205935246;;; -2.011123805160388 0.07775362383318922 -0.12240262859674668 0.5724525060872153; -0.5031535337772283 1.573860506573084 0.8969751926496924 -1.9031014289467054;;; -0.11426421061808276 -0.5677073680039677 -0.47366081473979726 0.11777465198930541; -1.1648704880075733 -0.2570460487364017 0.33786929721377157 -0.04891347067904494], [0.029528384746925065 -1.3300538626916207 -1.532603704937348 0.3951357955457978; -1.9750499558639474 1.1954389843049473 -0.8064487076875526 -1.0063197804825594;;; -1.3510439439487676 0.0786325690365857 1.1182542563692874 -0.5464552365037678; 0.34471157088168247 0.13048330722367327 -0.09117547716371921 1.5680948988772472;;; 1.1869276040127004 -0.08422958077622651 0.7725400411066771 -0.16491081538916283; -1.526189987732187 -0.6621742583853646 -1.7392739126782766 0.2831550695968881;;; -0.48047579007935165 1.5425722700404891 1.4875989893725212 1.0785070216487729; 0.13044242514133034 0.5569214971058873 -1.569671963738024 1.1226802686712416], [-0.9527235225860539 0.28679095746768984 -0.4656818189840255 1.5597417019491941; -1.5928415129484734 -0.4830990680796867 -2.0242847935054353 0.8092663894728944;;; -1.2650424901876087 0.6505731271764005 -1.6523234504859388 -1.0832859705677882; 0.8441789610792758 -1.176340531144223 -0.3950482406705744 0.36485472795347595;;; 0.5977201635623826 0.45317048469621546 0.22106742960622477 3.148133330922724; -0.37947757929275844 0.5828077936359695 1.0126300783428064 -0.5645999189992754;;; -0.29009546652203294 1.9719441814748742 0.10065840203376202 -0.03014067593570206; 1.6703480955391494 0.9989218533490233 -1.3396437249064224 -1.4539106176401355], [0.002169019173048919 1.3066291823970344 -0.1487381737976225 0.18195879289509173; 0.26470751787184477 1.3459523809090315 0.09190026147116927 -2.9188236995222225;;; -0.2078350690271499 1.4275030785774494 -1.6507515082037234 0.8640669058233155; -0.40674056472365744 0.9693054541374656 -0.2369750511385887 -0.8095100461417677;;; 0.0927817316164348 0.8743497241756792 -2.360890179381829 1.3897618245225434; 1.7466953437997137 -0.9919782039481531 -0.6241253570533688 -1.9980256804569827;;; -1.4056756375144408 -0.23987388112529934 -0.9027243350807306 0.15689520670311802; -2.6293345881171315 -0.7018359724993405 0.11166341708285228 0.8875950463109168], [-0.4245287145381745 -0.5067079697706647 0.33902160381072477 -0.08199158584254332; -1.6614298012530357 0.012126813923483137 -0.5721838595015261 -1.6957732462563457;;; -1.2811912746511032 0.5063756320750182 1.0533359365617099 -0.517111521262734; -0.5439841490678461 0.026763960123211927 -0.8155243637967358 0.18043034940724464;;; 1.6546439476142314 0.2956448139597287 -0.6607234245384286 0.6437124835552284; 0.12672088321874497 1.1432175270655878 -1.2173124407397933 0.7971071965840663;;; 1.7320759573623963 1.855248669122714 -0.5905533625798187 -1.7304622605303823; 1.0284636476323397 -1.8421572220956988 0.07137876050969078 -0.16166057226067507], [0.18291236163358773 -0.25643729451493774 0.7203681380048843 0.24890119700264438; -0.3010259671246353 -0.2935314915548001 -0.18797925468460228 0.359084042835256;;; 0.45541616089652204 1.357579030702841 -0.8680202845599164 -0.17331616176769438; -0.665578786757323 -0.8052584497071056 0.8665715934694675 -0.041351359682020535;;; -1.836256305487139 -2.3259705958718317 1.5261122386919581 -0.09994863972559297; 1.467877507260286 0.19077054467798832 0.39288169082847035 0.46336213437099316;;; 0.24316251966403993 2.0385080349817346 1.7133202390123037 -0.03079819164619865; -0.6652311098576267 0.4721320048648307 -0.5716001811280816 0.7376216750119903], [-1.5148905462703581 1.1650468579455977 -0.28753199610022445 1.0479327650465866; 0.8510980929346412 -0.07466847053147142 -0.9466242267779926 0.06851807057552778;;; -0.4675637638276012 -0.12793041410835312 -0.08132335266646092 0.6595324822854384; 0.33275851578678806 1.798140573425181 -0.54836993173472 -0.07608365257617103;;; -0.41387637124722765 -0.14146350973606037 -0.1397642313055869 1.459835040343823; 0.3758789182119896 0.4785314194747479 -0.6325435888450264 0.5362685406468473;;; 0.2747181471542202 0.742249013692883 -0.35909066748125495 -0.4720580800319111; 0.846879320560048 0.042908616893577375 -1.079037818654871 -0.505431447783241], [0.8811908237577685 -0.02212420212581547 -0.5819035034026302 -0.34817035949100233; 0.7063987460816298 -0.18723071847531786 -0.04715992084574093 2.6452988323135735;;; -0.6258657205496729 0.34277423469854884 -0.7723417359649892 1.1792046722834069; -1.3363721486246185 -1.5220496292028345 -0.11519458628697915 0.7293217100131321;;; 0.5148193905411137 -0.5065836128246982 0.830160319852139 0.07410668962242367; 0.06598375979915973 0.588314683270516 -0.8374436998456719 -0.7721209335651602;;; -0.05451111367310832 0.16341427496027155 -0.5538141945754897 -1.1230535477748118; 0.6243289327463406 1.4668330737364093 0.40066969376139244 -0.9700310973830514], [0.9428143595210093 -0.5346864255631542 0.6680800639249719 -0.6614249285639061; 0.4785761743729512 0.3566373309897388 0.8491348773743698 -0.5658797918059085;;; 0.09497838463006378 -0.4267024751905931 -0.09467071560622488 1.1863889220643233; -1.4788194265593066 0.3856017299164991 0.5513386139523191 -1.1611143220806563], [0.9413590517606986 1.8960794671777077; 0.5220266935580585 1.0158919008558513;;; -1.0354844332877569 -1.022806772188549; -0.6717123910543347 1.940178872110355], [0.4466878975001779 -0.7484852007342604; 0.3747485805108569 -0.736936052038039;;; -1.2742164489459717 0.04634689940467166; 0.5367459895693483 1.2610265149687188], [-1.3699406259474463 1.7967067455429762; -0.37110312127746387 -1.2591159959456695;;; 0.03850589791083552 -0.21923329480569312; 0.04729898432952431 0.6863424598839607], [-0.7396461693567526 1.0199328131037286; 2.1852712948775332 2.57789932831668;;; 0.476391407321857 -0.39145185979197683; 0.7668819663757798 -1.1871529316035694], [-0.658228948997088 0.3771962566808092; -2.049806630882363 0.1711140153488722;;; -1.9312602966764356 2.255307298247008; 1.0765931639260367 -0.3519513911870081], [0.04198475274118968 -0.23235701216311466; -0.9469410558831484 -1.8125512887030304;;; -1.683919702859055 0.2676843165759967; -0.9040166166696415 -1.1044387549264245], [-1.1935191872725242 0.2973065081309189; 1.2919524542198264 -0.2979840306613247;;; -1.3862861656556635 0.7077476497766204; 2.1522886094605678 0.9464290286996775], [-0.45571632572281184 0.5396653618657778; -2.682979185948455 0.682585379223178;;; 0.23919554418511838 0.7511670385092117; -1.5430586845701721 0.20560625441743352], [0.34686384859566455 1.8081396932365525; -1.127406463970105 -0.1482911510315207;;; 1.1920443294032537 -0.8026929696240299; 1.2365306509362635 -1.6436208953120988], [0.112225183711661 0.32151388945053877; 0.8543345266286844 -1.5212817669882328;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-197.8901884990162; -170.70488798154582;;; -96.22893225374077; 111.55369812732285], [-0.6873760951668354 0.5282746094472257; -0.7087620352476309 -0.4987650205950844;;; -0.11865338881055183 -0.494663773657215; 0.10380113765546485 -0.4735240709159293;;; -0.011135653018008873 -0.037057452933048775; -0.007448856438880575 0.042354199860997206;;; -0.00804705269479137 0.007380753588967283; 0.008540201553557804 0.004526361815492536], [-0.7037726198124815 0.3625534723415059 0.2096776773659472 0.086167102547137; -0.7074431081165485 -0.35897150441146697 -0.22860178814920734 -0.07207058933054186;;; -0.0464060722088851 -0.6110809228781773 0.3370769330633523 -0.016670956975664532; 0.0451733886584879 -0.6026849087598206 -0.07855074552553111 0.17748520715811053;;; -0.004016653364132572 -0.0388501953136671 -0.5008706948380696 -0.5119533930126211; -0.002064048245640859 0.03906197526250703 -0.4656261826061805 0.5061511182326865;;; -0.002674738680127814 0.0012139514095358174 -0.3925083303464332 -0.42104800020932626; 0.002547074032696575 -0.0006023278829248518 0.40008941139137855 -0.5016851157773284;;; 0.00019365501587540867 0.001963107427602509 -0.03254826253870954 0.05613702205293577; 0.00012784170834327971 -0.002134694589008745 -0.032657131471343734 -0.04620159402004759;;; -0.00022544393499538984 0.00011292328439762373 -0.004221229862269675 0.03883358099051948; 0.0002225233666690457 9.81506312416067e-5 0.005310165401714022 0.03941492692246458;;; 7.193767140589186e-9 6.678334846847641e-8 -2.9280812625795294e-7 -4.172148377048433e-6; 3.2244627481591487e-9 -6.937587616016034e-8 -1.8460869518090267e-7 4.2108923545691805e-6;;; 1.7732988793051826e-8 -1.2420689230442516e-8 -1.9837685163998182e-7 5.989363337650653e-7; -1.8327799821732155e-8 -6.011750402160348e-9 2.144941359805418e-7 5.537466472965877e-7], [-0.7065339941388673 0.20790270559739055 … -0.0561814772999322 0.0006871906898636158; -0.7070186599269848 -0.20783486546285262 … 0.0557275960277796 -0.0023788394602675283;;; -0.021501209816024276 -0.6757101572293499 … -0.009816477179242486 0.02622384183385237; 0.02164499308251677 -0.674768852273799 … -0.02411427817416226 -0.02679190121917555;;; 0.0013978798181584857 0.029139095989517798 … -0.010496409638975766 -0.021205672537429963; 0.0005692705114069349 -0.028668413161791882 … -0.015976596392131392 0.015510544285301457;;; … ;;; -5.443912938623018e-11 3.653972090335489e-10 … 0.0018308184441106665 0.0011624785099036048; -7.532335855474904e-11 4.480001242261086e-10 … 0.00144288491692973 -0.004507294836592231;;; -3.009393595091158e-11 1.842515704371042e-10 … -0.0011054237432298302 -0.0004938872608008767; -1.7205680279631268e-11 3.2314390955143875e-10 … 0.0013985373758961242 -0.0008498608381188822;;; 6.266259085475147e-13 -2.5398147264630967e-10 … 0.002173894813992137 -0.0016508032624071272; -3.7306853923014654e-11 -1.375032257586699e-10 … -0.0006074907510089062 -0.002641744383458309], [-0.706999708766897 0.10823455783725615 … 0.04646119676957537 -0.0677372155530111; -0.7070524681805869 -0.10806823260764245 … -0.04472523528877982 0.06579456855312801;;; 0.01075234087621038 0.6985847656956745 … 0.049056814729523314 -0.0570149034423461; -0.0105986035070762 0.6986044973377501 … -0.06316810442467971 0.07086697808024357;;; -0.0004235291339527703 -0.016385131260277623 … -0.05017708342136188 -0.11441740985287717; -0.0001392129088313014 0.016232800235672612 … -0.059737487445374673 0.22234367172188169;;; … ;;; 1.84363367236847e-10 1.6380213991987348e-10 … -0.1449655484339859 0.40551354629465863; -2.2461250364491149e-10 -9.351278879564612e-11 … -0.1634944824495376 0.34691808699595444;;; 1.7103181166379005e-10 1.0956797380737703e-9 … -0.008175059149776273 -0.28049652796714986; -1.4078860582731565e-11 4.6191325370512313e-10 … -0.11056437758754994 -0.36608293827445626;;; 1.3168160030395457e-10 -1.0211064459882651e-9 … 0.3823750346963655 0.08966332583938547; -1.8498649338875443e-11 9.462684359414947e-10 … 0.6152751064160558 -0.12093893538290133], [-0.7070754938788073 -0.05531364122090728 … 0.030413530520625363 0.0336280924208934; -0.7070959480416659 0.053543719654033414 … -0.030787361670841083 -0.03378166791033179;;; -0.006270273939741747 0.7049048161890519 … 0.024064186164490384 0.015693089979269652; 0.00449672966247104 0.7050494334503944 … -0.02131557368405453 -0.006741787766123258;;; 9.413689066361687e-5 -0.006172218763062642 … -0.15995748150897093 0.27616409596124564; 1.8240640313756727e-5 0.006017412273805271 … 0.14423558478900098 -0.2684982683036127;;; … ;;; -1.3825689044809786e-9 3.532184475505552e-8 … 0.0034990601634309793 -0.028108951221638933; -8.019096765498987e-10 3.425853687844913e-8 … 0.6027243992723981 0.13745898818301155;;; 3.258882491511034e-10 -8.465732312359389e-9 … 0.0004273231929232586 0.024703984793384485; 2.069375289883662e-10 -9.047503086629295e-9 … -0.07397499403746051 -0.027588834039785196;;; 6.054566484855821e-11 -2.37343504743065e-9 … -0.00045177161802470466 -0.04409020405510315; 2.3666473053706786e-11 -2.4094042035117648e-9 … 0.027633637245312412 -0.060295486483385966], [-0.7070899326724586 0.029255059298195163 … -0.004529252546017155 -0.0214413791313612; -0.7071070581804305 -0.025091172041906296 … 0.004229858801873391 0.02267235622582418;;; 0.004795354714212543 0.706473358159026 … -0.03828539750913354 0.1603878646148351; -0.0006305401611773246 0.7066374055297099 … 0.038637146173392645 -0.15843217710538465;;; 7.632430213289761e-5 0.00211739059780696 … 0.0670252591340476 -0.05293541705839285; 8.097765076797261e-5 0.002199785861724494 … -0.06452057885623914 -0.04861479825640701;;; … ;;; 2.819902643627556e-6 0.00010282644921384851 … 0.39550600331905805 0.007164910954306351; 2.0388837255745503e-6 0.00010228562270051992 … -0.08260200369846012 -0.12257882448541497;;; -6.878608341506158e-8 -2.7808705144488825e-6 … -0.060299248327279856 0.038482265106132965; -4.761033172808983e-8 -2.7704205672694555e-6 … -0.03285531427154592 -0.019338537631212037;;; -6.925702570033155e-8 -2.7933040462836053e-6 … -0.01758094330932766 0.15602452739626455; -4.7961421469551034e-8 -2.7828628386131173e-6 … -0.1639646899366005 0.011010284425402007], [-0.7070994869928549 -0.015435837201023152 … 0.0310335874507667 -0.060589700468625836; -0.7071067096898865 0.01177905726748039 … -0.03097957261309407 0.06051382922924586;;; -0.0031912598138257395 0.7069170438436158 … -0.013464012273708002 0.019016102956462385; -0.0004649716722515035 0.7069881790868466 … 0.01465933340111358 -0.021264418394139957;;; -4.7879592544386564e-5 0.0021057517602488976 … -0.01946825562617973 0.06551267959521699; -4.801012043059472e-5 0.0021115555000056985 … 0.017345012426912432 -0.07472837639727385;;; … ;;; -2.832010942190784e-6 0.00022249113334327298 … -0.5361640404969918 -0.13880125233206303; -1.9745642473902655e-6 0.00022268563887357996 … 0.535690884967367 0.14074023477985662;;; 7.461041634181364e-9 -7.923350386703428e-7 … -0.2963713802728561 0.4791894275934016; 4.426450060264947e-9 -7.947670012759525e-7 … 0.291331128606153 0.47317150186749357;;; 1.1102897472129023e-8 -6.774409087391142e-7 … 0.26774996698261033 -0.10771467725021337; 8.570882445314339e-9 -6.790335864767287e-7 … 0.2803298455772704 0.029256604151435803], [-0.7070979288722078 0.009663136706067338 … 0.007040415169428786 -0.15598312232706288; -0.7071034449407745 -0.003954431353779514 … -0.007031198811464401 0.1560457808261169;;; 0.003533896730853739 0.7069714184940459 … 0.004720487264944136 0.03403955045037798; 0.0021722325149486476 0.7070266137737662 … -0.004861022626714257 -0.031068092909922858;;; 5.688447953707038e-5 0.003839214708795015 … 0.0024513229206673485 0.03875444807382715; 5.349853378540535e-5 0.003839569807181103 … -0.000808914787526919 -0.037697938071062816;;; … ;;; -4.747987820420437e-6 -0.0004449930218850446 … -0.39278883387511787 0.2560352539286491; -3.894977809564312e-6 -0.0004448313893936246 … -0.09315972761215759 0.16420893608756268;;; -6.567715527033913e-8 1.4516846096971964e-5 … -0.5660819137293909 0.3043105066623417; -9.443938308365794e-8 1.4471375188373436e-5 … -0.6747120953875816 -0.4441661828504413;;; 9.681547266190331e-8 1.0685404491743384e-5 … -0.04009314099967936 -0.040424846311107654; 7.626818230624514e-8 1.0678350933223409e-5 … -0.09145964965808909 -0.12221564537152042], [-0.7070878848972909 -0.008265054375721401 … -0.010056395327059087 0.03218547538638097; -0.7070925139064832 -0.0013959800770915983 … 0.010055941001275269 -0.03218540452868885;;; -0.0051603567894964505 0.7060046168406053 … 0.001354300705526144 0.00017518206191453607; -0.0044836696588228045 0.7060514189574076 … -0.0015095215589468185 0.00012215301079774587;;; -0.00011951938244300976 0.015137511504674376 … 0.0010470762878581174 -0.0008557644470154332; -0.00010620430395953053 0.015139086115613135 … -0.000695857191404945 -0.001013373545515687;;; 9.757888596554236e-5 -0.012397834732578468 … 0.007138491483744759 -0.004949119002861442; 8.620739897236046e-5 -0.012399539707024764 … -0.002880960695355974 0.004380033496591463;;; 4.5384339775005255e-5 -0.005402948830993692 … -0.4212816587315388 0.553967550665487; 4.02149091626478e-5 -0.005402478626646987 … -0.08507736140472286 -0.6044173447013708;;; -3.8782394324378227e-5 0.004584083305009016 … -0.47679477794976244 0.33319781938025617; -3.4387895667170207e-5 0.0045840304119788905 … -0.7010968660018704 -0.45685420797686965;;; 0.0002310803406743309 -0.028786879785537553 … 0.005031384972178635 0.017957825098051425; 0.00020367922644999736 -0.028789868185483597 … -0.21968382153288246 -0.043058404426867466;;; -0.0001152185034317078 0.015079789814667118 … -0.008694854463114052 0.028265751948873902; -0.00010096165544258058 0.01508234149834307 … -0.21859649955919405 -0.05450065328889964], [-0.17691761278884918 -0.14200928812905447 … 0.1532000386212237 -0.17448966565957927; -0.983721967936856 0.005039443525051707 … -0.01647328850869673 0.015568048994601463;;; -0.020159836089504984 0.9898036533207675 … 0.027291855008143028 -0.03226557203507037; -0.00809117596542393 1.666697017539869e-5 … -0.0730623225272557 0.029723780641103464;;; -0.022405610360735555 0.009461961752735016 … -0.5106620411701982 0.7116373695119599; 0.004165377118655984 -3.0071138559036258e-5 … -0.1387159644565031 -0.0034801039545967033;;; -9.952858830947442e-6 -0.000992197468842928 … -0.0810159904079322 0.11167973080464101; 2.5023932896778026e-6 -8.127709163599142e-7 … -0.025908577252409217 0.06412097568447937;;; -9.092789125216209e-7 0.0024422020581134777 … -0.2011916470233249 0.21230642413675696; -1.0724766619660146e-5 1.729253577131814e-5 … 0.6536993451133941 0.4789142528402534;;; 3.105626757980128e-7 0.0004488798744371013 … 0.13372607016126628 -0.1760370186594895; 5.798489266183484e-7 -1.1313934904916168e-6 … -0.07162383647629207 -0.07143875418590137;;; 6.575012123735533e-9 -0.00010529017570038972 … 0.042941811213487724 -0.06578304765156898; 2.900711423465029e-7 -1.6852501121138448e-7 … -0.27486662235012244 -0.19650853430767312;;; 2.0864010122868966e-9 4.876222228980076e-5 … -0.03724980650541505 0.01944410458503847; -1.0701511602443746e-7 8.838897883546249e-9 … 0.33663925900275155 0.3008591200059812], [-0.4088343676416816 0.2562183219380039 … -0.01147570428287416 0.014108328773116881; -0.9114834562231815 -0.13044232887668794 … 0.0004539101595590406 -0.0004108907895624444;;; -0.015323654748626172 0.9573741919576229 … 0.0024272662501655658 -0.002898429430435602; -0.01830833318197499 -0.0012386427518977549 … 0.043320900804778135 -0.056543832150644686;;; -0.012744201887715495 -0.027428341294467605 … -0.043472306990344566 0.05635830823427614; -0.03633104297667796 -0.004213279819856638 … 0.11014170915643406 -0.13850366357848382;;; 1.5553420123271827e-6 4.963852136241059e-5 … 0.009358957442427726 -0.012082768916359366; 6.035236924604209e-6 7.084968716499979e-7 … -0.01140697484272423 0.013926085836258114;;; 7.018676127151118e-7 -6.02208260939367e-5 … -0.0005174197349351056 0.0006965013548824919; -7.717366960777756e-9 -6.889682657564314e-9 … -0.9397642612582349 0.03197755109202921;;; -1.6824527131403753e-6 0.00014429900811645415 … 0.0047636177819665605 -0.005849068544516949; 1.7107978280263525e-8 1.6698576824052116e-8 … -0.31085805794015436 -0.14821144502126765;;; 1.266667951565962e-7 -1.0947794076811715e-5 … 0.01277002365487586 -0.01574794956083923; -3.2854840316128716e-9 -1.428583251028107e-9 … 0.06140947192102699 0.07681330882730743;;; 4.0514272511686795e-8 -3.467622264382896e-6 … 1.4892243521095157e-6 -1.0480062203484842e-5; -2.215268739373868e-10 -5.138408323424737e-10 … -8.90407670682408e-5 -0.9719689049106126], [-0.5241028624312426 -0.41948658943841144 … 0.10329523569920265 0.032522958638215964; -0.8502141957367514 0.2801647295250987 … -0.04870030165167198 -0.014474583570090776;;; 0.021610681486020192 0.8630845786207987 … 0.07119889016392288 0.017341160342649313; 0.018347131583527566 0.014591632070633664 … 0.03467718994948027 0.12570639975767797;;; 0.015068483032200127 -0.018738167095364636 … 0.18005481383375962 -0.0842505317523269; 0.03770029827046864 -0.007726641033496981 … 0.2080247441279508 0.08826781263705119;;; 8.204526306014363e-6 -1.1162053523039863e-5 … 0.03734120525306438 -0.029336777508996128; 2.0725957347749848e-5 -4.381193850100726e-6 … 0.033614151285192836 -0.008827076220611647;;; -2.1336241356249614e-8 -6.240200612895845e-7 … -0.3069945267152405 -0.01228082492054551; -3.947343879136536e-9 -5.378286469106191e-9 … 0.10840532865250742 -0.3374418785685611;;; -1.1139386472796918e-9 -3.4192337242393444e-8 … -0.08918629458441082 -0.004164706178509771; -1.3062987346285818e-10 -1.8489723804317027e-10 … 0.11566476907225881 -0.13600269176604518;;; -3.8227548986578733e-10 -1.3575494844342825e-8 … -0.8799631478679961 -0.04161072944242924; 3.672548537015299e-11 -1.0131488782173734e-10 … 1.665919915922124e-5 0.14632511731419456;;; 1.222132587324107e-10 4.193662364122497e-9 … -0.028341559479477477 -0.0012826636149780401; 1.241093317448908e-11 -2.8871748476696795e-11 … -6.301040549348494e-5 -0.9006253111959829], [-0.5897406035618992 0.5848705575327363 … 0.07539968600471682 0.05618073534207732; -0.8068436508460085 -0.43389853286721286 … -0.04485905140416895 -0.04809049857043162;;; -0.011583604067726736 0.6777160993129612 … -0.10492902935933061 -0.04999306825887904; 0.023567129483397006 0.10078333626501786 … 0.026214270623400742 -0.18206132692077118;;; -0.008522221512280097 -0.009058773000701122 … -0.3491079074823433 0.09961045979193943; -0.021145099703355676 -0.01095537383907502 … -0.1631414061922881 0.05249798500810569;;; -3.466578108226881e-5 -8.792107316722968e-5 … -0.12036949732355767 0.0579469989127934; -9.514702731192203e-5 -5.531033166495172e-5 … -0.030895335120855596 0.05563771211939878;;; -1.3507676029875525e-5 9.789023436101855e-5 … -0.5667898309743415 -0.07459542767164949; -1.365816552152793e-5 3.7766303681102625e-6 … 0.06008368544133507 -0.5405098440588846;;; 1.304524770720003e-9 -1.028488682933107e-8 … 0.20791201934542305 0.03166761636805787; 1.144153022847531e-9 -6.535012370744719e-10 … -0.08754643495427561 0.3037281623553157;;; 1.7364258299056408e-11 2.6880677809253164e-11 … -0.13836018374402373 -0.020768411817792466; 2.1874870165362204e-11 -4.848612270462395e-11 … 0.018622034824067893 -0.559336293520553;;; 1.9199143650399894e-11 -2.2864654874718612e-11 … 0.6490052583937358 0.10774381507181355; 5.166044908783627e-12 -7.640321577638418e-11 … 0.014825070273924658 -0.4731675746642068], [-0.6564078888508316 -0.6295584694486309 … 0.11967107567667523 -0.15265541491954907; -0.7535911858609045 0.5473431989295711 … -0.09922828413707149 0.14207751640418828;;; 0.012620722049595861 0.5046464957087424 … 0.236744137462346 -0.22316205472141049; -0.03175199268937262 0.22187226113337374 … 0.07539030052338677 -0.2737403321120897;;; 0.0024840375200927294 -0.008046041141437177 … 0.4697667932548287 -0.22968791313840473; 0.007429512555356374 -0.010502071920494887 … 0.26770417185698003 0.21268590899257608;;; -6.561745291740519e-5 0.0007761565214169944 … -0.23533606265105989 0.07365886358521483; -0.0003545097653325745 0.0006382243718929986 … 0.2406430997875323 -0.09798245206176687;;; -0.000121609918204376 -0.0003556457216036734 … -0.2543165607312086 0.3606255643242578; -0.00015333409338948777 4.139619494042885e-5 … -0.4206291713692397 0.04457415468835572;;; -7.913779271516662e-9 -2.6009897179301466e-8 … -0.02685422835143501 -0.06085369484850433; -9.179575225533966e-9 8.650742035792918e-10 … -0.22364296840573994 0.11734227864122958;;; -4.816072741450992e-12 8.134149924128508e-12 … -0.29958655459817946 -0.29052249118191753; -1.0418587124723e-12 2.0675792223488486e-11 … -0.09676933835853083 -0.11200146757200921;;; 4.121587192327268e-12 1.2620494577177777e-11 … -0.0941280296638941 -0.1640741534327124; -8.338581990153047e-12 2.3992662672446753e-12 … 0.3288509319226929 0.6673673645182009], [-0.6930730851782779 0.621154522805693 … -0.051393905757119274 -0.07338900486346472; -0.7206658482668783 -0.5963326065463754 … 0.047141816041136875 0.073674894239652;;; -0.008884235869370075 0.4087743239692171 … 0.1504682183916054 0.08075947229662303; 0.014460024781412133 0.3023212101698789 … 0.0052388701566851055 0.1804767291370127;;; -5.742397569126798e-5 -0.004392330440529748 … 0.1925727262718752 -0.014949307522331244; -0.0013906822716194618 -0.005058088192804372 … 0.1997517647424388 -0.09013338626357663;;; 6.089077362998615e-5 -0.0026908530124253108 … 0.3688239316571878 -0.15162331432342632; -0.0006788274900654365 -0.0027889984363054887 … 0.10154278048110255 -0.36307151955050326;;; -6.399582798510581e-5 0.00013236258877302132 … 0.6409625977785263 0.14427768347081601; -7.664837136570837e-5 -7.461654169407914e-5 … 0.11547172632332828 0.20025400387309739;;; 3.332712634152544e-8 -7.933273166323483e-8 … -0.3019634343193042 -0.11650327982102869; 3.685211013463091e-8 2.72113996657737e-8 … 0.17029447035931902 -0.6855447294612858;;; 1.049324864730733e-12 1.5455140676236038e-12 … 0.2868694796797556 0.1064428529944969; -3.425269729028456e-13 1.7859707786766455e-12 … 0.011647188750687045 -0.47062974204244246;;; 9.103719935018598e-13 -3.647035125815013e-12 … -0.34980347934481326 -0.09788500053834179; 1.2766703360095712e-12 -1.492545622625488e-12 … 0.0001034470259449216 0.008236518280415724], [-0.7033556626738868 -0.6164133087778333 … -0.05562688125934134 -0.09465715008633938; -0.7108172393562032 0.6095032165074958 … 0.0561965100392452 0.09359856737410728;;; 0.0031849479034388633 0.3677783698734753 … -0.01739648831665132 -0.1993967504182359; -0.00440782975126284 0.3365617970649178 … -0.18133191771529397 -0.12647716562022923;;; -9.915540268100518e-5 -0.001448407693770165 … 0.037435716798424876 -0.1587831589854236; 0.00025253617436010235 -0.0015059913306110066 … 0.3231005650174202 -0.0879878996997269;;; 8.497392545030327e-5 0.0008343350425724933 … -0.4221631750610755 0.3428476278073651; -0.00010044547568369483 0.0007915410771973927 … -0.2685320427667064 -0.16963892359356186;;; -1.0253789729829407e-5 -1.6401577832918284e-5 … -0.12438266548733948 0.7004187556443981; -1.1875186870469213e-5 2.054796141441624e-5 … -0.49400836848571134 0.09022655960585566;;; -5.219272213396028e-8 -1.0429593137165394e-7 … -0.0001759595199883436 0.20901163550658003; -5.450768017112898e-8 7.587600775838596e-8 … 0.5789009722947045 0.3879677958278314;;; 2.5591122974585672e-12 7.711658660978294e-12 … 0.00022786809217388752 -0.1997556222075938; 4.582390514608874e-12 -3.688864719300652e-12 … 0.09896559955982441 0.03970808557532805;;; -1.927952425997196e-11 -2.6520244011959996e-11 … 0.0006839535382456544 -0.08331830944568268; -1.843553488137229e-11 1.7862813900367048e-11 … -0.0008341882955662576 0.07677793442392009], [-0.7059511811696951 0.6181565837443225 … 0.028633096054803662 -0.17391694611716615; -0.7082590294325019 -0.6160033609960059 … -0.028762409959748617 0.17352027256165078;;; 0.0008512460571439423 -0.349486879498205 … -0.012168022614059242 -0.3189387601759465; -0.0011610651539779235 -0.34099995716052894 … 0.11576325124632275 -0.30203417321601916;;; -3.32276066911965e-5 0.0003733600449255933 … -0.09189173392356043 -0.33347625488393134; 5.525022845107289e-5 0.0003089355886951845 … -0.48773056368357 0.4359811397257682;;; -1.228594939042737e-5 8.62332657374321e-5 … -0.6156496775243839 -0.61491704346356; 5.717868854691291e-6 7.221634034045952e-5 … 0.5995447935890355 -0.2593994973406789], [-0.7067119095810613 0.6327991530897532 0.06767770380431334 -0.3091006908969255; -0.7075013479978121 -0.6320396229416959 -0.0671622121491159 0.30896115430946147;;; 0.00017604239992744831 -0.31750652589596284 0.8235269991578782 -0.47009877332383004; -0.0002973998021525946 -0.3150884842295673 -0.5592068019302275 -0.7668160870340673], [0.7069823519906375 -0.7072311884905715; 0.7072311884905715 0.7069823519906375;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^cores, 2^cores)
xes = collect(range(0,1,length=2^cores))
yes = collect(range(0,1,length=2^cores))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="f3f63376.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this exampl we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 8
h = 1/cores^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,cores)
xes = collect(range(0.0, 1.0, 2^cores))

u₀ = qtt_sin(cores,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393110550548e-5
Relative error for implicit Euler: 4.8313688501847086e-6
Relative error for Crank-Nicolson: 4.831433104171374e-6</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 24 July 2025 08:53">Thursday 24 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
