<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets.citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Quantics tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li class="toplevel"><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in [<a href="../resources/#FastandFlexible">15</a>] where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^d)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, d)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(d) + id_tto(d) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(d) ⊗ qtt_basis_vector(d, 1) + qtt_sin(d) ⊗ qtt_basis_vector(d, 2^d)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-0.7332454484877572; -0.6790712125944388;;; 0.2550344864657663; -0.32161634352905055;;; -0.6811622458354172; 0.5509781903426423;;; 1.4566614987314768; -0.37404534087212854], [0.06039060170025687 -0.7033385119965371 0.13520340917139992 -0.7970470826868936; -0.4517299184680657 0.6563744689788528 -0.7512787562623311 -0.5524892547906431;;; -1.1994995153355184 0.26631907908282043 -1.12104121679263 -1.0772328959717223; 1.3864428443845227 -0.043628082234141316 0.7390734229996128 0.06622436631763616;;; -1.234265405711631 0.5532969174227531 0.3554776594337791 1.2949834860489624; 2.024687787507593 -0.833062822166738 0.29600927223635853 -0.03717717695592094;;; -0.016048479654693745 -0.7528204841554136 -0.4221567837411671 -0.7426343541873446; 2.451305148623787 -0.08495617983168194 0.6381774256732355 -0.35359611954203346], [-0.03450643237111047 -1.2227125837959898 -0.6895651645575203 0.9321361040736638; -1.2892995163426346 0.056522014465499835 -1.6748865479100346 -1.2297901318641007;;; 1.2132281245608152 -0.46421255648976206 -0.02157624025162411 -0.2536619092492274; 0.11120093120695254 -1.4689717366635935 0.35637148880484043 0.3402487579305441;;; -1.2956808951703194 1.4405418173418445 0.01860265917839198 -0.405243150917487; -1.1688833518576687 1.8152021970848768 -0.4863018975066198 0.8843153355005166;;; 0.26467050208081594 -2.1572281655137613 -0.4118581440552969 -0.2781628513183906; 0.7214356946239169 -0.25153556868999 0.48507550258800675 -0.35621453074681003], [0.7280845669764717 0.17108301965610495 -0.5348663917830792 -1.0707335323721496; -1.3251843238996228 1.053304774464554 -0.9003485695424007 -0.5677451348011152;;; -0.2506225899403681 -0.934849610716987 1.8413049377858135 -1.5721319090038588; -0.9732793436025753 0.6820620081629272 1.2105230961139073 0.41554287220285513;;; 0.18252260019527922 0.8168649006855148 0.09002356765788987 -0.09911571884038285; 0.11597122119996515 -1.4018846709165018 -0.8323925476249766 -0.2709466084528784;;; -2.9511976454314937 0.9811731296728203 -0.0007246469572514929 -1.3777109108566268; -1.4380474819815574 -0.06182709795504116 1.327119320879692 0.3111172825854144], [0.43122167453016047 -0.8371485686761275 -0.22589498374422246 -0.8196444431203136; -1.8089581167430189 -0.5097290342569216 0.46173901810200285 0.7130282911493828;;; 0.08058122556463206 -0.7953310952176839 -0.43944517134854955 2.266925689425525; 0.22486014695566833 -0.09020188877587301 -0.7144091255382441 2.0384510086734107;;; -1.9408026838454135 -1.8464606521072313 0.8072777249000372 -0.9844831629396907; -0.9206921773934106 0.5048584476715066 -0.28518659240067235 -0.676640127758971;;; 0.531348706705467 -1.3800095338345557 -1.792202065572983 0.09220725644423348; -0.2678980663825738 -0.5936007431448715 2.0714047583331556 0.2084538695855805], [0.010294712680566333 -0.20991291709665683 -1.2381737090900276 -0.41217619279863615; -0.03821611399174521 -0.5704410335462037 -0.34736970459632943 1.973291644138648;;; 1.0240876521422948 -1.2885778697775068 -0.0005516619266671557 -0.7597284052739425; -0.6124259433477637 -0.61521923808327 -0.6916952820833498 -0.36748397220016943;;; -0.10755610558972997 0.8830699832502048 -0.4871760535802041 0.8689091680713097; -0.4449834911983571 1.760361522498061 0.43933078239860035 -1.2861028734902145;;; 1.368703207699407 0.882998435487822 1.454502495684847 -0.6324798910817918; -0.24806907685998741 1.4303005401085356 -2.313713411616401 0.6305619414493993], [0.3406927865563261 -0.34200151867120976 -0.12202412960104835 -0.6509710905131556; -0.7405111851293136 -1.5843713412455067 0.967512586554226 -0.5312085091853733;;; -0.0048533157009852885 0.3751750334873167 2.9263576302130554 -0.7237661752190309; -1.2126863653368845 1.3078836110766006 -0.3594996762653744 -0.6381925849397835;;; 0.997031081315898 0.04188708412801078 -0.48076546510697454 -1.3934516211352188; 1.353164143333979 1.2178300572876206 -0.6717463154627057 -0.5330636445946559;;; 0.44938773157680567 -0.510063240455243 0.4542106468035993 0.41802279588190755; 0.8754478449795153 0.5903736685174307 -0.017354056826513878 -1.2219278676601961], [1.0810085177812467 0.599293055995457 -0.4853453494271822 -0.7634218509476721; -0.6238665790611879 -0.27535731190255225 0.9023790183006982 1.3968540538166079;;; -1.9362138872014467 -0.4936736215561796 1.0165912881409678 -0.08900603961344059; -1.790023448795077 -1.9311292070093877 -0.3192982608912656 -0.7687174223409697;;; 0.5821504781911887 0.034022409955336994 1.8275650764112115 -0.3514492493573636; 0.05273332637285639 0.8011649500074313 -0.38728081797386366 1.4393092456502738;;; -0.0867457872524909 -0.8290788791909335 -0.764004843520053 0.6967477767160846; 0.947998262108617 -1.3318342650675554 0.5144434012115807 0.5368160659792226], [-0.21273581818984127 -0.04312174959570628 -0.8942583727571363 1.1989002381212548; -0.7883481642929377 -0.2497324867725655 0.7211386662423175 1.2288054713042726;;; 0.5415099999544546 1.1634820759921254 0.32509151770269795 0.8939048577341614; 1.0512996334563964 0.6839782053969956 -0.480765028891447 1.5133077166115878;;; 2.296017522496981 -1.1679417307314301 0.054439285326703786 -1.5906447378779411; -0.42985763539948624 -0.4835745647489226 -0.6155172395482039 0.6024681766865417;;; 2.2873272932365243 0.2112099419046238 0.5904006336379778 -0.7679439390692779; 1.1817664180215322 -0.24119773614736398 -1.4589199607299437 0.19555418906446778], [0.6457552073576908 -0.7305619034831623 -0.17241956127690705 1.8597257879920244; 0.8601347748899761 0.7568427327708213 0.05609207893594104 1.4619399222964053;;; -0.2156864164826478 -0.787730863644672 -0.1136796478825812 -1.5655888560186577; -0.6162883315643697 -0.6297779794373736 0.9799362071623334 3.149005164745832], [0.8973816927193466 -1.4248374071727095; -0.7474205747657074 -1.1215971600300427;;; 0.8587574696087369 0.4230410313354064; -0.7109588385414959 0.5808213762793267], [-0.9336292339056148 0.33616506334890195; 1.0864790866478211 0.8172654917565212;;; 1.8758677798204113 0.9137960642861181; 0.7961720944072521 0.1395946620287967], [0.9328123378946709 0.8008298570979894; -0.029468057163239587 0.2518869712588456;;; 0.9520177544253497 0.36312635507541413; -1.0261738099155497 0.901573337036524], [2.027644215001088 0.03328367540014224; -1.728087699461036 -1.018537425280438;;; -0.4806372956017997 2.071920171976707; -0.6926856859871757 0.23956910335223025], [-1.1161083357287487 -1.185326639145073; 0.13080101106863 -1.0304588202897786;;; -0.25024507879695335 -0.1784157338312139; -0.1576958628701484 1.2129393721677177], [-0.6114547160157318 -0.03721369353558945; 0.7627755415274008 -1.1099591295684306;;; 1.2583641630559848 -1.1711906800610736; 0.47884846263658476 -1.7782916358881873], [2.015479093737775 -0.288588553242568; -0.16687931175270185 1.5327929934366968;;; -0.5190229524260255 -1.6447114411950723; 0.6636323171320622 0.522576434459595], [0.03799068910239523 2.0462672232121513; 0.7600563123480757 -0.028842218892208282;;; -0.7015580101661926 0.19274256081489718; 0.7653941643346068 1.805927092399544], [0.33152344871573286 0.7489591856747385; -0.4260106690019643 1.1767350626392394;;; 0.09812309094194319 0.9959281200596964; -1.9125480913757942 -0.55869473446033], [0.03426408051204501 -0.8019564365150896; 0.041353328878168234 -0.16002340256072792;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-183.90152508867786; -184.62000096812514;;; -103.38927319650804; 102.98691863797835], [0.6988360428220068 -0.5185230655917862; 0.6983330392328594 0.5193010949963126;;; 0.10869817758160395 0.4787675202586715; -0.10911639609743987 0.479507798817336;;; 0.007773320418211698 0.033638521451790346; 0.007866236587155562 -0.033497550364965024;;; 0.0075958312669763385 -0.005460324788082034; -0.007580964372351824 -0.005539354740011366], [-0.7057663322975982 0.3677633295937751 -0.018333805833283544 0.09484440187941243; -0.7056168045232305 -0.36792533806395655 -0.0036025188537412807 -0.09549910897789486;;; -0.04452529536541709 -0.6025655134759449 0.2257270458290957 0.094251438860344; 0.04458683506157789 -0.6030247334555741 -0.2346273149293393 0.08462505182340184;;; -0.0027573267779193826 -0.03645831707843051 -0.49834939227155384 -0.5227870621270186; -0.0028138613063538142 0.036435463143665435 -0.5012233127308372 0.5241638795921503;;; -0.002529740626235838 0.000339299909985553 -0.44449079799789876 -0.45886355815694096; 0.0025300831609929545 0.00042961626594007065 0.4432822223683935 -0.45522484795591506;;; -1.857283513027494e-6 -1.1168885987380999e-5 0.0001942579952880075 -4.600497390227717e-5; 7.154004223295046e-8 1.2082243759230798e-5 0.00023133384766714125 0.000360961149532538;;; 1.1673528117008254e-6 -1.6617351287895383e-6 4.29705589592921e-5 -0.0002197498124303217; -1.3297512406700195e-6 4.3818875428400063e-7 -4.350201115488432e-6 -0.0001832878330614815;;; 1.037832092912794e-9 1.2614412007565909e-8 -4.381154287018679e-8 -9.411568625755421e-7; 9.809188678945258e-10 -1.2717362107249765e-8 -1.5644855982966458e-8 1.0124410752970518e-6;;; 4.032786674171377e-9 -1.2922721348664478e-9 -5.244735783376963e-8 1.8510177510405886e-7; -4.0803628014604285e-9 -3.7688697043789507e-10 7.665279488895398e-8 1.2122634500267806e-7], [-0.7068112488155824 0.2133244723466688 … 0.11948442305876311 -0.07844641115314455; -0.7067786074993189 -0.21333122753906628 … -0.11960940013141975 0.08138084873045079;;; -0.020965684611306268 -0.6735277876749106 … 0.03789237130055824 -0.07357159033986747; 0.02096015658449447 -0.6735720980876317 … 0.03460361119906193 0.021812123887188745;;; -0.000935251029712726 -0.02861980850838948 … 0.06163895839852099 0.024528681353649818; -0.0009559895399140811 0.0286458263812526 … -0.014782298584584616 -0.0017686041695755101;;; … ;;; 4.782293949918605e-12 1.0237472428090758e-9 … -0.006607246665931275 -0.023911546819450416; -2.1641391889864582e-10 5.979790475581493e-10 … 0.008266421839098348 -0.027029218854923844;;; 1.0555732845809217e-10 -7.474056579004176e-10 … 0.008456230371753914 -0.01959608789481974; -7.529151543006113e-11 -5.554488340115269e-10 … 0.004137576701195779 -0.016975399826009346;;; 4.823583308948352e-11 -2.396029086270011e-10 … -0.0008375312266386326 -0.011479446796955681; -3.2592692038906037e-11 -1.5400789311820955e-10 … -0.001204782743909906 -0.009054587494738883], [-0.7070303778634405 0.11132667315396548 … -0.1461477769902365 0.01843799350489005; -0.7070307230367266 -0.11131990953697717 … 0.14915202376240358 -0.013781379807659234;;; 0.010380807765293968 0.6981048712557287 … 0.12472180733755837 0.15027085568475168; -0.010374128373765177 0.6980915052788439 … -0.07536482322241615 -0.15712888875595918;;; 0.00026979266943083133 0.01622672120146495 … 0.09947613921051653 0.11519508044954578; 0.00027302166391386635 -0.01623344423960606 … 0.2250933802217215 0.030651195900081404;;; … ;;; 2.6529299447185414e-11 6.012685756703774e-11 … -0.08743007347738406 0.5940335605105403; -1.1642119184167416e-11 7.210952032138736e-11 … 0.1473256355032151 -0.10904585258663003;;; 3.705808530661282e-11 -1.7118221742312835e-10 … -0.06491979566329424 0.34802224562114004; -9.189057901099075e-11 -3.4919053607563436e-10 … -0.16994189421480455 -0.24715688787731452;;; 1.990904856693844e-11 8.032071593141688e-11 … -0.03694584664499012 -0.02741415443896645; 2.4881109177025236e-11 1.1257046283065741e-10 … -0.06670941339355045 0.08170423234624138], [-0.7070871979210656 -0.05608706393809033 … 0.014131140637524216 0.10272995992975477; -0.7070876665780526 0.056089090440725624 … -0.016832244405801146 -0.1021299487390119;;; -0.005229466955429687 0.704851599814186 … 0.17948267704953033 -0.031372861645115935; 0.005231554121077662 0.7048501440291588 … -0.1787377339530449 0.04902485710319894;;; 5.8527673598049284e-5 -0.006209491570352794 … -0.3012441712967541 0.16379972724020456; 5.7830220324229035e-5 0.006208830786165923 … -0.06909940601895212 -0.02294500134317413;;; … ;;; -6.320592187874484e-12 1.58816407154219e-10 … 0.1515518686484947 -0.38303071752795326; 5.3732058102464404e-12 1.182650320619669e-10 … -0.16706685621823628 -0.2737601658616568;;; -2.3756253895219107e-12 -5.079099733330007e-11 … -0.05221203243729407 0.12624996985093845; 2.1529953546277764e-11 -4.606742404775804e-11 … 0.14822679536728964 0.3991705186167506;;; 1.1439301816167102e-11 -1.13458678118891e-11 … 0.04763994717614939 0.3432811126424602; -1.670193535788655e-11 -8.946092695895965e-12 … 0.01596345840367523 -0.07559565150140354], [-0.7071018739889947 0.02800745429173171 … 0.031847940456565436 -0.08405413123072017; -0.7071018517340593 -0.02802655453658714 … -0.031115421537076405 0.08495469478429668;;; -0.0026277202259159093 -0.7065497561021419 … -0.09666218652258898 -0.12262174459227847; 0.002646837477909193 -0.7065490941186753 … 0.09899126657033017 0.11566418887326296;;; 1.0190721689072913e-5 4.89377149714115e-5 … -0.021151147129132145 0.2002890038451068; -8.349047302089946e-6 4.494363829245274e-5 … 0.0592898073370804 -0.16744892868087108;;; … ;;; 2.417783475925181e-12 3.5703187417895686e-11 … 0.3731829567252064 0.09552754471888328; -1.9005387270156237e-13 3.103563641520535e-11 … -0.1335186395714466 -0.045993851900289144;;; -6.225169416539939e-12 -5.337668523023853e-11 … 0.1252318746601845 -0.4567693280911446; 1.2714596698965289e-11 1.6349585671048802e-11 … 0.3023089992714638 0.020020570403668465;;; 1.7184948959538956e-12 -4.405040683299916e-11 … 0.6262367211953995 0.050258159824785445; 3.1902835159597673e-12 -6.889471693683562e-11 … 0.1722977480100147 0.31333080443526257], [-0.707105641559342 0.013937657108478654 … 0.08491377276164018 0.07291476805489769; -0.7071054404881547 -0.014046954441451752 … -0.08472703408049793 -0.0729630778294929;;; 0.001268542724215375 0.706966964899571 … 0.047824053606987 -0.014633191211476401; -0.0013778462177056652 0.7069648081308845 … -0.051699181780254566 0.012031972001474973;;; -4.742911378933105e-6 0.0013242434806142605 … 0.018293028383205904 -0.14221837832144765; -5.839784855226145e-7 0.0013240571127867097 … 0.09050253697744302 0.12130313238708823;;; … ;;; 2.330022550340373e-11 -1.8147912725101823e-8 … 0.09387620671019169 -0.2075238269965851; 8.703403492376599e-11 -1.8579812086636255e-8 … 0.08845348867005591 -0.08733652812431336;;; 3.372190265177089e-12 -7.769398722454403e-11 … 0.10667530248686624 -0.1046499642207591; 2.6354739978846227e-12 -7.708543008822531e-11 … -0.029513801584312205 -0.0023489604701010976;;; 1.823127691942949e-12 4.6443458067931803e-11 … -0.17252739121904728 -0.029770366571044843; 3.5100485627927803e-12 4.8923137571259874e-11 … 0.12244320302495593 -0.10068099190957243], [-0.707106551488517 -0.006917033154955378 … 0.17551614576485294 -0.13105898968812485; -0.7071063796844707 0.007100376126360973 … -0.17544607058083272 0.1311517864044552;;; -0.000570048994361096 0.707036731108765 … -0.03603370249559114 -0.05135300605529846; 0.0007533982307798091 0.7070349203969957 … 0.03945147043891994 0.048784553143464957;;; -1.4403137408278494e-6 0.004085922041792356 … -0.03647628954630696 -0.07747243874798156; 2.395145659355369e-6 0.004089656277517524 … 0.043948197291323994 0.07995144434529956;;; … ;;; -7.172285311371853e-11 2.3858699667398134e-7 … 0.10236988890544478 -0.048007263159078044; 3.6230927089663816e-10 2.384925056969569e-7 … 0.06650129014007151 -0.06438211296303753;;; 1.2512630031051853e-11 2.4432992857199108e-8 … 0.005937124649274395 -0.009483571466900598; 5.825289723726826e-11 2.4365006786303718e-8 … -0.004336229916744126 -0.014934730240499364;;; 2.176885509402775e-12 -4.322715113570115e-9 … 0.004831027329140446 0.01802274924343596; -5.957227697872022e-12 -4.326539319293993e-9 … 0.0005707060587086205 0.0425829042491385], [-0.7071067795986872 0.0032578805940941505 … -0.004176391172488831 0.004161199792826723; -0.7071065150931786 -0.0038268579857125297 … 0.004176364829291692 -0.004161192137958558;;; 4.292978725041796e-5 0.7054024644706484 … -8.684338392135868e-6 -1.3874090087879678e-5; -0.0006129433966259074 0.7053987003322102 … 5.441228505728569e-5 -3.176148671343813e-5;;; 7.4782971747975935e-6 0.01940713122589819 … 1.988691332433998e-5 -4.865964255501404e-5; -9.442671079109173e-6 0.019414629647808813 … -0.00021728140779799036 0.00027379673679683484;;; 4.408630557123327e-6 0.01098197041527467 … 0.0037584494341799776 -0.003603635260173785; -5.534132487324227e-6 0.01098754407960967 … -0.002690610509747648 0.0035716946090005807;;; 8.559803158787656e-6 0.021347687357183606 … 0.06709910111131473 -0.06778343475637526; -1.1178792070171528e-5 0.02135429132435347 … -0.050600300710639805 0.06811533542972945;;; -1.4805042625573132e-5 -0.03573030058002986 … 0.05046805521004329 -0.047533756221171196; 1.820755654951113e-5 -0.035740124188620555 … -0.02880776242834274 0.053584499891240076;;; -5.514989739973849e-6 -0.012920637043500001 … -0.03882772419843379 0.03604730286115057; 6.4215593371492115e-6 -0.012923899526656409 … 0.01374976078144769 -0.020802727891097175;;; -1.2381846028597842e-7 -0.0002942943272538745 … 0.5388836093435614 -0.825890359679693; 1.4809779872590519e-7 -0.0002943717283772985 … -0.8351119180575873 -0.5493154374972715], [0.17657696276967866 -0.1330867352188644 … 0.08480870519009323 -0.0655539804627804; 0.983785050574632 0.004015568006410001 … -0.009686542677196073 0.013952455681996061;;; -0.019658741923480466 -0.9910909952164906 … -0.011946524194042138 0.008864287344011224; -0.006683940482462849 2.4129920235766148e-5 … 0.02350223372754957 0.014569111306406467;;; 0.023201514432828276 0.002808797107442172 … -0.2622606042082063 -0.05190603104897711; -0.004254272051097461 -0.00023143027764435095 … -0.13057979462166835 0.15891848074859077;;; 7.822980402649005e-6 -0.0006908640511971455 … -0.041843576981951465 -0.005838079726951815; -2.1414420947305367e-6 -2.1519680407110565e-5 … -0.009989663841074223 -0.7663148138606692;;; -1.733369397777779e-6 -0.0013189337672824353 … 0.0834322851239655 -0.1610727940164338; -1.0909068349568838e-5 -0.00046600334138918395 … -0.574061036558712 0.06942945708331548;;; -1.1066678826592138e-7 0.00023421224921451936 … 0.040548473981413986 -0.0037682250857282596; -6.945328178283569e-8 -6.382496233494197e-6 … -0.01770594391745915 -0.4127896989680478;;; -1.879861436871477e-8 -4.427606598408728e-5 … 0.028409972515118048 0.3981486101545871; -1.8715717404478367e-7 -4.1379268176247734e-7 … -0.0992304595051431 0.035823707707822644;;; 6.903975450698965e-9 2.1941781255535842e-5 … -0.15227922837547092 0.11073267490037662; 7.981111516561743e-8 1.0974483852876371e-7 … -0.7294029896212432 -0.08218007460153308], [-0.4081864752752071 -0.24136097261661446 … -0.010811061401218541 0.018539767593510864; -0.9116583507411954 0.12343747711484113 … -0.0002615621100298736 0.0005937334583003547;;; 0.015144148157854235 0.9621214717400873 … -0.0018731890204432605 0.0031376408458548694; 0.02095753060872766 -0.001451186949320474 … -0.04216823083091482 0.07494482778136577;;; 0.013223113697800479 -0.02849417624127461 … 0.04542476781759722 -0.08033214851392508; 0.037675440711841694 -0.004002493085700555 … -0.1151914461591964 0.2004744521276045;;; -3.010034619596901e-7 -0.00017688630790476957 … 0.009710536300131358 -0.01713550142483221; 4.2494367546632374e-6 -4.6231824793413834e-7 … -0.012483445327442418 0.021299390808722944;;; 1.1600907146843627e-6 0.00011538069794090542 … -0.009791694025814516 0.01722751680831642; -3.222729177889497e-8 8.857222460010116e-9 … 0.0050568449411811005 -0.015199151559612087;;; -3.98946279756266e-6 -0.00040031746781769585 … -0.00017988970646238338 0.00031448548158202326; 1.8423743479120643e-7 -3.816151270385589e-8 … 0.6702279832783001 -0.13292418245392745;;; -3.0716072968683855e-6 -0.00030797886122590514 … -7.12918830755995e-5 0.00012561524636136936; 1.3664254240085466e-7 -2.9087990391471532e-8 … -0.7300702689907032 -0.1820225107678266;;; 8.842102426631924e-8 8.769189624083239e-6 … 1.7395346740607975e-6 9.10955973781925e-7; -1.7842004248643687e-9 6.915703853793251e-10 … 0.013752841675170347 -0.9462081452124331], [-0.521697003480555 0.39621031140015606 … -0.1096919606012845 0.049835056911564854; -0.8513472859819867 -0.2659221674680097 … 0.03802983185333951 -0.019408603845570745;;; -0.022814070310360462 0.8784761577039654 … 0.0568655863373949 -0.02481731264280337; -0.025225236359376065 0.010517136229848706 … 0.27712010656270103 -0.17765299730145154;;; 0.016138983422255174 0.02053612190219843 … 0.20414524848793386 -0.11378467583976568; 0.04028366719189827 0.007077273000810753 … -0.4929015876780138 0.1555041161094202;;; 5.5587329592895926e-6 8.515698850643393e-6 … 0.07517714950408685 -0.040174723807571734; 1.4062981739404782e-5 2.5574475007618238e-6 … -0.06023811174731958 0.009189982504748718;;; 6.140289021622113e-8 -2.2243936668642903e-6 … -0.014822739035693595 0.01798694157551779; 1.2291808734228713e-9 -1.463733978432943e-8 … -0.17466930830429872 0.4157755522169727;;; -2.089351621407488e-8 7.572560795352542e-7 … 0.00998345873498272 -0.001122111898226649; -3.630632721411042e-10 4.993357712489087e-9 … -0.7578703219108234 -0.31164346881985217;;; -3.6377868558931572e-9 1.3305081989356488e-7 … 0.08595465559304447 -0.03958815080165402; 4.558773635616724e-11 7.710224043806091e-10 … 2.0377643095118148e-5 0.06293026290413395;;; 3.6861106415929097e-10 -1.2745746578760838e-8 … 0.0001501262546975613 -0.0005628342549196552; -9.896478971319138e-12 -3.3451312438455685e-11 … -0.000514644415747046 -0.8064073615802212], [-0.5830545390231189 -0.5696271677485573 … 0.05346300382481603 0.2194002872839016; -0.811762341689838 0.4174501366384544 … -0.03116967145054507 -0.15708488696233286;;; 0.012210206998950205 0.7025923737165812 … 0.0687732593787784 0.23637011127726512; -0.017337143580787372 0.08615432111629334 … -0.0178782831679317 0.3226363261930884;;; -0.009499098993414798 0.00942206587193856 … -0.2336453584967202 -0.37420290641580467; -0.0234393207319527 0.010624441057122763 … -0.10642290325711981 0.017799537577285435;;; -2.387279691090252e-5 5.636007273372374e-5 … -0.08095931880346882 -0.09715485538402113; -6.41889379812724e-5 3.241211026791453e-5 … -0.021406912657971375 0.4442206011881982;;; -7.568309070612039e-6 -6.500084257906665e-5 … -0.3679889602317767 -0.15700700095675174; -7.12739224120553e-6 -2.5297472515621716e-6 … 0.02880343636112006 -0.25632506894305956;;; -2.919823633088e-10 4.1689435796144285e-9 … 0.12134514762503712 -0.3355592753290413; -6.086064192840878e-10 -9.170844326214382e-11 … -0.053630053581584604 0.16937749145032863;;; -6.168800232969292e-11 2.4552325831735255e-9 … 0.8742659359695418 -0.1267301454039468; -1.0998936659201372e-10 -8.782442927364152e-11 … 0.0012550049318446 -0.20416149112085138;;; 1.224061347536407e-10 -1.5326479638130103e-9 … -0.0008625370487243272 -0.030433776650864566; 2.3446815911242956e-10 7.212395975331452e-11 … -0.0015885186367326032 0.36027214218003795], [-0.6490968486185839 0.6292538411645618 … -0.05449049832552726 -0.05047929212827164; -0.7598421099538971 -0.5367704110426827 … 0.04190633464020166 0.052027886474212616;;; 0.012207354081622176 -0.5219023613783141 … -0.11387524053230257 -0.042947799610606824; -0.03283881226449682 -0.2082110010361658 … -0.006048342256337939 -0.16431780315617264;;; 0.003086479882650202 0.00808842496092524 … -0.2816948676146125 0.13163290394452204; 0.008731449091124112 0.010827710702495049 … -0.15984917502149004 0.17269675079855326;;; -2.9090972849203537e-5 -0.0005562205243304968 … 0.13055405733233363 -0.10573694082493025; -0.00021277588018071576 -0.0003765752657522821 … 0.02551642664154108 -0.18851070062225078;;; 0.0001098780475319911 -0.00034574575832836826 … -0.5299253373236282 -0.03252959983615742; 0.00013861808564867258 2.7831929638462746e-5 … -0.023572781955674083 -0.42034900716570467;;; 3.5932774017268734e-7 -1.272401371978156e-6 … -0.21793793884777843 -0.022452502572391207; 4.1429058312419815e-7 1.0230225071219222e-8 … 0.10322219403919128 -0.49312476153143564;;; -2.79556236620537e-11 1.1455755584201221e-10 … -0.7212065663666276 -0.12535332820172398; 1.1807328544377534e-11 7.455965685733745e-11 … 0.0013253453898610754 0.18547829908523772;;; 1.1188791951091393e-11 9.426898410626108e-11 … -0.000952236537334584 0.055308854539480236; 7.857189496315575e-12 -9.348685451323295e-11 … 0.001185059334925526 0.6304203188486838], [-0.6903774896799878 0.6223763550220588 … -0.05808402189707455 0.11076788482862523; -0.723197997736684 -0.593009204002791 … 0.05303026083380695 -0.10956169279912711;;; -0.00963797416719329 0.4170803204142975 … 0.1583786863015766 -0.15562628057182204; 0.016339418678024742 0.2948861942555334 … 0.016510235250968015 -0.2289856052273651;;; -0.00015845515986132527 -0.005210147070433236 … 0.2475635215523841 -0.07054084014093227; -0.0018211454760825778 -0.006038925071983236 … 0.20367686859465756 0.1881105416633716;;; 3.537677162964774e-5 -0.0022501298428766877 … 0.3389828419329189 -0.0027497481832466386; -0.0005958894600054547 -0.002277987980803439 … 0.058869499288618836 0.31496910813003426;;; 7.147853158740378e-5 -0.00015154601308778256 … -0.6555059786562181 -0.02252287095619396; 8.683430524790679e-5 7.687493399526313e-5 … -0.13521409416159572 -0.009176666185070187;;; 3.246208850259068e-8 -7.962640282107447e-8 … -0.3025941328602705 0.040112435651588535; 3.611120420082018e-8 2.1393780699150132e-8 … 0.15054601293171416 0.43228964248715074;;; -3.589846166393027e-12 7.324878455149353e-12 … -0.43024642282194836 0.15531077686262257; 4.740057786800726e-13 3.548100213368175e-12 … -0.0006265373244531046 -0.36348019832331985;;; -3.232433202753356e-12 -2.201262038584022e-12 … 0.00015109933547015472 -0.05463946848829457; -4.265094455048539e-12 -2.472440778881811e-12 … -0.0002057230092108515 0.6412475976081132], [-0.7026647393540442 -0.6168990531730428 … -0.05002993074669126 -0.10682134898550553; -0.7114928949864021 0.6087266097722922 … 0.04854491215415242 0.10652576481129733;;; 0.0036560948199223886 0.3706223953810159 … -0.16409765202792317 -0.14695702288398543; -0.005160114815813105 0.33394403589669586 … -0.0026892894676650834 -0.22653054193280756;;; -0.00010847781282817483 -0.0017064973198849564 … -0.1697714482749318 -0.07621196047161315; 0.0003094395546389301 -0.0018095393457742523 … -0.29657347814636537 0.1942500868712053;;; -9.199737599676005e-5 -0.0009461780184697025 … -0.55137362010372 0.09588882548168103; 0.00011964628427383845 -0.00090051892534771 … 0.04514860293256811 0.33330847681705045;;; 1.198779489299167e-5 1.954133208507825e-5 … -0.6180696280335406 -0.3503986729756146; 1.3978746321889172e-5 -2.335834558205251e-5 … -0.2998036464295587 0.4194171350013482;;; 1.6330417855868726e-9 3.3189964564531304e-9 … -0.21363174596541598 -0.154787938486056; 1.7039321818383313e-9 -2.178137689185994e-9 … 0.13589016702568188 -0.6301102767359393;;; -3.470508759165977e-12 9.252154969228749e-11 … 0.09684366862842832 0.09293290880604285; 5.16673799634502e-13 8.873297152436912e-11 … 0.00018137873265083228 -0.10639071394432893;;; -1.7200858819905572e-11 -3.7247102590142025e-11 … 2.6901423973251135e-5 0.013422384234767205; -1.976103483779081e-11 1.2335778649956819e-11 … 7.942569713809586e-5 0.025971931659681497], [-0.705766385854476 0.6183135068338569 … 0.023827527625025022 0.1741786634076484; -0.7084426102272753 -0.6158094299673764 … -0.023550089653551997 -0.17378971139333368;;; -0.000993284084942387 0.3502269888732496 … -0.1047719029923049 -0.30153007121450526; 0.0013726402510015716 0.34030546326707706 … 0.021153552097191292 -0.3205978065364603;;; -4.0094782937994594e-5 0.00045759722101047947 … 0.18563386665880352 0.2945613194471305; 6.321130219136926e-5 0.000415817251348484 … 0.3400556567137446 -0.5518460509439396;;; 1.452409789058479e-5 -0.00010518767862026588 … -0.7547223113420509 -0.4210114129111921; -6.59811188096113e-6 -8.832768477072986e-5 … 0.5174451356718195 -0.4209567048597739], [-0.7066585827220105 -0.6328513556761082 0.06717999986016174 0.30922428220147974; -0.707554580501375 0.6319877211965438 -0.06658023553444992 -0.3090713640965482;;; -0.0002058798188993051 -0.3176140653622508 -0.822512857371266 -0.471798540222964; 0.0003474051577191904 -0.31497934433828534 0.560826639269143 -0.7656770681142011], [0.7069675702361102 0.7072459647353605; 0.7072459647353605 -0.7069675702361102;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^d, 2^d)
xes = collect(range(0,1,length=2^d))
yes = collect(range(0,1,length=2^d))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="24b96231.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this example we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 8
h = 1/d^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,d)
xes = collect(range(0.0, 1.0, 2^d))

u₀ = qtt_sin(d,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.831397900080336e-6
Relative error for Crank-Nicolson: 4.8314559605106064e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on [<a href="../resources/#QFT1">13</a>] we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an esample of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h1 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h1><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve Burgers equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using CairoMakie
import TensorTrainNumerics: dot, orthogonalize

orth2(x) = orthogonalize(orthogonalize(x; i=1); i=x.N)

d  = 6
L  = 1.0
T  = 1.0
Nt = 1000
ν  = 0.01

N  = 2^d
dx = L / N
dt = T / Nt

Dx   = 1/dx * ∇(d)
Dxx  = 1/dx^2 * Δ_DN(d)

u₀ = qtt_sin(d, λ = π/2)
x0 = orth2(u₀)
v  = u₀
v_ref = Ref(u₀)

&quot;&quot;&quot;
    residual: (u - v)/dt + 1/2*∂x(u²) + ν uₓₓ
&quot;&quot;&quot;
function burgers_residual(u)
    t1  = (u - v_ref[]) * (1/dt)
    nl  = 0.5 * orth2(Dx * (u ⊕ u))
    lin = Dxx * u
    R   = t1 + nl + ν * lin
    return orth2(R)
end

&quot;&quot;&quot;
    gradient of J = 1/2 ∫∫ |R|² dx dt
&quot;&quot;&quot;
function burgers_cost_grad(u)
    R = burgers_residual(u)
    J = 0.5 * dx * dt * dot(R, R)

    g  = (1/dt) * R
    g += ν * (Dxx * R)

    Dxu = orth2(Dx * u)
    g  += orth2(Dxu ⊕ R)
    g  += orth2(Dx * orth2(u ⊕ R))

    g = (dx * dt) * g
    return J, orth2(g)
end

solver = GradientDescent(verbosity=2, gradtol=1e-6)

v_ref[] = x0
for _ in 1:150
    x, _, _, _, _ = optimize(burgers_cost_grad, v_ref[], solver)
    v_ref[] = orth2(x)
end

vals_init  = qtt_to_function(x0)
vals_final = qtt_to_function(v_ref[])
xes = (1:N) ./ N

fig = Figure()
ax = Axis(fig[1,1], xlabel=&quot;x&quot;, ylabel=&quot;u(x)&quot;, title=&quot;Variational Burgers&quot;)
lines!(ax, xes, vals_init,  label=&quot;initial&quot;, linewidth=2)
lines!(ax, xes, vals_final, label=&quot;final&quot;,   linewidth=2)
axislegend(ax)
fig</code></pre><img src="2effeaa2.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Quantics tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Tuesday 4 November 2025 12:55">Tuesday 4 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
