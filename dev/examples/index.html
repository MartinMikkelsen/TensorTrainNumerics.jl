<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets.citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Quantics tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li class="toplevel"><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in [<a href="../resources/#FastandFlexible">15</a>] where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^d)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, d)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(d) + id_tto(d) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(d) ⊗ qtt_basis_vector(d, 1) + qtt_sin(d) ⊗ qtt_basis_vector(d, 2^d)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-1.728036486421951; 2.02412472672462;;; 1.7418932089349; 0.7832861540833127;;; 0.4357793791630481; -0.7175809583966567;;; -0.3177070747485387; 0.5789539492388724], [-2.3058045981851385 -0.18286642371685044 -0.17910407753166008 -0.5787074719898495; -0.6081151926144985 0.9066391819669047 -0.7968774044313551 -2.096505714796398;;; -1.5652429205842309 0.6350274123909736 0.22763779316031374 -0.41977238608044243; -0.15479625940290812 -0.8169958712718915 0.45357663616032573 -0.06539398947398337;;; 0.7621884572076751 0.11073176571982807 -0.015952147219707214 -0.6234224119029643; 2.2625081806299083 -0.9517988856286632 0.45714057543555014 -1.4853451215128177;;; 1.0286147102031682 -2.8466743934169627 0.6459260406783106 1.1721562817740794; 1.1127668963686146 -1.564321705619446 -0.6882104371241877 -0.6992589593832399], [-0.1202539378718168 0.658870278615722 -1.5656427525211318 -0.3898878521145568; 0.6792190818489529 -0.11298792651967954 -0.20849359915520146 0.8859463253218145;;; -0.7632494624160746 -0.24232244458809635 -0.53193304421301 0.8332694784516563; 0.11944750401723274 1.6525805135305673 0.5233227047258787 1.2458484459988581;;; -0.25040579671395 -2.0380665349428972 0.41980193559765494 0.9634011624921838; 0.7333071944517785 0.25260392343694926 1.2840627514515162 1.5645806447070596;;; -1.3726650761392813 0.8084816846949839 1.5403873330654207 -0.3570514908305453; 0.16946877515526218 -0.194359154829586 -0.7981923273443962 2.3418320095123484], [0.057862871793613824 0.9587779117633458 -0.513781074643061 -0.08809014036128666; -2.534333093005991 -2.2000869984510762 0.724541609429813 -1.0306720625254762;;; 0.044767142718541035 0.04579035515949704 -2.0421748225367806 -0.31335710211481393; -0.33821824091033653 -1.1658251284846266 1.580291356224842 -1.2508949692198905;;; -0.6634117367363754 -0.9523376371598773 -0.8795080245437037 -0.8456189651926502; 0.34794459554868423 -1.0208322467946875 1.511005899477885 0.5924621442932952;;; -1.4695882133326499 0.9393773174420289 0.19565715464245353 -0.36413915008406145; -0.6009911624971972 0.755365245281472 -0.25720933263001844 -1.231086049795105], [0.28888302652960673 -0.023179399820120676 0.20620571467422866 -0.3865930713829717; 1.713452186051444 -0.7306024466737895 1.2270317499334362 1.0059589028598837;;; 0.3458770168598433 -1.177649211108844 0.5765496229430499 0.6081947776821673; -0.8787623622735641 1.6475724748489207 -1.923661303445608 0.445997525751537;;; 1.819077471973447 0.28056753813318647 0.49690253322992656 -0.0048492118082104655; 0.47975893685107507 1.1753382737710358 -0.9634305255938012 0.053267737434966565;;; -0.1553102517121599 -0.19533010486116223 1.0086467425630745 -1.3118582203498235; 0.7572540924696693 0.275490804929025 -1.5464480810187027 -2.0925941495189364], [-0.5051769060271643 0.6260311132299262 0.14623927145556184 1.7248647515707765; 0.5084433213722896 0.9244315810785413 -1.1341101925111712 0.07130951673804158;;; 1.351340218689941 0.675158056867208 0.15757299316515183 -0.005292285350091245; -0.47234171915550993 -0.4746691719903742 -0.028758978104042345 0.1616522381009781;;; -0.21866754208676067 1.2256989217236653 0.556050832731598 0.5342710383368472; -3.2616443534885033 -2.0028812878359172 0.473221976708134 1.1395041796785315;;; -1.1629784634188072 0.47955363059509504 0.9254749469378224 1.7640258497579535; -1.26370848609656 -1.0211346483207877 -0.30180501340069005 2.2808604130849752], [0.6897093087575722 -0.016664437076393042 0.27603085524850207 -0.2434412281690071; 1.9246553957150978 0.5351337766269019 -2.18159486548809 0.14254535970092716;;; 0.9686267397552589 -1.0827465626419086 1.07696085219699 -0.29985962814765926; 0.8245946518734357 0.6247404802027207 0.8268325779054612 1.8255508831944016;;; 1.639069777238238 1.5154497541095313 -0.851081082647354 0.5007486005724475; -0.652018042598005 -0.3925050658093014 0.430144284188233 0.4701875111328223;;; 0.4983339078862907 1.2571092951839862 -1.4066588903865165 -0.7048747805832396; -0.3916090733682587 0.1964981312753121 -0.6257888644368291 -0.2747898312352227], [-2.3981056399328757 -0.68213435972681 -0.2743841936059866 0.28032398472492587; -0.5458677321084173 -0.2779038968032836 0.5135451489967351 -0.7369197773216181;;; 0.5399761519605685 1.3979743320021019 0.3827106927177841 -2.7650183722695894; -0.848634213571786 0.43660347261652344 0.6728434107474099 -0.16884356747213267;;; 0.27557903519026594 0.5532597202723004 -0.7004256727723043 -1.1721216765044766; -0.602882901923322 -0.5634781111378384 -0.06197555798395137 0.056941429238871806;;; 1.3627392179181688 -1.2332083209180236 0.664778269859215 -0.131325149103694; -0.27917026726323735 0.2366487481583911 0.6303529031329531 -1.6325574662465137], [0.22648059380826036 -0.2920557435293772 1.1353619445797518 0.38670162244537404; -1.64870229995978 -0.7897504557594873 0.14028792890730443 0.42942283190943703;;; -0.15344284966126723 0.1246591475789949 1.8992553208760252 0.7088458509619663; 1.2525173978472022 -0.42574826556467277 -1.4027726960187308 -1.6206424991793587;;; -1.4158696183917683 0.9161650098554494 1.8703426266102718 -0.31775241067286547; -0.19533128590024765 -0.403786104542949 1.437694131961266 -0.5015196274800097;;; 1.260076182915854 0.1704380326472616 -0.8587053474459215 -1.7688809899071292; 0.7859734220619333 -0.26740006530160504 1.3611177851176202 -0.12300490714153989], [1.1567202588670455 0.8821435347001741 -0.8015263228930907 -0.245787327878826; -0.5035053540051079 -0.8550223234826799 1.0279915584531094 -0.5952533985929748;;; 1.3622799677592543 -1.294036043108981 -1.5154548114399555 0.45894933801966165; 1.2190245150799295 0.6348985739441063 -0.9706714624192044 1.4233913080960434], [-2.0865989507713723 0.03304102934146332; -2.087930098509135 0.5006433056658649;;; 0.6684018282999284 0.6899732810173552; -1.5395381144698872 -0.4138384414417895], [1.0955653716304856 -1.2526679338258508; -0.7375178810154988 1.799528592533399;;; 1.996326053248001 2.4999736229090623; -0.12557170213941843 0.6798921031823774], [0.194066846883115 1.02486200138266; 0.7487958265162322 0.5502700952352981;;; -0.38760336943764884 0.6725763648583495; 0.3513518426525939 -0.34434189505387314], [-1.023458627971597 0.13451885452982618; 0.4238642855771063 0.3782649512104485;;; -0.6789912801841338 0.14711963909115813; -0.7000256004895496 -1.8364846776242263], [0.02962824629770044 1.2654441246394479; 0.909546306531937 1.767765078829216;;; 0.6510398337287329 0.11322865263692966; -1.277458348490292 -1.43380415812416], [0.010280878852150635 0.04988434624560294; 1.2482935692213104 -1.0554830992988364;;; -0.030675203888141513 0.6387022129423655; 0.3312647134521597 -0.1194852703976813], [0.15777285867522375 0.1561800120132214; -1.191245922187752 -0.1851598685783511;;; -0.43632836931997837 1.2490020851240582; 0.5367480292744325 2.6976191486859937], [-1.6756042978129733 0.5705756421309395; 0.6842920293915625 1.7104911377054963;;; 0.27704566140172154 -0.09537670099317389; -0.19460509851459373 2.2796684499052136], [0.15055407052682448 -0.20396799071056818; 0.37595266818318374 -0.5178129596468243;;; 0.2113004618211821 1.524927646247974; -1.4926906772802992 1.600774635087457], [-0.3282793878284931 1.1792196308057852; 0.36592682442267505 -2.117609528280444;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-185.87277716794222; -182.81663247436782;;; -102.52465530247967; 104.2385594315646], [-0.6977672308087719 0.5189071530594603; -0.6992044882146377 -0.5167097783544568;;; -0.11018073481359593 -0.4814754626585795; 0.1090085770072013 -0.47945412829457223;;; 0.0075396707316696485 0.031382329791649254; 0.0071964514198768325 -0.031821362796408174;;; 0.007137309442137275 -0.0053354740376809155; -0.007192659515967104 -0.005056890253289788], [-0.7054646264581567 0.3660547009101031 -0.011034880047410442 -0.08788992030633141; -0.7058608967455817 -0.36561712652212974 0.031949032459674266 0.08599088899959112;;; -0.04510943641777838 -0.6047644542193358 -0.23006106250663902 -0.06834929008777829; 0.04494174991257135 -0.603525820679302 0.20432056584540184 -0.09540030617362064;;; -0.002738728968588045 -0.03418592091414509 0.5041132144522155 0.5237770370224345; -0.0025144246519670766 0.03428485837510147 0.4960597480814265 -0.5198486701132916;;; -0.0024079080470939145 0.0006091498195967452 0.4477854345417241 0.4566551464062924; 0.0024108138668850324 0.0003238464585562691 -0.451068328429812 0.46688770383996236;;; 8.109996357008102e-7 5.966957809833691e-5 0.0012266968760732248 -0.001850155135251864; 8.138766211771584e-6 -5.647396563210906e-5 0.0010649004793677349 0.00048465214431847787;;; -4.890464596377799e-6 -7.775985331242832e-7 3.506970460069551e-5 -0.0007571818259047328; 4.412624904814534e-6 5.341240297396166e-6 -0.00016018077105449505 -0.0008824346796894078;;; -4.6216448616596805e-10 -3.6813561103266698e-9 -1.8266589526414256e-8 -3.124946031981133e-7; -2.078777606305805e-10 3.607818929219961e-9 -3.1435125231801096e-9 3.3376389238523617e-7;;; -1.8228357216677403e-9 -1.352346036487813e-10 -2.911640158902585e-8 4.799863678185925e-8; 1.7166672846738386e-9 1.9019378549840488e-10 3.533191141149219e-8 4.14931365140144e-8], [-0.7067450193223686 0.2117486556416308 … 0.008933535823918455 -0.02493825795336963; -0.706830706614688 -0.21171907725936914 … -0.010326692750982015 0.023258138478586623;;; -0.021198558478219876 -0.6742100399185984 … 0.02565421475594317 0.019333500462767512; 0.021205836417155576 -0.6739911512566715 … -0.019654957531769535 -0.034965205822667204;;; -0.0009666237552773058 -0.027513829068426202 … 0.0014205402366405352 0.016552407382461047; -0.0008548549918432686 0.027471551756301435 … 0.00011688684832291454 -0.00016232061504503292;;; … ;;; -5.576117440165339e-11 -1.3239237778144858e-10 … -0.0012426997246672655 -0.014138765330829068; 1.067027249086841e-11 2.9080065433339695e-10 … 5.353987929176766e-5 0.01652310887303156;;; 6.662445493348556e-11 6.834714853164627e-11 … 0.006129707152076154 0.014694650856818888; -1.1257461896797364e-10 2.0218786270626002e-11 … 0.008189772375974427 -0.017876960626362248;;; -5.631419854161212e-12 -1.2922069984706884e-10 … 0.012045359966592178 0.007229113320660762; -2.3599042039338263e-12 -5.316478971910198e-11 … 0.0005735390128153308 0.006846380060530941], [-0.7070244556498854 0.11047671119769191 … -0.02467010033306358 -0.0005018970131759048; -0.7070338384258922 -0.11049274818889346 … 0.022976758552792766 0.0034781553842997506;;; 0.010463088374032946 0.698230134555353 … -0.050452260351616304 0.09709660409988047; -0.01048195824645459 0.6982235697995857 … 0.06027073094718388 -0.09776655572789375;;; 0.00029619614482896136 0.016459601836922005 … -0.07136322988500714 0.06774302897973004; 0.0002523804222457371 -0.016438261539567796 … 0.03876087742763391 0.007312690777713309;;; … ;;; -6.4491026859971465e-12 2.3031309009070287e-11 … 0.0454518581025155 0.26729563056406946; 2.845796311274722e-11 3.8770241912533864e-10 … 0.19316247642911916 -0.4802771564113422;;; 2.811598010683273e-11 1.8915576433318803e-11 … -0.24526997620615604 0.12288271155491655; 2.6804683466648745e-12 -4.818753951880045e-11 … 0.0721164199542959 -0.05133291175561819;;; 1.0458428788206013e-11 -1.2253695621129538e-10 … 0.12308794492443982 0.000451999410532375; 1.3320200407072087e-11 -5.977140991616376e-11 … 0.3265141694302478 0.033296673772020884], [-0.7070864825157479 -0.05569887557619445 … 0.05669359709105555 -0.06693707112430254; -0.7070877733939418 0.05567450340457979 … -0.05641822687154098 0.0672203570775346;;; -0.005283569158174428 0.7048775013486364 … -0.012979878026416551 -0.024707476836726406; 0.005259306841350143 0.7048814498176645 … 0.022371032077928343 0.012665281631083469;;; -6.701503654478873e-5 0.006570032216033582 … -0.0022396202236443594 0.06271768857670261; -5.497538846230413e-5 -0.006563738030403642 … 0.060505703268703775 -0.1204455323309379;;; … ;;; -1.5144720093100025e-10 5.996519651819773e-9 … 0.28338820116495733 0.1114232004946069; 2.7664854911100057e-12 5.191517683658098e-9 … 0.05041681985699999 0.018015675365226236;;; 6.926951850113885e-11 -4.103807938306869e-9 … 0.3916319745244107 0.1686950853345605; 3.2170825691004608e-12 -3.847031767302695e-9 … 0.12375691716888286 0.23240040073724974;;; 5.112011786669415e-12 -4.312856760729727e-10 … -0.05127615156674133 -0.10137806051175041; -2.3917773149913164e-11 -6.793768028160442e-10 … -0.13123642771240007 -0.17804750498534913], [-0.7071015088313566 0.027869480995206475 … -0.01578766535361855 0.04828306035686794; -0.7071020595483852 -0.027769598952912904 … 0.015824602286071413 -0.048226489426852176;;; 0.0027078114484941204 0.7065545832463752 … 0.004929214588172327 0.005492577936456831; -0.0026078650543201833 0.7065590759221514 … -0.004270318820857655 -0.00977794705660423;;; 5.258019061684201e-6 -8.299750183598472e-5 … 0.021609351510870085 -0.12890526215324408; -1.0450186075857901e-5 0.00028801122051395607 … -0.05007021501464371 0.012962828280358612;;; … ;;; 1.3942339510475285e-8 -9.586837117913673e-7 … 0.23397537917168726 0.10486870099267592; 2.9069763262448284e-8 -1.1399521462139433e-6 … 0.042565928715264226 0.24748350265268368;;; 5.196897583972376e-11 -4.595134852145201e-9 … 0.11515274591212954 0.4134128515004974; 1.002731666322779e-10 -4.4780553065470286e-9 … -0.14311977850544103 -0.06561792635793688;;; -4.665460014892823e-11 -5.535294129960325e-9 … -0.02215082449112311 -0.08815474934277918; -1.2053795412296588e-12 -5.404691186228531e-9 … -0.025074457660075412 -0.040431556243007115], [-0.7071052461348099 -0.014024419641468127 … -0.05373929420584466 0.01450588054044432; -0.707105775494795 0.013757594076841562 … 0.05378301418732029 -0.014425310154635045;;; -0.0014671260006029173 0.706967077370847 … -0.012642161164230132 -0.02122218455080142; 0.001200258415187044 0.7069725816714253 … 0.010580847178696156 0.021453382280537503;;; -1.2262402937484618e-6 0.0004924520816975997 … -0.023165446615466937 0.07375277883047121; -6.928208984687944e-6 0.0004907741863733001 … 0.014521196407316203 0.02722101232864856;;; … ;;; 1.6668887092461221e-7 -4.519304428152198e-5 … -0.17118254434514601 -0.087926852679163; -1.8942435966793246e-9 -4.485440170871407e-5 … 0.1605620786181395 0.0646419192616919;;; 1.5630477445245458e-10 -8.272366638070379e-8 … 0.12245775196790584 -0.14650602061224685; -1.5598338108960806e-10 -8.347178055284202e-8 … 0.6440715532746293 0.2523096858033512;;; -1.8219604079366637e-10 3.707168183494022e-8 … 0.05614756829009271 -0.17556752046265148; -5.342929546614975e-11 3.696362284884466e-8 … -0.1882113026201769 -0.16810963890761235], [-0.707106116022633 0.0072523409272785755 … 0.07530697127425916 0.16061303366138355; -0.7071066877219039 -0.006650505118249238 … -0.07529705417437096 -0.16064026489199154;;; 0.0009685568338709406 0.7070528722945928 … 0.004545179637073385 -0.01597074665073496; -0.00036680580442834555 0.7070588001594843 … -0.006039650012825023 0.012915599405143877;;; 8.153403878051879e-6 0.0032961327335354965 … 0.013394411699009482 -0.046758623488415564; 5.364485307004995e-6 0.0032889234996576174 … -0.008006177661393044 0.03634775177598934;;; … ;;; -1.2470586803681018e-7 -6.891369257398675e-5 … -0.1747393193865623 0.1239796662100392; 2.611978534059085e-10 -6.913908827426526e-5 … -0.34400570637105804 0.047310485911352305;;; 5.8189157790840735e-9 6.249945693183166e-6 … 0.21494006604035606 0.5687243801204356; -7.939384013317493e-9 6.199785609412212e-6 … -0.3302477144463904 0.26858802887924843;;; 1.1990363734171952e-10 -1.6528523579052285e-7 … 0.012667405188527412 -0.03146058904513149; 3.67475929557739e-10 -1.6600119311145934e-7 … -0.00010700981091280012 -0.04853860769626076], [-0.7071059480667157 -0.004262464794695983 … -0.006669559834994207 -0.03693432782972541; -0.7071066555302855 0.0027558269363531615 … 0.006669976274001924 0.036934178241836896;;; -0.0010842703911842862 0.7066548700325188 … -0.0003488363948394349 -2.4450676242842646e-5; -0.00042051008217054855 0.7066629145655569 … 0.00032158379151921797 -0.0003608049151390575;;; -2.21563758716172e-5 0.010875775055150043 … -0.0010255414343825892 0.0010539655114385853; -1.2834391774312972e-5 0.010867840056385495 … 0.0012578751648959913 0.0009997519637372843;;; 2.5465774645647295e-5 -0.0124209886955309 … -0.007400157917505573 6.2183930408538e-5; 1.4168426515653186e-5 -0.01240580240203989 … 0.007625845641877256 0.0006000486404823241;;; -2.46383730481875e-6 0.0007930105647309657 … -0.34847048345361353 0.6383414099543866; -1.7206342665666287e-6 0.0007920231903535759 … -0.4539384931783782 -0.6636971903446519;;; -2.7972118428245523e-6 0.0009665465188448874 … 0.6997513008134306 -0.25680614921063105; -1.8916315868048095e-6 0.0009659141269438936 … 0.34375044159454154 0.28865121687098294;;; -3.22282249168894e-5 0.015535659541509194 … -0.15997863571814575 -0.0032855923628763517; -1.774050113039695e-5 0.015526012946382683 … 0.05356397408429586 -0.000552250715997751;;; -2.087293421958796e-5 0.010263951896733934 … 0.18057560820814664 0.003844347269466323; -1.1316468412062726e-5 0.010256385920462182 … -0.058458168303137624 0.0007735266359305912], [-0.17692987301985733 -0.14153907193740084 … -0.515176916639264 0.1335127738568457; -0.9837216320248565 0.0050078160024965655 … 0.08075470385787395 -0.03684313461305524;;; -0.020063284505149912 0.9898491040256187 … -0.08039648635683319 0.012577107886831824; -0.007978181783808292 1.4270508040792722e-5 … -0.11170840301001747 0.14632693321727125;;; -0.02246354617985964 0.011413148760599094 … 0.6119238365516075 0.4822482789127464; 0.004095478804623246 -2.1245644856607712e-5 … -0.11417716570002714 -0.08966174917608118;;; -9.49637498817261e-6 -0.0008901306623060488 … 0.10621180324655682 0.0685924158632626; 1.7797725958705283e-6 4.099236900281593e-9 … 0.07820229193476741 -0.22741571259361912;;; 1.0422984333912114e-6 0.0029699224321220034 … -0.18294609877950815 0.3865152694656669; -1.2937263722953078e-6 1.5805592383160004e-7 … -0.2982009803063599 0.2721603952638091;;; 2.6458587164240786e-7 0.0006094635491768381 … -0.2090268760475228 -0.18218180733272782; 5.771893240286372e-10 -1.915613204813751e-8 … -0.2599174035275555 0.4006731186968436;;; 9.991919342078775e-8 0.00026951406761207484 … 0.026280717199447433 0.2629573975932916; -9.076326427064824e-8 2.6095975328215554e-9 … -0.11420049616166318 0.10585810447483182;;; 8.491463828602902e-8 0.00021605204187448725 … 0.14692676493575865 0.35935239588355594; -4.766888530631147e-8 -4.594693004301191e-9 … -0.18783772935613013 0.1885219909837755], [0.4088515527136593 -0.25443474836017255 … -0.020738811328583844 -0.019737748357140095; 0.9114624955965879 0.12963454300449162 … 0.0034218545575543905 0.0014755954642689262;;; -0.015312959837410102 0.9579375608704386 … -0.005546330717857626 -0.004409265090733372; -0.01862304550099315 -0.0012767543986314572 … -0.046977469447940325 -0.06772106638698498;;; -0.012807381586738525 -0.02818188945690068 … 0.036410764786879615 0.06350570506820026; -0.036485522359611756 -0.004197938179047361 … -0.13338596841314432 -0.17018893890068074;;; 1.8770654334534858e-6 1.3910162069450661e-5 … -0.00852672092961881 -0.013801646359123345; 5.748881333327072e-6 6.65583156611577e-7 … 0.014649163667048833 0.017160927803795356;;; 1.4926585910352815e-7 -1.3058232720368685e-5 … 0.002972898572446371 0.0015025722513994225; -2.7048202613013e-9 -1.7701601158127734e-9 … 0.9412904655817159 0.02770724965389165;;; -4.4184685318136306e-7 3.865678800475702e-5 … -0.017448191857448784 -0.008928387383302084; 8.382064269128707e-9 3.64835960530198e-9 … 0.29637333602633825 -0.19451931177266565;;; 3.8560887391879016e-8 -3.3489717348154257e-6 … 0.06102209909785293 0.03143045347920251; 1.4454652389703551e-11 -2.34952748399686e-11 … 0.0036083923993592386 -0.09955656556930147;;; 3.6835432234364835e-8 -3.2216744240677965e-6 … -7.778974081120243e-5 -1.1834866035087721e-5; -8.138728050514077e-10 2.980457341206408e-10 … -0.0008884342221734335 -0.954952153574444], [0.5238654978457334 -0.41712570019772527 … -0.13157293108265192 0.04938309878706645; 0.8503277083160666 0.2787223861685106 … 0.06689635662783645 -0.022295418442565697;;; -0.021737110266605915 0.8646987969758617 … -0.09656777687770565 0.027938283596738285; -0.019074987689181536 0.014128891609932005 … 0.07034518340222509 0.15141948070040867;;; -0.015176935834616986 -0.018910325031192648 … -0.4228732975552984 -0.07604716609609827; -0.03796092317922027 -0.007664599933627913 … -0.12818788113184415 0.12041646687216458;;; -7.801034890697279e-6 -1.0562056521267486e-5 … -0.10390047696402213 -0.029272357950392756; -1.9695163164344158e-5 -4.101683766498272e-6 … -0.0281356739914205 -0.033681700932066294;;; -1.2942917425258894e-8 3.8373050944130004e-7 … -0.5240064404819962 0.05046825886430499; -3.746138548688748e-9 2.922345270834883e-9 … 0.09021313052389093 0.37910129778162865;;; 2.0276010975308645e-9 -7.141018241423776e-8 … 0.20863562079516063 -0.02132075650693379; 1.0350152510649894e-9 -4.1735892458153425e-10 … -0.0809279085469264 -0.22508974314232652;;; -5.344390245139778e-10 6.085133958927586e-10 … 0.07812252137992681 -0.007418978752449566; 7.201048564655697e-10 3.2363589883009216e-10 … 0.001142007936867699 0.8655985449300133;;; 1.7023412564841456e-10 -5.664985171632e-10 … -0.6466799658400955 0.0658835590202413; -2.5021556531036916e-10 1.4272088953470293e-10 … -0.00024293796243576908 0.006313503274146826], [0.5890502562903017 -0.5834547483235154 … 0.1004864731182742 0.038712048727761884; 0.807357069501679 0.4322732582081245 … -0.0838631572175989 -0.020336282961468305;;; -0.011627066906470224 0.6801910658868592 … 0.09416315971139691 0.06010410811092728; 0.022984025488224254 0.0992896611818179 … 0.2907060696569412 -0.06046660806408103;;; 0.008617781816711535 0.009090861351355376 … 0.09575280129281262 -0.2801289360664961; 0.021368856507268493 0.010927105162830186 … 0.09839024894847673 -0.08744404165460995;;; -3.29660922692694e-5 -8.35752245630716e-5 … -0.06809077963411396 0.10485562062304055; -9.038639175142233e-5 -5.187245052237642e-5 … -0.10666891691257699 0.1203815163667765;;; 1.2798960954084662e-5 -9.42905724583535e-5 … -0.09152218072997755 -0.18064064219085582; 1.2859029744201534e-5 -3.6527639127245824e-6 … -0.7155676786808998 0.25032214407325976;;; 3.837517257860577e-9 -3.0788013737736685e-8 … 0.031064406106335818 -0.15621115846228803; 3.3228857234647534e-9 -1.2434127959458265e-9 … -0.43385616259643134 0.18393947919760434;;; -8.788691031099041e-12 -1.3326451832176723e-10 … -0.05713029495769535 -0.25101753659362225; 3.3535546310031306e-12 -2.956974647141189e-10 … 0.2502960457250748 0.35371576523196757;;; -4.55743412878221e-12 1.6923795393783352e-10 … -0.03368287541760258 -0.11199018624809631; -4.068294984501332e-12 2.092134385213851e-10 … 0.27923604917262485 0.7245824197061044], [-0.6557032681180204 0.6295648159808844 … -0.013339470252351385 0.14006877768097695; -0.754197986217628 -0.5463391441126505 … 0.020287630164256932 -0.1172149767656947;;; -0.012585750972124644 0.5063044859445848 … -0.019919013101686665 -0.27378300802601985; 0.0318834568041473 0.22054581821382885 … 0.11489712924823316 -0.09345028688221114;;; 0.002541225011108251 0.008054561844757665 … 0.17230712520615213 0.5939139856223963; 0.0075535120189392626 0.010539237973059322 … 0.2735999291830808 0.1953755149554843;;; 5.999403578819338e-5 0.000743565704463192 … 0.09796297230600529 0.3123444384381621; 0.00033327028459329857 0.0005992552893225484 … 0.13521382327262466 -0.10834188366983602;;; -0.00012078496739690988 0.0003557673759669341 … -0.5689441403119725 -0.014680623030840957; -0.00015229429635356425 -3.998920068729746e-5 … -0.10479362337692992 -0.029997894060628586;;; 2.8831865257503012e-8 -9.569275556841892e-8 … 0.515562388387797 -0.04365454738491893; 3.334250432111022e-8 2.84625952244698e-9 … -0.10454726306352935 -0.09735643167356114;;; -6.012795448682177e-11 -6.581174950880373e-12 … 0.3036652306938563 -0.5190325827056719; -1.1075510914022245e-11 3.980925084016941e-10 … 0.15501557423318701 0.2302995029152805;;; -6.383475019654847e-11 7.916162832069574e-12 … 0.3545836324626043 -0.11161980787519579; 2.5066818027588098e-11 2.4499306431830754e-10 … -0.0006056260221848413 -0.18803674081618693], [-0.6928250804428413 -0.6212708807188813 … 0.1777705753159219 -0.052274155703162975; -0.7208996004905396 0.5960285966987713 … -0.17716110183607545 0.048117226652512946;;; 0.008960924215891614 0.4095600496258093 … 0.23137726972557993 -0.15372522640460148; -0.014640982980899506 0.3016151617875453 … 0.39153017013230723 -0.005040860621348402;;; -6.548396389802429e-5 0.004473229033110168 … -0.07439663351407706 0.22450168394983352; -0.0014292907072371876 0.005154270920494276 … 0.3467516427062431 0.22594236129790812;;; -5.7633848218026865e-5 -0.002660546479047181 … -0.056714977886897874 -0.4624216425074331; 0.0006757298435585092 -0.0027542772077460537 … -0.5608643433691947 0.061531882454282594;;; -6.494849946174413e-5 -0.0001346956893258794 … -0.03705416538835889 -0.6948662536058996; -7.78820694617832e-5 7.508836836069428e-5 … 0.36453406304864777 0.015467372001076014;;; -9.356060761746853e-8 -2.2462568645467047e-7 … 0.1060696176688027 -0.3338149605158029; -1.0317884916842977e-7 7.404572123721127e-8 … -0.3212917525411112 -0.11318649038426003;;; -4.26658044662483e-14 9.472836856924408e-12 … -0.005367138623251477 0.05519136510641204; -1.3518741560367184e-12 6.771720221907027e-12 … -0.034367221391875064 0.13842944493005388;;; 3.252594645983153e-12 1.1335067621783468e-11 … 0.056278920889573376 -0.10809634806501463; 2.0922885649514707e-12 3.96949008913621e-12 … 0.1830541257190853 -0.1049228619295206], [-0.7032924558591169 0.6164579632067702 … 0.0722204509881313 0.023916441565194443; -0.7108791381186511 -0.6094331135855396 … -0.07184351611944341 -0.0235444479886177;;; -0.0032305004384832743 0.36804024612376945 … -0.11868666311105792 -0.06090508091694527; 0.00447681750319709 0.33632027774166434 … -0.13243853973447922 -0.02071694275108252;;; -9.996501843895816e-5 0.0014736179931940634 … 0.07835414529139424 0.05475198382945991; 0.0002574036435370505 0.0015359479538594417 … -0.2140571821893041 -0.019711290752080154;;; 8.603695737704491e-5 -0.0008507648374927433 … -0.12123323780644181 -0.20345931042805016; -0.00010286351549682507 -0.0008077548833118508 … -0.033702607067439584 -0.07532575850446291;;; -1.0488817209373395e-5 1.6680776274960063e-5 … 0.07808960720761353 0.22178699824906223; -1.2179930723368407e-5 -2.1074246256338677e-5 … -0.013372753973535654 -0.1323441314507908;;; 1.155166019468298e-7 -2.345703440558401e-7 … 0.4962234055852338 0.11253989272969454; 1.1966895237756806e-7 1.6214468812678925e-7 … 0.18202480172154714 -0.05661449781916326;;; 6.793602200568629e-12 -1.5063277057860472e-11 … 0.37681532732904377 -0.0347752441718368; 1.4722362163588497e-11 1.8733597549142644e-11 … -0.31013587265148185 0.3867732622404072;;; 1.2347996228399645e-11 -2.253743701429695e-11 … 0.006978548268781488 0.8428571759712352; 6.4109131066680265e-12 7.493943696871428e-12 … 0.6052542831682393 0.022205921836062344], [-0.7059332395393803 -0.6181700003018232 … 0.13043640725455657 0.11780478707306911; -0.7082768659261448 0.615987115510847 … -0.13028263093928474 -0.11740505722967601;;; -0.0008687455601133591 -0.3495492725427418 … -0.1901445594504311 -0.2567731134018795; 0.001176132958445101 -0.34094097467231477 … -0.2765862037301938 -0.16298621860456589;;; -3.3712458312622207e-5 -0.00039540222008806316 … 0.1388111263064847 0.3174294843796438; 5.6284960387191165e-5 -0.0003339230761553255 … -0.6495655121689041 -0.027839564290474822;;; -1.2755777172432075e-5 -9.145859145407143e-5 … -0.0740406169644395 0.8608831462593226; 5.696799477081551e-6 -7.676973720698298e-5 … 0.6377083987289038 -0.19283369791531627], [-0.7067025158064748 -0.6328092990043074 0.06801501349758654 -0.30902735022227307; -0.707510728085194 0.6320304405226289 -0.06749116515242987 0.3088867665075634;;; -0.00017704184876543919 -0.31748010105346175 -0.8240788601011445 0.46914857606697047; 0.00030406141168087125 -0.3151131523461568 0.5583125763402513 0.7674572795051442], [-0.706980925426605 -0.7072326145497966; -0.7072326145497966 0.706980925426605;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^d, 2^d)
xes = collect(range(0,1,length=2^d))
yes = collect(range(0,1,length=2^d))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="830f4e39.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this example we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 8
h = 1/d^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,d)
xes = collect(range(0.0, 1.0, 2^d))

u₀ = qtt_sin(d,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.831394807313625e-6
Relative error for Crank-Nicolson: 4.831467516857469e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on [<a href="../resources/#QFT1">13</a>] we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an esample of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h1 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h1><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve Burgers equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using CairoMakie
import TensorTrainNumerics: dot, orthogonalize

orth2(x) = orthogonalize(orthogonalize(x; i=1); i=x.N)

d  = 6
L  = 1.0
T  = 1.0
Nt = 1000
ν  = 0.01

N  = 2^d
dx = L / N
dt = T / Nt

Dx   = 1/dx * ∇(d)
Dxx  = 1/dx^2 * Δ_DN(d)

u₀ = qtt_sin(d, λ = π/2)
x0 = orth2(u₀)
v  = u₀
v_ref = Ref(u₀)

&quot;&quot;&quot;
    residual: (u - v)/dt + 1/2*∂x(u²) + ν uₓₓ
&quot;&quot;&quot;
function burgers_residual(u)
    t1  = (u - v_ref[]) * (1/dt)
    nl  = 0.5 * orth2(Dx * (u ⊕ u))
    lin = Dxx * u
    R   = t1 + nl + ν * lin
    return orth2(R)
end

&quot;&quot;&quot;
    gradient of J = 1/2 ∫∫ |R|² dx dt
&quot;&quot;&quot;
function burgers_cost_grad(u)
    R = burgers_residual(u)
    J = 0.5 * dx * dt * dot(R, R)

    g  = (1/dt) * R
    g += ν * (Dxx * R)

    Dxu = orth2(Dx * u)
    g  += orth2(Dxu ⊕ R)
    g  += orth2(Dx * orth2(u ⊕ R))

    g = (dx * dt) * g
    return J, orth2(g)
end

solver = GradientDescent(verbosity=2, gradtol=1e-6)

v_ref[] = x0
for _ in 1:150
    x, _, _, _, _ = optimize(burgers_cost_grad, v_ref[], solver)
    v_ref[] = orth2(x)
end

vals_init  = qtt_to_function(x0)
vals_final = qtt_to_function(v_ref[])
xes = (1:N) ./ N

fig = Figure()
ax = Axis(fig[1,1], xlabel=&quot;x&quot;, ylabel=&quot;u(x)&quot;, title=&quot;Variational Burgers&quot;)
lines!(ax, xes, vals_init,  label=&quot;initial&quot;, linewidth=2)
lines!(ax, xes, vals_final, label=&quot;final&quot;,   linewidth=2)
axislegend(ax)
fig</code></pre><img src="2effeaa2.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Quantics tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 8 December 2025 09:58">Monday 8 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
