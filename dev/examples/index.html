<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in <a href="https://arxiv.org/pdf/2505.17046">this paper</a> where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^cores)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, cores)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(cores) + id_tto(cores) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(cores) ⊗ qtt_basis_vector(cores, 1) + qtt_sin(cores) ⊗ qtt_basis_vector(cores, 2^cores)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[0.22681377273011022; 0.41301398988951654;;; 1.1339369715448557; -1.4137276364565075;;; 1.7565290381205325; -0.9077390952008676;;; 0.6107930069504319; -1.721946218612473], [0.4825932103435875 0.5102555929511033 -0.030562885369129374 0.705355810980363; -1.4786835255133937 -0.07841610298017554 -0.6832916868181207 -0.9135664209678404;;; 0.9012977744010611 -1.9365804587775517 -0.8397089185874325 -3.147485390732975; 0.20584056028027428 -1.2126863639204728 -0.9750688495165376 0.8477937558734496;;; -1.3789261211708266 -2.4625723142319815 1.6857228837428495 1.1995427405557852; 0.456132350650311 0.5643089057160534 0.3346238160957002 0.055637751364837916;;; -0.9978507929005956 -0.7230012239181792 0.20069924624039115 -1.7442363802735827; 0.10546763747336543 -0.3310865355655193 0.16123516791902784 0.017874072583003768], [0.837836803146599 0.43298531301748183 -0.6497990637226252 1.0109812809877552; -0.492256221642752 -0.20258193187300189 -0.08712620657247275 1.2771719658642933;;; -1.1212544677229914 2.611649598931085 0.22888551157927534 0.020227384666803065; 1.079921487129355 1.0025228050423576 0.2739299472432831 -1.549057429445777;;; 2.216257268238712 0.36127405912499627 0.42353922862581905 1.07511375086923; 0.38216500481051163 0.25810674367842656 -0.2630348236965778 -0.8520891664263188;;; -0.3101615985085054 0.1749160523138811 0.11819609501783394 0.5411173879247868; 0.1527073488479096 0.589655114494387 -1.1041421954215973 0.08965870023243251], [-0.26092137057477216 1.392463915198021 -0.9991738613229577 -0.4314505940081028; -2.0680724720400407 -1.033751019768713 0.10257993818907431 -0.03850476488123407;;; 0.32868617958543445 -2.5012115025488533 -0.36631652612144333 -0.4914335541373389; -1.4610897718210034 -0.9387945548285508 0.13650994077555859 1.1408433992615326;;; 1.078884638746712 0.5184196530406503 0.1508949561854009 1.6058085833969116; -0.007117661950108583 -0.7537917147539335 -0.28419766982906525 0.709620149696065;;; 0.06528707642228147 0.05090254840434445 1.7107084568281932 -2.776409596410688; -0.4211113670838506 -0.9661219392347172 -0.18369060023104536 -1.8937052060042294], [0.6926118931127315 -1.5197419324957102 0.3634709620825576 0.07645031470521511; -1.7183079030706927 -0.5742090741891703 -1.1208512241292425 0.31575424160916826;;; 0.8135125162536093 0.6468324350209257 -0.8566824839331009 1.267826214022711; 0.02887384596322463 0.11228586105190248 0.4398717893056664 0.004778399192709068;;; -1.1917914481738268 -0.36562834057115595 0.470301096361285 -2.053389667653114; 1.2205966419127379 -1.4345048564740142 0.31061980204158823 -1.2859483045463382;;; 0.08482453091086546 0.0707398605672114 0.7193375456518849 -0.5893663874832982; -0.31903040027360585 -0.5057035475795237 -1.0066678872892953 -0.2549084985062233], [1.3752061802487698 -1.186357659213454 -1.456087387404617 1.2647590640152162; -0.3223352763725628 -0.44240995899382834 -0.858158720580331 -0.7327491137292117;;; -1.2613091226680713 0.05876522552635541 0.7996651021937227 -2.025190606201234; -0.6859503016597132 -2.2373677104754077 -0.48193303756276584 -1.1077090232575513;;; -0.24729212379915808 -0.8847259593716101 0.4562960810744827 0.26369834776537693; 1.4899433732288654 1.2413912088963535 -0.6147882607471531 -0.4407639502304019;;; -1.0221825016357096 0.2293407960459496 -1.4669396961448138 -1.7371718864297399; 0.2045884758444709 0.28904805659514987 -0.6803756709070974 -2.1766101584335016], [0.5583570689415219 -1.2053313055978025 -0.4649573901373507 0.9006899091495556; -0.12770538797856967 0.023298933250036458 -1.2243195073851156 -0.33039312729238507;;; -0.36430304631843063 0.2624324105403279 -0.16487774340360134 0.4793505188346891; 0.3176750950251611 1.924180672424898 -1.31989375216685 0.9685747660073897;;; -0.7574793255956115 0.876438953914008 -0.0328156288701193 1.3715367504269425; -0.8784350677727389 0.8033779349838275 0.17841856819348853 -0.5901924800818418;;; 0.7780988263691007 -1.275291244567465 0.17193732703162648 -0.37153356606400884; 0.9856095006997128 0.7353921825868361 -0.23582694099208026 0.033661349349642516], [-1.2361942925841263 -0.07197517582598063 1.2147508114689305 -0.4200263097358215; 0.5055638524265366 -0.17932397096618374 1.5548140269871429 0.283439894706314;;; -1.359057826000054 -0.7498213139306973 0.37474456589748173 -0.8404606981550844; 1.579576549448781 1.7288231969807581 2.110789542123095 0.9302060489692056;;; 0.6363764652580276 -1.8384067481279338 0.14110014432785525 -0.20995257973290188; 0.06035021629396032 -0.09902743284557475 0.03773183166346963 0.688881843953305;;; -0.26438936400863156 0.3480899859352969 0.6819235193971888 -1.3333779725021921; -0.8787283846815964 1.3992178294055466 0.911794342466834 2.1786848977099815], [-0.23899081335563546 0.41354209109866685 0.656057544836191 -0.666321880468556; -0.6230515171370872 0.9973108806103227 1.3876857065102428 0.968240196742138;;; 0.19704703323886913 -1.3946939109536538 -2.5467977794131365 -0.6244241564475612; -1.534713195636232 0.4199952465848968 -1.50420771360183 -0.23313773665350643;;; -0.6949476006182408 -0.1761880216652838 0.1727216894881803 -1.0847636388347022; 2.581523535000668 -0.14418572303696472 -0.8703003702788741 0.4417306604728347;;; 1.7920875433922816 0.3876582682748845 -0.364213806254896 1.1421228316059329; 1.5758798455520584 -1.4061690739883872 -0.023746753653620598 0.9795288156637494], [-1.06615781026028 0.895922163562282 -0.7860233457747829 -1.2297067179452972; 0.7786412895633229 -0.20438437089209574 0.05672070737267276 1.7707914344905198;;; -0.4522567768077182 0.03697187843342711 2.2667920007481035 0.5144316113932456; -0.8105119792075339 -2.484195165020684 -1.76730706805811 -0.735730270012606], [-1.5831053534386945 1.0080200896786984; -0.027540798218630733 0.021950001376744434;;; 0.2359373520582503 0.938893948528082; -0.9541586249467674 0.5975141137057763], [0.6507649388763808 0.1968458043519909; -0.7911394756497195 0.9665899236463451;;; -1.1434399281712255 -0.470471909062216; -0.7163918345617779 0.7835958084582345], [-1.833046686328046 -0.011221746339824524; -1.297441551773198 -1.55299400324477;;; -1.245631398766769 0.21135015567565904; 1.3243674403305807 0.0742902797783434], [1.170917560293495 -0.2865844949832681; -1.5591690237762073 1.2200654781424563;;; 0.23820944842772315 0.19563785049759022; -1.2030004346547478 0.34159074216302054], [1.4465529539077564 -1.0514928924074767; 0.7733183823757688 -0.9943444834091107;;; 0.005652301542681286 -0.7467765575975146; 1.8805265764530212 -0.7673044190567069], [-1.0781121543524166 -0.615241084148363; -0.9253636120593567 -0.6728567778282458;;; -0.01983166877497116 -0.07430537591756727; -1.6235724194007 1.6490997554667204], [-0.2533170642692771 0.6982278535943623; -0.84007483242982 -0.5189895197924027;;; -1.2867407198495078 -1.2450352916187781; -1.1763104137607239 -0.13182488966024236], [-0.44003174879925877 1.6897635717393475; 0.05752449581413235 -0.7600142163499511;;; -1.0595772421284926 -0.20034113829140504; -0.9815610391887639 0.0819452012544738], [-0.4382369878963432 1.0993583756903642; -1.7363341323600403 0.1590738815366615;;; -1.6286244188461911 0.592066716037851; 0.4340916500777311 -0.17507678259651574], [0.030719255777821017 1.4370774845649958; 1.7656824676732483 0.19584523395493336;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-167.18251367100873; -201.7156183884992;;; -117.92514628932956; 97.73671736068002], [-0.7097708466027116 0.47718001064197346; -0.6840447879742934 -0.5135079119671706;;; -0.10756550539242964 -0.4889145346933529; 0.12662641835807972 -0.5128517902384196;;; 0.010133938702836166 0.06096692775071913; 0.017317864063641435 -0.05182935375358457;;; 0.012738195965202594 -0.005681697347130245; -0.011773649210954869 -0.010906462811241642], [-0.7079123125670298 0.33496547615386557 0.21476744269315437 -0.1046661692311802; -0.7028491658920291 -0.3395918198979319 -0.18695003242397687 0.1210109953275216;;; -0.04819358259573571 -0.6146503834242372 -0.1723288807032896 -0.20182160240117578; 0.0496915187779565 -0.6239997249137962 0.38881790510452996 -0.007195555631706786;;; 0.0025405378908659646 0.05157324715498465 -0.44305335591320183 -0.4932209308734517; 0.006110370376516696 -0.051291894294820076 -0.4955216105417948 0.506511393902797;;; 0.003575808578340861 0.00241106444098418 -0.3918501286237148 -0.5112863102488084; -0.0038199953865469087 -0.0009352768970401417 0.3764720322393067 -0.4113528314025974;;; 0.0001111985113370982 0.0020173563011835873 0.02141438472786698 -0.0274954896452463; 0.0002154111596025303 -0.0018274560660523024 0.0212861872955825 0.03311672146003405;;; -0.00023453360979523835 7.21604888459731e-5 0.003527487934911079 -0.025671393620119085; 0.0002361508326505271 0.0001194172023050728 -0.0028715372589204883 -0.025692613231873246;;; -2.8749799393233586e-7 -7.1692026440563766e-6 -8.08025820304846e-6 -0.0003339892005443013; -8.477817730993784e-7 6.863567562434296e-6 -1.867804168220119e-5 0.0003309341594123646;;; -1.938795957587199e-6 5.412671516431564e-7 -1.5958707501424337e-5 4.224263183485527e-5; 1.8666197797228292e-6 1.331776136108702e-6 1.4547747369622245e-5 4.678743219163338e-5], [-0.7070159325142323 0.19008456761385434 … -0.14681619276598826 0.000620554615568269; -0.7064122795365279 -0.18991365138667157 … 0.14677648136634036 -0.005278854259498531;;; -0.02371199806901762 -0.680117572684189 … -0.03777710091855217 0.06951895706138296; 0.023287896782118855 -0.6807545392329856 … -0.04078731702505864 -0.059699312049138184;;; 0.0004857774272942474 0.02928249207891182 … 0.11739146367151784 0.09507118951487839; 0.0018033366549234907 -0.030268185829372945 … 0.027346760121908044 -0.09681282183167161;;; … ;;; 1.1499181800666934e-10 -3.5759970910565226e-10 … 1.7525990428754116e-5 -7.448284403580501e-7; -7.462321635721308e-11 -2.75877149502257e-10 … 7.760940069020251e-6 5.224681618476648e-5;;; 1.444000884514809e-10 1.4366346307161602e-10 … 5.530695148491289e-7 -1.5066156423594873e-5; -1.0893973595329666e-10 2.2898575902361005e-10 … 9.423414416779308e-6 8.961586010179738e-6;;; 4.171392226816906e-11 4.169870733727109e-10 … -3.7918015296265124e-6 7.664805119544335e-6; -6.646979492816622e-11 1.8477566392518747e-10 … -7.6056067169043354e-6 -2.528805771731588e-5], [-0.7070360677464983 0.09775761771529994 … -0.04915705468399853 -0.0490984726695194; -0.7069806041115426 -0.09767158759192784 … 0.05116481305204303 0.04718157625010432;;; 0.011842547648799584 0.7001980397617715 … 0.06485058990305385 -0.04904596651359206; -0.011740922139579127 0.7001639115618511 … -0.055085454157187866 0.0570019198720967;;; -0.0001477383812831817 -0.0014453063543796055 … 0.07739612085969609 0.20462367169151643; 0.00022279476482724611 -0.0017813991378430843 … 0.05605159591920649 -0.03089370116534367;;; … ;;; 3.030902948986564e-11 -4.1232546318770975e-10 … 0.33707147068376425 -0.4589223052162597; -3.0704837091792653e-10 -3.7978682161529477e-10 … -0.12725108869440904 -0.3446954680225193;;; -4.387301944471497e-11 2.626184307381465e-10 … -0.006511888934937137 -0.05057501510816365; 2.948251446458909e-11 3.5945057689559983e-10 … -0.15983157834203687 0.24908651497839454;;; -2.557307813879331e-12 3.39362061314797e-10 … 0.474101095041307 0.19217742665614126; 1.249565420796183e-10 5.570433194028859e-11 … 0.09376343465520914 -0.18641022719497305], [-0.7070883935794886 -0.048666445042064466 … 0.00812534773675772 0.03138286527532173; -0.7070748944740534 0.04928574287992384 … -0.007520165760671641 -0.028556377970775433;;; -0.005643273483020129 0.7054168058611803 … -0.034145669981788 -0.163499110123357; 0.006262683685560367 0.7053635626303699 … 0.03237307529855168 0.16932917178885779;;; 0.00010569312368951813 0.0006076789715259769 … 0.1474787128841895 -0.0821768869134181; 3.948659859911846e-5 0.0006783894971391673 … 0.015338902695315904 -0.03368835485891531;;; … ;;; -2.7064276305646695e-11 -2.841170969852744e-10 … 0.013548365871506976 -0.04786136076568149; -2.2031547936116323e-11 -3.446744838723012e-10 … -0.039544658355941065 -0.19705568722020855;;; 4.039989886677056e-11 2.862389573305164e-10 … -0.30234423935221527 0.10547710452235408; 1.3848406368553661e-11 2.111526982395188e-10 … -0.32002476124033175 -0.421339095918932;;; -1.3475786615348697e-12 -1.8802846449689706e-11 … 0.07321581029742838 0.012234432947288888; -3.770429982647797e-12 -5.455293496563767e-12 … -0.02663568071623705 -0.02712137225829561], [-0.7071068324651977 0.02231589388350362 … 0.003800236746041205 0.10571051571847; -0.7070872842282283 -0.026623649586709184 … -0.0036048271673861454 -0.10470686922523685;;; 0.0008476209472082609 0.7067141140536317 … 0.021323009043675557 0.11366943876048996; -0.005150612702549612 0.7065624521037605 … -0.020245755721716985 -0.12021755173702736;;; 0.0003244551955283391 -0.006702593018547769 … 0.04268417914083976 0.07474352015264936; 0.0003379290585474181 -0.006709413467257307 … 0.03853543757239507 -0.01800957138571739;;; … ;;; -3.7212175306061763e-7 1.6178969266585115e-5 … 0.09233881331107335 0.03356487052555805; -5.043505793320745e-7 1.6134814101664186e-5 … 0.07594066690331276 -0.12068600076939656;;; -3.2207471648061123e-10 1.7950970254623785e-8 … 0.12046463147487972 -0.16166966812247952; -4.664647292060604e-10 1.7824508850671107e-8 … 0.026215087598255683 0.042286691501985316;;; 4.673171789375855e-10 -1.8693845216817113e-8 … -0.04424334391823079 -0.34889160330438557; 6.124066185679478e-10 -1.8659843528660698e-8 … 0.026766507668837418 0.1817617899715488], [-0.7071027585007069 -0.008417751580984211 … 0.1340222984495993 0.11637108278475158; -0.7070861236056423 0.016176418814454984 … -0.13395209510825562 -0.11689911102565426;;; 0.0023709959238184283 0.706832242756721 … -0.015344876760730973 0.12874989058545558; 0.005366758969802552 0.7066966238801743 … 0.02043125452215364 -0.12478807061545819;;; -0.00038935100479498496 -0.014589264530533884 … 0.02774840420219563 -0.03103115498987799; -0.00043272076384847123 -0.014579251325845907 … 0.017780391510950153 0.03876218888008323;;; … ;;; -8.038716911039058e-6 -0.0004607733684866344 … 0.182153535920607 -0.03310682380756527; -9.990161719850994e-6 -0.00046061545482921617 … -0.14973256017867326 -0.05987783167964245;;; 1.6458815292736617e-9 1.0658476548911582e-7 … -0.10971474394184147 -0.007682609937219189; 2.0991224475644048e-9 1.0643345539307881e-7 … 0.24835006573958054 0.33403105851391146;;; -3.315137963456769e-10 -1.6636086805130944e-8 … 0.10172349266186412 -0.040897345215433624; -3.9904042753572804e-10 -1.6632670852863613e-8 … 0.31659126398368453 -0.019372724432728992], [-0.7070908512286559 0.0007736899730240969 … -0.06385681994522832 0.04255076340464851; -0.7070793625012907 -0.011723310365873917 … 0.0639576218979952 -0.04246570998991227;;; -0.004709807186454415 0.7061650311899562 … 0.05002258240668526 0.04159289700923597; -0.006188963352260582 0.7060686774582365 … -0.04883792143442865 -0.042416933941417025;;; 0.0003430774622304627 -0.020223498776062946 … 0.09435010480269387 0.024732026221413513; 0.0003799603642655893 -0.02021586754665921 … -0.08437439480309047 -0.04267307128344672;;; … ;;; 3.85848786550464e-6 -0.0003240736468062517 … 0.3148008467577573 0.24435015221966494; 4.538765262944432e-6 -0.00032430254537143665 … 0.14660356720316617 -0.17745876350243237;;; -2.243336879236985e-6 0.0001440013271074821 … 0.032233977118112725 0.13901254098198645; -2.542495585491321e-6 0.00014398967623731202 … 0.40507011758428896 0.30672758786027404;;; -6.638842708454782e-8 5.301748977580779e-6 … 0.09066117522729708 0.0057753839450759474; -7.748041858718429e-8 5.304650925202698e-6 … 0.14467595302891972 0.014008503764773216], [-0.7070772478296655 0.0035796344333552297 … 0.0019473290580043672 0.033341513060930285; -0.7070703257742598 0.010062663972866162 … -0.001947202680502563 -0.033341306430684524;;; 0.006378814113737022 0.6970917340050607 … -0.0006930564583148922 -0.0001328110448020999; 0.007086377296072618 0.6970303254785862 … 0.00022382231647241442 0.00046348637851371206;;; 0.000237824814005036 0.02691983440353622 … -0.0004978128513910662 -0.0010332263459153107; 0.0002638792928296197 0.026918596718119334 … 0.00029379504769492474 -0.0008553069067672079;;; -0.00016239123902605628 -0.018490372330508813 … -0.006521586843617069 -0.012567466374129062; -0.00018078324779652717 -0.01848925987514771 … -0.0010621087537845116 0.008950007439690474;;; 0.0001195938703591594 0.013525523830690377 … 0.1546647860281672 0.6126593717806303; 0.00013329225619913544 0.013525110114054474 … 0.2664105495460606 -0.5001773380463509;;; -0.0002876360220720824 -0.03280582789026314 … 0.40591195361393556 0.5491289405327933; -0.00032080090970157464 -0.0328026900371587 … 0.8129734357700535 -0.23967684101131884;;; 0.0008540049384747757 0.09781477217124479 … 0.058066639698452965 0.08135538943156709; 0.0009528192314018461 0.0978039272521238 … 0.138739435901288 -0.02917428223660458;;; -0.00040822066674734325 -0.04644189532186333 … -0.126326718113967 -0.07449640403493521; -0.0004551941865483482 -0.046437475439765126 … -0.20194798551583815 -0.0007850234146862575], [-0.17688350666420258 -0.14205979733347746 … -0.18536044865249932 -6.927266819202905e-5; -0.9837268619017986 0.005012903798746615 … 0.0147388884606981 0.005355197651261804;;; -0.02016518314674123 0.9897848405617256 … -0.03632319605436523 0.0025221022373163047; -0.008110168510537532 1.0015468372736311e-5 … 0.014037471313908135 0.04995299116827144;;; -0.0224631332103288 0.010561805685092466 … 0.854610726722487 -0.21850155526018308; 0.004084647022515897 -4.789506401928739e-5 … 0.07131705956189163 0.19655454755461432;;; 9.932792178980248e-6 0.0011064963252979212 … -0.13394741255851694 0.03287299611830146; -1.805327046944811e-6 2.557259517144491e-6 … -0.007528101206509673 0.053958638901614266;;; 3.800992588311335e-7 0.0009232929073770545 … -0.07829107650618544 0.011620724933549533; -1.3917144714155295e-7 1.0598385020353943e-5 … -0.04417809934133192 -0.07051832910621783;;; 8.047548340894394e-7 0.002082672833785282 … 0.23230326380676566 -0.1104745028373599; -5.797567410547359e-7 4.6112530980228456e-5 … -0.2076460273502003 -0.49948222322767055;;; 5.351493167164835e-7 0.001371283714093936 … 0.19817374869734902 0.004113250902185758; -3.558525220014758e-7 2.682752957234437e-5 … -0.20474588664663174 -0.6988707816100436;;; 1.995912401189456e-8 4.820460611964546e-5 … 0.07311325117808792 0.07054166190851843; -6.813253672015179e-9 2.8432848006785295e-8 … 0.13697265703925832 -0.38326553322738005], [-0.4089044605065577 0.25579093694160576 … 0.045935152680999146 0.010740195584783268; -0.9114492445497007 -0.13026290408608585 … -0.0034587024536601165 -0.00012653996633808432;;; -0.01531918030587836 0.9574947508675531 … -0.010631726848756639 -0.0020845040693506637; -0.018371591828433082 -0.001248362639877116 … -0.131034259163558 -0.04554834269474476;;; 0.012759154594090967 0.028054839899838 … -0.1390858155283356 -0.04587732672427453; 0.036365203838704396 0.00421209829772299 … 0.40794113180509717 0.10980174306865406;;; -2.0201816806858762e-6 -8.513563403106107e-6 … 0.030497895423568313 0.009765130404020729; -5.981489475846602e-6 -6.967863277651383e-7 … -0.049279180594811275 -0.010624069606682584;;; -5.1243319193507195e-8 4.427688272102251e-6 … -0.0010249636565516488 -0.0003172942364918317; 8.850102506613164e-10 5.66512105676188e-10 … -0.6900332387795055 -0.018939591883464956;;; -1.382977764487735e-7 1.1911446114481851e-5 … -0.005871415217505303 -0.0012155315884402728; 1.504370306314649e-9 1.0572863241812883e-9 … 0.5592524495640419 -0.1291330225956493;;; 1.1625703669154102e-8 -9.995450399021654e-7 … 0.05029226083260798 0.010111645535948743; -1.5106841159914074e-10 -5.2678767266553335e-11 … 0.0012461263026484657 -0.027646931555811487;;; 3.130117861480404e-9 -2.623401669547348e-7 … -3.981479665284442e-6 3.706463818734104e-5; 1.1157679018234079e-10 1.0082450759162986e-10 … -0.00019155384106746333 -0.9826159125315087], [-0.5240917250575013 -0.4191599522573007 … -0.054926427344843966 0.019988524567252506; -0.8502161467613357 0.279982124807812 … 0.027973989817542726 -0.008469178205422081;;; 0.021629946156167403 0.8633031182726487 … -0.0406594816386755 0.009841108662707031; 0.01845791380774343 0.014528571796553796 … 0.031492577926683474 0.09301958057029917;;; 0.015085315895409677 -0.018762284759091766 … -0.1802831996393637 -0.07509083698368282; 0.03773925166015131 -0.007717987089489329 … -0.05257480182805141 0.06567614695485305;;; 8.134474119867004e-6 -1.0999411477585987e-5 … -0.044563278837934296 -0.024822571522965128; 2.0542729492923836e-5 -4.3324350029543714e-6 … -0.011896237598114609 -0.010729002100951603;;; 1.5334652263415176e-8 4.186586890847409e-7 … -0.21760074064590942 -0.005945636168580079; 3.481246772450256e-9 3.3233012107223538e-9 … 0.037221179200607094 0.23662526477895285;;; 2.883271447684245e-9 7.676651810943697e-8 … -0.1019130249276704 0.002701965616749804; 1.70002326087576e-10 7.792086700931609e-10 … 0.03323704818061287 0.14289481171450194;;; -6.812839551241788e-11 -3.279970236966877e-11 … 0.16341340170284885 0.0024864323436977745; 1.348491501226387e-10 -7.873023998508922e-11 … 6.594655839204636e-5 0.9457340008913973;;; -3.817872469922097e-11 3.6582386671239605e-11 … 0.9323259111855302 -0.029564813453103245; 2.3850432481444e-11 7.283336681506133e-11 … -7.750230778316808e-5 -0.09137737772272317], [-0.5896499428112729 0.5846788112374489 … -0.021580268372970775 0.0590719373840279; -0.8069112858361048 -0.4336791065325098 … 0.022706777450481466 -0.03732309483926077;;; -0.011586523773701774 0.6780521957377131 … 0.011092896244885703 -0.07800523878803915; 0.023487105939029994 0.10058003555606869 … 0.1280562318608695 -0.009034432811121568;;; -0.008534820046280723 -0.009059127447406473 … -0.141263990252703 -0.22159175690928423; -0.021174901613189072 -0.01095028547225961 … -0.0712945967869868 -0.10023393161100319;;; -3.4387550349881635e-5 -8.705729359545425e-5 … -0.06447538902355986 -0.07311895908656542; -9.4347317738004e-5 -5.473221876613325e-5 … -0.051874802581823844 -0.02132879151607064;;; 1.334222826183894e-5 -9.705210717547918e-5 … 0.06949839889135065 0.37565097903535016; 1.3451826929876293e-5 -3.768406436855181e-6 … -0.36782208860890886 0.0366226805060811;;; 4.42544601833192e-9 -3.616167896895298e-8 … 0.02729955451356245 0.1301245898294339; 4.082089727938899e-9 -1.640318389049263e-9 … -0.23680942701192234 -0.017612911597939096;;; -5.2750597078143876e-11 -3.931370020305628e-11 … -0.0031901718184735098 0.17752099942479171; 7.378820574489787e-11 1.505633783735104e-10 … 0.8617481946205255 -0.15187558559925518;;; 8.721226755543157e-11 1.7389407583138257e-10 … -0.08548824836603702 -0.842276802826935; -3.912602930949529e-11 -3.826454637576442e-11 … 0.06111695796903238 -0.017099521039462627], [-0.6563147940931318 -0.6295629238770449 … 0.026422129923992146 0.05805750166836211; -0.7536712180254932 0.547205414812155 … -0.03073064579951308 -0.04734936556102411;;; 0.012607198065314127 0.5048690376603598 … 0.0028116865025495205 0.11871804051722902; -0.03177870331544802 0.22169452646787247 … 0.12862278906921512 0.02681665760595464;;; 0.002490925232473434 -0.00802000045238162 … -0.1895675466443324 0.2511715144773322; 0.00744229817004112 -0.010493355872898123 … -0.16983503372174924 0.14294721291459028;;; -6.545524318107235e-5 0.0007692312549453615 … 0.13403930950387297 -0.1206944831028833; -0.000352482931027509 0.0006328986432634556 … 0.21324729379354623 0.008453194643680885;;; 0.0001207933894338916 0.00035467671779217867 … -0.027741175423815684 0.5207666058589966; 0.00015204201862516675 -4.0348536587198964e-5 … 0.3675927930053546 0.10723523360225354;;; -2.398665556311391e-8 -7.931750404439412e-8 … 0.03734846888437246 -0.21685244772062826; -2.7658839244316252e-8 2.3110944052054156e-9 … -0.46739778532941634 0.012999959151536355;;; -5.275974779068431e-12 -1.0762795614213622e-11 … 0.06966777028627559 -0.6623600889991742; -1.0649217112975645e-11 -1.4939642318515946e-11 … 0.40605536742568865 0.08115265029974664;;; -1.8075964603595783e-12 -1.6146284311960002e-11 … 0.042760593107135265 0.302733926351816; 1.467441103866308e-12 1.0462660447138765e-12 … 0.5712025671253225 0.12070170362300577], [-0.6930483882693677 0.621156932528577 … 0.027388728569943895 -0.09661390392711279; -0.7206890447547317 -0.5962987169367344 … -0.023124078006889367 0.09526757102656394;;; -0.008897743263256194 0.40892178510880967 … -0.12215619651152677 0.14331002495246378; 0.014478832724966873 0.3021829484317585 … 0.05138694667895113 0.18987634105156975;;; -5.938298271091157e-5 -0.004413377356192406 … -0.19433216761800431 0.06323561255314937; -0.0013960292259249882 -0.005081535325550118 … -0.2199861092440551 -0.037661640401965304;;; 6.001251908776095e-5 -0.0026912711462464063 … -0.4086921847365186 -0.0016078404240540646; -0.0006780841023446485 -0.002789026915907168 … -0.2204668426999981 -0.31719820883929656;;; 6.419057409192436e-5 -0.00013273346224565137 … 0.5560052113333407 -0.3875473144044172; 7.68867068494787e-5 7.457316865085178e-5 … 0.08072495271734609 -0.16623266838043987;;; 2.542884792668352e-8 -6.10157176294217e-8 … 0.24191478044812753 -0.20945362888173535; 2.797494570888324e-8 2.0009576081584727e-8 … -0.4135169266660008 -0.5908003207512216;;; -1.5723903300946136e-11 2.713192276074724e-11 … 0.32090515675277886 -0.2836508502531835; -1.35778165699554e-11 6.268938851697068e-12 … 0.1157836923710912 0.26038639602996566;;; -1.1165449117265418e-11 1.3479114492972778e-11 … 0.0032095257096275472 -0.00344696723180749; -9.464117413341316e-12 -1.0764719807335713e-11 … -0.13336027496125114 -0.3161515465419555], [-0.7033471748665103 -0.6164219813054156 … -0.051617743589726005 -0.10692596364401909; -0.7108255428192779 0.6094913804702323 … 0.050336117656575384 0.10665361331001053;;; 0.0031860995182125054 0.3678093065856212 … -0.16750050041853637 -0.14855109539827654; -0.0044222926894814845 0.33653365159205534 … -0.005912450366746028 -0.22513637191655894;;; -9.94056706934915e-5 -0.001437310837784968 … -0.16347000857523072 -0.07900588821362614; 0.00025270066942334387 -0.0014963906865682393 … -0.30001757903125437 0.19437971521311934;;; -8.487920303031871e-5 -0.0008292373074814028 … -0.5534793449017885 0.0819170061212237; 0.00010096479293610896 -0.0007874392528349545 … 0.04944054363869809 0.3203170624008004;;; 1.0164458973669578e-5 1.6303878500390834e-5 … -0.6112936037543288 -0.34067981309921624; 1.1805348035191823e-5 -2.0556391314556795e-5 … -0.30924100555043244 0.41769412316401483;;; -1.3677490202270254e-7 -2.805590783888586e-7 … 0.21554011405218784 0.15396867495242333; -1.4121706373030511e-7 1.919024172784451e-7 … -0.13109667499712824 0.6414357645824643;;; -1.7497523293664584e-11 -5.4311393793034824e-11 … 0.08788321512967719 0.10075807481082316; 1.3477869955728513e-11 -4.002553566124828e-11 … -0.00015087241470426133 -0.11778082962579324;;; 6.334936999578979e-12 5.818696144337527e-12 … 0.022726746423507572 0.033017597451592225; 8.736026193225635e-12 -1.595222035453778e-11 … 0.0001713005067756854 -0.01752789227690576], [-0.7059533345078004 0.6181567543330674 … -0.018971841735878205 0.1745679879706667; -0.7082568748585757 -0.6160023333840032 … 0.01912078524373092 -0.17418070674256533;;; 0.000848148402296002 -0.34951926476303535 … 0.028592725055103286 0.31818585271670263; -0.0011683640626908263 -0.3409683430408521 … -0.0977094088739183 0.3051578258525414;;; -3.34096408234368e-5 0.0003572040915584221 … 0.10724882151899376 0.33026727562487257; 5.4651547934585585e-5 0.0002925543868455244 … 0.466033700641364 -0.45036544654423527;;; -1.2015749046058689e-5 8.310519677370094e-5 … 0.622863941971813 0.5963492324056643; 5.933984181739947e-6 6.96566414392042e-5 … -0.6101316105766692 0.27800296337618263], [-0.7067176476710499 0.6327922215278882 0.0677960117065451 -0.3090758347732543; -0.7074956165906044 -0.632045245469459 -0.06728029730202191 0.30893708385281926;;; 0.00017871556807431618 -0.31755874319550914 0.8236158765741105 -0.46990775747575586; -0.00029501885404498683 -0.31503850030328107 -0.5590473595740323 -0.7669528708100894], [0.706982319536768 -0.7072312209330208; 0.7072312209330208 0.706982319536768;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^cores, 2^cores)
xes = collect(range(0,1,length=2^cores))
yes = collect(range(0,1,length=2^cores))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="288a1f50.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this exampl we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 8
h = 1/cores^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,cores)
xes = collect(range(0.0, 1.0, 2^cores))

u₀ = qtt_sin(cores,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.831357431920019e-6
Relative error for Crank-Nicolson: 4.8314858266718516e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on <a href="https://arxiv.org/pdf/2404.03182">this paper</a> we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an esample of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h2 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h2><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve a simple differential equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using KrylovKit

d = 6
N = 2^d
h = 1 / (N - 1)
Δ = toeplitz_to_qtto(2.0, -1.0, -1.0, d)
kappa = 0.1
A = kappa * Δ

f = qtt_sin(d, λ = π)

function fg(u::TTvector)
    û  = orthogonalize(u)
    Au = A*û
    val = 0.5 * real(dot(û, Au)) - real(dot(f, û))
    grad = Au - f
    return val, grad
end

x0 = rand_tt(f.ttv_dims, f.ttv_rks)

method = GradientDescent()
x, fx, gx, numfg, normgradhistor = optimize(fg, x0, method)

relres = norm(A * x - f) / max(norm(f), eps())

x_mals = mals_linsolve(A, f, x0)
rel_residual = norm(A * x_mals - f) / max(norm(f), eps())

x_krylov, info = linsolve(A, f, x0)
relres_krylov = norm(A * x_krylov - f) / max(norm(f), eps())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0</code></pre><p>with a relative residual of</p><pre><code class="language-julia hljs">println(&quot;relative residual = &quot;, relres)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual = 1.5117834555699724e-6</code></pre><p>Compared to the MALS solver</p><pre><code class="language-julia hljs">println(&quot;relative residual MALS = &quot;, rel_residual)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual MALS = 8.696932943619164e-7</code></pre><p>And the Krylov solver</p><pre><code class="language-julia hljs">println(&quot;relative residual Krylov = &quot;, relres_krylov)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual Krylov = 0.0</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 14 August 2025 11:31">Thursday 14 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
