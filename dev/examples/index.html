<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in <a href="https://arxiv.org/pdf/2505.17046">this paper</a> where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^cores)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, cores)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(cores) + id_tto(cores) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(cores) ⊗ qtt_basis_vector(cores, 1) + qtt_sin(cores) ⊗ qtt_basis_vector(cores, 2^cores)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[1.1441881116390418; 0.43466966304808563;;; -0.4158453962525104; -0.6385668356149697;;; 0.7630372718268055; 0.42507586760844546;;; -0.14006172927177904; 0.3200602058355729], [0.2710648983036765 -0.29470930281438495 0.5298671202661266 -1.7214323818682724; -0.32173753377434594 1.2101055549504223 -1.1712885749198367 0.7043985195612631;;; 2.2707267755298592 -0.9747043040392338 0.8746149017362529 0.051028677709971035; -0.33308348576289126 0.5633158100079079 1.6042204431765537 -1.215077779118435;;; -0.009471169385873066 0.15818411987188655 -0.8495229461223941 0.9847556479461597; -0.17679606656161992 -0.8691669946360934 -0.4077000543256454 -0.4722688106173393;;; 0.09904671697929807 -1.0667117828477297 2.085965946474559 -1.3380700226008082; 0.7715163380505821 -0.4990120839166203 1.3057990597052382 -0.7441169131737807], [-0.2284690225333893 -1.2708087899996325 0.02706285279428871 -1.1614257783596544; -0.6602246913819431 -0.023200683059777388 2.05122735490063 -0.03225742662526734;;; -1.346206288660153 -0.2980907592869915 0.07599904490753291 -0.07844850854653151; -1.2878687220187952 -0.6454478850987873 0.7278586959886545 1.636678014587265;;; -1.1785756412730595 0.550714308815573 -0.14827940026054784 -2.0332240593084716; -0.284395497035147 2.2388286111802094 1.2133959438666253 -1.03999144060244;;; 0.2421479022738726 -1.3421954994484342 -0.3909789608483298 -0.5320095829326804; 1.4669608630289785 -2.4862025352853867 0.8313643752245053 -0.11592924066765459], [0.581994908815287 1.5388144082701414 -1.4067184390053926 0.41942163935477544; -0.14387508449811004 -0.5476962311150182 -1.598381383318315 -0.27031499162660416;;; -0.5228705849720546 -0.8185504883448038 0.8867043275429335 -2.097028805137117; 0.9754221409577223 0.483868509387602 0.00908450585571382 0.8163234221909597;;; 0.8505335313409192 -0.06509286697996405 0.8914021731209828 1.0550979727482954; -1.4185580242863254 -0.7887348286152114 0.4220628827361667 -1.9171943164848737;;; -0.15453464706700637 0.09779155218489746 0.7529608291832884 -0.3864097391324733; -2.310047095178915 -0.1953958899784056 -0.8677473825858643 -0.8335468303020361], [1.5943903437106923 -1.1576705368645401 0.20470943526918223 0.23193384164588693; -0.5948458097872089 0.8567831549928775 0.07533052830053494 -0.05768962778122155;;; -1.008296181461667 0.5084550126229451 1.6675161153100957 -0.898581580705994; -0.24886763159540684 -0.6013218254336414 -0.1422597937063072 -0.057632042751735994;;; 1.1126315588383795 1.5018022795772008 0.6730737462324741 -0.5119593273076298; 2.248731260349304 -0.39919354742643703 -1.7468661351833599 1.571717396771208;;; 1.2141529122430568 -0.2941256118261965 0.8167187111721742 -0.6588130856002843; -2.417526334845876 -1.1764198999332616 1.1515718419429097 -1.7861384786420058], [0.07821929863597697 -0.5303426825422074 -1.5917220099389449 -1.193100976576728; 0.817976709829788 0.34959459931540426 0.4239213569058338 0.8965475355284642;;; -0.11878203925174385 0.196865113435762 -0.23615212631176913 -1.2175979482454669; 1.2591713825193327 0.9130387264988579 -0.0629765240847001 0.20888529703530187;;; 0.38647151159169973 0.0517275491790126 1.7097245482115422 -1.8674285658782326; -0.17904915978403538 0.06881164101326541 -0.11570877908295524 -0.25049554673771757;;; -0.9506999387489501 0.03047738982893782 -2.321668796678721 -1.3396590309436665; -0.19282306407458952 2.730257746342799 0.12046696363418564 -2.1363843848490816], [-0.7184636264044757 0.8741277524755814 -0.16001928205451119 0.1682527538581156; -0.7885376438931927 -0.4564379292083714 -1.539794454910956 -1.6557726158711121;;; -0.7044111706539107 1.702777786976911 -1.612862244683662 -2.363663778244638; -0.3108151507718149 1.5493287600514014 1.2302039346834597 0.3508345109000097;;; 0.6753098200575383 0.4645491908540328 -0.5904413428111467 0.5303228560931063; -0.45520859178253015 -2.769430739714836 1.842757953861134 1.1138495409004914;;; -0.4471472004909994 0.5742288852631974 0.579529555307144 -0.7910562973040625; -0.6197110421045626 1.3224337392320147 0.29464329405025697 0.9483101958103091], [0.49105124030773184 0.039841130763673724 0.7999057220084326 -1.0152178329031056; -1.5496706726515697 -1.9260828738145408 -1.2944718876693886 -0.925118554351964;;; -0.29211262886120104 0.4000892174205622 0.2730057503756441 1.2167612152734741; 2.106413976421495 1.4781377672977487 -0.5698499606902864 1.3001881034786542;;; 0.6114189125949764 -0.6985029540043761 -1.3909262843520138 0.9729854666162508; -0.13256783834332267 0.886985010030666 0.31363566624371503 2.2895439583864197;;; 2.019760915874051 -0.580618174366275 -0.040310604588212805 -1.02968165209438; 1.3143021976140887 -0.7916397170900683 -0.4057806696411991 -0.993898588711927], [1.3236430160932617 -0.3247481982299205 1.0828609154228173 0.68776251247261; -0.679855204424277 0.4626961173822136 -0.08655152244739715 0.04632640707810313;;; -1.9079297610002635 -0.6823463409567375 1.4870756703100991 -1.5467271503098234; -1.8441150554863892 0.9669805311193834 2.609315661775456 0.5421602691656443;;; 0.6275217382573892 -0.6987101933038801 1.1068256863928223 0.3353270740033253; -0.5231646153181587 -0.6010139201427399 -0.2867537798983237 -0.3956439221830161;;; 0.5400306256306888 -0.4566677047165939 1.958807242718487 1.0033535952286878; -0.6741290310397904 1.223435839534008 1.4995739113654045 0.02291683302505064], [-0.19864069562398562 0.3605674191229189 -1.5645794494101934 -1.997130614979712; 0.4936775844516891 -0.8726316021206326 -0.7134543493019339 1.7702112170063968;;; 0.853035586773683 -0.9403648153444697 -0.504200818710865 0.1777180494773568; -0.5476724881284827 0.48983395240631455 0.47452011253039095 0.038149406209936024], [-0.5325764399872333 -0.3212475441833031; -0.9240642211054847 1.0834705430013722;;; 0.6715824092859752 -0.547964448458596; -1.9592003401326787 -0.18852674924325408], [-0.5463948515663107 0.009345425239774992; -0.3947073410230602 1.9449029622426734;;; 0.49757815524069393 -0.8405249596463704; -0.8681179918838113 -1.2682872895806765], [1.4286020954677194 -2.172423092583682; 0.09591467163867012 -0.5226633518056882;;; 0.26099092234402327 0.7794150091613314; 2.039047848000132 -1.0200114297860339], [0.9109679512307955 -1.464084610946977; 0.14666657894356686 1.1192459862255737;;; 2.5286282622754905 -2.2584217681536134; 0.4391474342650658 0.7380266343244826], [-0.3047241187147425 -0.923936267013529; 0.812199642334224 -0.04612269961479414;;; 1.7124797511730654 0.5228359917517592; -0.10297632266264367 0.933558559332397], [0.883189902481756 0.8746636933762529; -1.2014507321499552 0.07823326755667824;;; -0.4219014810436107 0.5187253933479287; -1.2850127013898953 -2.0969720786247343], [-2.236960793706253 -0.6303468280225835; -0.03914613044076321 1.580109775189047;;; 0.5471234368650335 -0.765737964655217; 0.7023575073644278 1.3237331134636736], [-0.26909308659676834 -2.256725839686325; -0.4535506649231626 -1.0406599560886984;;; 2.4328061082563153 -0.2047796113675659; -0.10044365860284556 -1.901690790567105], [-0.9364528352097935 0.8326685703038947; 0.13361825504333522 0.3884353790486756;;; -0.3536957508438842 0.7780325069839354; -0.4123800645352075 0.4180463845531775], [1.8143383849504389 -1.3061442869953186; -0.14588688922947365 0.21908405744669457;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-183.73489581332896; -185.41136999952667;;; -106.94577865363563; 105.97878381811883], [0.6983152958012326 -0.5027232623571227; 0.6969522897445636 0.504714939041101;;; 0.11391061402237758 0.4935242166792787; -0.1149684090557797 0.4950424744557512;;; 0.010330151052859234 0.04379960971569999; 0.010617019103412437 -0.04339869092569459;;; 0.010032712782740679 -0.006851027119363059; -0.009990093136577963 -0.007082306946091197], [-0.7056568228398492 0.3463035009434814 -0.029400558298256642 0.1125036968394548; -0.7053163310619416 -0.3466199313625355 0.0012645256738066334 -0.11363598481554223;;; -0.04753410268759781 -0.61443617748423 0.26700540118764843 0.1095371267264293; 0.04764291514283789 -0.6151132761232354 -0.28413134915398824 0.09467357593182539;;; -0.0035730766938964313 -0.044910440202823136 -0.49038842833894275 -0.5245674186282109; -0.003724069901014288 0.04489260310528405 -0.4943407751471217 0.5251324706872421;;; -0.0032611711076331574 -0.00014775425879131362 -0.4261831182611455 -0.45203327824600953; 0.0032727810016814464 2.4337983895126648e-5 0.42499237760110287 -0.44516876102197894;;; -1.3226893429249628e-5 -0.0001288159357083828 0.001840372291073636 -0.0015422807745999773; -8.03414626629302e-6 0.00013048476002161934 0.0019220587231106796 0.0022574921879240165;;; 2.2956448561948255e-5 -1.4819795465429307e-5 0.00040388567838396417 -0.0029249392922886257; -2.3717519054697095e-5 -5.869859864947546e-6 -0.00026826084711980045 -0.002806523734579147;;; 1.1588887544104538e-7 8.936401789757295e-7 -1.5372056849377607e-6 -5.9342402964195156e-5; 3.134254153248393e-8 -9.359303564666481e-7 -7.142471490372755e-7 6.165818068366349e-5;;; 1.875430433827455e-7 -9.627162484278893e-8 -2.113880915470072e-6 7.1643559058067e-6; -1.881069652843178e-7 -7.702330413423077e-8 2.1749049782578684e-6 5.687160195807103e-6], [-0.7067602921221938 0.19682518705844237 … 0.408370030365402 -0.03059271720627967; -0.7067226578004364 -0.1968150384984778 … -0.4072349825209131 0.038634361501712934;;; -0.022691726002663018 -0.6784891158110815 … 0.0953473354150141 -0.1308613262210927; 0.0226678125896466 -0.6784946261809145 … 0.1313605364868106 0.10836723882393902;;; -0.0010641970396893558 -0.03004346806377025 … 0.1533494311758919 0.021048233486788626; -0.0011135587844316051 0.030094563803623523 … -0.06551686832376558 -0.033059850028339235;;; … ;;; 1.8976988047036272e-12 -2.6298913797632004e-10 … -4.2916667824539925e-5 0.00013090940850469209; 2.2267014280790432e-10 -2.3353164313529807e-10 … -0.00024610836550780505 0.000251096625696616;;; -4.848980390665163e-11 -9.16570446721465e-11 … -0.00016446042429640656 -0.0007384266584011263; -9.469021362031512e-11 3.802866730302273e-11 … -0.00019784421466368998 -0.00014534235557271216;;; -7.991145682744471e-12 6.243636592278568e-11 … 4.366433078506969e-5 -0.000278959173814649; -1.7092096293847305e-10 9.348004662805789e-11 … 8.07354772179648e-6 5.650748848276206e-5], [-0.7070150878886462 0.10177483844938612 … -0.11495325142256693 0.029564489066099535; -0.7070164047206605 -0.1017635752946661 … 0.11096638662504468 -0.025328689741495405;;; 0.011346273912645087 0.6995893355691315 … -0.10247472409599669 0.12558986911801218; -0.011335056432207453 0.6995775618776681 … 0.13951094294879746 -0.13053423504404493;;; 0.0002765941407434698 0.0148430766633869 … -0.23886729287646133 0.03825054753933516; 0.0002855815135726949 -0.014843571228501377 … -0.0073112982863995975 0.18994999472963653;;; … ;;; -2.373599562710164e-11 -1.6993141493084882e-11 … -0.0064531684049772605 0.17593644234581338; 6.457669014446128e-11 -4.062669938719438e-11 … 0.25095249014052096 0.04485059784797026;;; -1.7119243259360055e-11 1.3280678618139083e-10 … -0.08247587553992232 -0.15298362371009624; -4.19235709615691e-12 -1.4368364477883325e-10 … 0.1012986320285614 -0.4826137245778535;;; 3.932583761260609e-12 9.928042174239802e-11 … 0.08544331357162223 -0.28737032093921; -5.947864355764063e-11 -7.897907904414242e-11 … 0.1913742926036623 0.03443989127016122], [-0.7070835130773825 -0.05110247704485543 … -0.07502548725821787 -0.09278244893141241; -0.7070836757225175 0.051111982113837294 … 0.07271992327695832 0.09387779000339058;;; -0.0057210467060905676 0.7052364699901463 … 0.134749720319961 -0.07414426860779083; 0.005730588846898541 0.7052354994532993 … -0.14726345631921284 0.05797904891517287;;; -3.134758564624587e-5 0.00036058552614593765 … -0.16733922459660786 -0.17841255016668456; 2.936542338671766e-5 0.0003390336942498861 … 0.033427410458436016 -0.03181176819147834;;; … ;;; 9.235532609319307e-12 5.0979767750550616e-11 … -0.14386867044472484 0.06719383456346589; 1.1465387915150758e-11 4.6728065179166976e-11 … 0.007063888305094837 -0.0011498966677809385;;; 7.773294920000536e-12 6.517502210494937e-12 … -0.33826691460865826 0.06973418473856469; 2.473823106070088e-11 4.1028897397335686e-11 … 0.20736929874029328 -0.3823883871945417;;; -2.1723733268045086e-11 -1.3268795761833416e-11 … 0.06643587588903598 0.37564012289250914; 1.5825589056304377e-11 5.26626180999989e-12 … -0.3283184252182716 -0.03890756194847448], [-0.7071011918228828 0.025438578155028625 … 0.012232265650058577 0.054525910765484936; -0.7071005855347369 -0.02558911163250948 … -0.012328396584743334 -0.05474465457327698;;; 0.002810401174235833 0.7066453645438937 … -0.011421653369652335 -0.028492190932705826; -0.0029609828928015896 0.7066399933253215 … 0.011645157455750645 0.024335315291311388;;; 1.8761694829909262e-5 -0.0015737286228548037 … 0.01898219774564685 -0.027590360094366117; 8.480706419625218e-7 -0.001577647601436482 … 0.08023213351579671 0.035239486808113486;;; … ;;; -2.8862796371497405e-9 -1.0415630515966268e-7 … -0.11378362768281561 0.06212067265239889; -1.2586874578388541e-9 -1.0501949626886239e-7 … -0.03692011395877718 -0.017596012279940895;;; -4.348958702739974e-11 1.23040621722993e-9 … 0.1549613793363357 0.06401020831301582; -5.129220536304844e-11 1.3796622429998088e-9 … 0.12883659331446004 -0.14337337866112568;;; 9.791073645172873e-12 -2.7191314358684054e-9 … 0.11654047104526052 0.3397244325281261; 3.1511549444148044e-11 -2.8148806016902872e-9 … -0.04430964671583827 -0.08450158740974581], [-0.70710572621913 -0.012538817113452474 … 0.04447350874344941 0.0256229014974341; -0.7071048070792573 0.01298649039757502 … -0.0446101186700678 -0.026039811382241033;;; 0.0012224566350580402 -0.7069339322723276 … -0.034452192776440654 -0.10282469834997848; -0.0016698120792017319 -0.706925763959616 … 0.03263426191574976 0.10201713090399478;;; 5.774653509368406e-6 0.0077043511967259766 … -0.026943952597631975 -0.013635559246862123; 2.233539123785928e-5 0.00770506483461904 … -0.02140926522660973 0.024311560630199885;;; … ;;; -5.130081787510166e-8 1.9305463580338012e-5 … -0.002300899516500443 0.2848868646715882; 2.3779769214411893e-8 1.9343677318190643e-5 … 0.2563264445083973 -0.30452202022813446;;; -2.067203704059387e-10 -3.2905668210751304e-8 … 0.23201855867301743 0.21934398366613864; -3.262728458977186e-10 -3.338890352994216e-8 … -0.34651492343773077 0.4181370453464761;;; 2.228184313097892e-12 -1.548234161477398e-8 … -0.12006272752051309 -0.11101765446805183; -5.5040766893877543e-11 -1.5540956033581706e-8 … -0.004706026213840509 0.12402607688582061], [-0.7071066680440569 -0.006122836784600086 … 0.011849595020212452 0.14465480785712187; -0.7071060194087662 0.0067598734531039845 … -0.01191745429975487 -0.14463013370146288;;; 0.00040066775565820165 -0.7068221291859165 … -0.034021151439531785 0.011047019532838754; -0.0010368938165621893 -0.7068163588683919 … 0.033836414580597225 -0.013607366451775042;;; -3.0980092683625686e-6 -0.010960861110727742 … -0.008521141645206154 -0.0030682476023086913; -2.0644775186964892e-5 -0.01095775374565026 … -0.0003523797770438753 -0.008833928207874415;;; … ;;; 8.816310667276498e-8 -3.274179032422101e-5 … 0.03189149183041949 0.18351820148330084; 2.2612562260287062e-8 -3.278343141851454e-5 … -0.10079409263636047 0.441165821320683;;; 7.512551584682781e-11 -1.232933614752413e-6 … -0.055537566883724944 0.13812764466320426; -2.3804198823721797e-9 -1.2343545997354795e-6 … 0.0275892001397769 0.16544498090196275;;; -2.5644512881730887e-8 -2.1326334925669023e-6 … -0.38410989450149374 -0.2399090361484196; -2.981754626440723e-8 -2.133920844260728e-6 … -0.5585645925787107 0.08929577958715433], [-0.7071067476120525 -0.0027229474925814768 … -0.034849831662809985 0.005115098850400361; -0.7071061802865316 0.0038574270432033993 … 0.03484966302608508 -0.005114819757318603;;; 0.00021744500559908202 0.7006931539348642 … -3.620849155272224e-6 -0.00011887676889611317; 0.0009183150167500253 0.7006894207569512 … -0.0003695186752620346 0.00015358348260488257;;; -2.7170310822737457e-6 0.023579510863112867 … 0.0013267917396386983 -0.000695028658442196; 1.9614279380996747e-5 0.02357612729924552 … 0.000605542340151683 0.0002953799621310357;;; -2.1582678764972927e-6 0.015902218676296778 … 0.023127294897685266 -0.00913281624174293; 1.3400520877613892e-5 0.015899223331408804 … -0.02607689166983732 -0.01026237281537979;;; -2.894635424617162e-6 0.01536065725654416 … 0.5595525483271786 -0.32573410425444804; 1.240179857101001e-5 0.015357795727923338 … -0.5904411177153589 -0.13764769566208818;;; 7.916753632654163e-6 -0.05310152699749182 … 0.34037202310044656 -0.4990458380742723; -4.4932234910756906e-5 -0.053094641754228136 … -0.4159062503122192 -0.5660552018826294;;; 9.999773852116307e-6 -0.07177031023628522 … -0.12397659911887625 0.2979064388301233; -6.143378395565441e-5 -0.07176164657757363 … 0.17193316627904215 0.3765511536354927;;; -1.0620354760752001e-6 0.002481924930529161 … 0.004380503405534283 -0.01196440033216497; 1.401369006642234e-6 0.002481204056418531 … -0.0291986294887463 -0.2730592286875154], [0.17705624562285655 0.14232817422732358 … -0.12083958606779888 0.06717779137920794; 0.9837001891282533 -0.005188099801686487 … 0.005879487445699185 -0.013515133218064145;;; 0.020134703592810676 -0.989774518854768 … -0.023173772164405672 0.010093517750046948; 0.008219986270171849 -4.2293281829593615e-5 … -0.013110095572748653 0.05499251824295999;;; -0.022238710593194787 0.007536828094468663 … -0.7135032114005112 0.008879030675976111; 0.004181948020582755 5.0012226500580615e-5 … 0.07463301550510631 0.2225579856899946;;; -1.0589147307066764e-5 -0.0008442829032234613 … -0.1109691655851099 0.00350840671020612; 3.0132090766328947e-6 7.025951393837685e-6 … 0.009329395640243786 -0.16383643918782703;;; 2.0682818707636432e-6 -0.0021334959991387253 … 0.23157243760370216 -0.07128858209187217; 1.6373671268835097e-5 0.0001464004500718178 … 0.3053881908478941 0.7645445504467328;;; 1.494140048492662e-7 0.0002653638233028384 … 0.11148057970443692 -0.00698987448183501; 1.469248478284384e-7 2.1572545522159277e-6 … 0.00977356484351923 0.11959999330001345;;; -3.069209264317586e-8 9.637810449400479e-5 … -0.0521566839319777 0.22452883404191587; -4.0496621972506026e-7 -4.2277871280413673e-7 … -0.02614778596385949 -0.326478994923291;;; 1.3268240063514711e-8 -4.885607006358318e-5 … 0.06373702214592081 -0.06241440993817642; 1.929765743254256e-7 8.070648518038833e-8 … -0.5391832686188517 0.3883968449219643], [-0.4088923171779224 0.25765126039039155 … -0.010474205767050061 0.010505191728682443; -0.9114694589210192 -0.13111113800720997 … 0.00024239547098550284 -0.0001545219184339247;;; -0.01533955652925491 0.9568922299216759 … 0.0021279006112249394 -0.0020796893267514297; -0.018006954712583404 -0.0012156566046598156 … 0.04243721836642515 -0.04472972562504521;;; -0.012699241049923532 -0.02763198668680224 … -0.04314033151177946 0.045109142798794674; -0.036189435239611 -0.004236865340758757 … 0.10535930265010637 -0.10749332794510903;;; -2.1304390216210386e-6 -1.783542085969617e-5 … -0.009302226408332963 0.009696460529432564; -6.601621513882834e-6 -7.790634279464158e-7 … 0.01082286426822256 -0.010776321571320866;;; -1.6295144618160886e-7 1.6317324807423453e-5 … 0.00039733732320697496 -0.0005266931276526377; 6.860673847116924e-8 1.1533761967199785e-8 … 0.946086785927574 -0.025836701600380964;;; 8.811527032193333e-8 -8.258015289485362e-6 … -0.009130676360698177 0.009338880480578201; -2.2237866283614352e-8 -4.046004643741221e-9 … 0.06053305103453669 -0.00775076597405166;;; -4.078953951250544e-7 4.041793006635037e-5 … -0.0002805564020234104 3.1623129698780834e-5; 1.6042831861534646e-7 2.723269433821969e-8 … -0.2933965982590765 -0.12749725831767159;;; 1.2480506056955394e-8 -1.1377378345453956e-6 … 1.7557990554235633e-6 9.145396239494331e-5; -2.2828270732387157e-9 -4.4658608078501644e-10 … -0.0031342690160897067 -0.9833687411027169], [-0.5243588451607522 -0.42185489794948217 … -0.1589700268824122 0.023691490523723928; -0.8500880675025158 0.28163054115884356 … 0.0621477160122729 -0.010649047986114987;;; 0.021488524912348775 0.8614468295543799 … -0.09205247895400924 0.012439279465964362; 0.017621329740316966 0.015067059768041062 … -0.3756201175132713 0.09849105792052548;;; -0.014962679100067853 0.01855677567215071 … -0.26987252375779264 0.0697919960459185; -0.037442337914419505 0.007789273429731767 … 0.6934974775419435 -0.06442043905338661;;; -8.926605342000766e-6 1.3374782096621133e-5 … -0.1036151353719515 0.024049325948870055; -2.2643933307779158e-5 4.872810374609202e-6 … 0.09117006081939627 0.007922218632946735;;; 9.551622264569432e-8 4.081038354959206e-6 … -0.028115046223243484 0.0039609212452571384; -5.637569021554778e-8 6.136008539466856e-8 … 0.27928076943932667 0.26397311840013765;;; -3.069222066076285e-9 -9.0151283197713e-8 … 0.12924282875512322 -0.023849200154588975; -3.232479559997302e-10 -7.947118431523078e-10 … -0.016277888311803893 0.05791143902352748;;; 5.839972462194617e-9 2.1133378478107647e-7 … 7.753599071237365e-5 1.9420917407408172e-5; -1.8160033979131335e-9 1.929871760544415e-9 … 0.39079514768942764 0.09181475767888057;;; -3.0836259546002454e-9 -1.1151951259599864e-7 … -3.725112448165384e-5 0.00010524091873135146; 9.402663087517714e-10 -9.958770084827098e-10 … 0.002513242616468088 0.9475009568069054], [-0.5904370537376559 0.5862617117709361 … 0.03593411176855675 -0.03469280854841786; -0.8063246547366462 -0.43552163083823187 … -0.03156078054592595 0.03139926488273195;;; -0.01154506939712576 0.6752437684164093 … -0.030343872500611168 0.028026092425032664; 0.024135877706002274 0.10228337421465811 … -0.1282270134656158 0.13305098993873882;;; 0.00842745816712619 0.00902470635633065 … -0.0905918368080013 0.09774471334507304; 0.020923020744581928 0.010982285491532498 … -0.034497868835523304 0.05350587658598389;;; -3.796529275171157e-5 -9.454928319510469e-5 … 0.04866975441701445 -0.051079328376050656; -0.00010399554801791738 -6.107213141524614e-5 … 0.0571164051092635 -0.06474793125204942;;; 1.4252059892989448e-5 -0.00010175078778509216 … 0.010160895087147757 -0.007602155552234474; 1.4477776291597787e-5 -3.931772795287841e-6 … 0.4176190911988 -0.37752086347217023;;; -2.5209383859857932e-9 2.6992535453444642e-8 … -0.024572749856445676 0.028854701409454286; 2.2546819542673252e-10 3.265220239813716e-9 … 0.8254255799657516 0.1688251537121909;;; 1.465265435301139e-12 1.499920493526556e-9 … -0.04487888107594439 0.04662410971573309; 3.0224277318084903e-10 3.0895366536599526e-10 … -0.3268577870409184 -0.1929642932244487;;; -1.0605164344137077e-9 1.135114738394376e-8 … -2.8323244659895987e-5 0.0021942911989404025; 1.9883265241134157e-10 1.4502669934881578e-9 … 0.00560728507612734 -0.8653184412626311], [-0.657104124928847 -0.6295454007354482 … 0.06443534953154542 -0.050805540694955374; -0.7529907878105158 0.5483335085579889 … -0.05522870684604308 0.05213666685266318;;; 0.012654437104225771 0.5030060053505068 … 0.11816961086471697 -0.04542204392557808; -0.03161385646738547 0.22318735945983592 … 0.06189439073909297 -0.15616300442958517;;; -0.0024275230126287665 0.00803411222683421 … -0.1968152683480141 -0.11391561848124071; -0.007306149561683774 0.010462048871945536 … -0.08932455348893266 -0.1678668302486299;;; -7.670902025067584e-5 0.0008299886477408822 … -0.08684657664145959 -0.09992335406399307; -0.0003930864671583979 0.0007035654639768207 … 0.03441076041470328 -0.1725751112972046;;; 0.00012219822615276943 0.0003547086779260209 … 0.47291919483554207 -0.03667128107266061; 0.00015411613279145824 -4.282949408859643e-5 … 0.22099905888197802 -0.4038400135556222;;; -9.488666664639351e-10 -3.599201167969828e-9 … -0.1907533162775711 0.026097389004662283; -9.228798824001489e-10 -2.8925604381137755e-10 … 0.37009804767778504 0.4371657104672871;;; -9.995639524497978e-11 -5.738630347979646e-10 … -0.6882640064822344 0.10090773149446633; -1.4854293558295017e-11 -2.0955121116994637e-10 … -0.0011908200170478772 -0.2223081792352388;;; -1.1048101013769783e-10 -5.841404304054651e-10 … 0.000216595589626544 -0.0016694769099068537; -3.2344091846661754e-11 -1.5953596728923746e-10 … 9.750212940202194e-6 -0.6866549911784421], [-0.6933143049203914 0.6210401567276794 … 0.05475603706351658 -0.06576463973176788; -0.7204383943178624 -0.5966290866549485 … -0.05064266835384617 0.06647759548201995;;; -0.008808625193948132 0.4080017766334219 … -0.15308225900639713 0.06146495571294988; 0.014279047500205776 0.30301614619214534 … -0.015300468618949497 0.17556557953668492;;; 5.01571204690799e-5 0.004306095278785628 … 0.1829101573432232 0.03698543305410375; 0.0013515439802548042 0.004955684835536375 … 0.1846101235742893 0.059600309653868616;;; -6.429006773752517e-5 0.0027317327613099918 … 0.3611379596411971 0.20893485368711492; 0.0006845400425132419 0.0028348295497507055 … 0.09155461936836361 0.42200301857527706;;; 6.279860700572847e-5 -0.00012934309845482662 … 0.6505804526550325 -0.16603412366627215; 7.517525825480126e-5 7.401987279126195e-5 … 0.12315921888718688 -0.20567947685290908;;; -5.488455281645391e-9 1.303054991480666e-8 … -0.30098866577552696 0.0997682545689976; -6.063948960188607e-9 -4.534372919162053e-9 … 0.14754206500031572 0.760223190354266;;; 3.860642472851293e-11 -8.224181637791067e-11 … -0.46221512865229614 0.1333494897066474; 4.9744598227597795e-11 5.103172290174279e-11 … -0.00036547989072188995 -0.16138506452282078;;; -6.344972730948791e-13 -4.687255072385892e-13 … 2.0564971998486204e-5 0.04505990793300248; 8.608500340789448e-14 3.2487047481794736e-12 … -3.131398737871047e-5 0.1623948461892472], [-0.7034152580957093 -0.6163695561816773 … 0.04691620771300381 0.06615904753359815; -0.7107588887794577 0.6095708043005024 … -0.045690631699191256 -0.06617410562867271;;; 0.0031428994304350654 0.36752347314849304 … 0.15918699924019108 0.07410929920075145; -0.004337131428393259 0.3367981352043396 … -0.001927787757370388 0.15828897681599868;;; 9.843129148901278e-5 0.00143252541434733 … -0.15862418505563936 -0.025082236097680503; -0.00024856964421192553 0.0014830899206550799 … -0.2927753203574037 0.08619531073625707;;; 8.374984488860899e-5 0.0008168340610366329 … -0.5512834258444697 0.21206751964262913; -9.721232756406359e-5 0.0007733086401090771 … 0.02750166029389078 0.37070592827499316;;; 9.988905786695615e-6 1.591915397161676e-5 … 0.6255973776084608 0.4433187752600988; 1.1560344286590198e-5 -2.0056357803900263e-5 … 0.28697912229793787 -0.44973748310035516;;; -7.614124884802922e-9 -5.800798584042151e-9 … 0.24841458736047076 0.09110818677258178; -1.061841460690722e-8 2.4075871515745966e-8 … -0.12825623308424328 0.500644562483244;;; -2.5861685633180805e-9 -4.163165518738483e-9 … 0.026100179443366234 0.21398892452240187; -2.965020620203756e-9 5.148957270176073e-9 … 0.04741790667727495 -0.04065476570052817;;; -2.3047786147800353e-11 -1.6489881680608204e-11 … 7.044126510824897e-7 -0.17750744241900213; -1.9338239397523618e-11 1.1633222904975484e-11 … 5.129000253279721e-6 -0.18316148532617876], [-0.705965089403716 0.6181414874506316 … -0.07507883433165305 0.174913465229133; -0.7082452143245203 -0.6160202656745655 … 0.07477129901678209 -0.17456741586772917;;; 0.0008438363275317454 -0.34942521062240073 … -0.18015299051024397 0.3027974486409734; -0.0011369222086285921 -0.34105995967838443 … -0.08701936690373563 0.32211046791966125;;; 3.223201201642691e-5 -0.00038409902911013753 … 0.23976245899864548 -0.2958550351249517; -5.533720740599897e-5 -0.00031551413686785773 … 0.21800987923487478 0.5531502906713169;;; 1.2193323638235477e-5 -8.673280819659486e-5 … 0.5750366681268401 -0.41830497056833776; -5.289122834910261e-6 -7.247353292730235e-5 … -0.7162844668098932 -0.41833665183816654], [-0.7067106573266108 0.6328013132255416 -0.06666706939984923 0.3093186813929219; -0.7075026005780725 -0.632038128450916 0.06615825743867898 -0.3091778765245106;;; 0.00017151052290950708 -0.31746106679547065 -0.822070986622817 0.4726708522917512; -0.0002959398507679147 -0.31513294533160996 0.561585149183364 0.7650576837094885], [0.7069834712226525 -0.7072300696505832; 0.7072300696505832 0.7069834712226525;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^cores, 2^cores)
xes = collect(range(0,1,length=2^cores))
yes = collect(range(0,1,length=2^cores))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="6b1b4e64.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this exampl we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 8
h = 1/cores^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,cores)
xes = collect(range(0.0, 1.0, 2^cores))

u₀ = qtt_sin(cores,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.8313433471533905e-6
Relative error for Crank-Nicolson: 4.831470254684175e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on <a href="https://arxiv.org/pdf/2404.03182">this paper</a> we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an esample of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h2 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h2><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve a simple differential equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using KrylovKit

d = 6
N = 2^d
h = 1 / (N - 1)
Δ = toeplitz_to_qtto(2.0, -1.0, -1.0, d)
kappa = 0.1
A = kappa * Δ

f = qtt_sin(d, λ = π)

function fg(u::TTvector)
    û  = orthogonalize(u)
    Au = A*û
    val = 0.5 * real(dot(û, Au)) - real(dot(f, û))
    grad = Au - f
    return val, grad
end

x0 = rand_tt(f.ttv_dims, f.ttv_rks)

method = GradientDescent()
x, fx, gx, numfg, normgradhistor = optimize(fg, x0, method)

relres = norm(A * x - f) / max(norm(f), eps())

x_mals = mals_linsolve(A, f, x0)
rel_residual = norm(A * x_mals - f) / max(norm(f), eps())

x_krylov, info = linsolve(A, f, x0)
relres_krylov = norm(A * x_krylov - f) / max(norm(f), eps())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0</code></pre><p>with a relative residual of</p><pre><code class="language-julia hljs">println(&quot;relative residual = &quot;, relres)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual = 1.5117834555699724e-6</code></pre><p>Compared to the MALS solver</p><pre><code class="language-julia hljs">println(&quot;relative residual MALS = &quot;, rel_residual)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual MALS = 8.696932943619164e-7</code></pre><p>And the Krylov solver</p><pre><code class="language-julia hljs">println(&quot;relative residual Krylov = &quot;, relres_krylov)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual Krylov = 0.0</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 14 August 2025 11:20">Thursday 14 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
