<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets.citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Quantics tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li class="toplevel"><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li><li class="toplevel"><a class="tocitem" href="#TT-cross-approximation"><span>TT-cross approximation</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in [<a href="../resources/#FastandFlexible">15</a>] where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^d)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, d)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(d) + id_tto(d) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(d) ⊗ qtt_basis_vector(d, 1) + qtt_sin(d) ⊗ qtt_basis_vector(d, 2^d)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-0.6459234504216114; 0.044747461937435076;;; 0.6209667761965046; 2.635622065357482;;; -0.5700816634283183; 2.209835328954064;;; -0.3268430262812792; -1.2720802321515396], [-0.4579956712284774 -0.0742119171522253 1.025232497879093 -0.6495692920475028; 1.7734511383826648 -0.5304607239899892 0.5590332367036996 2.2816899230601924;;; 0.4169721116659111 -0.904359011718959 -0.24184568599388512 -0.027879830487094498; 1.2433214532903132 1.7126215497705075 0.7240864875600994 0.8297702745119788;;; 0.8646941435515617 -0.2644904050415206 0.4683597741689281 -0.4932826567498241; -0.6738342783487852 0.7908680353903691 1.3682877165469607 0.4541138059446556;;; 1.2556722192563605 1.635283075772068 0.2426809766316429 -1.3938447674436023; -0.2524163536054557 -0.5695483135994249 -0.41057320636375993 -0.4262880594885486], [0.30793919363713984 0.0029340393825032837 2.0671884714098145 0.45056588439978945; 0.015046383048041368 0.9016368610381517 0.7051644670572337 -2.778794015809438;;; -0.4717463815262921 0.6691793241754561 0.36442175291055323 -0.04029303690487825; -0.5334269988672675 -0.1746106526852195 -0.007287108243675096 -1.9428350762983118;;; 1.4153767825741952 -0.301597699198381 1.576410500395671 1.0689160174465564; -0.8436671403061055 -0.3670519640789719 -0.5971703887165958 2.952149191333669;;; 0.8191081897441788 -0.8874898618347212 -0.26960207753812593 0.3631119852954917; 0.6285489672617617 -1.208524061986978 0.7409600478402444 1.0962606734034042], [1.4043565805941203 0.16469992443862455 -2.961378881075287 -1.6732183707562862; 0.40550647526300626 1.2393168049305865 -0.08726648871524183 -0.7737486000778347;;; 0.3067156190919294 1.544085721621433 0.16652441876570812 -0.7011018046460895; -1.0576005531521664 1.8682586376247232 -0.06082959772474674 0.8918837574056018;;; -0.5232842026104731 0.2135930521355046 -1.1458189601649467 0.039272068083928066; 0.3057281470195769 0.9883469841798508 1.2142202957024635 2.544906395959442;;; -0.40144907537797087 -0.851981525793396 1.676532314678708 -0.3143513831209856; -0.7790462222908762 2.426119899542316 -0.9309880053524308 0.42510694788171555], [1.81879427219533 1.4829454860132736 0.2856255310357216 0.10558738084059698; -0.006311191330266574 -0.09030432476929309 -0.927873685042364 0.2661925797439327;;; 0.28821879387127675 -1.9007811048658487 2.078593593685804 -0.39673209365697865; 0.46852324101549003 -0.9376506176482144 1.1617308575719285 -0.5113545422855207;;; 0.6943783603680009 -0.7361498858897764 -0.5796632739108267 -0.9395423524473704; -0.06826390049201943 -0.1885498413882977 -0.07039978461001362 -0.21460736625035573;;; -1.326391896770285 -1.1595482709111367 0.15569036241082052 -0.726282646302428; -0.3876846567490332 -0.26424291364528835 -1.665958384735386 0.15489553684243063], [0.280520415875318 -0.024764912160621783 -1.3475515368054425 -0.4867580080580327; 0.9062877305718697 0.7900160890359482 -0.40206587506402364 1.652348616318854;;; -1.058644584823594 -0.3760098607739626 -0.8291711504118685 -0.32511944363870404; -0.4070456105261067 -0.689323138732344 -1.4071929925013837 -1.5556704521266127;;; 0.5262382019032161 -0.862242370973728 -1.0339034045618325 -1.4137490689974872; -2.053266896735146 -0.30083174814335273 0.5396450264474661 0.6617639762586901;;; -0.15037059990549845 0.532087355835491 0.6934897420474154 -2.328342384482361; 0.6733210559180438 -0.6978621275879985 -1.2284316600560141 -0.011659834243129807], [-0.0576968586294582 -1.1076734968726192 0.18846480468695603 0.028723264006294998; 0.2536685157212581 -0.8113663881900085 0.06662218248262018 -0.2954147185571442;;; -0.3515470986910338 1.5648491894144312 -1.4127823786927887 0.6398509522445135; 1.6703338334781592 0.6124510400642342 -0.04114921542305556 -0.4428027290011577;;; 0.4598875165497869 1.083036414351381 -0.5172430243296845 0.5988918722468095; -0.648909320218447 1.088161700415915 -0.7081615486073474 -0.6486955010257391;;; 2.2836297343676715 0.7364001669084331 0.2032168267736901 -0.7132378039305579; 1.8857757157919637 1.2482119088573105 0.5056066886889027 0.5252233413616847], [-1.7676411500707636 -0.6066984250140094 -0.2846352721057731 -0.4991055053449614; -0.42471531542821733 0.26975907533283827 1.4252720649519064 1.585910984333803;;; 1.1230565408123694 0.36838860959502195 -0.5960527293038888 -0.7288396465777488; -0.12992156417800488 -0.09466451211490524 -1.258819610507342 -0.8973473479396369;;; 0.479838474144692 -0.08582834701710639 0.581274304319184 -0.26546692509633557; -0.41110037929576354 -0.7898867514658005 0.9502323254982722 0.5558547573275757;;; -0.6645676916676982 -0.0759435687257579 -0.07312851450806335 -0.3962316433180853; -0.42603316037386263 0.0894964352845859 -1.9713302594078543 1.2192768430373526], [-1.30871647393903 0.38353255305218736 -1.3368033403778394 0.44426989160800157; 0.0564382493037564 -0.27197048178908784 0.2569218916953043 0.8613876954863942;;; 0.08989419795524493 0.13659763521168594 -0.07129315431469326 0.3825491428141542; -0.7533647178703563 2.168229544440541 1.6938552857032962 -1.0834190350109139;;; 1.4002512616091138 -0.37460403400975856 -1.0078339393014393 1.8678029739661544; 0.2482702985617866 -0.3868735692088383 1.0467246446255931 0.6024577722991316;;; 0.23491201335195097 -0.934953443688327 -2.1077858252640467 -0.8096271546715423; -0.9995795434809133 -0.936785491536602 -1.2930199896590753 -1.237372945298493], [-0.13701638854876957 1.0874302487356409 2.4539187240040334 -0.2824020160280541; -0.6941073862811945 -0.3863456083553398 0.8222411699043636 -0.18842012996833393;;; -0.6522465093858395 -1.0680371378033406 -1.4869690439201433 -0.7764382110538491; 0.6474791336245794 -0.15979283998777039 -1.4799362401362262 1.7490151756450387], [0.11648977401574075 2.1090946599320395; -0.15816426301346806 -1.9404897016620937;;; 1.2657216774955815 1.460717016764812; 1.5035241502002574 0.27221931574440256], [0.16491107941248256 -0.9403034454271695; -0.820541612521208 1.534619720835775;;; -1.9787880441598644 -0.7822926126988511; -0.7085582284515503 1.0229739684966848], [0.00869278246188175 0.052838942023683784; -0.9335910222942276 1.0404537830800586;;; 0.5895942213016034 -0.460108065790197; 0.15517635407675587 -0.38788198690991904], [0.8371153097005055 -0.6391820790385789; 0.13456563663760607 -0.4123826729375222;;; 1.7739071210181225 0.6928507292514858; -1.4465271727774462 0.2616164262066984], [0.04816816857478304 -0.6560514630322163; 0.7316786149673737 0.1285487944228938;;; 1.7091757784161248 1.2629246245493109; -0.6929649415983133 0.46957740790447294], [-0.5450030517330332 0.41848402818462477; 1.9395707963676434 0.18111320501241243;;; 2.3659549512358478 -0.9177660103627391; 0.17880638961788226 -1.231929388811065], [-0.15700172925199124 -0.5423898900504645; 0.009993161043614912 0.5315823049755766;;; 0.6111858014722031 0.04932903994665878; 1.3302101363356253 0.9374614937821545], [-2.515585119793462 0.7928825068379389; 0.8097389147708156 0.10117667461218535;;; 0.3496210981858681 1.5280933272085202; 0.22085578578479148 0.5901983911172666], [-0.6739834855704068 1.2208327860987465; -1.9144290195822165 0.7326256797185875;;; 1.7706395378423267 -0.9881467930785659; -0.45874753153597475 0.6025876208352066], [0.6787943337227782 0.5720842502101342; -1.095220066489692 0.14776821397379414;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-163.18479956070567; -205.53409280766078;;; -121.18800428259323; 96.21780950240398], [0.7113878514291461 -0.4695237915183763; 0.6817273842968852 0.5121172504134677;;; 0.10704947927535774 0.49029723567495387; -0.12971164105087463 0.5184591852038888;;; 0.01045102005304623 0.06863626323161848; 0.02028816002586571 -0.05651488510953149;;; 0.014236466022461704 -0.005548123597893734; -0.012918485953125624 -0.012504976992203964], [-0.7084632532457018 0.3294836236403923 -0.22853160068045322 0.10909017984322843; -0.7021859295867718 -0.3352337247313754 0.1993742183084773 -0.12869100539098988;;; -0.04870015108629954 -0.6158926068098184 0.18086604829868755 0.22113427222561638; 0.050550296312628196 -0.6274256882003736 -0.4069331882635636 -0.002374556134691288;;; -0.002304577315981123 -0.05522631199436793 -0.4294493769795803 -0.4796458683635193; -0.007131221875111143 0.054801803884738653 -0.49560434897558103 0.5044063816667558;;; -0.003798082409651008 -0.003415403627033125 -0.3850421972599488 -0.5204637614192935; 0.004114316941238575 0.0009392338049237924 0.36162673972320164 -0.40605021639606664;;; -9.077710187259063e-5 -0.0018973131425121222 0.01753247923992045 -0.0223099875948679; -0.00021934686233404291 0.0016858423376945343 0.01755316215092508 0.026913537835384475;;; 0.0002516272360818623 -6.168714020135211e-5 0.0033569970103271857 -0.02405140099638275; -0.00025260577556578015 -0.00013465986678077563 -0.0027349227407781765 -0.024209218114257587;;; 1.125991675868062e-7 4.00688366257799e-6 -2.7111433519969514e-6 -0.00017383392418073956; 5.242298299788157e-7 -3.7955677250666906e-6 -9.203405264538563e-6 0.000171591560132259;;; 1.0422419783690444e-6 -2.3574658927119588e-7 -7.754126383776117e-6 2.0525397377059027e-5; -9.94211999061498e-7 -7.582627035888407e-7 6.944220828607226e-6 2.352024844657655e-5], [-0.707098865338795 0.1865078185495709 … 0.20221625743089827 0.001720637822193834; -0.7062971877092497 -0.18623707613448845 … -0.2038411896085978 0.004186670309346271;;; -0.024266968536225637 -0.6810728698331941 … 0.07667653581882855 -0.08383449812329953; 0.023668043004484173 -0.6818325440777941 … 0.029652266231703597 0.07706842098561427;;; -0.00027551903626948194 -0.028337134109989042 … 0.13101974087058857 0.08410928767368941; -0.0020770816372571287 0.030032919155916476 … -0.015975333930473692 -0.08516559173129698;;; … ;;; -3.7598279496799454e-11 -4.873233277417572e-10 … -1.0942905425432791e-5 -0.00021230810989794063; 6.705419491212867e-11 -3.3365760097161893e-10 … 6.748580660368681e-6 2.4635478206406176e-5;;; 8.959194500400662e-12 -1.067440271905591e-11 … 1.1181599460336344e-5 -1.0235098312745443e-5; 3.275361866159974e-11 6.696049902307744e-11 … 8.378043227814635e-6 5.2178769826120555e-5;;; -5.7557740501230125e-11 3.9609032999073245e-11 … 6.8390018465384065e-6 3.094998813614786e-5; -1.0366221851150057e-10 3.948013956167681e-11 … 9.823832680419759e-6 2.7763343776459585e-5], [-0.7070387928419867 0.0956264641740595 … -0.08170576168572298 0.08554729741504905; -0.706969064666386 -0.0954817153198828 … 0.07695701717119788 -0.09062978728149156;;; 0.012133684531295192 0.7005220126496959 … -0.12424000904625687 -0.15720972016282775; -0.011969900596632398 0.7004639252011678 … 0.14657509175491354 0.12520151407950575;;; 0.0001557867819756831 0.001408432870199105 … -0.028010734633918868 -0.2817360793830731; -0.00023701559193526072 0.0016887502677803937 … 0.08172582425047485 -0.07782612018721279;;; … ;;; -7.200451938486505e-11 1.2301471358089164e-10 … -0.33334845141053654 -0.04825165049734102; 2.7257712338532754e-11 3.1375233859489265e-10 … -0.27018644352950105 0.13704087315468574;;; 2.16494314600172e-11 -3.4520457269453354e-11 … -0.42600941389387725 -0.08915927150222387; 8.031420654220955e-11 -1.382159166951083e-10 … -0.06617022725911109 0.011636975528386903;;; -2.469597349323524e-12 -1.7325630983008602e-10 … 0.07570452483629306 -0.029818931341704998; -4.257502338421972e-11 -1.6334022520549392e-10 … -0.25395046917052033 -0.15767543064668782], [-0.7070880551421068 -0.047584381351468856 … 0.005907554077468697 -0.039636759078864686; -0.7070729983170454 0.04816361553151895 … -0.003963713747406705 0.038299577754024115;;; -0.00579533798436946 0.7054938581932245 … -0.10934710883730593 0.07210815224257461; 0.006374182419418326 0.7054408323455663 … 0.10758165207667006 -0.07665288707011329;;; 0.00013515272563009874 0.0009307145920950447 … 0.06250192201193555 -0.20656056135345804; 6.07949454587791e-5 0.0010031567138963477 … 0.0053911543474933835 0.15898462233089336;;; … ;;; -2.0792383855305283e-11 2.0570283034869047e-11 … -0.0005493876154447131 -0.045382216762036014; -1.8525009937948447e-12 7.680162963191038e-10 … 0.3466620179788565 0.17486108595936312;;; 7.13940029731685e-12 -4.418114862931465e-11 … -0.24694024049811966 0.47558670523156915; -1.1301051942727096e-11 -1.2285398787078428e-10 … -0.31817172869728716 0.06505985160013417;;; -1.1102181518193571e-11 1.3364877358191387e-10 … -0.1565879543442239 0.039085274208379414; 4.803655116268238e-12 -8.20015066653716e-11 … 0.08644345985577172 -0.21180459544407207], [-0.7071070222934441 0.02157106546328708 … 0.02830083236740758 -0.010775042199964379; -0.707085105340723 -0.026274883390497304 … -0.028389127145652237 0.011192514845770364;;; 0.0007161273420464389 0.706715880365352 … -0.01131227899016446 0.05016704367609724; -0.005409220557076451 0.7065536947396682 … 0.009145625867303199 -0.050785893091015846;;; 0.00048734546322459586 -0.008876396868879892 … -0.06540602393626531 -0.040290466493623285; 0.0005124147387858232 -0.008883684102446467 … 0.0068278873480959 -0.06091686685388279;;; … ;;; -1.974822458347486e-7 5.8386153317322914e-6 … 0.015657824948905396 0.0498834676029021; -2.4520542992380314e-7 5.826721045789787e-6 … -0.024216305984410724 -0.010218509118820971;;; -2.861353635543113e-8 1.1738433609813381e-6 … -0.02765594970793623 0.01457840230427979; -3.8248389219188305e-8 1.1580879642841602e-6 … 0.004499218278293712 0.07777757419066438;;; -1.1731654479801455e-7 3.5983894353475283e-6 … -0.01563961677812475 -0.033538044719019326; -1.4656749600946018e-7 3.5829097412342026e-6 … 0.02971794196300623 0.005379981432110367], [-0.7070972993461616 -0.006908329608767405 … 0.03460787435299592 0.012092339870512774; -0.7070748425489017 0.017203388078442985 … -0.03474155893111398 -0.012088939040116223;;; 0.003595768770513663 0.7066358656347264 … 0.03237151095693628 -0.0004321369440041951; 0.006647157560960435 0.7064597141308511 … -0.03119599441232809 0.00080045540050207;;; 0.0007061361731043997 0.021306438266912888 … 0.02001226898055945 0.009780869181978038; 0.0007772181839494972 0.02129160466984415 … -0.01801696105956033 0.0037028504608597095;;; … ;;; -1.705114206782323e-5 -0.0006472068477259408 … -0.2602586250752232 -0.1318822960320928; -1.9821873208328848e-5 -0.0006468205649665699 … 0.22698793100056366 0.06276059924852526;;; 3.6831214755653786e-7 1.3549870943524474e-5 … -0.10497131729157669 0.7795720738299584; 4.2560518949117104e-7 1.3533479132534924e-5 … 0.4109427445578798 -0.09022019885425535;;; 4.433430574828572e-8 1.4977584332623966e-6 … -0.028824518023415815 0.11333069252866503; 5.052129450986383e-8 1.4960644467465907e-6 … -0.6126012278002524 0.19562102026248704], [-0.7070883280996273 0.0003489037073640894 … -0.04062750053422141 -0.04995425054685695; -0.7070759532883006 -0.012008820335617234 … 0.0406334512300915 0.04994860784630076;;; -0.005045828861122572 0.7061278976432704 … 0.003488744192880778 -0.0016950037118204598; -0.006541369272786322 0.706026250435848 … -0.0027874769384918334 0.00249796891951903;;; 0.0004912674482901438 -0.02209406212590156 … -0.006211916064588054 -0.002604402656629146; 0.0005325136096209759 -0.02208485510700686 … 0.007928083793005875 -0.006953837126294207;;; … ;;; 1.4290333371977036e-5 -0.0006846061602019584 … -0.46565249896521194 -0.1905615567701236; 1.572730590528784e-5 -0.0006845146540382407 … -0.274181732898228 -0.03349775235361412;;; 5.301202075440734e-6 -0.00026225274655216263 … -0.3817571418693221 -0.3081749714283285; 5.8536769517965535e-6 -0.0002622477474500401 … 0.09261808096140131 -0.44484353418929967;;; 1.8330003087517806e-6 -9.352351457721227e-5 … -0.2103831733963715 -0.13786928883963284; 2.030485241228123e-6 -9.353281774240916e-5 … 0.005399162712164537 -0.17680069171395923], [-0.7070414598670235 0.006762322978503975 … 0.020980815428192964 -0.03762001465519437; -0.7070312397903605 0.013183870501186658 … -0.020979548973262447 0.037620325185787416;;; 0.009426817257147174 0.6925962748623191 … 0.0013129622662805221 0.0006475314030173703; 0.01013676994298752 0.6925090691325728 … 0.0001394819553267835 -0.0006119424603697491;;; 0.000406129833297539 0.030578582205872867 … -0.0011877320003496853 0.0006898474547790566; 0.00043617401868457245 0.030573064837846397 … 0.0008163934984540256 0.0016976776595821733;;; 0.0002912567243664914 0.02205531860745467 … 0.019387208425612194 -0.008158244253922023; 0.00031345758586639815 0.022050795205869993 … -0.0035478913181337143 0.013013679225780775;;; -0.00027182052149168765 -0.020653119456933912 … -0.6460147861898539 0.4625317128243574; -0.00029292860156428116 -0.020650513802728185 … -0.034566478898918035 -0.7575901732424438;;; -0.0010611593132429694 -0.08067843514953826 … 0.3239299643785022 -0.05278606428581694; -0.0011434834283008271 -0.08066435332435733 … 0.46765982256911537 0.39865261563823884;;; 0.001380341419511383 0.10497960427935811 … 0.1503361080723048 0.023038126395615997; 0.0014873808491130654 0.1049594890816982 … 0.223744517366419 0.13940555150831002;;; -0.0003917957973253256 -0.029782008979121404 … 0.1030570893253693 0.019562940418798466; -0.00042222104611592165 -0.029777282453614523 … -0.4162664975536989 -0.16429630813803922], [0.17687321679921245 0.14088468017136224 … 0.17122744980376228 -0.047539845260493256; 0.983734846726901 -0.004905988983213631 … -0.013822406407095332 0.006785132294835489;;; 0.019859608259605626 -0.9898181490556932 … 0.04027315731284625 -0.008150163884590274; 0.007536899047218102 3.547006135320247e-5 … -0.015302933716183574 0.02500924241424793;;; -0.02265680671117483 0.019207230390353856 … 0.7810972078968653 -0.06521744591323016; 0.004132392032030165 -5.960645688173195e-5 … 0.07869220039768893 0.05545547451486342;;; 8.229860028857924e-6 0.001674023640794857 … -0.12362883368463208 0.011248913122162451; -1.4424882390247522e-6 3.418875270063648e-6 … -0.009880645982397648 0.06640477714838659;;; 1.5351718825828463e-6 0.003911083527580237 … 0.2449562247385662 -0.03145853365742378; -5.697721481864273e-7 7.700035728554539e-5 … -0.33582064327795697 -0.6138893318621536;;; 2.613154456853007e-7 0.0006165527526987617 … -0.1271856155111494 0.013592071909405028; 6.146085722912491e-10 -7.049767949613835e-7 … 0.01054927468351188 0.09435427964618265;;; -8.880702654408302e-8 -0.0002206486523417521 … -0.059531335063341184 -0.0980321391214576; 2.316446180779494e-8 -1.8715788743679677e-6 … 0.09419345301579614 0.28043417652618724;;; -4.827677812202188e-8 -0.00011729179152448055 … -0.12557981872674437 -0.34685206871143726; 7.289624067141178e-9 -7.250731810848407e-8 … -0.34596786912601396 0.6242115582723284], [-0.4086478518655247 0.24995628197318984 … 0.012674370065371893 0.023440644511950513; -0.9115208129281317 -0.1274989265225092 … -0.0002425300857855676 0.000133508179057825;;; -0.01524624795359521 0.9593793003246265 … -0.002464275006591303 -0.004245085925450097; -0.019419001603545614 -0.0013428980369720198 … -0.047315561985843 -0.09754098023286771;;; -0.01293881481997398 -0.02895437223063078 … 0.04896114865340027 0.10063039472793267; -0.036875223533999635 -0.004132699516990842 … -0.12570347506662066 -0.24525273499798858;;; -1.5558178423081835e-6 -1.1059464907711036e-5 … 0.010288463462014634 0.020980552644256877; -4.740477949366391e-6 -5.35789337002087e-7 … -0.013169559851027652 -0.024727823714844773;;; 9.430230901655136e-8 -8.680775863085062e-6 … 0.00032393634137071916 0.000895050364397428; -3.70397756318991e-9 -8.694618855220257e-10 … 0.9452932022983911 0.04164923957922558;;; 2.411420838640014e-7 -2.2190989461231674e-5 … 0.0017987205722500808 0.0021772719582284455; -9.281512872886802e-9 -2.7714859647784715e-9 … -0.2920229658421241 0.2782540894082999;;; 2.2188335398980964e-8 -2.0092311248185904e-6 … 0.016016102196169876 0.022164902028075265; -9.039057840153869e-11 -6.278954906875273e-10 … -2.984443197101609e-5 -0.041071855949849814;;; 5.370109188319939e-9 -4.897344080299182e-7 … 1.260116494791982e-5 0.0003284133892026358; -1.022482016141421e-10 -1.8439863861489188e-10 … -0.0003334016069024891 -0.9150122394877377], [-0.523146743460472 -0.4104124188144439 … -0.05557582737774654 -0.12993596946176317; -0.8506747620914539 0.2745900379945756 … 0.028410506977637678 0.07243678152773064;;; 0.02208795721059598 0.8692315247059146 … -0.04019141760339135 -0.07274708718296026; 0.021089502651210287 0.012873044936867212 … 0.03314954032754164 -0.5230598051261433;;; 0.015482187929394523 -0.01941111485834521 … -0.1818887966411626 0.12395061920552458; 0.03869871480497174 -0.007483797323918228 … -0.049124633544814056 0.11272796323490802;;; 6.391483430435256e-6 -8.696864595883068e-6 … -0.04421286782002804 0.05303613960063714; 1.6126092884066637e-5 -3.217641357880975e-6 … -0.011875368752322025 0.042077149091993005;;; 8.904902583151601e-9 2.634440557222593e-7 … -0.18752502262094164 -0.23063487301997096; 2.327424015421408e-9 1.6265748257900489e-9 … 0.029797344499329043 -0.2982645919663449;;; 3.828919187701686e-9 1.1430471877222596e-7 … -0.1470973707560345 -0.08127004271805716; 8.399773236874084e-10 5.555501297747358e-10 … 0.0402186700120362 -0.32050654877538437;;; -8.296690315578938e-11 -5.422995038797766e-11 … -0.9336658271917633 -0.013885910803514399; -1.48642884645399e-10 -5.7128660945730363e-11 … 0.00014384163375879758 -0.2852339898834707;;; 4.3763092497847506e-11 -2.6349966000066192e-11 … 0.157340825780144 -0.06247040836040742; 1.0520297699081473e-11 -7.458844869249534e-11 … 0.0007972709406986201 -0.5739284896781706], [-0.5870951920523465 0.5792723603294857 … -0.04834623959897375 0.04263244162372282; -0.808804184167957 -0.4275924577098362 … 0.027160594148227874 -0.03574699962225033;;; -0.011775282882348536 0.6872929801979965 … 0.06797608673881471 -0.03759392251248781; 0.02127433168676628 0.09505062769303459 … -0.03701702720644755 -0.13769560732181965;;; 0.008893376811096521 0.00918848774970656 … -0.25598564241261607 -0.07364059713172447; 0.02201531534057985 0.010840579352624774 … -0.11555446362117025 -0.033684063289901665;;; -2.6870040065866483e-5 -7.014626036469931e-5 … 0.08892909300037444 0.04238475370331962; -7.380864027024036e-5 -4.098766135947436e-5 … 0.032439363422210404 0.052331910366514245;;; 1.0929224055718179e-5 -8.44657972241802e-5 … -0.3669344237116419 0.07825101411380353; 1.0767300561803933e-5 -3.3015609401047137e-6 … 0.09721137638686089 0.3999059271011672;;; 3.3921795369839086e-9 -2.6364957717267898e-8 … -0.13324066296111692 0.03299076624549706; 2.5140915078551106e-9 -1.7234231407700549e-9 … 0.09779042336464824 0.239645051489102;;; -1.2524861205349517e-10 7.414210118147158e-11 … 0.8399508904798066 -0.205112567765843; 1.327885595057576e-10 2.7675191204454737e-10 … 0.02386823703127109 0.19967997827311104;;; -2.094181366011753e-10 -2.8991855494857408e-11 … -0.08080235737937043 0.018166044194319157; -3.0917247035710514e-11 1.3410173482516616e-10 … 0.13808902642390808 0.8115412597997667], [-0.6536554938891499 -0.6295409559761004 … 0.05909854242327831 -0.03729804768300185; -0.7559559845740532 0.5434024195075602 … -0.047130783268084425 0.04383540860725048;;; 0.012477457471921251 0.5111284853609112 … 0.12324970488657407 -0.005065305989333311; -0.03223737174432423 0.21670363537700332 … 0.01679716219488743 -0.1818357291137898;;; -0.002708608925971973 0.008074966244661813 … -0.2931040428059752 -0.23870425520919533; -0.007916300259298636 0.010641103555128003 … -0.1425109345520443 -0.29751060927187056;;; -3.9209938413916286e-5 0.0006399169945076117 … -0.13815639176458686 -0.16672630938361122; -0.0002597762715387842 0.000474709610463293 … -0.06545734909384417 -0.059015670133747214;;; -0.00011830480415600479 -0.00035608057136857105 … -0.5117235160719322 0.24685157769050037; -0.00014907713786881902 3.5888762159431025e-5 … 0.0005633612806791025 0.2383343322842777;;; -2.2691475203362758e-8 -7.667415506260171e-8 … -0.24792026296136227 0.11263359050460027; -2.6115383373110683e-8 1.8172744820902788e-9 … 0.12545478579481933 0.3676828263019015;;; 3.416185995394483e-11 -7.758868439194939e-11 … 0.7077811364433122 -0.12009024023616444; 8.588534303781993e-12 -1.5783868075112545e-10 … 0.06211888534956825 0.24923619744902273;;; 2.7861138054076327e-11 -2.143557730931367e-10 … -0.025339867407229273 -0.018741376150020136; -9.418685247824526e-11 -2.1398817353304772e-10 … 0.0685753700884002 0.6665711502293162], [-0.6920925768573809 0.6216102034942336 … -0.061559919782910574 0.09347678585106485; -0.7215889817589791 -0.5951270271393263 … 0.05700486871791405 -0.09120527388005818;;; -0.009177755775996993 0.4118591732653946 … 0.16302023756949757 -0.1556663375918928; 0.01517002122454767 0.29955208880701745 … 0.026864266946000664 -0.16155455758268739;;; 9.012664003230687e-5 0.004728586230266421 … -0.22025036605468948 0.10223558074109847; 0.0015507655062885178 0.0054563426874522794 … -0.17984646690241116 0.15679792639632464;;; 4.927378492677624e-5 -0.002511455869127729 … 0.34713542637636136 -0.07899054236316787; -0.0006472953500528515 -0.002584419917972445 … 0.07252048690707061 0.5521933938975359;;; 6.799312484807065e-5 -0.00014246786194247222 … -0.6555350247298485 0.00301384612241589; 8.17262903046109e-5 7.63633601003254e-5 … -0.1135551432748094 0.15518939892398778;;; 9.214039109818194e-8 -2.2361547800192006e-7 … -0.2993604947459946 -0.19048537738136195; 1.0173548553100263e-7 6.984666899488098e-8 … 0.1730498988341089 0.6911598677121406;;; 1.5510653676449272e-12 3.3176530604902095e-11 … 0.4432592815088951 -0.17520818625097095; -8.16334129713266e-13 1.8950726496079525e-11 … 0.012897662143220206 0.0660934494786872;;; 4.919867686007838e-12 1.1918253559247557e-11 … -0.014561860262788598 0.08855329949763832; 6.03697559968577e-12 1.7978189730406992e-11 … 0.0022876258717590145 -0.07368607104301347], [-0.7031077625654418 -0.6165902623816116 … 0.05151343542494565 -0.10296727741571; -0.7110598661537703 0.6092250362636392 … -0.0501462723528904 0.10271017717723067;;; 0.003358995976494943 0.36881351702069365 … 0.1676844104502748 -0.14118375655586152; -0.004685478714541897 0.3356060381712595 … 0.0049409556173833505 -0.2188093759875044;;; 0.0001021107658026576 0.001532210142549742 … -0.163507165237084 0.07223502583887649; -0.0002709168412073566 0.001611093225615038 … -0.30282951280876697 -0.16085063081844364;;; 8.906896178174529e-5 0.0008971410922584834 … -0.5496448871492713 -0.09287272591904314; -0.00011112741114782051 0.0008551949578343665 … 0.04403380352550907 -0.36209531472076906;;; 1.1228159369912781e-5 1.812289430965142e-5 … 0.6150005986972186 -0.3459847039598205; 1.302395619549103e-5 -2.2207796666689726e-5 … 0.3059873110595179 0.4651161280479758;;; -1.1244364162312371e-7 -2.3133111681423916e-7 … -0.21201444106038994 0.20828215323537522; -1.1619765396539417e-7 1.5398148827973036e-7 … 0.1406332672310918 0.5802793916426795;;; -2.998293945846981e-12 5.4437260532181804e-11 … 0.08407810418232811 -0.0368002385144421; 1.3035209592268684e-12 5.0288978457531116e-11 … -0.002238041969339611 0.1409081205010097;;; -2.514007776535627e-11 -1.4477693370201173e-11 … 0.022844747112867207 -0.005072630831618085; -2.4343616391364774e-11 1.0408647213718936e-11 … 0.004757010849882272 -0.05319431706566556], [-0.7058861630631101 0.618213412657485 … 0.005612460184758017 -0.17576108824544312; -0.7083236350622755 -0.6159358981180184 … -0.005802196617476413 0.17536236804131264;;; 0.0009024883074968647 -0.3497430169493439 … -0.05313392420000753 -0.3157451722011959; -0.0012383451554858482 -0.3407560260695583 … 0.07455740753282754 -0.3118862779787727;;; 3.594875056969487e-5 -0.00040114236506893835 … 0.12983102526089166 0.3186415016019976; -5.7539028642234085e-5 -0.00034915245234203344 … 0.4368334161190245 -0.4854423853323931;;; 1.3408454156489265e-5 -9.602006531465447e-5 … 0.663585445049003 0.5506628342740753; -6.4417478932743485e-6 -8.105495111909516e-5 … -0.5861123121439984 0.31776051123883947], [-0.7066938452043452 0.6328170446992767 -0.06986773636840662 0.3086177190362306; -0.7075193815295774 -0.6320224021834995 0.06932158204545552 -0.30847775634706265;;; 0.0001868192779717632 -0.3175390935341946 -0.8267591370913194 0.4643686234146918; -0.0003146567313719439 -0.31505427334628316 0.5538793613355589 0.7706869396349597], [0.7069771286000691 -0.707236410004746; 0.707236410004746 0.7069771286000691;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^d, 2^d)
xes = collect(range(0,1,length=2^d))
yes = collect(range(0,1,length=2^d))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="9bfb5fbe.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this example we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 8
h = 1/d^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,d)
xes = collect(range(0.0, 1.0, 2^d))

u₀ = qtt_sin(d,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.831333819144763e-6
Relative error for Crank-Nicolson: 4.831571804134092e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on [<a href="../resources/#QFT1">13</a>] we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an example of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h1 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h1><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve Burgers equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using CairoMakie
import TensorTrainNumerics: dot, orthogonalize

orth2(x) = orthogonalize(orthogonalize(x; i=1); i=x.N)

d  = 6
L  = 1.0
T  = 1.0
Nt = 1000
ν  = 0.01

N  = 2^d
dx = L / N
dt = T / Nt

Dx   = 1/dx * ∇(d)
Dxx  = 1/dx^2 * Δ_DN(d)

u₀ = qtt_sin(d, λ = π/2)
x0 = orth2(u₀)
v  = u₀
v_ref = Ref(u₀)

&quot;&quot;&quot;
    residual: (u - v)/dt + 1/2*∂x(u²) + ν uₓₓ
&quot;&quot;&quot;
function burgers_residual(u)
    t1  = (u - v_ref[]) * (1/dt)
    nl  = 0.5 * orth2(Dx * (u ⊕ u))
    lin = Dxx * u
    R   = t1 + nl + ν * lin
    return orth2(R)
end

&quot;&quot;&quot;
    gradient of J = 1/2 ∫∫ |R|² dx dt
&quot;&quot;&quot;
function burgers_cost_grad(u)
    R = burgers_residual(u)
    J = 0.5 * dx * dt * dot(R, R)

    g  = (1/dt) * R
    g += ν * (Dxx * R)

    Dxu = orth2(Dx * u)
    g  += orth2(Dxu ⊕ R)
    g  += orth2(Dx * orth2(u ⊕ R))

    g = (dx * dt) * g
    return J, orth2(g)
end

solver = GradientDescent(verbosity=2, gradtol=1e-6)

v_ref[] = x0
for _ in 1:150
    x, _, _, _, _ = optimize(burgers_cost_grad, v_ref[], solver)
    v_ref[] = orth2(x)
end

vals_init  = qtt_to_function(x0)
vals_final = qtt_to_function(v_ref[])
xes = (1:N) ./ N

fig = Figure()
ax = Axis(fig[1,1], xlabel=&quot;x&quot;, ylabel=&quot;u(x)&quot;, title=&quot;Variational Burgers&quot;)
lines!(ax, xes, vals_init,  label=&quot;initial&quot;, linewidth=2)
lines!(ax, xes, vals_final, label=&quot;final&quot;,   linewidth=2)
axislegend(ax)
fig</code></pre><img src="2effeaa2.png" alt="Example block output"/><h1 id="TT-cross-approximation"><a class="docs-heading-anchor" href="#TT-cross-approximation">TT-cross approximation</a><a id="TT-cross-approximation-1"></a><a class="docs-heading-anchor-permalink" href="#TT-cross-approximation" title="Permalink"></a></h1><p>The TT-cross algorithm allows you to approximate a high-dimensional tensor from function calls. Below is an example of how to use the <code>tt_cross</code> function to</p><pre><code class="language-julia hljs">using LinearAlgebra
using CairoMakie
using TensorTrainNumerics

function sin_6d(coords::Matrix{Float64})
    return vec(sin.(sum(coords, dims = 2)))
end

n = 8
d = 6

domain = [collect(range(0.0, π, length = n)) for _ in 1:d]

tt = tt_cross(sin_6d, domain; ranks_tt = 12, eps = 1.0e-15, max_iter = 50, verbose = true)

tensor_approx = ttv_to_tensor(tt);

tensor_exact = zeros(Float64, ntuple(_ -&gt; n, d));
for idx in CartesianIndices(tensor_exact)
    coords = [domain[k][idx[k]] for k in 1:d]
    tensor_exact[idx] = sin(sum(coords))
end

error = norm(tensor_approx - tensor_exact) / norm(tensor_exact)

max_error = maximum(abs.(tensor_approx - tensor_exact))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3.6637359812630166e-15</code></pre><p>And we can check the difference at random indices</p><pre><code class="language-julia hljs">println(&quot;Relative error: &quot;, error)
for _ in 1:5
    idx = Tuple(rand(1:n) for _ in 1:d)
    coords = [domain[k][idx[k]] for k in 1:d]
    exact_val = sin(sum(coords))
    approx_val = tensor_approx[idx...]
    println(&quot;  Index $idx: exact=$(round(exact_val, digits = 8)), approx=$(round(approx_val, digits = 8)), diff=$(abs(exact_val - approx_val))&quot;)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error: 6.650828942795556e-16
  Index (2, 2, 7, 6, 3, 5): exact=0.78183148, approx=0.78183148, diff=2.220446049250313e-16
  Index (2, 7, 5, 1, 4, 4): exact=0.97492791, approx=0.97492791, diff=1.1102230246251565e-16
  Index (5, 2, 7, 2, 5, 1): exact=0.78183148, approx=0.78183148, diff=1.1102230246251565e-16
  Index (7, 8, 6, 7, 6, 6): exact=0.43388374, approx=0.43388374, diff=3.885780586188048e-16
  Index (1, 8, 3, 1, 3, 6): exact=0.78183148, approx=0.78183148, diff=1.4432899320127035e-15</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Quantics tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 9 December 2025 14:41">Tuesday 9 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
