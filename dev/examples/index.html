<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets.citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Quantics tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li class="toplevel"><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in [<a href="../resources/#FastandFlexible">15</a>] where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^d)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, d)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(d) + id_tto(d) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(d) ⊗ qtt_basis_vector(d, 1) + qtt_sin(d) ⊗ qtt_basis_vector(d, 2^d)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[0.05981644733878341; -0.5616605760337232;;; 0.8192890322359878; -0.9978103616858506;;; 1.5882253142375296; 0.37160568036560937;;; -0.8353095120922976; -0.9772394125752808], [-0.1120451413996695 1.0474282166599276 -0.3965083200864543 0.5071857700054898; -2.491236397328185 -1.2583954608395753 -0.7399291037922318 -1.887711096663132;;; 1.3116080618768449 -0.6414421176396884 -0.5732301233397018 -0.8698334691417858; 0.3399749231381046 1.2722129099963746 -0.9161520076033215 0.7932553493733108;;; 1.790026601629605 -1.51641748463251 0.482199535582171 -1.7570640290773447; -0.34991716749420526 -2.460586762628678 -0.6275975972008424 0.3321885024662109;;; -0.0798479612448702 -2.698529711540862 0.32203874576803376 0.007691839672229311; 0.2367612869798909 -0.053584129532578975 0.5181936450831559 -0.4158059252894272], [-1.7041334247881215 -0.020884377618154433 -0.21688560452757427 -2.2119491179571806; 0.736587179692471 1.459542052869223 -0.18212133625085958 0.7091424630482493;;; 1.6823391525813323 1.398053834990863 0.5922334403275673 -2.6662325850611954; -0.5926127385191071 2.211882150571072 0.5033171602338391 1.3195686555424153;;; 0.6835761391629905 -0.2864295450499716 2.6499089057512393 0.6643773460374564; -1.2826354517855065 2.97941409740299 0.18967209783818711 0.2506580175186414;;; -0.2963991981284873 0.04481233642291732 -1.8776950576269094 1.199597190752483; -0.3688003881254857 0.4277781712573284 2.448541002846757 -1.152712533489573], [-0.9465081439792178 -1.2217370307322117 -0.9913021880398944 0.006229558065308557; 0.5259233041911274 -0.7439917454510766 -0.678855136812014 0.6529211150538475;;; -0.8754036616024026 1.5643021258277572 1.2572283325318727 -0.46040305978967816; 0.17716762042040735 -1.325899718637341 -0.8366935053009182 -0.6617777475230686;;; -0.017450993965424155 0.18185126029093635 0.11862507685397634 0.9171658317088537; 0.527890769423751 0.18859749096564146 0.7370309744216886 -1.3651133297496938;;; 1.220958994671998 -1.002563767012237 -0.07486415846103657 -0.029378854791641314; -0.35162058608708446 1.359284344769791 -0.8496771082701429 0.6427888396063377], [1.2379330983770487 -1.0153427310734806 0.14524844755063454 -1.1011930680150512; 1.0793737040471225 0.22110705987901352 -0.25417488400312005 1.1286074671390824;;; -1.081054146484069 -0.6084056624399672 -0.13665006111066513 1.6254559901049739; -0.6340277307204127 0.3414132963568346 -0.452659104831688 0.03727463373010435;;; 0.3627086675892362 -0.35398484698756527 -1.5814704050347836 0.2049466820308323; -0.03441823242681481 -0.31162767108894346 0.8161668963985619 1.090305123084015;;; -0.7190030637610042 1.4711221045652199 1.122628129608588 0.14699690157368506; -1.7178213440324954 -0.2122593563402779 0.5674271946760838 1.8852288704868434], [-2.47934353901163 -2.895161115413996 0.34103730334170135 -0.1081735412939334; 1.2560332907096863 0.20013318952560077 -1.4071810134735314 -1.7014054287574805;;; 0.9138698552217719 1.4614755233031462 -0.09937868868838783 0.46205987842057467; 0.39687121719231694 -0.3416047205420865 0.35287605338236905 0.5970560743368939;;; 0.13699819044682193 0.050642766774584534 -0.2495260343624999 0.6702887265379335; -0.8441216850556694 1.4189574813596808 2.401625590676108 0.5630152091840731;;; 1.135761638677971 -0.006994744523604084 0.2655227496362796 0.9396451848713502; 0.8139388026469677 0.022811451382302412 0.815317907492663 1.3069157926238846], [-0.0516737968509128 -0.022163290395694153 0.6634420326769106 -0.04529692961561335; 1.4534708026279344 0.41866842690085426 -0.8521149270830907 -0.20522787620257463;;; 1.9008901751985947 -1.4168158626391494 -1.7235994463732445 1.4443018377310017; -1.4929932997300948 1.8199140303338688 -0.13617569353309078 1.1838371122427807;;; 0.7968497882176119 -1.1555171174700398 1.4011863247011513 -1.2681471769369372; 1.0480005902280132 0.3636840081787777 -0.13004251346645812 -0.9871028998981722;;; -0.7800746120553015 0.6913350133406841 0.7101741939685883 -0.31782454448070574; -1.9445876971056595 0.5867496638376049 1.4600384231170926 1.1083658757328951], [0.1668646018040031 0.08418991553845852 1.4776950643776117 1.8812548005662966; 0.7884547471973089 -1.3536817793392482 -1.0492972030473897 0.16185789138293155;;; -0.8674660639617954 1.1197457844875367 0.25066583005187193 -0.5453687303075165; -0.9062840037998107 0.19389068483339544 -1.225417219809725 0.6113027227485377;;; -0.1567830464381441 0.5093238846657675 0.16307221818291331 -1.0881013984850711; 2.658225729488862 -0.9081596065647055 0.04332516870120514 -0.48361724153465346;;; -1.7748338563165154 0.571247499527053 1.2140264075651992 -0.32245306674263774; 1.4658257440451918 -0.27183536822418025 0.9828897991502302 -0.7755507731620598], [-0.1914182735813091 1.741024188532532 -2.1763308322666544 0.07787259491724675; 0.2650643899353131 -0.6476461567516222 -0.09520487288815772 0.18184950735144617;;; 2.772372487896122 -1.7781503789003188 0.3861778333412264 0.22234908258882574; 0.6455735592936661 -0.981352141184441 -0.7070776863898445 1.160107986796025;;; -2.0776459990788045 -0.3082389649588628 0.4227430711216619 -0.5574414037763282; -1.8060157886073962 0.3749853028023774 -0.5726873018001509 -0.4684954049335749;;; 3.43600800506141 -0.19453981453727437 0.5895405867051592 -0.7926533620558625; 0.8668114596462959 -0.9586291938073462 -0.5380126487503417 -0.739867443011694], [0.1276603717146234 -0.9274792304455693 0.33230080649908667 0.8630865327300696; -1.591005855097946 0.5551253570321192 1.282482934614854 -1.7951646691117586;;; -0.8456422592957572 2.220013411591475 2.0119599817238685 0.01464722949920074; -2.4956861331436664 0.9452564896599841 1.224653540718694 -0.7013978839670076], [-0.34952451413013386 0.7047244358946718; -0.600355563349533 0.029773590411135104;;; 0.20750040183527133 -0.8231614658298111; -0.9895642006822604 -0.209180554049545], [1.6758491216351883 0.3453744553872102; 1.4527991002359963 1.2330604387881454;;; 0.26612616065298417 -0.19889083349590972; -1.4217123469248174 0.6850239891525972], [-0.35921509465206036 0.09749096332480997; -0.27346658196457924 -1.687294040653868;;; -0.8374303485027186 -1.2998108098050576; 0.44972748727131406 -0.8957858457726038], [0.17314755434831217 -0.2910836562738465; 1.813886937551986 -0.5281292911552028;;; -0.1252138290572317 2.139267651876585; -0.40877103717458824 -0.49616393971738443], [0.49230855055573564 -0.028185243660089555; 0.5363596671374969 -0.6530895749131126;;; 1.4149465383917679 1.0929990476460991; 0.17356033341328567 1.6615655548976747], [0.26991170817971927 -0.27566725034603884; 1.2994018496298496 -0.01435782239501382;;; 0.2793904248989377 -2.1295368661328298; 0.5458599637543075 -0.6848750872584892], [0.6988889290064266 0.0392182229644381; -0.23436196803156015 1.1056239078905894;;; 0.38833150484718937 -1.15131748736873; 0.4929615871640139 -0.3786563144794719], [0.744230839823031 1.4126538971770581; -1.0178881035342238 0.07847884856152385;;; 0.9438249487913095 -1.0421201128593036; 0.19757856796440876 -0.8135430504133394], [0.35459802037485855 -1.1536288734263571; -0.12030092730727628 -0.26304440711917215;;; 1.1537212836208555 0.8850133164806995; 1.3994070997115036 -1.951558433929604], [0.27946079181016525 -0.6112015477323729; 0.5250984416937213 0.09821310930255256;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-175.2434127918854; -193.87653324000024;;; -112.7469225634245; 101.91102121337333], [0.7030953043124241 -0.4908735442541155; 0.6915795606457935 0.5079818230354465;;; 0.11112262468399213 0.4914074444507045; -0.12031614465648506 0.5044183650448585;;; 0.010298953529737547 0.05191342110046121; 0.013802318018813533 -0.04754840667405552;;; 0.011524705944881374 -0.00639126926461764; -0.011004576117033963 -0.009042398491515205], [-0.7069050855253727 0.33994171834281744 -0.12666449588448495 0.11314080549075968; -0.7039671198721187 -0.3428167257007513 0.0973491463092249 -0.1232676260957892;;; -0.04773705755216913 -0.6140678380822967 0.22690718490393968 0.16925896152417888; 0.04875220996049207 -0.6205433746446105 -0.3492053945688891 0.04438065055445171;;; -0.0030598299307836104 -0.04900254206690202 -0.4614862877216224 -0.5082855363727231; -0.0050128676245900445 0.048564202185864644 -0.5025178525959026 0.5228713376425828;;; -0.0035284272205037505 -0.0014691499891753906 -0.4169643325874422 -0.48170658555185486; 0.003595652610162642 0.0006188101157203583 0.40197941116293384 -0.4210492226837051;;; -3.999501205507076e-5 -0.0005879251546504713 0.0072076462636905935 -0.0074509270084959995; -5.56805436442375e-5 0.0005572566304104485 0.007270326327458451 0.00855887095493589;;; 8.632787952525654e-5 -3.231462657499851e-5 0.0012403504299309854 -0.009620007283207823; -8.653063190923285e-5 -4.1221571048397436e-5 -0.0010663751016131027 -0.009611663459523837;;; 5.809603376613689e-8 1.1328983659534723e-6 -8.010329052155141e-7 -6.445220981129911e-5; 1.2161057622401212e-7 -1.105001958897848e-6 -2.0503679968820695e-6 6.389848150401935e-5;;; 3.081571657983528e-7 -1.0958457194653872e-7 -2.977865451905354e-6 8.379284681795882e-6; -2.97394999803238e-7 -1.8413621542987831e-7 2.854564829561526e-6 9.060254922483777e-6], [-0.7069525987354199 0.19305826043101038 … 0.26009699790495483 0.002702514129772421; -0.7065004268776288 -0.1930164391871647 … -0.26053092522706545 0.00412475002543534;;; -0.023244864022346295 -0.6793333855824383 … 0.07722312476850386 -0.10172017445913098; 0.02302325460787707 -0.679861421798752 … 0.06492681656573009 0.09520995230319336;;; -0.0007250559865118558 -0.029230220435209467 … 0.1218615520126903 0.07558374423555997; -0.001481169273786873 0.02980123313883882 … -0.013828348772691595 -0.08168831293492257;;; … ;;; -4.435085618995803e-11 -7.00497737580878e-10 … 0.00018886973632082255 -0.0004358351736201572; 1.323058555495422e-10 -2.71805676543733e-10 … -0.00010976531089225068 0.0007896888226998758;;; 7.406399109232187e-11 -2.299371286015367e-10 … 5.894421610610972e-5 -0.00037414008551972213; 1.6923051835167825e-11 -3.6862373899445963e-10 … 5.337783925340897e-5 0.00043958523715601806;;; -1.894636295106008e-10 1.4944336339907979e-10 … 0.00011434603452058907 -8.339596776241232e-5; 1.8945881439648404e-10 5.098917562629153e-10 … 0.000195614133336405 0.0004240660512573621], [-0.7070259141110602 0.09958864810617073 … 0.006734177474494487 -0.033912311814452145; -0.7069971428768763 -0.09945152019735376 … -0.011314221930677763 0.029591330116945955;;; 0.011672952637744545 0.6999446210931073 … -0.138447199040354 -0.12435737163074065; -0.011526618309593593 0.6999035305005216 … 0.13414882402060382 0.13194849877962292;;; 0.00015249617870610803 0.001648864104276566 … 0.029161106397887715 0.02022236435877267; -0.0002272265970637678 0.0019653791372341977 … -0.10762191961270084 -0.03672443641377225;;; … ;;; 2.0756381333779636e-11 1.6525521978035275e-11 … 0.10717452674714216 0.011123136014731269; 1.9269410174129474e-11 -2.1883632233830636e-11 … -0.09477294319024449 -0.019145374221260357;;; -2.502908402211135e-11 -3.702712149292514e-11 … -0.2545480144028482 -0.0057174117465881805; -2.6477693526270615e-11 -9.514954365559293e-11 … -0.010494132705861477 0.10122530215037683;;; 7.0127931464656045e-12 1.4715065515450248e-11 … -0.030114112937806588 -0.017974905957321888; -2.5412772595099295e-13 2.5391838155422853e-12 … -0.06581216713806119 0.06250780622712873], [-0.7070844363191819 -0.04991083006716545 … -0.013232277065875857 -0.09259100813909349; -0.7070806563359344 0.04996713758931676 … 0.012997235589881936 0.09274333707385272;;; -0.005825691017737812 0.7053280079706507 … 0.013264271094922092 -0.01640163623123777; 0.005881593531965544 0.7053149608914441 … -0.01739269877710471 0.001963125218813526;;; -4.7691123823319715e-5 8.237845549151118e-5 … -0.1560330034301494 0.00900549960716184; 2.020723687557023e-5 2.8083080774985847e-5 … 0.018572879348327916 -0.11716375407250788;;; … ;;; 1.4246769055176099e-12 8.863886901204976e-11 … 0.44754187022158753 -0.28373174403153617; -1.1614870943275959e-11 5.3831781628037685e-11 … 0.44240130120917 0.13678742918116357;;; 2.0729486042307564e-11 2.3233612380501687e-11 … 0.0484494189778957 -0.1948481101618798; 1.6998072432907114e-11 -3.836585112755704e-13 … 0.14083681059704176 0.365877079439828;;; 3.0846390174552787e-12 2.751006115245151e-11 … -0.05116892995988813 -0.46802378141850276; 2.0876671671116185e-12 2.6459517897412302e-11 … 0.1380145995405059 -0.2709247291959391], [0.7071032135836764 -0.024320516970745915 … -0.09736740784509958 -0.12250638394729262; 0.7070974871284644 0.02555672346052898 … 0.09843871401331826 0.12327808845524713;;; -0.0023308252342239986 -0.706675686904638 … 0.1316181381478491 0.09568056537292229; 0.003566177755512154 -0.706630740830764 … -0.12465073226061198 -0.08669761934648401;;; 0.00013702413871799626 -0.00390962921085078 … -0.047789849941352325 -0.1344159355326174; 0.00013125320281984258 -0.0039202688767955565 … 0.011186027019262105 0.09965108221767183;;; … ;;; 2.1609597281045555e-10 -1.7515723382827308e-8 … 0.02927743115063779 0.11778261689075341; 3.5673331355544895e-10 -1.7478503852242303e-8 … -0.08482202135607976 0.4033700411436273;;; 1.2577512182933038e-11 -1.5268281648912222e-9 … -0.06836481590339985 -0.13631167445935907; 1.94461932853186e-11 -1.4873548105160932e-9 … 0.12528543169223394 0.2716918522572;;; -1.5226589999326243e-11 5.748554713607804e-10 … 0.06460918067727382 -0.21804945464779207; -1.9189917037306574e-11 6.009084989489393e-10 … 0.23359489540107212 -0.22722465992073065], [-0.707106750240541 -0.010773243405243334 … 0.08480919878171415 -0.022736453070598704; -0.707099423847718 0.014236916654772466 … -0.08442521093744533 0.023266509822787832;;; 0.00025236454378996996 0.7068772829031891 … -0.09136278305539482 -0.1293926002542679; 0.0032021972783489987 0.706815605736453 … 0.09430859117692067 0.12885578957233565;;; -0.00020852447844090283 -0.012639929793149011 … 0.05851024800509457 0.07976994523083272; -0.00024390969300866502 -0.012637234972655365 … -0.04472733777178327 -0.04446169198343988;;; … ;;; -1.8801887502330944e-9 7.370710581495284e-7 … -0.18650617671572794 0.14478196741184043; 1.4206393529002377e-9 7.363999547828418e-7 … -0.1050529089726332 0.24654664238207444;;; -3.9175595899734217e-10 -3.298327874664624e-8 … -0.015935927421966634 -0.09721992177631081; -5.256927190257129e-10 -3.299187348252485e-8 … 0.14566888564808583 0.14591519383054094;;; -6.295274688665836e-11 -5.100799174019611e-9 … -0.005893706616776695 -0.0013029213159763556; -8.365313676812703e-11 -5.105222755418693e-9 … -0.01097217986238373 0.0498164072040792], [-0.7071007073373072 0.0026909617115015083 … 0.01557129880738358 -0.18372919473488386; -0.7070931525994993 -0.009995348145563325 … -0.015678038007147288 0.1837197560027258;;; -0.0029020078464857776 0.7057761498324383 … -0.053803666524070454 -0.003025633152754707; -0.004359406062850636 0.7057107335786958 … 0.05347061998717956 0.006437044096261114;;; -0.00025056927360273944 0.025113042204251302 … 0.04413579247612004 -0.05013324736229; -0.00029745290156933576 0.025116613446238556 … -0.028655972285327052 0.050001161296845634;;; … ;;; 3.5822521625128673e-7 -3.986582013208412e-5 … 0.5004191794987951 0.11862862570189894; 4.39637949897575e-7 -3.98700656247564e-5 … 0.42570740202954305 0.01879324038458727;;; 1.548341261494244e-7 -2.2963025604486772e-5 … -0.4292349715593981 0.16755459263003408; 2.0193945929459016e-7 -2.2981816092636522e-5 … -0.40936837749491345 -0.2231672765074947;;; 5.010855229192882e-8 -5.301104397697937e-6 … 0.116877503952658 -0.5514880519606503; 6.097146663976559e-8 -5.301305573570938e-6 … 0.01396185629949934 0.4392050340700724], [-0.7070952183287496 0.0010729634492895634 … 0.013250921926841755 -0.028871971311052312; -0.707090860532133 0.007715654923575526 … -0.01325060693549637 0.028871844101505853;;; 0.004001826596063978 0.6993669768830668 … -6.233916873519356e-5 -8.53359578775705e-8; 0.004695490897715965 0.69932362593371 … 0.0002844609745144652 -0.0002880863755806508;;; -0.00013080228727557912 -0.02341033497053628 … 0.0005886577952903908 -0.0009146930411521644; -0.0001530916790586508 -0.02342026576660921 … 0.00031138738926768985 -0.0007431003568670179;;; 0.0001283979227652135 0.023074048287566137 … -0.006370840659386872 0.018546840611755034; 0.00015100303081672233 0.02308394667942286 … -0.0027666788619888495 -0.0206647955299707;;; -2.7909254322163786e-6 -0.0006964747633586019 … 0.27994663050163787 -0.5255377244699233; -3.4789642973989487e-6 -0.0006957963245370634 … 0.06106744646951854 0.5723956496024155;;; -0.0001273459689669188 -0.02297381971764026 … -0.3396426992406657 0.3683347825892371; -0.00015006925896030135 -0.022975692391163482 … -0.372161181088144 -0.472550612301077;;; 0.0005361633437233418 0.09630057826783578 … -0.07564185427942188 0.06607496618311716; 0.0006314326270573061 0.0963087095319647 … -0.10361631228416117 -0.09313651624308274;;; 7.861429696771722e-6 0.0014080390674823683 … 0.13948800520919238 0.13928405505597305; 9.25534205442742e-6 0.001408126726194345 … 0.7922907757797002 0.04815290626472426], [-0.17700262011921192 -0.1414950066374999 … -0.15024901579284927 0.06531291290110065; -0.9837124611265138 0.00506951888356018 … 0.00809602291947518 -0.011952479439905631;;; -0.019949147017123442 0.9898222055253679 … -0.03414007137346452 0.010499753928081472; -0.007849778028824665 1.1768539208499704e-5 … -0.012180702419570586 0.062303132752101996;;; 0.02243197560861924 -0.013905297053722485 … -0.8537260146614138 0.054929851400460535; -0.004133421808629384 -1.7844018260651052e-5 … 0.06144061544284029 0.17642309125064914;;; 9.06285094071503e-6 0.0011407649035754324 … -0.13289101755009464 0.010344032025911389; -1.9013047880817672e-6 -3.7981542212998964e-6 … 0.009028451122270601 -0.4369145642658097;;; 5.337947877447148e-7 0.003230422702186207 … 0.27209480536317265 -0.11103379979433219; -4.673435681334455e-6 -8.10605841870312e-5 … 0.24737339163397168 0.5316486654849177;;; -2.39261049291562e-7 -0.0005605152542822839 … 0.18953090496186906 -0.03382573548133578; 2.214849478335127e-8 -2.5318868115928167e-7 … 0.002584962019766466 -0.00970244911074071;;; -4.759556833084624e-8 -0.00019829792558459427 … -0.06883870596963629 -0.4222545264093006; 2.078434459897979e-7 1.7135999475931764e-6 … -0.0643707089342175 -0.23728338483170797;;; 2.9148798244332878e-8 9.85784409302764e-5 … 0.07484072985960431 -0.39109369650182063; -7.3758559671885e-8 -9.265318493524446e-8 … -0.2000996413238008 0.28754479642454617], [-0.4087849855959092 0.2533302083689378 … -0.014315954866842676 0.011543125517831479; -0.9114845605144228 -0.1291017421690113 … 0.0013143718336814238 -0.00019767854754831454;;; -0.015297305318884805 0.9582944414372321 … 0.0033174535853549955 -0.002253448549077032; -0.018810777996144782 -0.0012953573139605945 … 0.0437297590949438 -0.04630172504242901;;; -0.012840640616192486 -0.028445133993093216 … -0.041004928635605446 0.04691854908575425; -0.036578634308740934 -0.004183947011120152 … 0.11775592749804141 -0.11579417818741991;;; -1.921201464958705e-6 -7.4017361019110206e-6 … -0.008964280060307235 0.00994198724727876; -5.617124846043904e-6 -6.50864613146748e-7 … 0.01257112987333189 -0.011754521705610229;;; -4.0187929457321984e-7 -1.1037099915458808e-5 … -0.009409866930190596 0.0030419221235698625; -1.1807327767334304e-6 -1.6802598617033184e-7 … -0.40715814602265715 0.10993490441833213;;; 9.014620068814045e-8 3.4806982071035052e-6 … 0.028876690977955383 -0.008970770477341149; 2.907389955039081e-7 4.108545058096372e-8 … -0.7343068856686304 -0.029067371270786017;;; 1.1848356599707707e-7 2.6070441720670536e-6 … -0.03169246834795166 0.009996692163673652; 3.3152514502728957e-7 4.657173061965681e-8 … -0.5245688812290611 -0.08063463817918057;;; 5.6374395651914315e-9 4.0220961342784717e-7 … 2.3641515070312163e-7 1.761260162368945e-5; 2.2966884531636903e-8 2.753639769736142e-9 … -0.0002889344424641939 0.9809428796973386], [-0.523681683410272 -0.41553196710848933 … -0.11033171431687895 -0.026334795680572936; -0.850418983720065 0.27773270378835524 … 0.049592684761256764 0.01140887494945028;;; 0.02182218162494743 0.8657867733985654 … -0.07120683774309176 -0.013762934622511977; 0.019549070965086696 0.013819058499002964 … -0.11343972616536058 -0.10313777375595361;;; -0.01524893056491466 0.019023642276304712 … 0.07714861000809368 -0.07039792177864536; -0.03813322065425708 0.007624112601546425 … 0.2794270243628868 0.07463065495355507;;; 7.369128020487622e-6 -1.0522704565229546e-5 … -0.006316957823621124 0.024161625347630705; 1.8641290902961865e-5 -3.849728864143685e-6 … -0.035325024516751125 0.005132305467631347;;; 5.831200410715707e-8 1.9089235719466073e-6 … -0.24071696564200565 -0.0103491507547441; 4.924993167503272e-10 1.929500348500121e-8 … -0.02027260702874914 -0.27644250398443554;;; 6.064945834426989e-9 2.0094715423980877e-7 … -0.07370448289321115 -0.002260662979493311; -1.1544302910279075e-10 3.1463645583012782e-9 … 0.5587937001535377 -0.11402685813150527;;; -2.421348171948792e-9 -7.924540622345019e-8 … 0.7113866519743354 0.03402808934514606; 1.8164812457938478e-11 -8.518682681226559e-10 … 7.360958644355145e-5 -0.09933800808236985;;; -1.959241943752719e-9 -6.558102447435088e-8 … -3.692506033530194e-5 -0.001100388217185465; 7.038368310651364e-11 -1.4515053289042648e-9 … -1.6550953809212207e-5 -0.9362968605865503], [-0.5885814071336142 0.582485178568671 … 0.07601340929900699 -0.03618825442488451; -0.8077048597765751 -0.4311675003344916 … -0.04538663785371461 0.031442701675393384;;; -0.011659518113107132 0.6818680588954423 … -0.10377034000079641 0.030194076279872487; 0.02259039002206326 0.09828277278740488 … 0.021575682795862288 0.1306285243682215;;; 0.008682379449557028 0.009113644152104864 … 0.3400096423600819 0.09299915630666353; 0.02152032283136042 0.010907543870312614 … 0.1588835929582638 0.031776417261048816;;; -3.1134064036792854e-5 -7.984754927540266e-5 … -0.11554836259763128 -0.04905253918031479; -8.546594030422987e-5 -4.8704183860026284e-5 … -0.028898971180623432 -0.12097621471798434;;; 1.2338547511899355e-5 -9.19293697729134e-5 … 0.558067174352141 -0.04250186273252344; 1.2339758653210398e-5 -3.5719187004026817e-6 … -0.04181165241674692 -0.3927318278613971;;; 1.758746509391566e-9 -1.4944908719251892e-8 … 0.14144224663333171 -0.023167980607594344; 1.7231955180934034e-9 -7.064182582993905e-10 … -0.07691769952046205 -0.22931705644162087;;; 6.213532632702233e-13 -6.305051132457577e-11 … -0.47352285208343725 0.07665368677994848; 5.5574386529978826e-11 1.8925550780279433e-11 … 4.0464364916228905e-6 0.563597216348628;;; 5.134726730540271e-11 1.2092229085483116e-10 … -0.5124039163795008 0.023681573543710033; -9.368474898034205e-11 -2.321668552375695e-11 … -3.916089972744027e-5 -0.6479043923966191], [-0.655223830377329 -0.6295649451786012 … 0.09869043396012793 0.03226417088734069; -0.754610231401123 0.5456538466339917 … -0.09497281780087895 -0.018488563106590535;;; 0.012561531946096877 0.5074332419766238 … 0.12554083346221387 0.10916641006554584; -0.03197184137566179 0.21964478514808594 … 0.21933226927199553 -0.0854795765701102;;; -0.0025802788137860005 0.008060518333564604 … -0.03615801230762123 -0.41701010243406805; -0.007638377459068851 0.010564397044232746 … 0.20822967721278937 -0.25367476215339596;;; -5.372822843431379e-5 0.0007135401818313161 … 0.019708256126219126 -0.24035950707166437; -0.0003115359120878753 0.000562902594954921 … 0.28391132335778047 -0.21419661700687156;;; 0.00012027234040197994 0.00035607386160743947 … -0.004729190247617689 0.2899587133182717; 0.00015162081834926215 -3.9011539360047296e-5 … 0.12949851509706947 -0.2890092894455516;;; 2.3560658873536077e-8 7.824544206598483e-8 … 0.3887581048059803 0.23705235294461616; 2.724077497254056e-8 -2.2089445020780003e-9 … 0.2574295794422757 -0.432560069648947;;; 1.2525485954315325e-11 1.52610473259092e-10 … 0.425972427396247 0.01670413442699659; 1.6206472197777673e-11 -8.439367957325404e-11 … -0.22137948607845573 -0.1250444214042874;;; -8.191744030869416e-12 1.0862962054010032e-10 … -0.4845837638569742 -0.4010964587114686; -9.63595371597651e-13 -7.1185401956022856e-12 … 0.3037009526951404 -0.22314564307412704], [-0.6926559128820371 0.6213501459886587 … -0.055324160117699306 -0.04506804356096179; -0.721058911712283 -0.5958202012513123 … 0.05103292617229413 0.04658837726829615;;; -0.009011822329111128 0.4100952988849224 … 0.15342577980443087 0.02037280817214685; 0.014765783626276643 0.3011345023432178 … 0.015979900020271883 0.14864571825108475;;; 7.090221350455019e-5 0.004533459366504526 … -0.19933708640125058 0.08591974824287506; 0.0014575129764032894 0.005225869902371262 … -0.18639719520853867 0.1330282827478061;;; -5.552139542568128e-5 0.0026247457919508486 … -0.34977622638795564 0.26289316014705766; 0.0006692544455152581 0.002713958711275096 … -0.08596406344113967 0.31339409259853246;;; 6.569845320526506e-5 -0.00013666629056012123 … -0.6511611419907616 -0.23883055058245667; 7.880628246359676e-5 7.537634674001247e-5 … -0.12006193217364806 -0.18204042631519393;;; -4.990303210299578e-8 1.1957263286798338e-7 … 0.30154701212549545 0.19838615436719154; -5.5200566574637904e-8 -3.966029433117764e-8 … -0.14734671472521368 0.66126308173958;;; 1.4270074743796642e-10 -2.9159573436226534e-10 … 0.46395686867549357 0.02447365436713593; 1.6259170275209866e-10 1.5805989881794822e-10 … 0.001601991043810839 -0.2691269573931992;;; 1.2744902210789224e-11 -1.526543506917045e-11 … 0.0010148680700494408 0.06985536972135707; 7.507816880236027e-12 -1.5111818603808997e-12 … 0.0008401859712466924 -0.36900903207862573], [-0.7032506383981191 -0.6164878970758823 … 0.04883510879705871 -0.10684910219911427; -0.7109200616304959 0.6093858942830661 … -0.047542415700085036 0.10659626551478976;;; 0.0032605148147165823 0.3682213999746412 … 0.16250827453767164 -0.14585455385730786; -0.00452525196904005 0.33615243440282894 … 0.0011226022781800696 -0.22774079138831727;;; 0.00010042929481514072 0.0014874578967479463 … -0.15983962758786432 0.0748905138629103; -0.00026038889750309746 0.001554118231311301 … -0.2911161917681663 -0.18340984146954523;;; -8.681006866444546e-5 -0.0008629423939391651 … 0.5489572894491005 0.10368254355513705; 0.00010492674204999387 -0.0008202577827801891 … -0.025394837897879493 0.35327155874046257;;; 1.0685232816050862e-5 1.71038953378743e-5 … 0.6248514067304426 -0.3310841636532553; 1.2388165431414407e-5 -2.1309054433150674e-5 … 0.2879640716376561 0.4012784411946379;;; 9.458432583794975e-8 1.9054193675124643e-7 … 0.2303096180697833 -0.1679233458042176; 9.854419143643741e-8 -1.3500905381201642e-7 … -0.13424209410925272 -0.6366788584016306;;; -4.510192424994176e-10 -6.355915317767629e-10 … 0.11055384606404695 -0.0961926999516796; -5.081015730882126e-10 9.6091123808469e-10 … 0.00032235394515873984 0.12160993642306293;;; -3.9564345585968275e-11 -7.552175661199735e-11 … -1.9895047159023206e-5 -0.005843178831301948; -4.406926626013412e-11 4.624368065657786e-11 … 1.844327085633254e-7 -0.03173293298780933], [-0.7059227204893935 0.6181802982261813 … -0.02304643217829193 -0.17476728461008234; -0.70828731594266 -0.6159753308551789 … 0.022801202062927572 0.17441464304990986;;; 0.0008757005772549141 -0.3495916688991574 … -0.1041609159325247 -0.3022403363195201; -0.0011913666710334989 -0.3409001224712703 … 0.02318382193733932 -0.322121856837193;;; 3.430310448711025e-5 -0.00039408050506129416 … 0.18303178801667505 0.29246647551876326; -5.6459329185281934e-5 -0.0003352651501989768 … 0.34446946917663823 -0.5570224781837844;;; -1.2892349477800199e-5 9.216315671371791e-5 … -0.7612791883811338 -0.4170048858224719; 5.9143204872168995e-6 7.747260430805865e-5 … 0.5058222295027757 -0.41739724683427026], [-0.7067014614511538 0.6328100709207246 -0.06857360343658771 -0.308904709313135; -0.7075117797329229 -0.6320295691460064 0.06804477234320362 0.3087646583095727;;; 0.00017955084613237478 -0.31749785331824776 -0.824890878370312 -0.4677073012913665; -0.0003060775218830733 -0.3150954633198092 0.5569763088767227 -0.7684348681976155], [0.7069801293620204 -0.7072334103301829; 0.7072334103301829 0.7069801293620204;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^d, 2^d)
xes = collect(range(0,1,length=2^d))
yes = collect(range(0,1,length=2^d))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="a8dad364.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this example we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 8
h = 1/d^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,d)
xes = collect(range(0.0, 1.0, 2^d))

u₀ = qtt_sin(d,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.831385355447399e-6
Relative error for Crank-Nicolson: 4.831479822150195e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on [<a href="../resources/#QFT1">13</a>] we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an esample of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h1 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h1><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve Burgers equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using CairoMakie
import TensorTrainNumerics: dot, orthogonalize

orth2(x) = orthogonalize(orthogonalize(x; i=1); i=x.N)

d  = 6
L  = 1.0
T  = 1.0
Nt = 1000
ν  = 0.01

N  = 2^d
dx = L / N
dt = T / Nt

Dx   = 1/dx * ∇(d)
Dxx  = 1/dx^2 * Δ_DN(d)

u₀ = qtt_sin(d, λ = π/2)
x0 = orth2(u₀)
v  = u₀
v_ref = Ref(u₀)

&quot;&quot;&quot;
    residual: (u - v)/dt + 1/2*∂x(u²) + ν uₓₓ
&quot;&quot;&quot;
function burgers_residual(u)
    t1  = (u - v_ref[]) * (1/dt)
    nl  = 0.5 * orth2(Dx * (u ⊕ u))
    lin = Dxx * u
    R   = t1 + nl + ν * lin
    return orth2(R)
end

&quot;&quot;&quot;
    gradient of J = 1/2 ∫∫ |R|² dx dt
&quot;&quot;&quot;
function burgers_cost_grad(u)
    R = burgers_residual(u)
    J = 0.5 * dx * dt * dot(R, R)

    g  = (1/dt) * R
    g += ν * (Dxx * R)

    Dxu = orth2(Dx * u)
    g  += orth2(Dxu ⊕ R)
    g  += orth2(Dx * orth2(u ⊕ R))

    g = (dx * dt) * g
    return J, orth2(g)
end

solver = GradientDescent(verbosity=2, gradtol=1e-6)

v_ref[] = x0
for _ in 1:150
    x, _, _, _, _ = optimize(burgers_cost_grad, v_ref[], solver)
    v_ref[] = orth2(x)
end

vals_init  = qtt_to_function(x0)
vals_final = qtt_to_function(v_ref[])
xes = (1:N) ./ N

fig = Figure()
ax = Axis(fig[1,1], xlabel=&quot;x&quot;, ylabel=&quot;u(x)&quot;, title=&quot;Variational Burgers&quot;)
lines!(ax, xes, vals_init,  label=&quot;initial&quot;, linewidth=2)
lines!(ax, xes, vals_final, label=&quot;final&quot;,   linewidth=2)
axislegend(ax)
fig</code></pre><img src="2effeaa2.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Quantics tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Tuesday 4 November 2025 09:36">Tuesday 4 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
