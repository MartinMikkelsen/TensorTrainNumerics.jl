<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics</title><meta name="title" content="Examples · TensorTrainNumerics"/><meta property="og:title" content="Examples · TensorTrainNumerics"/><meta property="twitter:title" content="Examples · TensorTrainNumerics"/><meta name="description" content="Documentation for TensorTrainNumerics."/><meta property="og:description" content="Documentation for TensorTrainNumerics."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in <a href="https://arxiv.org/pdf/2505.17046">this paper</a> where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^cores)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, cores)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(cores) + id_tto(cores) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(cores) ⊗ qtt_basis_vector(cores, 1) + qtt_sin(cores) ⊗ qtt_basis_vector(cores, 2^cores)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-0.2810577902072527; 0.07130409344577264;;; -2.2435382467799294; -0.09648461723822116;;; -1.1435991024329544; -0.47952429276972647;;; 0.08178971726525976; -0.5248005334859415], [0.8245578964368871 -0.28513599161292286 -1.5620746587731282 -0.6389787251246173; 0.19005141085319768 0.3483563025488084 -0.5772285073125359 0.4916296799318658;;; -1.8020000834220358 -0.6733211175621333 -1.8318079080900098 -0.5600998378651687; -0.8543082694042343 1.0046354959409058 -1.359719491199781 -1.154174675987428;;; 0.6668253165976927 -1.203621891841626 0.015812153819349598 0.923535395795521; -1.5922592720543645 -0.5449334758019925 0.13844573925899847 1.0984379503631478;;; 0.30394855239704427 0.5007157823528706 1.3288466968760393 -0.3682885092564199; 1.4143405718112936 0.7441129699758516 0.18244458162156227 -0.3784236437540576], [-1.962986708915992 0.04134172282958985 0.7346935350459247 0.5175767629536162; -1.2940598397320153 -0.800854444873976 0.812600724745068 -1.450189783662431;;; -0.5938841159669426 -1.686396451629058 -1.6820061534910589 -0.7830928006131662; -0.14644724249337537 1.47322622511546 -1.5160915541001185 -1.6222313158520774;;; 0.04585582282920587 -0.9275888311363341 -1.7702945231195784 -1.067290607470184; 0.9166702358964444 0.16649464369126885 -1.3062511904777059 -0.8351540683098415;;; 1.78594664941204 0.9607090045855756 0.6944598121450224 -0.14559392698749565; 1.9150200722809838 0.3147372857025534 -0.9031440055916728 -0.8959656598022439], [2.883204675766364 0.7681180703038433 0.7593476017508441 1.3526086306703362; 0.2853967236558336 -1.93119078183608 -1.5933285482821273 0.15111305150920096;;; -0.11516806702549316 1.7377304487062146 -1.170829580008501 -0.5564597868882663; -0.4160166463571727 0.9185364037476639 0.8595160740892687 -0.9281610526201409;;; 0.8799909291901145 0.4869251714190076 0.02639835751688854 -1.2037143060896167; 0.9638355102613541 -0.24294183444674025 0.11780236633806358 -0.7912091383513945;;; -1.259570303863465 -0.08810597137590762 -0.5911364156725942 -1.0320141451833402; 1.1257064983312919 -1.4187109354881835 -0.6731312802370127 -1.1068775306585372], [-0.7509288932142897 2.513458079046855 -0.1583381967100772 -1.8837361055546313; -1.440825591085888 -0.7384832214566875 0.19903290267754134 0.07409784926783046;;; 1.1112197339574772 -1.7276131594337742 -1.2607461316698858 0.31350418401938385; -0.5437806830612403 -0.9055263038784522 0.24370839646869794 0.8603079765267196;;; -0.30609348693041516 0.6824998479970298 0.49566470984031397 -0.6334814597104145; -2.0000042979035597 0.4687356005282976 1.2724533871236376 -1.3113120994984808;;; -0.7178552886274465 -0.4793565073315225 -0.5054764335260381 0.957715023264451; -1.7347235374279828 3.5048311637022667 0.3038341097377149 0.029967483724255412], [-0.7284039610479914 0.6316700596789808 0.778858966877906 0.18734739810346487; -0.8457574680177113 1.793983173644064 -0.4692342503885133 -1.7697663683963278;;; 0.6970407221790222 0.4208247234106915 1.492000616478383 -2.088761361476098; -0.4424443385197382 0.8898228183079517 1.22289534444094 0.3086043665329052;;; 0.22327702656914705 1.3134763342925428 0.12530413661385448 -1.1074559383321119; 0.25398012443368617 0.3221248702936833 0.8551786129328739 0.33134147542827247;;; 1.2494695773448272 -0.2481873337604349 0.6993897550072828 -0.6466916193496338; -0.013055961652366138 0.034165893515572025 -0.3135584019187793 0.3362392081842894], [-0.44935794552642616 0.5739465309821054 -1.0363811169327937 0.22512985442091832; -1.1794321280141904 3.215845207569231 1.3205347699843988 0.7913131410130405;;; -1.016541996502033 -1.6107117637411406 -0.9246043891459232 -0.7494925148163497; -1.4508020682551734 -0.46688376875712223 -1.3628075160417603 -0.015224009499408693;;; 0.13512194039237213 -0.04496665573697675 2.021663538927333 0.6972790137620234; 1.202644681321244 -0.9912332561464487 2.027005724149745 0.7475092677000977;;; -0.2023600734407921 -1.0230516012801494 0.6643652119073324 0.20843354081580032; 1.8494495031156555 -2.116865568473839 0.03740951154843455 -1.2092707538239604], [0.5507659828338688 0.4516506492836338 -0.498325305946033 1.4159683592571588; -0.1779557196837327 -1.5791758407655647 1.3881683322239735 -0.04737649063689225;;; 1.9319802358782088 1.5170320185056172 -0.462595924106219 -1.8208781986298985; -0.3515989406065223 -0.9932028589442478 -2.3425001084543493 0.2775888502338488;;; 0.01583885248514842 -1.8499230967317646 -1.31192148503543 0.757472110347204; -0.741944406386283 -0.11892355829117275 -1.0349012769687174 1.4557316401792895;;; 0.624794895626949 -1.6415403978963303 0.19774953338905904 -0.24090064266542177; -0.40342334271217667 0.2806642727910637 0.5987566722136753 -0.832720252823768], [0.9990061661198061 -0.5172524881335364 1.1388140008785181 0.2986830324264086; 0.36721425556460896 1.4799146522622744 -0.4541635415466699 2.1962013852911864;;; -1.4139833339245198 -0.5589240280258404 0.34290171334536285 -0.315850179333193; -1.2743582197812642 1.816137019785187 -0.7261614390967444 -0.05800977449466114;;; -1.202433414535324 -1.3911642763823064 0.007178632673190336 -0.1501086120506313; -0.4715963071425125 -0.2277433260899118 1.9743052406726027 1.7270923134102931;;; -0.4219115363968381 -0.8830504052458452 -2.1018814676014186 1.8472013718417024; 0.9278117234500441 -0.1881663033724865 -0.526524861018314 0.4074318229967158], [-1.6909317622418998 0.5758339042990204 -0.24503193791028535 2.616121641935578; -1.061083740770189 1.7781085259979648 -1.6646157178279344 -0.17147774965616924;;; 1.5921851956141093 1.2705054349633338 0.3445441773548726 0.04867716545683533; -0.22198291542924237 0.870334182309367 -0.2850262733669859 0.7852769368244972], [-0.16414286312634463 0.15645701123730876; -0.7892643811239594 -0.9088092065556093;;; 1.2206382365180681 -0.616502331569999; 1.1077061891100104 0.5056188440986756], [1.9977290039159294 -0.7614818015741566; -0.06761387073211578 -1.2370654342842728;;; -1.2626314386857114 0.5042915315402311; -1.6618575259329063 1.4155282616235263], [-0.14651219472035232 0.28491494335629014; -0.3406760164830093 1.2582119107282859;;; 0.05681840384233024 1.1440533224156295; -0.30090154428565796 -0.8207691787793635], [0.5732165061447487 -1.0325429553517924; 0.850547864809373 0.24660359408865953;;; -0.3304980635607949 -0.5388017618860538; -0.44447306534180164 -1.0146679315317806], [0.5140488014575285 0.40192026194625735; 0.8915362340513842 -1.049127457107088;;; -0.27325011229382373 0.25975681090670166; -2.2500127936944114 -0.2815917635481108], [0.27965207396375286 -2.062717352684793; 1.1299644046466202 -1.5081356470562721;;; -0.14503734769176266 1.7078511683307716; 0.8781136183748979 -0.23172716942407223], [0.056598490602849695 -0.23790409389719125; 0.17318678174413177 -1.2639242196802776;;; -0.2899513601700789 0.7661342446479946; 0.0957338944903233 -1.2719780817317456], [0.18227217567486712 0.9505128942837053; -1.0388049251114406 -0.5957280625922367;;; 1.8071936020865003 0.6486485015695801; 0.07818619590414488 -0.9580738470124018], [-1.752887657851138 -0.20396956611093583; -0.33933255225524894 0.8048870970286118;;; 0.37619833140497383 0.29750514208007606; 0.7867897070008578 -1.3133046705065312], [0.43934051972891736 -0.07806886054156943; 2.1143309298174016 1.3330506420123769;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolvee(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-191.58223218934353; -177.59462522445668;;; -102.35119089564277; 110.41251723830061], [-0.6917977338000492 0.5110358302026937; -0.7033469061376635 -0.49539154069416624;;; -0.11853664361435036 -0.49952122693863305; 0.11060488955750548 -0.4897110090521121;;; 0.011845475550363648 0.04314873837038504; 0.009557571723648607 -0.046146532924831174;;; 0.00991511642924575 -0.007910665632799197; -0.010231112365589563 -0.0061137839261353405], [-0.7045873201630899 0.34683689125010525 -0.08924840098566574 -0.11086226729039735; -0.7063739581400199 -0.3451770767440062 0.11638385252926575 0.10425765229865717;;; -0.04793435151317689 -0.6167666907894661 -0.3260963012035759 -0.05697690934739318; 0.04738998318765563 -0.6132445062690076 0.21141286732811782 -0.14125587986835605;;; 0.004275910724545471 0.04513159104948977 -0.4994735628481823 -0.521203913268626; 0.003068145838590252 -0.045239674148302884 -0.4790863696633895 0.5227397098249736;;; 0.003297640422516693 -0.0005530668027796068 -0.41605810769515367 -0.42662511335148134; -0.0032249759551741444 0.0006905314023577582 0.4179716174656744 -0.47374049889384356;;; 8.966342378974182e-5 0.0011454156875159484 0.018081023530153555 -0.030736907982905494; 0.00010145023590010216 -0.0011790553694687894 0.017692574271030246 0.023135292920860074;;; -0.0001375927062205575 4.257354642771551e-5 0.002070351731698543 -0.01963524291941043; 0.00013359833279405457 7.530643008439242e-5 -0.0029783390894545804 -0.020609713288600368;;; 1.0288005505669038e-6 1.0870753207418884e-5 4.156962409722402e-5 0.0005564747531177154; 7.177735804722324e-7 -1.1075194363529743e-5 3.340043040413585e-5 -0.0005593856239360221;;; 3.0008749071096807e-6 -1.7540651451030455e-6 2.9362352156937865e-5 -7.846265266522935e-5; -3.0458247612311867e-6 -1.2536693179988718e-6 -3.053068047011745e-5 -7.545475486278225e-5], [-0.7066309757039565 0.19657662457833938 … -0.04905773052340696 -0.00725017940700594; -0.7068508619005129 -0.19659783276791942 … 0.050759434749769565 0.006239772852702575;;; -0.022635789945419652 -0.6787263584289113 … -0.04148695999125186 0.006279140328509069; 0.022754306829081337 -0.6783748836327673 … 0.01373571505872084 -0.02186524748458356;;; 0.0013354266785333164 0.0303789506944595 … -0.06378127063408746 -0.1260729491405393; 0.0008601162885884343 -0.03012711883816569 … -0.09043259938060604 0.12653265210049283;;; … ;;; -2.211414706527944e-10 2.1001893114166817e-10 … 1.757367044719154e-5 -4.818491313892829e-5; 2.1285287932061426e-10 5.496441098086721e-10 … 3.1943302914320616e-5 -7.803155766573107e-6;;; -9.701550267638585e-11 -4.895061019428102e-11 … 1.876121733045779e-6 -1.0998255538544593e-5; 3.2195593156569055e-11 -2.793566855661588e-11 … -1.6037763017026578e-5 1.0703815879606399e-5;;; -1.3750558080438393e-10 -2.2243563680170957e-10 … 1.2881592365981911e-6 -1.8215178936420326e-6; 5.563344798895241e-12 4.5865798766888234e-10 … 1.2760255719206703e-5 1.0775196832590402e-5], [-0.7070010184021989 0.10171041952503053 … 0.0807361416972383 -0.16158577107204053; -0.7070303517961378 -0.1015788640156515 … -0.07820555193193912 0.16408937449689612;;; 0.01140672872022823 0.699592810754181 … 0.065416778298038 0.09597930058997062; -0.011281095381136178 0.6996073704745724 … -0.08815999040644856 -0.053752536950326724;;; 0.00036117421416233876 0.014960972272190964 … 0.08973180166052089 0.18986284857435642; 0.00020863968525254364 -0.014866271878878054 … 0.07949496583931448 -0.05619084938018593;;; … ;;; 5.924319547044647e-11 8.792896863631215e-10 … 0.2653289968478969 -0.048607661575319504; -1.646019721160094e-10 -8.670704618574778e-10 … 0.5092959228736855 0.2919164282210176;;; -1.0723634604070864e-10 -2.0040265320521286e-9 … -0.13183466029504565 0.09392011705151727; 4.2282798864848874e-11 -1.4218086415694309e-9 … -0.0894569796168195 -0.04756503524201078;;; 3.6305258680057905e-11 5.62815174299085e-11 … -0.00581888415992508 0.0822100729372819; 4.9152344331886364e-11 1.8390654449977163e-10 … 0.04704067177310993 -0.2522705989979218], [-0.7070758304559948 -0.051702348579500644 … 0.012725642066682474 0.11479858794292577; -0.7070906686118368 0.050382903304840757 … -0.012820919964487308 -0.11430109683297252;;; -0.006391036746512027 0.7051891621297142 … 0.006270386468493306 -0.02230247479583775; 0.005068876217946821 0.7052881616465515 … -0.0048693313408132936 0.03908537248720214;;; -1.174506526675684e-5 0.00017799596990268 … -0.008356294525194784 -0.10053638358552779; -6.616631404661027e-5 0.00023823745673975493 … -0.0157940588312526 0.04843709005567563;;; … ;;; -4.888855913034717e-11 6.445148437880819e-9 … -0.08306238638586026 -0.32370035858945084; 8.199630727241738e-11 6.5431815892541085e-9 … 0.13292850526555297 0.3769797387329738;;; 3.9102905135685135e-10 -2.899756041179498e-8 … 0.09637670636319041 -0.16009699004436695; -5.82671010588046e-11 -2.9345754273149323e-8 … 0.08055979603544912 -0.02286951366450275;;; 9.730611703350251e-11 -1.164365461645114e-8 … 0.01679382263321959 0.10882088454824766; -8.805329867745671e-11 -1.1807425443173504e-8 … -0.0481281587293258 -0.1533757715269854], [-0.7070975627405534 0.026153952792332468 … -0.0074338213288155834 -0.042305203898100344; -0.7071035846571994 -0.024835055197129346 … 0.007239944415866972 0.04209972871783745;;; 0.0035478633620057124 0.7066171235524102 … -0.023603172322787275 -0.02245176266986637; -0.002228389839832785 0.7066662378470958 … 0.023290869490644673 0.026032212978152478;;; -2.8170832093799377e-5 -0.0014840885981997557 … -0.13745989083048205 -0.05163126848040362; -4.555810567182225e-5 -0.0014967588850349743 … 0.06842388322291523 0.1121902841665385;;; … ;;; 1.8369896243072395e-8 -2.6467606182077864e-6 … 0.02752100503873327 -0.2663566447266344; 4.130463044646341e-8 -2.643836713316586e-6 … 0.23722186062627573 0.05237224693900025;;; 1.1111714398504424e-9 5.6143214270881134e-8 … 0.16675520970575788 0.06493989841644786; 6.676723221663889e-10 5.60125850385615e-8 … 0.1403598740456077 -0.49032233233944633;;; 1.0492571335957132e-10 6.603608058601054e-9 … -0.13472344625537497 -0.1697493321043804; 5.206246046639106e-11 6.595294752357053e-9 … 0.19526012593179287 -0.2922320919068806], [-0.7070999691315937 -0.014396374763161053 … 0.04057830157966886 -0.030759235186799922; -0.7071067899120194 0.011105707675480714 … -0.04028030006258255 0.030589626046637824;;; -0.003091910529557876 0.7068886246815124 … -0.0725340348177398 0.04080086594735509; -0.00019667130151766643 0.706947990973681 … 0.07397307251275882 -0.04219175783911686;;; 9.218272852402896e-5 -0.007598863492514979 … 0.02018181030405997 -0.0785358860730511; 7.574223273368354e-5 -0.007601327928341611 … -0.004191889382880014 0.02441524418799082;;; … ;;; 2.2645967694323382e-6 -0.00021318934866225675 … 0.14156634941058438 0.1467570789241341; 1.4107729021294995e-6 -0.00021307586911873883 … -0.22829193078599963 -0.1924362333092733;;; 6.312263145260398e-13 -1.881198327488191e-7 … 0.6674137757598777 0.13395547643753644; -7.681158333120909e-10 -1.878801434886129e-7 … -0.1712428022152807 -0.11546888905090316;;; -1.5134300990727508e-10 6.19148971730325e-8 … 0.3073762263370139 -0.2716574051663883; 1.0516970134172603e-10 6.183855038728362e-8 … 0.09850714925920787 0.0011213023737660017], [-0.7071028357145277 0.00807312394639992 … 0.044882390852266335 -0.015756280667527104; -0.7071061826712177 -0.004793291513215004 … -0.04486930190937588 0.01564688034691077;;; 0.002356609202015827 0.7067710794033609 … 0.00615472568098707 -0.054469684209723694; 0.0009177929528278735 0.7068014659468974 … -0.0069730867592480246 0.05476945936427202;;; -7.452525260321217e-5 -0.010684494845551966 … 0.0015450556036789795 -0.02100503532523468; -5.747476814995239e-5 -0.010679480276995343 … 0.002432141212901571 0.02142039022612229;;; … ;;; -4.1978428096639554e-7 -0.00012495860230078712 … -0.14175567050449103 -0.2821003986148509; -1.6569625490464045e-7 -0.0001247560911473974 … -0.4103496415307795 0.350926655228246;;; -1.0743232183768409e-8 1.0215591480911197e-5 … 0.3195597829172653 0.302117101884527; -3.163967497379473e-8 1.0185235581679617e-5 … -0.23069171940447497 -0.0009227741199796742;;; 3.5849545177815587e-9 -2.631521613881784e-7 … -0.07862566651412005 0.10256705176408433; 4.131954229374525e-9 -2.614063069286285e-7 … -0.013971425173706541 0.06105254360615036], [-0.7071028962678804 -0.005280119504109881 … -0.0007177829949356179 0.03445076685677731; -0.7071048864817221 0.0013003061530772555 … 0.0007180078492871601 -0.03445062570203673;;; -0.002320498543943473 0.7016945059014129 … -0.00013864192144759846 1.1187729749783013e-5; -0.0016185093394049982 0.7017127374877513 … 0.00011108756753697071 0.00034683425210022076;;; 8.512866078762215e-5 -0.022463714142616033 … 0.00047195840623593847 0.0009949549258676386; 6.387663382891014e-5 -0.022464709266944896 … -0.0003810990698134423 0.0009350620984031468;;; -5.4701323441957635e-5 0.014432877320531655 … 0.004498276897303111 0.00022487347246911114; -4.0600241714526864e-5 0.014433592071415962 … -0.004232962349035703 0.0014280514489706684;;; -1.1710667720161252e-5 0.0020380902544597035 … -0.22456655633533815 -0.554954566250355; -9.673245814769519e-6 0.0020372401530283015 … -0.24971380192675754 0.6006879085657677;;; -1.041467200900332e-5 0.0019342606165830664 … 0.7701701803704761 0.33774212200860565; -8.482992727461736e-6 0.001934016916942654 … 0.5057344583523405 -0.46289317385844436;;; 5.6801952722151706e-5 -0.017331344818844976 … -0.1861683446663131 0.00038630628695798455; 3.9555371213963014e-5 -0.017332424326383523 … -0.023353103926755735 0.02083562240854672;;; -0.0003095352431547015 0.08109086963316134 … -0.054445146044698814 -0.0005610594074970485; -0.0002287689881039682 0.08109415703224285 … -0.00869212880982168 0.006875448559170814], [0.17693989973280141 0.14448384140505013 … 0.007714700454957185 0.2497531620818952; 0.9837175896694288 -0.005267341244363332 … -0.007416958735916216 -0.026497896634651723;;; 0.02019156129994792 -0.9893159223291865 … -0.004011720244789184 0.05301936986067507; 0.00820817586713804 1.3853260012855294e-5 … -0.1124301629594132 -0.12195208308458008;;; 0.022352376889413977 -0.01823459487139072 … 0.29321056657162814 -0.8355886991465591; -0.004156131712495261 2.2992113492962633e-5 … -0.09036079390401078 -0.11627142154229042;;; -1.155723859201373e-5 -0.0015931735627706253 … -0.04540925305746697 0.13862544402242583; 2.447392246957902e-6 1.0829025292278853e-7 … 0.023537550552166872 0.0012758742053116696;;; 6.979692350706958e-7 0.003914727715126698 … 0.03593027322517298 0.32521268105166684; -5.929302553347169e-6 -7.648853956476194e-7 … -0.8112184462120539 -0.19288141891132188;;; 2.5752026231990665e-7 0.0005267419433115297 … 0.03743388598106661 -0.13820641077074422; 3.9404221761977056e-8 -2.364285636228394e-8 … 0.02612795907967867 0.006435810595805198;;; 5.610203153613695e-8 0.00017960740393421152 … -0.02117010611688186 0.06250663566868277; -1.5261372855032526e-7 -1.2362198799858568e-8 … -0.34263659852024775 -0.0955137950216103;;; 2.5806857491053582e-8 7.957861837998137e-5 … -0.024013357590999845 0.06203936930790574; -6.265126467369883e-8 -4.8875467892103785e-9 … -0.33256629301355806 -0.09645665845472313], [0.408904624016826 -0.2575063021050218 … 0.010975695221975902 0.01087920031011533; 0.9114626994564408 0.13101957547909426 … -0.0002687279189002802 -0.00020366498411969401;;; 0.015309798059901533 -0.9569404859484832 … -0.0022303910508574016 -0.002166431685160645; 0.018054453021592233 0.0012022441635611964 … -0.044132207403901044 -0.04578235334678653;;; -0.012687092287677297 -0.02774918879959289 … -0.04483475428595998 -0.045929894574116; -0.03621381504929216 -0.004221175800982896 … 0.10992976393533514 0.11006622954858603;;; -2.375887625610594e-6 -1.0269828565788411e-5 … -0.009768614058525863 -0.009982485838341257; -7.033487401683999e-6 -8.277769286669298e-7 … 0.011434703489311476 0.011059653497215775;;; -8.794108289637762e-10 -3.247275974654545e-6 … -0.010079510537173195 -0.010004777689558757; -8.815827001397669e-8 -1.3347606811591644e-8 … 0.008442837760732297 0.009128709897900114;;; -9.661890835259764e-8 -1.5192979452359884e-5 … 0.000147378656793486 0.000185893902477681; -6.177626730515884e-7 -9.209274700268585e-8 … -0.3934299638045655 -0.1152153997308347;;; -2.6121933200540347e-8 -5.222267637234955e-6 … 2.9283419870884714e-5 9.819790731698743e-5; -1.9658628504691306e-7 -2.9678649610290588e-8 … 0.9102997434619218 -0.06872781031295654;;; -9.063128096682144e-10 3.764087909669431e-7 … 1.0686718317305882e-6 -2.4657947713323123e-5; 7.967680371078344e-9 1.349916733325055e-9 … -0.0005376639203527515 -0.9824221160893082], [-0.5243475536643588 -0.42159220888777477 … -0.0688342402503402 0.024012499709740624; -0.8500908923550567 0.28148550838924985 … 0.02792229013498121 -0.010778130587657773;;; 0.021506226630541168 0.8616245409009213 … -0.03884643886427149 0.01259664041472602; 0.01771894128739378 0.015016254711666129 … -0.1951309830570213 0.09990772507129314;;; -0.014976510836508677 0.01852166389971801 … -0.13959593780935073 0.07078984958363531; -0.03747455812726322 0.007779970614137763 … 0.27096278582404587 -0.06532327433899728;;; -9.25376905907576e-6 1.826025663135017e-5 … -0.05200125101202745 0.024634881316059277; -2.3820454241184494e-5 5.158627391764571e-6 … 0.023163598482224837 0.008675005469044806;;; 3.7159783827394015e-7 1.1927907304096123e-5 … -0.0063062030689316215 0.002239234989496547; -1.2962571111853107e-8 1.291614885753946e-7 … -0.6673607229983337 0.15491664707112676;;; -3.185260695307543e-7 -1.0217605212780928e-5 … 0.00940441786159793 -0.004356510410698853; 1.1344399449412432e-8 -1.0982242562507599e-7 … -0.6404859240428036 -0.23987877413943248;;; 1.98859574224716e-8 6.209703156480301e-7 … -0.05482635927820612 0.024954028417686402; 3.0067272750111996e-11 6.546829261378654e-9 … -0.004397019804268668 -0.06424521640725296;;; 1.3301625916444993e-8 4.2065415193972744e-7 … 2.5855303847333364e-5 0.00014799331002441919; -2.564393229016794e-10 4.180579918149734e-9 … -0.0015742528499354401 -0.9449292970175498], [0.5903569107377089 -0.586081050424096 … 0.05291604312031274 -0.03552707669535361; 0.8063847400638016 0.43532323206082696 … -0.03203554637498024 0.03213075432634829;;; 0.011550893559837383 -0.6755575314851954 … -0.07289067941083664 0.02873226795252411; -0.024057033311012038 -0.10209094697776469 … 0.009814505547655516 0.13601131940215694;;; 0.00844009485472457 0.00903156214251789 … -0.22712297720575855 -0.09920098624975265; 0.02095127021833128 0.010979678121950345 … -0.11460170160673658 -0.05513153465591451;;; -4.018965740692604e-5 -9.70846372052359e-5 … 0.0787742890998019 0.0525133697886501; -0.00010952828125798507 -6.394717899960504e-5 … 0.020596247858530665 0.06541394532813843;;; 1.412959768623556e-5 -0.00010091922528296596 … -0.37308383281167506 0.011450889334114204; 1.4369748883199413e-5 -3.867477128014186e-6 … 0.02569353963899777 0.38302756325377685;;; -7.68268064869676e-9 6.227169863621896e-8 … 0.11844663047802745 -0.007742268943117609; -6.302557148929489e-9 3.6629151421352272e-9 … -0.059596178822417106 -0.23459611361219176;;; -3.674264905724164e-10 3.715791609462552e-9 … 0.8729165094259937 -0.056474791698544274; -4.7125945871124326e-11 3.4563483767980075e-10 … 5.2081518671014605e-6 0.1329360927917639;;; -2.580964632061984e-10 2.8218189489856364e-9 … -6.409044123249561e-5 -0.000352185891292753; -3.647727545924698e-11 3.3403719273073694e-10 … -4.4572328840689384e-7 0.857709631493236], [-0.6570159661071447 -0.6295475556309638 … -0.052075716673518395 0.03488834314770043; -0.7530670008042706 0.5482091947360661 … 0.0412318696086663 -0.037074583781225905;;; 0.012650276468580053 0.5032121383642237 … -0.11465922462439966 0.023301615766740537; -0.03162841045211055 0.22302170239866229 … -0.006750214337111387 0.1250049279554804;;; 0.0024343329273616397 -0.008032443598767376 … -0.27142945783269595 -0.13181052732079823; 0.007320027599379297 -0.010464111221743792 … -0.16029878845369383 -0.13644981625098598;;; 8.39160867130244e-5 -0.0008560778374469427 … -0.14370418511713248 -0.10573324327899897; 0.00041535578179756387 -0.0007354253674747894 … -0.03041896607967584 -0.17148667720196034;;; 0.00012169031670836511 0.0003531968530626527 … -0.5335772774595671 -0.0055183926250446285; 0.00015357659944294357 -4.273688275607383e-5 … -0.022648212593179777 0.40335894062216854;;; 1.7894600785201355e-9 5.963020066815178e-9 … -0.2150038097013263 0.047440514319278516; 2.098578067688757e-9 -1.5030148014813816e-10 … 0.1010814540761958 0.44999549948897044;;; -3.996112309217421e-11 1.2029212659130128e-10 … -0.7209633256150556 0.13915507003479027; -9.703104999411513e-12 -6.330319872672275e-11 … -0.00011701430134788172 -0.24627561500085565;;; -4.250338093491003e-11 4.831246986862602e-11 … 9.656367016071283e-5 0.008163609930446302; 2.1607237754619936e-12 -6.851617738345556e-11 … -1.3991645649543131e-6 -0.676092758869698], [-0.6932822682796174 0.6210552473827579 … -0.05667664620770897 0.07774517153910389; -0.7204686745213672 -0.5965905691776953 … 0.05244138427437066 -0.07822691154717078;;; -0.00881856529870516 0.4081003482212403 … 0.1578078713298331 -0.08198096132637227; 0.014300150775635755 0.3029280657657002 … 0.016627275395656185 -0.19566873770650395;;; -5.162545718436754e-5 -0.004307395796068305 … 0.18645065758706877 0.017577667875719884; -0.001354616196588727 -0.004958052965258971 … 0.19104105465564666 0.10939640487953811;;; 6.41233960718803e-5 -0.002741350195721808 … 0.37355738601417054 0.17732203965118631; -0.000687664158465098 -0.0028447163802756657 … 0.08888702871016937 0.3903686464764682;;; 6.234398285482094e-5 -0.00012813320761555203 … -0.656798089788919 0.1532157343397411; 7.473634943167423e-5 7.376710847545296e-5 … -0.1354764548823055 0.14658671840001214;;; 1.211524272531041e-7 -2.8825035668741417e-7 … -0.30442431657824265 0.1036309983410785; 1.3369683915605153e-7 9.944592451756056e-8 … 0.15049548864672488 0.7272384978952163;;; -4.5448011635147915e-12 -5.5582487585324764e-12 … 0.430212141625353 -0.13437341988936308; 1.8812661786121725e-12 3.2948722062732045e-11 … -0.00010830917276639053 0.2674756998794975;;; -1.0847746647479884e-12 2.7476890884575004e-11 … -0.0028554982667143448 -0.0008777489166231036; -2.096598105438448e-13 -3.1446618268784653e-12 … -4.521002008021328e-5 -0.26933917581645894], [-0.7034059544865716 -0.6163753614886494 … 0.04911409062342133 0.09614050878328292; -0.7107680207029756 0.6095604760454961 … -0.047876890728934834 -0.09589793012679806;;; 0.0031490480527967303 0.3675606000201337 … 0.16246314192132857 0.1331158407822915; -0.004344969084713017 0.3367656566382203 … 0.0024455728280728096 0.2028842033785277;;; -9.887677533735256e-5 -0.0014414114347909826 … 0.1623557639089295 0.07139976496729485; 0.00025012407671854727 -0.0014895950068639604 … 0.29503705257322255 -0.19570464326484374;;; 8.326110963740907e-5 0.0008094674617084356 … -0.5526613003293943 0.08467880078372549; -9.581156569531079e-5 0.0007649676878150776 … 0.045943843316149056 0.25316486191882254;;; 9.82418743205552e-6 1.534174484735048e-5 … 0.6193272422818629 0.34205254357131076; 1.1459376021311991e-5 -2.0147627203164604e-5 … 0.294774747420167 -0.28673338407684973;;; -1.583703141178272e-7 -3.175751099071522e-7 … -0.22673686705321164 0.06603646702847174; -1.647475194346171e-7 2.279360889001442e-7 … 0.1281318833363871 -0.6891035516439393;;; 1.3640232833946602e-11 -3.0495379874187207e-13 … -0.09826983823238117 -0.26417901854455417; -5.684846981398429e-13 -2.1303230801773534e-11 … 0.00030402371191357404 0.09610507390846504;;; 3.202988827210544e-11 6.537808681051794e-11 … 0.0004855260604875445 -0.21351846363562813; 3.728284899224072e-11 -4.88939711205163e-11 … -0.0008304283640645265 0.07042877762766205], [-0.7059616073190506 0.6181436937929977 … 0.02286462189234316 0.1741460730374995; -0.7082486787961654 -0.6160162908907821 … -0.022629902867957605 -0.1738002981271764;;; 0.0008458913734712241 -0.3494392486554165 … 0.10302074309261453 0.3015271773331031; -0.0011393520664717098 -0.34104875319928124 … -0.022630967708575814 0.3206348506943903;;; -3.220015831240591e-5 0.0003871124163886697 … 0.18620764143952304 0.2963041298954925; 5.5770296840687653e-5 0.0003167467940494249 … 0.33735505357608525 -0.5505353979457811;;; 1.2095937624847062e-5 -8.570638933028783e-5 … -0.758154105346431 -0.4181764575666634; -5.114130029684273e-6 -7.13535323251278e-5 … 0.514354252434726 -0.42424561755991297], [-0.7067092414570358 0.6328027574246735 0.06550957708473835 0.30956616989769703; -0.7075040142794812 -0.6320366710382784 -0.06499968589084178 -0.30942326524578334;;; 0.00017185694986597728 -0.31746319160203496 0.8202921547400424 0.475749801171768; -0.00029712426595538896 -0.31513082781034085 -0.5644504557675627 0.7629470204834218], [-0.7069832554683998 0.7072302853295407; -0.7072302853295407 -0.7069832554683998;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^cores, 2^cores)
xes = collect(range(0,1,length=2^cores))
yes = collect(range(0,1,length=2^cores))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="81fe4c1b.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this exampl we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 8
h = 1/cores^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,cores)
xes = collect(range(0.0, 1.0, 2^cores))

u₀ = qtt_sin(cores,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="327b8c7f.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393110550548e-5
Relative error for implicit Euler: 4.831378113278502e-6
Relative error for Crank-Nicolson: 4.831450495242083e-6</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Wednesday 18 June 2025 11:24">Wednesday 18 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
