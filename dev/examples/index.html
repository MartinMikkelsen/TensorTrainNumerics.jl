<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics</title><meta name="title" content="Examples · TensorTrainNumerics"/><meta property="og:title" content="Examples · TensorTrainNumerics"/><meta property="twitter:title" content="Examples · TensorTrainNumerics"/><meta name="description" content="Documentation for TensorTrainNumerics."/><meta property="og:description" content="Documentation for TensorTrainNumerics."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in <a href="https://arxiv.org/pdf/2505.17046">this paper</a> where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^cores)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, cores)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(cores) + id_tto(cores) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(cores) ⊗ qtt_basis_vector(cores, 1) + qtt_sin(cores) ⊗ qtt_basis_vector(cores, 2^cores)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[0.6774694577694705; -1.0208062984010136;;; 0.7851091243733627; 0.1957355399752415;;; 0.6478999400615988; 0.8665323611727341;;; -1.5081918193153456; 0.4307068069225334], [1.9493674788520587 0.11949456260278404 -1.3519317245414184 0.6226578390491799; 0.6392038985389249 -0.8927525183547214 -0.6780169673166897 -0.37227014702703914;;; -0.8806074152351504 -1.079646467284732 -1.2032370339144716 1.0770594000396159; -0.4719833710833274 -2.145039701321304 -0.6042805665735418 0.8185849669161255;;; 0.20687249615136769 -0.7951035488990383 0.8900638774244894 1.0696636688591605; 0.4504222389982737 -1.9715316060110561 -0.04052966799505109 -0.25800956242788375;;; 0.8278994681258998 -0.7091610595792992 0.6976171961169335 -0.28480929300506097; 1.9056219310368614 0.7421065349044238 0.2185482806865327 -2.170276644350849], [0.7526512911544416 -1.2032357115301195 -1.023260489506247 0.2826857885869935; -0.08899438938230897 0.9960653261749339 0.9364393119202853 -0.051877174174976164;;; 0.18041706838309102 -1.0562390422884536 1.9884265180506144 0.4151432851084432; 1.0516297131302952 0.41458736189298157 -0.8271361307572822 -1.681052990823061;;; -0.03934164798019196 -2.111282269337197 0.8481625621888542 -1.3197286546297757; -2.280759975617169 1.018054749190202 -0.529514172932852 -0.16113333779206623;;; 2.1157560653925462 -0.050913575180849754 -0.769855546270309 -0.7522215230008215; 0.11955880067385108 -0.42672345288961666 1.14447467310299 0.14119066882842027], [2.3222895843011644 -0.8269231405087071 0.24396366306807588 -0.49645188003919505; 0.43655564076786596 -1.4455852339244886 1.501221598575132 -0.05234154239607911;;; 1.409058847151152 1.1566917966011514 0.5435428577940675 0.16365025155751461; -1.7455695291296867 -0.3589948007805201 0.21729151047709966 0.8236314369826772;;; -0.5313988820940944 0.6458383503948737 1.0154968953025842 0.5562697014238603; -0.6721999833806023 0.7414908188513739 0.8239945972159853 -0.00023617915097778438;;; 1.591696077818213 -2.973077177466938 -0.11028006572262262 -0.5275091571481738; -1.0828403918527871 -0.30640398687399645 -0.10968597561294112 0.6209264484815304], [-1.0357713671818527 -0.5538794261402276 1.3782775003161216 1.7321737740249534; -1.4916332477565286 1.3180774790245284 0.2611225299470548 -0.6460423539507236;;; -0.5734488780268416 -0.2681545537058101 -0.2014802374472203 0.6932355989733475; 1.6066218220704953 0.08783876341809277 -0.5485321306006209 0.4476113543878025;;; 0.6284316803013874 -1.5861891230080656 -0.44215472441997 1.2341340940464176; -0.567302416487389 0.002319305368064747 -0.3053121220455281 0.8786036783945238;;; 0.23782751428341878 0.707591617496228 1.9454084294255074 1.578003795872272; -0.04561592338035383 -0.13477618326792695 -0.8415894141283137 0.173064810320203], [-0.3521766826746829 -0.9253242264672944 1.4334459079591255 -0.9131452041166206; 1.2925008324033356 -1.479680885907187 -0.48732513343942174 -0.6201324658548875;;; 0.3163852793714523 1.1534782545662485 -1.2338021514433364 -0.511212876245558; 0.375933646743203 -0.7838182705397279 -1.13846556658686 -0.21109820591603812;;; -0.47239691668266254 1.3264160825741729 -0.12449192186270838 1.3424915228627203; 0.5805475452976344 0.35289139756184423 0.4469167396607079 -0.7595741495824745;;; 0.5573243022949775 -1.64245284872807 -1.1894973919699332 -0.4395536745680516; -0.38416211272058415 -0.16512225567335906 0.7872446808934233 -1.6251781231819211], [-0.0532140452096929 -0.9522302993385633 1.6807720932338912 -1.4149469907219456; -0.35635715199860246 -0.18127766975541176 0.3383592219507753 -0.4415493931512449;;; 0.4080073775775845 0.5194714517014337 -0.9602906565128151 -0.7566556254012201; 1.5349863251611644 -0.9452527902058505 -0.2804161510494987 -0.7631451723674253;;; 0.8810263041566714 -0.9870016977709056 -0.5897199773401772 0.1283826292578017; -0.2985514348234734 0.09287102189386277 0.3747267298020868 0.9100205001662934;;; -0.24903077177066102 -1.5045491782556444 0.8670292793908166 -0.3893775266645588; 0.7863303159340059 -0.5277241882101418 0.6565865571071449 -1.1880797402819572], [-0.32687017294083853 -0.8743809780827341 0.013003633782299087 -1.972359615840813; -1.438493849802756 -1.0174919821616806 0.35932963171868065 0.28138138400822016;;; -0.23840543305995726 -0.9510793590340272 2.217042939977811 0.868592313280431; -1.368519340038512 -1.2993826286934445 1.092154410040983 0.5645420334880711;;; 0.8402235808855539 -0.5321993747359353 -1.0016363673721178 0.9378087428582405; 0.1749340931571742 -0.8357108194182215 0.04376325469790308 0.1641053997884709;;; -1.0779500441533802 0.20897806345858888 -0.2264943729058995 0.33118883523300924; -2.3721612629975657 -0.3331625755330679 1.3981397021184545 1.0951994348888472], [-0.09680446210964375 -0.4329501268079456 -1.4663689193789688 -1.1845895385294596; 1.0247883791760348 0.966981121276414 -1.4777063075478405 -1.376300960247899;;; -0.08899641116658745 0.2999478641734198 -0.9304161812023028 0.9287265436432688; -1.0490526924703134 -0.5013779077481468 -0.38282133749391045 0.47574277772045404;;; -0.8425375950444594 2.0353381125913206 1.1274314743034266 -0.038864456229083875; 0.4469261458705461 -4.449928766903562 1.6813785007370137 0.42242765159260387;;; -1.018839162703785 -1.4639880619426477 -0.45460508451565196 1.3548131280914695; -0.7152506853344941 1.3577282983703098 -0.6553447674903842 -1.3039193009407624], [-0.4496607089033667 -2.3606690269513924 1.1214974151058914 1.1014798775045616; 1.0489059280385238 -0.28825639507045064 0.8563880695533207 -1.2235954505344846;;; -1.2942735652696005 1.592779415013713 0.8825129104704585 1.7589173574749153; 0.14115911613754226 -1.3747415410259796 0.010288656115435486 1.602454451174192], [0.9920032859662761 1.9327962908247112; -0.946384510797125 -2.1006698550667653;;; -1.298084596534493 -1.4224581029417018; -1.5479592291776005 0.47669626390923403], [-0.5982869404530888 -0.5278808634412797; 0.13646162962101308 0.18493833783043484;;; 0.08387361347316258 -0.8063567559895528; -1.3008599794733071 -1.1772669064016819], [-1.6575031584522046 -0.8716519106755908; 1.3571502788432002 0.25643611638290653;;; -0.952453319892902 -0.3018939308264229; -1.6104771976990397 -0.18577667224112274], [0.8785087002195162 -1.7265597859899047; -0.8895238736878912 0.97218219130631;;; 0.47766301920568216 0.7171241514717565; 2.214951627328695 0.500428545914202], [0.39756737553806115 -1.1807038991280037; -0.9575574807234865 -0.031820718894204104;;; -0.268171830523094 -1.1264320479679815; -1.0728481441572864 0.026613518022725224], [-1.562872787137106 1.4128413152476995; -0.9562936708228106 -0.828056407311371;;; -0.7052998185416648 1.375036902644841; 0.8859746801718318 0.17479801527733269], [0.3501188172438145 -3.309695208801917; 0.09698919226483518 -1.020328408561236;;; -0.3697572914309634 0.04432961958198331; -2.50276368885136 -0.11164111590340879], [0.8700593562044364 0.9921331901630293; 0.13923546510293194 0.5761280420341061;;; -1.774165201920825 -0.5120267743243541; 0.5504527201062778 0.38353069263063694], [-0.014133622201922534 0.10383169325323943; -1.0276105184132776 -0.12878023147498713;;; 0.4369386711996146 0.3907085180842292; -0.47909909867547185 0.48033117503494993], [-0.11304593724737885 0.46713687036355767; -0.6165897890703713 0.6330235850577469;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-194.02864661814323; -175.71904926233708;;; -106.78412568868183; 117.91083251733427], [-0.6905063360683827 0.48715949188301555; -0.7017697818156857 -0.470536354536087;;; -0.12623299719652706 -0.5209612851017287; 0.1170709510843863 -0.5105467320321041;;; 0.019432130477327576 0.06445362342475229; 0.014656383276698614 -0.06967805559647944;;; 0.015267926976686292 -0.01160204016166554; -0.015945819231210842 -0.008284565436262872], [-0.7038556156339256 0.31801599305983347 -0.058642356661877504 -0.1583386730762107; -0.7065073834153449 -0.31558026420482166 0.09824447253019203 0.14977144927065827;;; -0.052024038538368456 -0.6317956215476274 -0.3943598570619634 -0.08093136283461842; 0.051229546285488675 -0.6270378024361077 0.31668963205617906 -0.1705417625075297;;; 0.006498139970370997 0.058652809737224726 -0.4786065785414502 -0.5042234144443682; 0.004033145516225778 -0.058988310656786246 -0.44355801405170614 0.48951296713907133;;; 0.004796077850346478 0.0008724814987949678 -0.3837777096224056 -0.43345780170021975; -0.004696914492188079 0.0033136901468209545 0.39734515810980203 -0.48433678743496755;;; 8.38365999255478e-5 0.0007855636449959574 0.007616921944377863 -0.009772996026337594; 6.287601474099717e-5 -0.0008203717249382657 0.007537541309626112 0.008537834543959644;;; -0.00016781226672023516 6.570459971163682e-5 0.0015703078428432123 -0.013436025531632059; 0.0001671047196870564 5.305918940762448e-5 -0.0018182007598852104 -0.013493088741155332;;; -2.600523588260862e-7 -2.0724323314862904e-6 -3.0863078168134714e-6 -9.03878054478199e-5; -9.773090503430905e-8 2.1425116714730945e-6 -1.2412910417129636e-6 9.225679952408318e-5;;; -4.498044622140552e-7 2.650518264967796e-7 -3.0162850918509823e-6 1.0018728671338554e-5; 4.649186906933841e-7 1.549354627584359e-7 3.1360618313917325e-6 8.717793852205156e-6], [-0.7064525941393502 0.1748697311555203 … 0.4438231592869118 -0.0047782033132251845; -0.7068432392725262 -0.1750568256383699 … -0.44147514547963207 0.01301617809162533;;; -0.02523482664279278 -0.684655360942879 … 0.07567566004830102 -0.10734742553434243; 0.025576765848974312 -0.6843028435081719 … 0.14019615797857446 0.10627485764947694;;; 0.0017945054479270284 0.029647023162422265 … -0.1029211938363072 0.06512546054060865; 0.0006671830559883539 -0.0279914302046282 … 0.15564462787109823 -0.0601817503891388;;; … ;;; 2.518251163281994e-10 -6.304494586200514e-10 … -3.948257388495229e-5 -0.00019237398661924807; -2.2906102352039024e-10 -4.529761313001362e-10 … 0.00013540764006219794 -0.0003034553613966873;;; -1.6518619357505565e-10 2.0387075725189403e-10 … 8.807186327382558e-6 1.1123362075546478e-5; -1.5231919430036167e-10 3.74940881552915e-10 … -2.74548331463316e-6 0.00012326883687581265;;; 1.5320087875906014e-10 1.266880445503162e-10 … 1.1269266723805528e-5 9.208762678419081e-5; 2.0786840009968605e-10 -1.915359415590431e-10 … -2.7985306531250615e-5 9.922626268744418e-6], [-0.7069713703093552 0.08907765012669833 … -0.0030297858201745113 -0.014761998818427107; -0.7070073500721878 -0.08926107847219392 … 0.0019430116338944759 0.01701818425950511;;; 0.012782272910175398 0.7013469580030858 … -0.02968144911945227 0.056264474933174734; -0.012975845955270031 0.7013603427436419 … 0.030596948169219224 -0.05654734153885443;;; -0.0002613570143458874 -0.0020218438589432396 … -0.07617992871848621 -0.14304803441588537; 0.00018554980004101233 -0.001897227455984431 … 0.0970384483617129 0.28206540911904954;;; … ;;; -2.265513503020131e-11 5.370999580167614e-11 … 0.14333529245719873 0.09980573020805376; 3.0925430167305255e-11 2.447628070734832e-10 … -0.07606737949613994 0.5234563524601954;;; -1.550252677376916e-11 -5.288315792397505e-13 … -0.20240801005339723 -0.14387391409458952; -3.646054874422521e-11 4.1444599908854856e-11 … -0.17214648126393517 -0.25789691264825954;;; 8.977137239622327e-11 7.381151621977493e-11 … 0.28592159005187323 0.12093399905873504; 6.090848651340626e-11 -4.763799027377242e-11 … -0.2977070063257372 0.17596186516031995], [-0.7070735130931697 -0.0446662152812546 … -0.019682619758839552 -0.029195643410265787; -0.707080104307322 0.04451170267146247 … 0.018856597895271235 0.028423053539864147;;; -0.0065862631845576515 0.7056782230239104 … 0.0408878740332577 0.03785774506709446; 0.006432193987249236 0.7056949470415536 … -0.0421735514788767 -0.04368155963666765;;; -1.4830801540684723e-5 -0.0009564003899615763 … 0.26694400375712674 -0.06711845787362018; 9.823662986147534e-5 -0.0009300496342658624 … -0.21614960697940086 -0.04807939032990657;;; … ;;; 1.1707811012239234e-10 -1.9927332287076373e-11 … -0.19136585507202414 0.3049222712545295; 1.0713239621887045e-10 -1.3333984835931458e-10 … 0.21770566697359156 0.16572887224191454;;; -2.3118725927354593e-12 2.0518583170944727e-10 … 0.12990703630170752 -0.21501146152993578; -4.7277782467847535e-12 1.9943984056445034e-10 … -0.17150638717886885 -0.39476467171418983;;; 9.043216684410398e-12 -4.934760926367496e-12 … 0.08037411639324792 -0.0336121971266891; 1.575316055782162e-11 -3.031876265102754e-12 … 0.018092126989760437 -0.008704339487264212], [0.7070940418609398 -0.02318495043990995 … 0.05597922174895211 -0.05656573822054043; 0.7071031250728431 0.021382531586213577 … -0.05620880843240949 0.05698110458215607;;; -0.004172298063480755 -0.7066498628186473 … -0.024737967795264628 0.04813437553430789; 0.002376270466665873 -0.7067081259119612 … 0.02271499457843162 -0.04422047792195685;;; -0.00025919709915036204 -0.010045512741798202 … -0.07835285798955915 0.0779998685954203; -0.00023976141131067777 -0.010043574849905233 … -0.0256667227052714 -0.0978110444011951;;; … ;;; -1.8879951925454564e-9 -1.0367601613492266e-7 … 0.02484304148504535 -0.03304643367603363; -9.697078104854974e-10 -1.0364060870013708e-7 … 0.0003194295639563815 -0.11554459621684474;;; -1.1930883310382605e-11 -5.498859937735897e-10 … -0.07743126607060762 0.24861171764966747; -1.00350595680788e-11 -5.484395448996267e-10 … 0.20274182850259867 -0.16548264770041313;;; 2.4252980804111245e-11 4.078387931945287e-10 … -0.018555317948748543 0.2960650553664797; 1.8216645441100642e-11 3.855931900408154e-10 … 0.055883345568943574 -0.33797772465337333], [-0.7070969580190313 -0.013353655580239467 … 0.03437133226919333 0.09428378573452885; -0.7071065964391278 0.009210226310507098 … -0.0343298955989724 -0.09432275780739596;;; -0.0036820392456959586 0.7064405848929813 … -0.009784027756850257 0.010063811139998134; -0.00043000241799164766 0.7065066567911599 … 0.010583172255752645 -0.006871718936625535;;; 0.00044300776103130057 -0.024454701887877957 … 0.011572517819492001 0.0984845399314718; 0.0003568513442207689 -0.024464714766808345 … -0.01960225120915153 -0.08386163937130685;;; … ;;; -2.813067051283122e-7 1.688579412720552e-5 … -0.026522976231446015 0.2603306983957819; -2.0535198425385556e-7 1.685975718684178e-5 … 0.011914358474025236 -0.35081614158000807;;; -1.3921229744751858e-9 8.681887277432888e-8 … -0.060951004655315735 -0.44188941833278467; -1.0042974287120445e-9 8.680513044057573e-8 … 0.05332313313584622 -0.07141144405101196;;; -7.754287577127121e-11 4.1123629626672245e-9 … 0.0843627894333466 0.16426096489647615; -5.409446873345624e-11 4.11436184531475e-9 … 0.12494544484570166 -0.031700786318405734], [-0.7070908393858532 0.009775997829555605 … -0.049690337974949546 0.15737421664906884; -0.7070996505023932 -0.0019087678832856705 … 0.0496479113822474 -0.1573569877858036;;; 0.004651226721975143 0.7031956796797036 … -0.02002158989384585 0.006486727803970866; 0.0030775600696485677 0.7032598680861784 … 0.02094092323052958 -0.009450908345095876;;; 0.000471115425789694 0.03633225399597127 … -0.019174870395800278 -0.002932302649383799; 0.00039577944286702633 0.03634274813848998 … 0.016529430362150245 0.04532083775643715;;; … ;;; -1.3252261500678198e-6 -0.00011206899156729934 … -0.38667680628549694 -0.06656571066733967; -1.0779498089115336e-6 -0.00011204922060048209 … -0.24994928975738695 -0.07573007872480511;;; 2.6950185453028643e-7 2.2402832990256057e-5 … -0.21724170974359377 -0.07659100836457884; 2.1976571799427704e-7 2.2393149001780648e-5 … 0.2671848853691343 0.2817827025605973;;; -5.6631982013102714e-8 -4.276589279691832e-6 … 0.10878441517056762 -0.06185652003039757; -4.716336262609483e-8 -4.275889629182285e-6 … 0.002748524267049777 -0.13213562408018126], [-0.7070948822177254 -0.0069261646127221355 … 0.0015774190835782234 0.034446712330146304; -0.7070987450052069 -0.0005469648839540925 … -0.00157712073443609 -0.03444658222970529;;; -0.003987142066547734 0.6879962816613813 … -0.0003000308463704588 4.543172193121917e-5; -0.0032756687537375895 0.688026125381014 … 0.00025023893404834633 0.00033717764779079694;;; 0.00021660783675833816 -0.03627472177082565 … 0.0009697120309394243 0.002361170297737984; 0.00018010891283715553 -0.036282055386823435 … 0.00011714961607910377 -0.0007368586857817162;;; -0.00016781044503124214 0.02827450769883319 … -0.00828862212740576 -0.022344380467956133; -0.00013880611885696916 0.028280433670562453 … -0.011796705556563154 0.028057565867984108;;; -0.0005301109534878942 0.08973845263843984 … -0.27161242602125485 -0.43311196273551467; -0.00043750048805851657 0.08974847657021874 … -0.14565252666921352 0.5160632932025454;;; -0.0006802605161468778 0.11510283821608205 … 0.5131284430877309 0.3812492391649562; -0.000561498423751995 0.11511712009945088 … 0.3187447387449091 -0.5462661084696706;;; -0.0003229645821736678 0.05463026772074473 … -0.5906391223091466 -0.09956634659498932; -0.0002666016401194089 0.05463737748810416 … -0.39692400918670556 0.2950833776307721;;; 8.594725850572908e-5 -0.014547690405854106 … 0.15060111601874068 -0.009908016314994083; 7.093393656584194e-5 -0.014549381067876128 … 0.10399586589111443 -0.03979146145870936], [0.17724150069172123 0.1372381299613096 … 0.04388217752777566 0.25112582456681104; 0.9836785097539663 -0.004895823523139219 … 1.609346747472599e-5 -0.04974891120343455;;; 0.01969809898376283 -0.9905254462600516 … 0.005950871581276269 0.03501158858966336; 0.0075927623921400855 -6.866908717360404e-5 … 0.016280675758569237 0.06848692581958869;;; -0.02235116194325698 -0.00013569993419867044 … 0.3425518587328765 -0.16203441963139117; 0.0040987955962713965 0.00014033704987430077 … -0.09198446102519081 -0.09869872670196354;;; 1.2831837014975294e-5 0.00041761561897456944 … -0.055587437505120435 0.018012420286962157; -2.4223392616755677e-6 -1.7363643109962703e-5 … 0.008138499232256966 -0.1520240340685174;;; -1.344349195133118e-7 -0.0007057720296814025 … -0.04536557534803392 -0.14396693622296913; 4.35377564893726e-7 0.0002451449558931389 … -0.2770112026663789 -0.4438599179157481;;; 1.1891202274832825e-8 -0.0004835037812185083 … -0.11117295510975908 -0.12709316393820438; 3.9937084773143456e-7 0.00023442570343629063 … -0.27712611648090146 -0.45990335481407063;;; 1.515363303143368e-8 4.6337935718572084e-5 … 0.032474480763137845 0.0934001196068491; -1.4622379571787505e-8 -9.476519233536996e-7 … -0.14413344962080668 0.3135078540722432;;; 5.700717572120583e-9 1.7021824044465966e-5 … 0.08993463027049406 0.4833688254962123; -4.89560792873642e-9 -7.074734698818503e-8 … -0.8191128935963791 0.28819125211078833], [-0.40878347975772944 0.2501035680048864 … -0.012353655983235621 -0.010750444070946242; -0.9114470650442392 -0.1278368143374291 … 0.00011646789246795506 -5.775661485746658e-6;;; 0.015418718658650465 -0.959394474036211 … -0.0025222080619929092 -0.0021400575198669185; 0.019612826664036763 0.0014060230612027587 … -0.048211074421379334 -0.04423262606356742;;; 0.013054024705264716 0.025449362823031483 … 0.04979844111831334 0.04533715396150103; 0.03697981514017446 0.004179833562501088 … -0.12464517173106507 -0.11063090945468097;;; -1.419510437953644e-6 0.0003230546643487732 … 0.011257359079483432 0.01021575889203028; 6.119551699387374e-6 7.189232920517959e-7 … -0.013492339083167985 -0.011528151013520664;;; -3.934752461432008e-6 0.00036099229063329545 … 0.00032723577722373496 0.000270787285591333; 1.5603547498221412e-7 4.5657209590297334e-8 … 0.9451875377297183 -0.009318275753633008;;; -2.433346123338485e-6 0.00022148952421662308 … 0.012256883434826268 0.011069933520531188; 5.9145105989080023e-8 2.3199926188931105e-8 … -0.04558023296158608 -0.00802528971861258;;; -9.730127425189507e-6 0.0008916697633696291 … -0.0002663381056974215 -0.0002454013696982253; 3.609096927101127e-7 1.0905911787019369e-7 … -0.28739859017938996 0.14299060320299337;;; -2.624868462085694e-7 2.386733827904202e-5 … 2.7832521661667867e-6 1.8174737565870672e-5; 5.229387272502592e-9 2.311182252521411e-9 … -0.03140432288113966 -0.9811580819440469], [-0.523013381750489 0.4090353363771065 … -0.15777812974528965 -0.024980867466985402; -0.8507363148588766 -0.27375437268035613 … 0.05835030446842678 0.010388171616634252;;; -0.022160583369089857 0.870145321033568 … 0.08739208472085318 0.012566527683572129; -0.021505080691320896 0.012627836173750961 … 0.3653721545344519 0.10183538616806126;;; -0.015545994584516706 -0.01951567205353463 … -0.25856386762637606 -0.07124156801208543; -0.038852113281897124 -0.0074453660288132184 … 0.6976151613340911 0.07379625228906841;;; -8.118037528854245e-6 -1.1075941949165689e-5 … -0.10292810804937907 -0.025434748114412684; -2.0480795396711423e-5 -4.050899280528477e-6 … 0.09656447554268753 -0.006836270207934155;;; 8.076419608087942e-9 -2.5144358808117125e-7 … -0.01816535136881689 -0.0028852434925255646; 1.5871922802949188e-9 -1.5283025691730248e-9 … -0.05643865319773567 -0.12987579803952606;;; 7.20233168507671e-9 -2.3274472771222048e-7 … -0.03048791528122007 -0.0054803627799895034; 9.183988266447858e-10 -1.4115033694787582e-9 … 0.4824978676059132 -0.2613174763605396;;; 1.4072259987828193e-10 -4.944946954040356e-9 … -0.14098126107469738 -0.02831605009356205; -1.031906097349918e-11 -7.79308353657607e-11 … 1.3683354443201885e-5 0.06397287121496924;;; -4.4151313907371313e-11 2.5999891819327657e-9 … 0.001131274148453199 0.0002447573784508407; 8.77691753046223e-12 -1.4788869868640444e-11 … 0.00018139111394069877 -0.9420390000237194], [-0.586699428174333 -0.5783867661536473 … -0.05732601472362195 -0.040375646325439954; -0.8090960834702923 0.4266247395599233 … 0.03489700937370294 0.037090069429058244;;; 0.011807740550174126 0.6887579464432367 … -0.0752048775754072 -0.03037989013035874; -0.02091049387385467 0.0941848914118139 … 0.005222906697661558 -0.17103357890049822;;; 0.008949671620177638 -0.009203395434746733 … -0.2362790783819562 0.12748105533718068; 0.022147921061747965 -0.010819418265088645 … -0.10283824295367563 0.08851152204601868;;; 3.477076258511514e-5 -7.950067591852377e-5 … -0.08409055601928567 0.06748549315510395; 9.354969115375618e-5 -5.064327371782146e-5 … -0.01731236950809107 0.04622240108874316;;; -1.0393293784111691e-5 -8.112017526231875e-5 … 0.41089540852972156 0.039646652627546804; -1.019604493453973e-5 -3.17585615036513e-6 … -0.019119944151623672 0.4054906538255311;;; -6.663177863446723e-9 -5.78280154191056e-8 … 0.14527940622834315 -0.027449279345684727; -5.687041448659201e-9 -3.0407282211570305e-9 … -0.05352827951104099 0.2791878425961845;;; 2.1860024579059432e-11 1.587893559424009e-10 … 0.20164053776131954 -0.012219773170319737; -3.4141093503816035e-11 -4.915134885157751e-13 … 0.001911612098540539 -0.8278425838168426;;; 3.724305814675149e-11 5.026785538073346e-11 … -0.8259562464858736 -0.06677610339648313; 1.0765509338660778e-10 -7.506203098894465e-11 … 0.0003925908421753511 -0.037638327910414514], [0.6532284610816333 -0.6295256430929882 … 0.026590680469811428 0.06207532975337188; 0.7563217148005645 0.5427839516602513 … -0.029623317296318705 -0.05067588072255646;;; -0.012451289926088342 0.5121447443131667 … 0.011026196459714732 0.12204636500608955; 0.032303692333397256 0.2158969382143809 … 0.11322955626030522 0.03448966442065889;;; -0.002743531047390191 -0.008058298227292596 … -0.14308569019041079 0.2551551756303972; -0.007987560728770144 -0.01064906766742989 … -0.13759608654908617 0.12636095664611818;;; -6.341070382088989e-5 -0.0007265599237304445 … -0.10583803365961172 0.12602423872151347; -0.00033435411702454677 -0.0005762065845091399 … -0.16201675196629742 0.05964417672869009;;; 0.00011488783269202986 -0.0003456823396189525 … 0.14375339285469135 -0.48003883422299093; 0.00014523445362321215 3.5190144448956614e-5 … -0.3750440639143257 -0.16644215229241002;;; 3.668425739481832e-8 -1.2521435979120038e-7 … 0.03594020104883033 -0.3188700201572712; 4.240281426103837e-8 2.1797424679644522e-9 … -0.4809944528674951 -0.023972836197387243;;; -5.898995568594415e-11 -2.053394594896325e-10 … 0.02901523786584673 -0.3919945357419067; -2.0468487215440244e-11 -3.1806754066060533e-10 … 0.6858020858612157 0.12384019282593381;;; -3.082240645704087e-11 1.8858778217263737e-11 … 0.02313092508605049 -0.5851186948944808; -3.893521177763661e-11 -5.3686702330655963e-11 … -0.207228608152994 -0.07231811135139407], [-0.6919372419350434 0.621676270445738 … -0.025710259521217874 0.09525128681786015; -0.7217350430306727 -0.594934102775818 … 0.029009334286608943 -0.0915280290694036;;; -0.009224059767344979 0.41236792222967805 … -0.03381826203839029 -0.18572484909432382; 0.015276701593731375 0.2990965513755939 … 0.1449388689661758 -0.128604625972661;;; -9.84594799556436e-5 -0.004751872677692073 … -0.15358445486277567 -0.1706505312383941; -0.001571241594153275 -0.005488361553274146 … -0.24396374260915069 -0.09810283918491426;;; 4.923327481307027e-5 -0.0025395128722491586 … -0.3654263785395876 -0.21932076830950706; -0.0006547673728731974 -0.002608204364632188 … -0.33442355556882425 0.17449234117464565;;; -6.480062775551102e-5 0.00013420481237345856 … -0.26855724042136375 -0.609211678167629; -7.846569763899906e-5 -7.427699729416835e-5 … -0.05460508550652684 -0.19104085299980877;;; 1.1877311961975991e-7 -2.8799639509424823e-7 … 0.09746437157904587 0.31485666080979585; 1.314446423169928e-7 9.002672611104867e-8 … -0.6668657410809077 0.33153475461720633;;; -1.6354460152607312e-12 1.6805743407156198e-11 … 0.11404465991568898 0.36936635457389966; 4.227681385736664e-12 1.5042570307953824e-11 … 0.2269729640906796 -0.17616126329834628;;; 1.7341852028337726e-13 1.03681107821559e-11 … -0.002432521125765878 -0.007514420812504163; 1.7570002925322765e-12 8.399934664345757e-12 … 0.23242566600286338 -0.1732505343386821], [-0.7030657898996976 -0.6166183790296772 … -0.04927955620663669 0.10932869047126684; -0.7111009368832153 0.6091748721008083 … 0.047922924476085246 -0.1089800212755827;;; -0.0033849463491041902 -0.3689945095751552 … 0.16333137728293143 -0.15630275159711682; 0.0047315733579635574 -0.3354463600643099 … 0.001502993099983222 -0.22546071298195883;;; -0.00010540979504286608 -0.001578306788298853 … -0.17211600764987645 0.08935767978511648; 0.00027955784662978835 -0.0016495533758671423 … -0.3124268825423369 -0.20253345099670803;;; -8.541896085863041e-5 -0.0008386697134446786 … -0.5626760091371686 -0.06163262890953648; 0.00010089614687279866 -0.0007906503658891804 … 0.08087106397826463 -0.29934533249702727;;; 1.0199907046517851e-5 1.5961426098853286e-5 … -0.5897387720157127 0.36635370551569707; 1.1999370955331744e-5 -2.0937191515633318e-5 … -0.3316253722891494 -0.47365535095824507;;; 1.2335640264608175e-7 2.548065862741581e-7 … -0.1933877101433842 0.19242895580905434; 1.2745033575080444e-7 -1.6851452492232747e-7 … 0.13446052848527412 0.5853900657349691;;; 3.830828050869211e-12 3.6452452855221416e-11 … -0.07033281719080449 0.06372022197982868; -7.217425428756741e-12 4.147385392585617e-11 … -0.00042013048312126343 -0.12656636765945106;;; 1.614663410969658e-11 1.5766758607514985e-11 … -0.0046968759094058446 -6.317042439922797e-5; 1.8268364351056316e-11 -1.8508514296386207e-11 … 0.001426302173777038 0.011938558145483232], [-0.7058763100922915 -0.6182276079097767 … -0.012485533474623957 -0.17438849837150194; -0.7083334103605045 0.6159153169340232 … 0.012260549193753198 0.17402360242747644;;; -0.00089541221837066 -0.3498048677491494 … 0.08342936717440622 0.3067722733707827; 0.0012680887677030614 -0.3407042118893606 … -0.040399810883982736 0.3161297736035968;;; -3.73209792976307e-5 -0.00028610189196124806 … -0.17289635944397713 -0.3148451469194682; 5.701746748455117e-5 -0.00023055007740202706 … -0.3624323998703848 0.5155882746994832;;; 1.097882296947906e-5 6.35044490627662e-5 … 0.7137848005421584 0.4741769029004874; -6.403375939974234e-6 5.141615186888956e-5 … -0.5660053438713644 0.39427744695268435], [-0.7067067639124637 -0.6327979385976186 0.06169403477951044 0.31036456759688696; -0.70750647796826 0.6320364219665233 -0.061145964555549256 -0.310202701405507;;; -0.00019990646249641933 -0.31782739944352295 -0.8136856317147183 -0.4867251759888667; 0.0003057952380310265 -0.3147736875555625 0.5747788355813179 -0.755345432421306], [-0.7069708581147547 -0.7072426781356504; -0.7072426781356504 0.7069708581147547;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^cores, 2^cores)
xes = collect(range(0,1,length=2^cores))
yes = collect(range(0,1,length=2^cores))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="89365a37.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this exampl we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 8
h = 1/cores^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,cores)
xes = collect(range(0.0, 1.0, 2^cores))

u₀ = qtt_sin(cores,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393110550548e-5
Relative error for implicit Euler: 4.831408252078765e-6
Relative error for Crank-Nicolson: 4.831496706844934e-6</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 5 August 2025 11:20">Tuesday 5 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
