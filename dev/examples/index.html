<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in <a href="https://arxiv.org/pdf/2505.17046">this paper</a> where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^cores)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, cores)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(cores) + id_tto(cores) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(cores) ⊗ qtt_basis_vector(cores, 1) + qtt_sin(cores) ⊗ qtt_basis_vector(cores, 2^cores)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[0.19895463362510538; -1.9275176174642776;;; 0.42154542859600413; -0.05687634690643229;;; 0.2371254969967094; -0.5672334245486166;;; -0.940960091697092; 1.1041462115887106], [-0.7332909820491404 1.2824783663293946 0.7906554675406775 0.5978300488160918; -1.048961259699957 -0.9970636306169102 -0.6539553248078377 -0.12019632791060508;;; 2.267696849710892 -0.35987116470198993 -1.5579789205761019 0.26782648546836435; 1.5751932743870705 -2.3535156004933206 -1.3463542531458517 1.045277620379951;;; -0.12710561770066492 -0.7775959415136667 0.24314560445188924 0.8724008813907146; 0.2078922872361843 -3.5336624787548194 0.6428060865034001 -1.4436925554142697;;; 0.08814461021532201 -0.11557579981540697 1.0151086153140367 0.2026240746943284; 0.7125973836908147 0.580899567865992 -1.4641547096290581 -1.2738673933898832], [-1.4080432102134008 0.6035702895889193 0.5554014990892655 0.34255894095706174; -0.4310779727578169 -0.06218858244814975 0.9972604469219098 1.5688347045253306;;; 1.5721877250191902 0.936751342782936 -0.008759476124226012 -0.18918575021827141; -1.3834775675979165 -0.3947244083988354 -1.8192974567964872 1.3583276178385564;;; 0.4818919724357642 2.084552615304213 0.2446632415815605 0.9983588162735902; 0.517570212529403 0.014721879276981063 -0.8443101502158107 0.23438364055659822;;; -0.5651052720900481 0.47697020767848525 -0.40077546025207156 -2.498862633546546; -0.8002344639133687 -1.024818284597864 1.915027761898134 -0.7990287429915801], [-0.33373006294913066 -0.35364499972242286 0.9335799387847709 -0.1614358125837852; 0.8820202298228946 1.2686398716188347 0.6199769902291663 -0.3612758353724489;;; -2.8478890310039704 0.21240571687069662 -0.07444433029562712 -0.8194535888507984; 1.8431499835271545 2.391939525179272 -0.4774314009904642 -1.3577586925573655;;; -1.734045096406439 -1.2719824717029102 0.31322005661904145 0.07628431692474068; -0.26022464968857867 -0.5046130909741494 -0.055810002620086674 1.7549115781717561;;; -0.8457741715395658 0.09063218045063667 -0.024851919159821077 -0.1326565818257962; 0.47013447118098134 0.6267276561795979 0.14689080755811026 2.014856744165974], [1.860166559629068 0.7882013118182495 0.6788197772306495 -0.740835904319759; -0.10985414048013284 -0.6024855609696186 -0.8019193129695132 -0.6597901674671126;;; -1.733664091125637 0.12238000212564734 -0.46022197462464215 -1.2308080553493246; -0.014594070974097657 0.28921149798500595 -0.7077773059647443 0.3447540138362625;;; -0.42196395535759607 -2.327231744072832 0.6557664528211715 -0.48113638116597607; -0.027439108247872067 -1.2719102906357478 -1.2769265336154751 0.6325816487668033;;; 0.6561046178625379 1.0139493559970334 -0.29061727625651707 1.2785823019809681; 0.34407100574746874 0.5603910496549815 -0.14936123477690144 0.8074471674260763], [0.24521443602911316 -1.15303586137463 1.014730836355777 -0.452765740110191; -1.5798646915741095 0.18116783998204503 -0.1895638712824173 -1.6045271726950563;;; 2.384443261927103 -1.1821196561150864 -0.3757895749920257 1.2478104498825366; -1.6938256115155979 -0.9785208953958269 -0.32533644143643803 1.5972675913199483;;; 0.46988762791024047 -1.1913031950131163 0.16702267926895378 -0.3384322217192707; 1.661736635142542 1.1302973689228297 -1.0111075246816597 -0.2268697584442371;;; -0.908342275279024 -0.8812554384003367 0.9583630203803764 1.423749476303159; -1.3200026061353283 1.1929961634665431 0.42644076509496925 0.21133242948947972], [0.41326893696136013 -0.20191012820186188 -0.13475220077056088 1.656586032070207; 0.4944332614807674 -1.3724838048130072 -0.5175304019353204 -1.9242541685351102;;; -1.5967385475042286 0.17509306707573005 -0.70518377323366 -1.4165390740289672; -1.2851873344169797 0.17003146199656555 1.3062859986529953 -0.42538731653917045;;; 1.0977654028764938 0.10438097233918739 2.1402824335111923 0.258793444611301; 1.3720319467111564 -0.4867810041319784 -0.9025732520773013 -0.52333530599646;;; -0.8527429672924998 -1.762944605243178 -1.220954586225719 0.7946432222189224; -1.375496759006426 1.4490503611384093 -1.5960445339851197 -1.8966134546981068], [-0.3944465529245005 0.4659404282055108 -0.825363030783301 -1.3325272697530066; 0.5893965685959873 1.13395420224482 -0.24773968434506446 0.9514951030389057;;; -0.6532744995719174 -0.18089887140935162 -1.009547439260638 -0.5817250724266954; -0.5609138678197314 0.5614452237009482 -0.11436118950935127 -0.6101784997147952;;; 0.24851488106367697 0.7905952921702633 0.5756875678568201 0.2709715524031998; -1.0734942110762844 -0.43276420701457763 2.3820965936928062 -0.20254274265844524;;; -0.9318080784032454 -0.9428381266029753 -1.0928008686839756 0.30463430288741566; -0.2863027162619467 -0.3314123111802759 2.2739675910162935 -0.8002505695807461], [-0.3002290372251109 1.2839692612500049 1.8709723005309764 0.7361690438927552; 1.3030769456909745 0.4616842737551019 -0.4550143091763783 -0.10707933018044492;;; -2.230017251527644 -0.0975387602895308 0.2961834197413582 0.0058989769212203814; 0.29681334273119686 0.0463684083906973 1.028150534193921 0.40979411491094925;;; -0.9494315503801503 0.4821843690765872 0.7725700602634709 -0.20263508513648443; -1.1425740604400276 -1.3085817178863393 0.22621613744381328 -0.6646882401846664;;; 1.885268409025031 0.3938143738276335 -1.127310354710605 0.7719218469908758; -1.8131335462062548 -1.0807444318221506 0.5060503790803522 -1.5399452685013602], [0.37088370532386045 0.3293893416561249 -0.15167586349174336 -0.2608844189075547; 0.4563055197530818 -1.0756863155544338 -0.7744920369933387 0.8976635523624805;;; -0.9014818330172236 -0.6061114629956837 -0.5103789925400901 2.3860655245065945; 1.207450916065939 0.027923994647801376 0.6578595156136579 0.9195121656153887], [-0.304737536778507 -2.5467585187507376; 0.5260815648513973 0.6682042234252397;;; -0.19397235812038707 1.3079441894923378; -0.82494323173075 -0.2965726630277033], [0.2268029832784325 0.424845418303261; -1.65696551814047 2.190748846460999;;; 0.1787830202255771 -1.6188968059301165; -0.8143300901629218 -1.9269379236085513], [0.7117560665326654 -0.8005705434344054; -0.6157343136864089 0.6988285630311922;;; 0.47120337845171173 0.1802629673262008; 0.3136874937912608 -0.12767537584601737], [-1.218906827371678 0.15422056966494152; 1.7627614331825043 -1.360522151141357;;; -0.561909519627192 -1.6345880656784886; 0.23702958089434883 -0.2536534952764942], [-0.0021373189898852697 -0.15950137120558533; -0.5245076653511016 -1.6505044200438888;;; -0.19020816357309991 0.5910472270919617; 1.1091391299926998 -0.6725223908080158], [-1.0881251065897308 -0.014559479540190223; 0.01141927137862599 -0.9515062150639279;;; -1.1938713386234296 0.27800574686034024; -0.8685344413925895 0.3106016289700115], [-0.32992106325898635 -1.1743325205263497; 1.5431252756353921 -0.24160841453591742;;; 2.019570060405307 -0.6955059297088954; 0.26730409473900096 -0.4153928910916936], [0.5181671241629421 -0.6005418919917417; -0.9181281729733156 1.7308386036945456;;; -0.6333316606255337 0.12644438642824118; 0.24797057300835051 0.6629089162676174], [0.8851891392740814 -0.5230775122905751; -0.21853448931138303 -0.6349323041282762;;; -0.7453268364696023 2.4283767541461776; -0.5364376771400431 -0.35400596546338037], [0.22025176489980927 1.0086026003042547; 0.48549871396395944 -1.7361300852025554;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-178.46236652141374; -190.17546682832577;;; -106.64800721377081; 100.07944804648967], [-0.7019563988533468 0.5124343231703278; -0.6949715681943878 -0.5229642674023901;;; -0.10681736226744813 -0.475705390011519; 0.11239381036112339 -0.48515481020088624;;; 0.007011992273146686 0.03405587446606803; 0.008412032985215447 -0.03210492916571877;;; 0.007507667661332525 -0.00478464717463691; -0.007288388896761569 -0.0059337677077523085], [-0.7065948751152568 0.364881473487432 0.11055825645732277 -0.08166041497848382; -0.7047316199212016 -0.36686072322901847 -0.08992917895634547 0.08985487320794751;;; -0.04462835930654244 -0.6013647892698927 -0.157141102682233 -0.1414949989150574; 0.04536791040646265 -0.6067260664080987 0.27740347298069695 -0.02376483069907275;;; -0.0022948715983044155 -0.03563711480305531 0.48319727376285054 0.5164056738259873; -0.0031538451899906844 0.03531894651526095 0.5140712416833838 -0.5297292665880516;;; -0.0024302968924390595 -0.00010396028611909237 0.4419654262088765 0.477772977400791; 0.0024424137585941324 0.0009631038588430872 -0.4299801094539035 0.4346938350253556;;; 2.5809838414588528e-5 0.0003363776862415084 0.00613852697856727 -0.005772334890158929; 2.530241187106574e-5 -0.00032647622565893774 0.006303142866394081 0.007387697344113197;;; -3.427028470730547e-5 1.8882316334221082e-5 0.0008000178764547124 -0.0060024755998781334; 3.480158778023101e-5 1.484660106246631e-5 -0.0006092516879275119 -0.005872382104773587;;; 9.497021477887306e-11 -2.4076786483096693e-9 -8.101024574938729e-10 -2.0808616712317725e-7; -5.784328280059343e-10 1.7755538695063066e-9 -8.129532259676522e-9 2.3720396559222184e-7;;; -6.452664651036018e-10 -9.889092214345599e-11 -7.048784024621366e-9 -6.328495129961783e-9; 8.524808583866824e-10 4.1509851573287643e-10 6.349309204277374e-9 6.04397351057178e-9], [-0.7069646938511401 0.21176825629548163 … -0.27813111477451224 0.05316988600082213; -0.7066114804188011 -0.21186151433970954 … 0.2783826190540445 -0.056158066524896355;;; -0.021218128019618462 -0.6737236155045416 … -0.09010312021650836 0.06528836643150172; 0.02116763660111115 -0.6744185705459318 … -0.0816468303346679 -0.031138908901203428;;; 0.0007261873267742727 0.027446232880738584 … -0.018190851840213598 0.028748018114773254; 0.0011044285899387803 -0.027692976176617347 … -0.0897539271828289 0.029283835680155253;;; … ;;; 8.472539514131369e-11 -3.3450494366941493e-10 … 0.013706147141635533 -0.01085854088166974; 9.34029146091085e-11 -2.350030445511975e-10 … -0.04666884728153163 0.06743152589213942;;; -2.618948567505979e-10 2.780132458578504e-10 … 0.003443162250228759 -0.06160730372017932; 4.080264676753916e-11 6.757026193117436e-11 … 0.02621648823827561 -0.06168507217352416;;; 3.246236131178101e-11 -1.7044616661524537e-10 … -0.001135559210003471 0.02713632340879381; -1.1409736553451669e-11 1.3826380445062168e-11 … -0.0077410472302796235 0.006919488829161748], [-0.7070392825371005 0.11053216093669972 … -0.061063166964865516 -0.042381333340433563; -0.7070190178520507 -0.11046406065240301 … 0.06726835191223463 0.041866196468586525;;; 0.010509282275104915 0.6982526384237031 … 0.21292534073930638 -0.0118846588037014; -0.010434905169730804 0.698206688796799 … -0.1939039073543935 0.01889299064996827;;; -0.00021080823971664914 -0.016185003215624126 … -0.11940737386333426 -0.31652264426549376; -0.000332380985631937 0.016267150219976472 … -0.06877461980598568 -0.014256183798377215;;; … ;;; 9.932467111311788e-12 6.382373717575111e-11 … 0.009807078196013229 0.22849320686260474; -2.7732470691044816e-11 5.977205800052292e-11 … 0.09836895459970152 -0.03813203483950874;;; -1.9707457235588995e-11 4.4819347413998027e-11 … 0.008887535562157965 0.12802806207281; 1.5357066436351204e-11 -3.1821930202036754e-11 … -0.018158891763585344 -0.08843071732474915;;; 1.2013302758275486e-11 -1.1620910854921697e-11 … 0.12719057376035608 0.1305711342891371; -1.905663774018117e-11 5.635301644909049e-11 … 0.07963527569335187 -0.011677538026390119], [-0.7070877618313586 -0.0556170310265595 … 0.053445773992554624 -0.11695815852334898; -0.7070864778752647 0.05575530674848422 … -0.05455204244760504 0.11423487487625841;;; -0.005202803712899065 0.7048907920989452 … 0.07721692085139675 0.17054579856805652; 0.0053413266763878585 0.7048701998354332 … -0.06767133720105827 -0.1883191182427019;;; 4.769343622302611e-5 -0.006450220018503301 … 0.0430986432808496 -0.17615580562260819; 7.339764786130151e-5 0.006466059874331978 … -0.07996052672166967 -0.23213580119479718;;; … ;;; 2.5779752750236297e-11 2.6430039294128855e-10 … -0.017002511947629743 -0.1449414151621715; 3.668254462077786e-11 1.31865869799954e-9 … 0.011451187393573616 0.17829283987713873;;; 3.352191781148641e-12 -1.3119919365727576e-9 … 0.04424320362006918 -0.34046320677096803; -3.076616549091118e-11 -1.1174943132338725e-9 … -0.2740983531626586 -0.40890682283669566;;; -4.39618222800639e-12 1.0763078503896326e-9 … 0.19330024124829837 -0.25505193527657377; 3.849830275915171e-11 1.0929789338728862e-9 … 0.20601492600303656 -0.26905456696350943], [-0.7071032093339445 0.02745317172117633 … -0.0016732777823344094 0.02298366881425934; -0.7071001647104168 -0.02819992202193473 … 0.0021153715927782484 -0.02384885954005111;;; 0.0022841613685532524 0.7065708075952699 … 0.058421194437694834 -0.11539937685148373; -0.0030314056868976148 0.7065405815467564 … -0.05917527970135496 0.11243516823649882;;; -2.443611781333049e-5 0.0005377283099369043 … 0.07488033292823945 0.041732594354224446; -1.2753255471412432e-5 0.00043102570814551665 … 0.05833363940305113 0.10376822996587669;;; … ;;; -4.5171808808883544e-8 6.250038372358819e-6 … -0.19702907170649306 0.06028084570912317; -9.170036462586697e-8 6.29010460126705e-6 … -0.20045966488982503 -0.04524878242878353;;; -1.8287003579189975e-9 2.394510920886486e-7 … 0.43245681368851574 0.1868756547857813; -3.610322399532446e-9 2.4086402203912713e-7 … -0.10705404213790574 0.07816571386194406;;; 2.4231466001904894e-9 -2.9184892017852634e-7 … 0.24678581211423847 0.18917363484236696; 4.597191053501176e-9 -2.94833519291779e-7 … 0.19264888048671533 -0.08346023730079377], [-0.7071065524358947 -0.013188359097065006 … 0.025092802254768187 0.003906047282452507; -0.7071037358834396 0.014646979463375247 … -0.025099079463003184 -0.003763986303539824;;; -0.000605596254507688 0.706979589607981 … 0.0022042579251390342 -0.03742696675982428; 0.0020642971026387257 0.7069507996307925 … -0.0012962772898194145 0.03771728025240093;;; 2.63246904349903e-5 0.0014950448246266986 … 0.010968475351106944 0.0654766995065718; 2.504641623425195e-5 0.0014911123142343657 … 0.002631373040499278 -0.08159239537199757;;; … ;;; 3.298140335299971e-7 8.075429096370236e-5 … 0.11606716092470731 0.06352942979202557; 6.284776724096917e-7 8.042074892694247e-5 … -0.015056624483399615 -0.18997017330476812;;; 7.67829495488894e-9 1.3889917502803665e-6 … 0.5544652401390878 0.36749260560433733; 1.2741674304324702e-8 1.380713250963015e-6 … -0.6316419125715165 0.4942259911576023;;; -1.4152410383745012e-9 -1.573957766814798e-7 … -0.4292571207498521 -0.5099720773106383; -1.9594665197779887e-9 -1.5640409683088133e-7 … -0.15363654115700018 0.2832166148386249], [-0.7071064985392179 0.0056573829965922365 … -0.009448243256618331 -0.10337385802161687; -0.7071040300376132 -0.00826447641300939 … 0.009452592494944052 0.10338294342081863;;; -0.0006365007095620673 0.7070597244494324 … 0.0024106166070780415 0.005893346200301756; -0.0019700665024146727 0.7070339048659798 … -0.002225687894431436 -0.003873552523562946;;; 2.8609723254642788e-5 -0.003500491833370837 … 0.0012177467574502232 -0.005640391823316285; 3.1684983193919593e-5 -0.003502250236494085 … -0.00035372682649891657 -0.008669630731776163;;; … ;;; -1.3437280659485757e-7 2.009885454639691e-5 … 0.3785234638452109 -0.3675870004719758; -1.7019376901764865e-7 2.013141033108885e-5 … 0.14168434775627586 -0.22666465261999472;;; -4.2423134831731744e-7 7.164834682357114e-5 … 0.2722806562930382 -0.4533187920798218; -5.557082399355214e-7 7.167918719337966e-5 … -0.7640371340219069 -0.39971004657835857;;; -8.302656510212497e-9 1.9645512136426034e-6 … 0.028210390398296183 -0.023869432193751778; -1.1935838579512955e-8 1.9631562831619337e-6 … -0.005274395423312806 -0.033215694248017374], [-0.707099472099058 3.9667827013277635e-5 … -0.00688969110327225 0.03851627378806295; -0.7070961415563011 0.007054256883281839 … 0.006889076553904665 -0.038516111045766875;;; 0.003211914573212524 0.7063256812896508 … 0.00029777630841818344 -1.4881489853022422e-5; 0.003875215455197582 0.7062904026356518 … -0.0009091645721579073 0.00040923343061833353;;; 5.499304226002748e-5 0.012773053342235233 … 0.0010134363853659019 -0.001206713968805838; 6.601133070359807e-5 0.012773131066066454 … -0.0007571754963933336 -0.0009282405812036903;;; -8.181748753818137e-5 -0.019325949771744694 … -0.004441888886082805 0.023002952142822854; -9.944723471124882e-5 -0.01932673175786772 … -0.007605082718215493 -0.023784129495700232;;; 2.210892364704754e-5 0.00508911769854239 … -0.2579901928510884 0.6752973700460967; 2.6863685512217527e-5 0.0050899033702081365 … -0.17531664526756585 -0.6879748545206903;;; -3.6716873776465074e-5 -0.00850559271483565 … -0.21428829021891954 0.17040917179451082; -4.4685006061377376e-5 -0.008505946852912541 … -0.3786612768509169 -0.19025287172679078;;; -8.674766829868615e-5 -0.020472516908842518 … 0.13818929999118845 0.019586977971609056; -0.00010583846892324344 -0.020472725632013147 … 0.33832232318432537 -0.0008948995924553594;;; -2.9827469379313697e-5 -0.007073070972958223 … -0.2983172608765919 -0.02950206578008172; -3.641198208988686e-5 -0.007073122853185256 … -0.7004818518287136 -0.010464120844384474], [-0.17696588207014743 -0.14059303737992826 … 0.11574638998439944 0.09317866155182421; -0.983720309762894 0.004960106073407591 … -0.005770164415058459 -0.007860134785255548;;; -0.019847614418227275 0.9899240317367675 … 0.027331568850654592 0.020371769965208026; -0.007622860320129762 -4.630345500482065e-6 … 0.023481201089523573 0.027803855657641506;;; -0.022545975770158523 0.015666364159050736 … -0.6723039920786843 -0.43085157187858375; 0.00413180907703053 -4.4932514046399395e-6 … 0.08940149405244306 -0.08255577521058988;;; 8.232123787480654e-6 0.0011332053206107747 … 0.10359452295496306 0.06700042041722709; -1.5797535945581726e-6 -1.6452856238439432e-6 … 0.11267648828122141 -0.4366093727386263;;; 1.0209116256559988e-6 0.0033359176186157375 … -0.21334150109642255 -0.09953223627386071; -2.063259629381411e-6 -3.5116411237926735e-5 … -0.2891932660068215 0.21054822635800063;;; -1.7562386625314406e-7 -0.0005460643780636475 … -0.058388023253140416 0.48579325390042566; 2.917791587965288e-7 4.5558202864842985e-6 … 0.16358789950740607 -0.1263354534675797;;; -4.6639172742197334e-7 -0.0011203573647903526 … -0.3092099378956809 -0.21978332504432108; 2.3290038781829973e-8 -7.751776376319068e-8 … 0.02142991248232622 -0.023675234305531714;;; 2.5879734516556226e-8 6.652998671028165e-5 … -0.2417594642337024 0.07200743734107384; -1.1274984550385186e-8 -1.6318971463382343e-8 … -0.43361599040962423 0.49219844215912156], [-0.4086952413940981 0.2508518414012867 … 0.14667755167452132 0.05573210736353448; -0.9115063533296579 -0.12793371559612332 … -0.061372640759733324 -0.00521912285921294;;; -0.01526658318053068 0.9590894703933962 … -0.05596082265166367 -0.01287704527902763; -0.019253669485831147 -0.0013348023649595163 … 0.06984252308620137 -0.15945925771584696;;; 0.01291662740692186 0.028891166141448762 … 0.31395222244371634 -0.1521697107846422; 0.036793421427023874 0.004150258210679639 … 0.011955871615613279 0.45439482114076557;;; -1.685005538879368e-6 -4.82671486868326e-6 … -0.05130571786679203 0.03313707050871469; -4.908666605239358e-6 -5.57113472583885e-7 … -0.010933039129997199 -0.05160549956017843;;; -1.4513231388125232e-8 1.3290223203724116e-6 … -0.0538734755047639 -0.005356732120889546; 6.679340363988361e-10 2.0770747622984986e-10 … 0.006444264394611183 -0.07396278885795861;;; -3.871327839557951e-8 3.5616802128480802e-6 … -0.31952520554948116 -0.034688507180827326; 2.133936911686047e-9 9.86642523591402e-10 … 0.09401273985480503 -0.5007421673064048;;; 5.699538808983242e-9 -4.755075081697539e-7 … 0.8668154693534796 0.09418969928507215; -1.780244071766693e-10 -3.932873551007327e-10 … 0.00014632280503637106 -0.3597168218950263;;; 6.06999430770709e-10 -5.1969204187963506e-8 … -0.0010209365742991285 0.0009844036606843516; -4.460809469601594e-11 -5.649621617783558e-11 … 2.118547616798781e-5 -0.5849513591678873], [-0.5232943039107019 -0.4118402578063243 … -0.17208991438086726 0.019531076156769918; -0.8506047803267041 0.2754643973460086 … 0.0875420450726815 0.001318804871872333;;; 0.022013565788287812 0.868277211442131 … -0.12424619467106683 0.012180569128407063; 0.020662145493069134 0.01313179860121344 … 0.08838716905293531 -0.06858135918519526;;; -0.01541677094395347 0.01930313280063514 … 0.5440500696281558 0.02719533476209328; -0.03854063692826473 0.007523082616948513 … 0.16326138825561606 -0.33490534189943194;;; 6.628482457906754e-6 -9.00963274537229e-6 … -0.13170656422566393 -0.011082015983654561; 1.67263155920194e-5 -3.368623037901341e-6 … -0.03489840703744172 0.1826470759650601;;; 9.623132858495381e-9 2.9392750283292543e-7 … -0.6529144120950283 -0.21750828946719608; 2.6195717112834065e-9 2.10664679538154e-9 … 0.10540971579964302 0.5121281422479127;;; 2.616465593805692e-9 8.317534254028867e-8 … -0.32083458642937673 0.3499312298370596; 6.648851276221469e-10 6.539631534562504e-10 … 0.11225436945109582 0.3419396535523296;;; -1.9017603766537613e-13 -2.6169037289324183e-12 … -0.16996026045615037 -0.008509657480672936; -4.163408664394962e-12 9.983739805695884e-13 … 8.538547820136087e-5 0.1237785313861851;;; -8.683585859545766e-12 7.856571344184687e-12 … 0.12816738058109564 -0.5290502721264703; 4.826532602037346e-12 -4.539237883206836e-12 … -0.002253497606228232 0.06429367875446021], [0.587508027041683 -0.5801820717593633 … -0.03313254185894949 -0.04128985186060822; 0.8084993843509306 0.4285935031640414 … 0.03223705231192234 0.02732439984358904;;; 0.011740824090653607 -0.6857753477471935 … 0.028635688077420483 0.05161853941019129; -0.021647000689225156 -0.09595081468402199 … 0.11801129607184563 0.020054205631449232;;; -0.008834162607506923 -0.0091671180302434 … -0.010849286810017792 -0.14034515535267536; -0.0218763514412935 -0.010859815086613078 … 0.2063530202997524 -0.036063645664257446;;; 2.787435502737399e-5 7.25806622345642e-5 … 0.0009297736396946562 0.04595596743525853; 7.65839041242132e-5 4.285348283181907e-5 … 0.5727778083582501 -0.4474009824050169;;; 1.1310533582530096e-5 -8.652047773948905e-5 … -0.44275015817198127 0.07835319366257362; 1.1190495112016943e-5 -3.3781725912594245e-6 … -0.008740773346140186 -0.20111983265800248;;; -4.254852394660841e-9 3.4245079173319586e-8 … -0.5712346245674771 -0.6233570371130642; -3.387206760674831e-9 2.104866670205474e-9 … 0.007677792865440496 0.08354688783688503;;; -3.7373382991519715e-10 2.103631378796706e-10 … 0.2267401225122942 0.0762311780619611; 2.059361940009114e-10 3.22192691827978e-10 … -0.13328587624769275 0.13205603791544762;;; -3.290393038903041e-11 -4.077035088993576e-11 … 0.07115789422799218 -0.48686444870889484; 1.8820534108038778e-11 6.001889267559815e-11 … -0.12502030993067176 0.2622507808498323], [-0.6540968703876722 -0.6295515721826025 … 0.1076692762358639 0.06182830434079648; -0.7555776980601092 0.5440374010893285 … -0.10343501227973345 -0.05509596901163909;;; 0.012501431753988866 0.5100882381989772 … 0.13745910990405857 0.10168107853870556; -0.03216604776012982 0.21753017627372565 … 0.23880745441460763 0.08358845467732888;;; -0.0026723165731358136 0.008071215049272737 … -0.04614877168655994 -0.1643857545505634; -0.007837867510752402 0.01062000782747185 … 0.2192534936241662 0.02856075184704693;;; 4.2591572925480643e-5 -0.0006577820277089775 … -0.0036009692821168072 0.07813611614858905; 0.0002720805739878302 -0.0004959306268516202 … -0.48059778042460277 0.040791257606929546;;; 0.00011893003045921703 0.0003560396976270245 … -0.5547735091823542 -0.1439597532835296; 0.00014995968589490757 -3.693496847738121e-5 … 0.1856053376082772 0.1150265012383461;;; 8.554273589070212e-7 2.880289875207183e-6 … -0.1843590677796382 -0.12030048772083926; 9.88820658720896e-7 -6.976629615147752e-8 … 0.38274296813229197 0.07985456171886583;;; -5.103692950818886e-12 -1.1270368941735225e-11 … -0.1594506008691342 -0.22445144395938219; -3.707981798422649e-12 -6.121230225993715e-13 … -0.07869831048823671 0.5418072470750898;;; 8.072216492920563e-12 8.117063419719132e-13 … 0.19142196162712175 -0.4686100772533799; 1.521173171795447e-11 -7.242061818137271e-12 … -0.17213890302788581 0.5673399670356152], [-0.6922527387188002 0.6215367513042527 … 0.06254256620205328 -0.1615039205590129; -0.7214383512022694 -0.5953238901579099 … -0.05776644677742343 0.15688992119430326;;; -0.009131007728099098 0.41136149647481046 … -0.16914266798687624 0.2885489092900305; 0.015056696760148364 0.29999829746773615 … -0.02291308542801163 0.2538887846750523;;; 8.452878871385387e-5 0.004673637749829524 … 0.2263693314213162 -0.24660863654017073; 0.0015243507521044823 0.005391729504346137 … 0.1993374480293462 -0.11438371800408413;;; -5.090766713532253e-5 0.0025428683051088425 … 0.36591165859829 -0.30541215825182555; 0.0006536556935436507 0.002620660722134384 … 0.08461225500784095 0.5667611525597499;;; 6.735945017934866e-5 -0.00014089627251857666 … 0.7442580718560424 0.1383558082614036; 8.090992821123818e-5 7.60879055337889e-5 … 0.13677019744669527 -0.03956389251218528;;; 8.044921805545401e-8 -1.9437305998347978e-7 … 0.3224073029511986 0.10843168797984364; 8.865056963451801e-8 5.7694030824011985e-8 … -0.16145541068713762 -0.5030554975556428;;; -2.8793693587180936e-12 -2.9161256777592434e-11 … 0.16982640683421105 0.013150370448526265; -9.16059821670269e-12 -3.469538384520702e-11 … 0.004024713143345795 0.14857722539263324;;; -8.373099315734466e-12 1.0333488914447652e-11 … 0.008235802369721644 -0.001365608692655076; -1.1794064231138664e-11 -1.8604078394490258e-11 … 0.004756800152983883 -0.07353854996554032], [-0.7031489232410895 -0.6165604459035606 … -0.011705558260202842 -0.10312304977630311; -0.7110195943145944 0.6092715238838521 … 0.011189261199644052 0.10254913670300905;;; 0.003331736658469523 0.36864817033628905 … -0.055494034121544106 -0.17052924747531942; -0.004639568430197428 0.3357582186091601 … 0.017560966560637582 -0.18790454947447358;;; 0.00010159540752705193 0.0015211796437310853 … 0.06032793810502915 0.11246775243360718; -0.0002678929397548645 0.0015967695537391494 … 0.05641294707299772 -0.31438540492131334;;; -8.848581329262929e-5 -0.0008890100571261116 … -0.24981595188084285 -0.17068379074307577; 0.00010942829983148037 -0.0008468022580176309 … -0.14360574427984843 -0.08101735324285438;;; -1.109446440431164e-5 -1.784466971184788e-5 … 0.2366567270707171 -0.034123016642275406; -1.2867266115213228e-5 2.1990645610427062e-5 … 0.26384509366496567 0.1740774583680808;;; -1.1347696573690973e-7 -2.312054125268524e-7 … 0.13202002059422874 0.10212652865667572; -1.1774081326532885e-7 1.5808882701950409e-7 … -0.24263674801436735 0.5582329835123051;;; 1.8019391695595184e-12 6.496310684178295e-12 … 0.18714182851691694 0.3437670445424555; -5.962866351603784e-12 4.187706455127914e-12 … 0.6675991081569445 0.09542831079093747;;; 9.553501822510574e-12 -7.622479949075602e-13 … 0.3466554813816649 -0.48552199726073036; 7.31145996566472e-12 1.0018116260845581e-11 … -0.32201573167174186 -0.22525948225014117], [-0.7058963154236386 0.6182035107826247 … -0.050782755524439664 0.16852474207435586; -0.7083135511055759 -0.6159477790855711 … 0.050862899157083474 -0.16809301430279655;;; -0.0008965224614868005 0.34969806911054707 … 0.029667127085084788 -0.3185682917077281; 0.001223387838124191 0.34079863602092497 … 0.15299838610627461 -0.2828893548069205;;; 3.5438609875263133e-5 -0.00040468082513337453 … -0.04461573485858758 -0.3410993831905075; -5.734266487791488e-5 -0.0003510557944200038 … -0.546187440456657 0.3606366117040212;;; 1.3351163009208504e-5 -9.61888330751743e-5 … -0.5093585970470913 -0.6991617506117104; -6.235656642436334e-6 -8.113685735337414e-5 … 0.6409274283058315 -0.1630867801938047], [-0.7066944126952677 -0.63281699614796 -0.0695513985737455 0.3086879644689759; -0.7075188161542105 0.6320228635090988 0.0690100124460284 -0.3085479589491762;;; -0.00018408787496862825 -0.31751346495945876 0.8263308254056281 -0.4651478610781158; 0.0003129931136825158 -0.3150792740842705 -0.5545967797626381 -0.7701606098436559], [-0.7069780052842904 -0.7072355336408415; -0.7072355336408415 0.7069780052842904;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^cores, 2^cores)
xes = collect(range(0,1,length=2^cores))
yes = collect(range(0,1,length=2^cores))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="c9ef4091.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this exampl we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 8
h = 1/cores^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,cores)
xes = collect(range(0.0, 1.0, 2^cores))

u₀ = qtt_sin(cores,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.831372975605752e-6
Relative error for Crank-Nicolson: 4.831443987171971e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on <a href="https://arxiv.org/pdf/2404.03182">this paper</a> we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an esample of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h2 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h2><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve a simple differential equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using KrylovKit

d = 6
N = 2^d
h = 1 / (N - 1)
Δ = toeplitz_to_qtto(2.0, -1.0, -1.0, d)
kappa = 0.1
A = kappa * Δ

f = qtt_sin(d, λ = π)

function fg(u::TTvector)
    û  = orthogonalize(u)
    Au = A*û
    val = 0.5 * real(dot(û, Au)) - real(dot(f, û))
    grad = Au - f
    return val, grad
end

x0 = rand_tt(f.ttv_dims, f.ttv_rks)

method = GradientDescent()
x, fx, gx, numfg, normgradhistor = optimize(fg, x0, method)

relres = norm(A * x - f) / max(norm(f), eps())

x_mals = mals_linsolve(A, f, x0)
rel_residual = norm(A * x_mals - f) / max(norm(f), eps())

x_krylov, info = linsolve(A, f, x0)
relres_krylov = norm(A * x_krylov - f) / max(norm(f), eps())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0</code></pre><p>with a relative residual of</p><pre><code class="language-julia hljs">println(&quot;relative residual = &quot;, relres)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual = 1.5117834555699724e-6</code></pre><p>Compared to the MALS solver</p><pre><code class="language-julia hljs">println(&quot;relative residual MALS = &quot;, rel_residual)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual MALS = 8.696932943619164e-7</code></pre><p>And the Krylov solver</p><pre><code class="language-julia hljs">println(&quot;relative residual Krylov = &quot;, relres_krylov)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual Krylov = 0.0</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 14 August 2025 13:16">Thursday 14 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
