<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in <a href="https://arxiv.org/pdf/2505.17046">this paper</a> where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^cores)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, cores)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(cores) + id_tto(cores) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(cores) ⊗ qtt_basis_vector(cores, 1) + qtt_sin(cores) ⊗ qtt_basis_vector(cores, 2^cores)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[2.096699466432093; 0.9951838164075302;;; -1.4690518611510057; 0.0453973246720648;;; 0.5523807510108761; 0.41559851445676416;;; -0.10432619363301972; -2.3147024485889665], [0.27634378637804596 -1.0040076521721024 0.6741851097351029 1.1937960489540143; -0.5841894032506157 0.7437383921329715 -0.8627608752461835 0.09096757292347075;;; 0.1954261722359056 1.562753535375952 -0.9684281432940608 -0.2367362764951998; -1.8632864434322418 -1.6465661423267333 -0.7012485202048405 -0.2467899081278767;;; 0.9110278405035953 -0.09669740129523535 -0.06980150765624014 -0.10870073398461609; 0.97590580317049 -0.9211219846124102 0.242386828661704 0.5451303892693161;;; -0.1469462799083458 -1.6120917606298497 0.8151081896743294 0.807502684005193; 0.5811312815631198 0.5625005451680832 -0.7172602029764333 -0.405339672986297], [-1.3112743911524192 0.2547770189510243 0.5933665440249891 -0.19525561730170313; -0.381802854710539 -0.15624826775105619 0.3119119730178504 1.261105329539238;;; -0.8017607535117692 -0.7972879197194717 0.8594516555868256 -0.11441734858605206; -0.649086017791966 -0.9621936447888093 -0.6545634294385715 -0.056236060691983676;;; 0.950317291737528 -0.9043638454362131 0.7593124526820806 -0.524958729720012; -1.8201575493995275 0.5913041758477594 -0.8479221765757335 -0.08398393617443027;;; 1.9552971174425067 -0.720754927357501 0.39357628681949963 0.21521415353899523; 0.8705184580189399 -1.524202532215571 -2.286539722521341 -0.19512247752626427], [-1.008082889619558 0.5704350674485934 1.37116601518747 -0.8126485777447353; -0.7549441648229204 -0.6836660104754883 -1.1453069069485942 0.17005441906831023;;; 2.0104245924745325 1.050673225012408 0.08206060383906597 -0.5081601093152265; -0.7050649669895165 -0.017344559024758878 0.9029496060527258 1.2249940272649886;;; -1.3652395818341048 -0.05368148427449045 0.4593087159938634 -0.2523138324734928; -1.0425176269400942 0.3324533642964572 -1.113779397333113 -0.9002441225321552;;; 1.6711778607049388 -0.3115007426598934 -0.3402566008308333 0.8698252761804193; 0.48749165871590416 0.014520459957285892 0.48552644016548063 -1.298092149871972], [1.225768004981427 -1.508158369464383 1.6187446686731166 0.9286369162023308; -1.592435500219594 -1.1970915814929899 1.6283821588240335 -0.2531614930058063;;; -0.3103886847760971 0.14250956009445132 -0.03142078555572285 -0.6208470644308273; -0.12924794131058953 -0.4494723460036932 0.904138068570674 -0.023866060302326794;;; -1.5658528644575462 0.518586238640929 0.6524717636192497 1.5018998376939778; -1.1251468005841323 0.14905854628679208 -2.3075721047730906 0.15588130143540294;;; 0.07044298042146634 0.822086956939797 1.7787574262944776 -0.2801339506965058; -0.19028734948793 -0.08621848834695862 -0.011003815060763042 0.1973962905864466], [-0.40936462918301 0.46011404013354806 0.9910589807305364 0.06596449634699457; -0.15034262000585924 -0.7985307772770837 0.49414405470628764 -0.734129221435461;;; -1.6838029917766775 0.608822205536295 1.5599414457264635 -1.887462976299479; -0.5696083449481023 0.20428474516447576 0.2290537015973691 1.4193426608608948;;; -1.3756284736284394 -0.4847257861664883 0.8222938803822515 0.8556833023219358; 1.1899790212556605 -0.5570023397669533 -1.2271562795273954 0.16411934831826214;;; 0.295948479558305 -1.3479448049329845 -0.3680709290041699 -1.3175009116734437; 1.033406057864169 -0.19119756123926127 -0.2935409486586168 0.4075821930293137], [0.44376857058590263 -1.274752493501938 1.080976873074155 0.2450181637435092; -0.863385909931315 0.31562393641695724 0.7433370411443541 -0.5818477352354531;;; 0.6132601324028748 -0.6567981267593226 -0.3739826588493065 0.6999666009251789; -0.8670810136909907 -1.8285273606157064 1.6631240246312724 0.8367782303944882;;; 1.5071094996871885 1.4866153204291013 -0.14195213486755792 0.42408729872614276; 0.27842684762437536 0.522636090770199 1.10179834292566 -0.28274630880831103;;; -0.1871018343016164 0.6541927780085951 3.0492305568332316 -1.579483090379462; -0.9277705495046127 0.5119428370821963 -1.8988474157790467 1.0009026791092521], [-0.5845256271784675 -0.0730447411487741 -2.302294593555867 0.1711682110661741; 1.8544755199801517 -0.005698554229276709 -0.7815394390135384 -0.8723013337372496;;; 0.5090366273390721 0.5905202033088157 0.549212669812457 1.0963443142454699; 1.203084242362489 1.2130429661963187 1.579901559955706 0.6491418705047768;;; 0.23607762113102787 -1.9580066409245918 -0.6609721009191765 0.5679489601773058; -0.8826484438372487 -1.9475581524351004 -0.6945102635987196 0.06174522550506778;;; -0.9161563416589616 -0.12994412082738324 0.02161730995918493 -0.282397681243809; -0.0704319988772159 -0.9635007323827145 0.28533020458832786 -0.15952597136132635], [-0.6914531823861199 -1.9823407440946434 0.41537512684855926 1.6485225741095872; 0.36080249182226654 -0.0690930667458165 -0.9402983984420069 1.7964521240259765;;; -1.7553071942157654 0.11596111087338346 -0.0794522425830435 -0.45267415678190753; 1.5268888462150785 -0.7947000055268307 0.4171940426842476 1.84601599848507;;; -0.4381633081419554 1.0226493516209398 -1.1522565271467144 0.6546430114772082; 0.30970921659027373 -1.2781183257112825 1.520455324362735 1.116654333761247;;; 0.6333030896205517 0.2340203229131286 -0.3609817578948292 -0.5388021231658813; -0.4730351027414214 -2.499735461948199 0.33115124563167847 -0.5485180836053276], [0.25983556470652247 -1.3289746697691625 -0.6251197213928352 1.8604690097305094; 0.13838801936746947 -0.8075339000669586 -0.025406259381567462 0.276983858120419;;; -0.20332655351992876 -0.4960728014828808 0.0586674597929482 0.7968666944411392; 0.650199815400156 0.7297360615759011 0.5571353151953297 -0.9783292618834284], [-1.552921766332012 0.9542270178634291; -1.179716309194456 1.5092566529491225;;; 0.7679988004201326 1.2166369815488653; 0.6046569881747932 -1.0007092677575529], [0.8674308054843526 -1.0160049406439844; -0.26035347508749557 1.0400342882598463;;; -1.4951287392986055 1.0268322189804588; -0.691151728243897 1.8101359167953928], [1.7170740894543581 0.5373162515793474; 0.04693129085715429 1.6060514868897708;;; -0.9080932007030976 0.9663525088065522; 1.1469728291119499 -0.6205297010679478], [-0.47206090397599854 0.4957465977980274; -0.3924859765502042 -0.3702880557507522;;; 1.42035411526909 -0.47044167248243296; -0.1451195548247211 -0.4986984428930469], [0.8803967673375493 0.9999972784434551; -1.1826750989589494 -0.8565710868823821;;; -1.0248076602679725 -0.03897688006499446; -0.8325794762747489 -0.4705928487856409], [-0.5957382232887638 -0.04517817122862633; -0.5510448814822184 0.2500074857013786;;; -0.08991822733612477 -0.4213235089657541; 0.026791817909788008 -1.8558637620330234], [0.021659540031394926 0.020242329382808982; -1.1194681583542339 -0.640504666462776;;; -0.05852973216863829 -0.6391303424723703; 0.9174842663525875 0.43367120337104403], [3.4945621591991265 -1.4194366240070586; -0.6005624028194155 0.7609879274648798;;; 0.11047800168081777 0.6202905058855523; -1.3984939782011983 1.333818101318526], [-0.6312499079613295 -0.17169897951563862; -0.51980966718834 -1.9839972865770357;;; -0.8632157109187553 -0.7271627267672728; 0.5861898034168398 1.1340109975919301], [-0.21105538633320917 0.5862449118570301; -0.3756002452240054 0.1951958599550682;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-182.21742259326518; -187.3619024632901;;; -110.91013782089378; 107.86482837484421], [-0.6986472190176385 0.48847320366240965; -0.6950480733961217 -0.4937508511786462;;; -0.1171809926764852 -0.5040010142409348; 0.12003832275348965 -0.5076547294980217;;; 0.012685437693322827 0.05420474313346472; 0.01376207169208356 -0.05288435199567341;;; 0.01251507275463834 -0.007916044305857947; -0.012357712586048604 -0.008723927150337263], [-0.7057636600826872 0.33011831815433007 0.04946601088558685 -0.1299777540089321; -0.7048764000160619 -0.33093453946932894 -0.015882082624277767 0.1328359429691475;;; -0.049743438556836925 -0.6221664877442803 -0.29567842222010926 -0.12930966678938782; 0.05002192095995306 -0.6238205857072882 0.32993926544026053 -0.0956138790493007;;; -0.004094309896664329 -0.051321142835844574 0.47220506481179847 0.5106122034588726; -0.0046644375861065795 0.051239507079464425 0.4834254748882389 -0.5137741969956179;;; -0.003970428395364948 -0.0010676038882966785 0.4168545204219151 0.4641326620562581; 0.004002022609227711 -0.0004474657058472785 -0.41295157019170936 0.44646301560223794;;; 3.2268893560107936e-5 0.0003738187739505659 0.004396318961544317 -0.004485284090088225; 3.209191906933903e-5 -0.00036952717380001423 0.004440041289647911 0.004977462909861967;;; -7.602506613460335e-5 3.233294445551264e-5 0.0009654959960479866 -0.007626637073977045; 7.65624784669939e-5 2.9153627601489895e-5 -0.0008646746791617102 -0.007564595334532195;;; 9.39244323951612e-8 1.3109841342263923e-6 1.1374466666315158e-6 7.129391885486058e-5; 1.227524576280271e-7 -1.2985206082373326e-6 1.6335626053949883e-6 -7.088270514992699e-5;;; 2.769043968725081e-7 -1.1581859098328191e-7 2.4787401958626653e-6 -7.116536462233227e-6; -2.745077249404946e-7 -1.3573482545021876e-7 -2.4379580356451695e-6 -7.397112166157984e-6], [-0.7067490827342029 0.18500602822035653 … 0.4574603388092374 0.005248296451386174; -0.7066369501831872 -0.1849665485184891 … -0.4573854186602459 0.003146920898197065;;; -0.024174143522505846 -0.6818053912431788 … 0.11766009266776975 -0.11758423453919677; 0.024091977970035712 -0.6818755126285144 … 0.12062608955969842 0.11536259309503658;;; 0.0010405422426056818 0.0292190396655815 … -0.14579361446257025 -0.029135599898029434; 0.001247255271014094 -0.029406383994059322 … 0.07474752531096354 0.04062854311038136;;; … ;;; -6.837234776477599e-10 -1.1875604188475832e-10 … 3.093742104812358e-5 -0.0006621318093531842; -1.028500863518603e-10 -1.9637769731288092e-10 … -0.00032019561661907254 -0.0005279719467176394;;; -2.8384963960814397e-10 5.470407860856651e-11 … 0.0001395089349928074 -7.103533441807673e-5; 1.590787348097248e-10 -2.033013827648674e-10 … -0.00016653139672450997 -0.0001210781032571018;;; 5.461230286094696e-11 1.4577884632098e-10 … -4.519105693884792e-5 0.00013439919680342474; -7.551712617362315e-11 1.4780618815985762e-10 … 5.4916139271000786e-5 4.431733637043404e-6], [-0.7070040752657999 0.09500692459370907 … -0.05006117721755253 -0.03433920602936671; -0.7070004245779052 -0.09496496684032373 … 0.046644626486346215 0.036144593296720505;;; 0.0121742249667157 0.7005735783847612 … -0.09183380971613875 0.05609697598322174; -0.012130640293254393 0.7005589560969152 … 0.10017579279372103 -0.04312413051303586;;; -0.00019267932843750475 -0.0019411987649804222 … 0.1399466735534148 -0.2203217715595438; 0.00021203179154934964 -0.0019050134014536252 … 0.010412176584212512 0.06260071739715631;;; … ;;; 1.9941641007003927e-11 -1.1253584921389152e-11 … 0.05912376288063953 0.06391807793224834; -3.116369812356937e-11 -1.1117140287646615e-10 … 0.07685103023716082 -0.07675821967456102;;; 2.710147304766508e-11 2.3454079230573545e-11 … -0.06830376120919468 0.10418412598919607; 2.553236933238192e-11 2.3918404868181236e-12 … 0.10682981365599772 0.15886922137758894;;; -5.573113255388237e-12 -2.478478779029162e-11 … 0.06387641047195491 0.0884004110239186; -1.9541561172450873e-12 -4.570336639325683e-11 … 0.06946125051281778 0.16981870140074168], [-0.707080536905317 -0.04759703921836995 … -0.1621639717756491 -0.06064330590465665; -0.7070798172528481 0.04762802626166606 … 0.15937843994844447 0.06048269190311454;;; -0.006117738473029186 0.7054857110557886 … 0.14749490529211676 0.00379282851928534; 0.0061486948892322865 0.7054823241992912 … -0.1689615436921764 -0.011749624832639556;;; 4.697713604924833e-5 3.4868566208620895e-5 … -0.015975226242864116 -0.14350558999826543; -3.3687801641562096e-5 5.222781136273446e-5 … 0.03625507828290005 0.14520951379158611;;; … ;;; -5.247668145597093e-12 -4.7744560138126325e-11 … -0.1977763737517263 0.03400763445412338; 1.672906357842232e-12 -4.0070974592048246e-11 … 0.016415535578795614 0.587240131241722;;; 3.664435719034445e-11 1.0012944410493017e-10 … 0.48757490585522556 0.015585104333560746; -3.488881404998723e-11 1.256188545114e-10 … -0.023477109832973245 0.08540686477521586;;; -5.951698429743611e-12 1.0177710440119915e-10 … -0.43254739649892815 -0.07065860404551397; -3.6152205159294172e-12 -2.942520955061166e-11 … 0.1396423112112631 -0.05584032385873476], [-0.707101100525076 0.023534550629589427 … 0.0073801783026321115 0.020587429107143375; -0.7070988890201889 -0.02401569767726717 … -0.007434242810335135 -0.02015040643242855;;; 0.002847828295390332 0.7066938945431894 … -0.006832876456288205 0.048728848861414; -0.003328478492301742 0.7066775733220787 … 0.0061292894093842145 -0.05012232564695495;;; -5.1997749649776225e-5 0.005144846456406815 … -0.047817074437657085 -0.08422560319037746; -4.926606570075409e-5 0.005151572333024667 … 0.052944752626146084 0.0738220600392432;;; … ;;; 1.138210304370832e-8 -3.53147355512473e-6 … -0.3968987381507736 0.23372346373843578; 4.013225663941812e-8 -3.6260583182208127e-6 … 0.1752542458328111 0.1912088702916044;;; -2.6936030462948306e-10 1.5794077787621408e-8 … 0.2271506916542365 0.19890614388832537; -4.0213008609515524e-10 1.649044248073837e-8 … -0.0648578009805663 -0.17592831785643753;;; 1.426207912847749e-10 1.5500451178724218e-8 … -0.1219021722006528 -0.23823651986228844; 3.653901111637622e-11 1.5317678488609525e-8 … 0.10949180310184094 0.2837290453320153], [-0.7071063892794207 -0.011149241688266316 … -0.05754236555360368 0.1088074422916994; -0.7071029030202435 0.012736471218515495 … 0.05759208702847082 -0.10880887547843208;;; -0.0007519968387019732 0.7066379900028724 … -0.012582759032325518 0.0022833014777891222; 0.0023328272706320424 0.7066107456980548 … 0.010555682649773723 0.0014807940242738495;;; 6.764735943361345e-5 0.020486563020763512 … 0.015546987118004318 0.002770347259619257; 0.0001369127929737693 0.020461002830475222 … -0.0041064430972601795 -0.031149007344932447;;; … ;;; 5.400591504432007e-7 -4.5253882021092965e-5 … -0.10145903161614785 -0.5196210170710592; 3.3979071154925776e-7 -4.5230874733964935e-5 … 0.05142922049723968 0.48745799061535433;;; 1.3270432182457405e-8 3.3592309609813428e-6 … 0.27268542685472175 0.12975221433272377; 2.7404078610912786e-8 3.3720004488314137e-6 … 0.6779417856028908 -0.06373667421433243;;; 1.2437711807974378e-11 1.111136889006023e-6 … 0.189804068426915 0.3799775214850155; 4.720703065571376e-9 1.113572348245677e-6 … 0.18211704286675262 0.09447517974464288], [-0.7071067388888529 0.005127718527114111 … 0.055866403492788506 -0.05332617536364737; -0.7071045959364219 -0.007126915876439263 … -0.055871883153267334 0.05332643250051537;;; -0.00023925028822220718 0.7057255031015272 … -0.003163329686242226 0.0005762178284595396; -0.0017497976231150212 0.705712397603638 … 0.0021378233094906276 0.00031103075178479176;;; 4.074453790617127e-5 -0.024496381990670973 … -0.004573549015023008 0.01393455787693052; 8.85076481545472e-5 -0.024461897887580273 … 0.0011650823717087619 -0.017408320001313923;;; … ;;; 1.0882463494364404e-6 -0.0006511773673043396 … 0.21344708602512039 -0.024939391314608435; 2.4571006417899525e-6 -0.0006505079154517918 … 0.40903398256382395 -0.011454503793677578;;; 3.5869625203800744e-7 -0.0004219205351096516 … -0.07951112930649927 -0.7446840502776928; 1.2476401521692273e-6 -0.00042164495269894083 … -0.5106145914774439 -0.3007573304869739;;; -1.6435409417835744e-8 1.8804931898161613e-5 … 0.0032139854104190108 0.059537997795669796; -5.6057984095468514e-8 1.8792920970679374e-5 … 0.02743513355168885 0.012063346874614276], [-0.7071063013204215 -0.002027609422940244 … -0.018115696072374444 -0.038017234907467605; -0.7071050856610671 0.004396908035138792 … 0.018116992482873302 0.03801695700372605;;; 0.0008202573671056917 0.698039273425956 … 0.0014681022681559167 -2.3152683185421322e-5; 0.0015366765750899946 0.6980303293079684 … 0.0001869310628168031 -0.0004467228710616941;;; -1.6330188018311045e-5 -0.023470682868121436 … 9.60521923228223e-5 -0.001509803721980791; -3.951626609353012e-5 -0.02346740590629891 … -0.001456984484207494 -0.0005104322003243467;;; -2.8233086582862068e-5 -0.0419178552877949 … 0.022530473013594256 -0.0779516196862453; -7.089160214320143e-5 -0.0419104115868789 … 0.06784404757416175 0.07405417318739069;;; -2.279988027474817e-6 -0.004029136126873368 … 0.2749422696274643 -0.6781326970780944; -6.43164175783743e-6 -0.0040282521692736484 … 0.49390785317272595 0.6398628394383384;;; 3.8976414735341814e-5 0.05864148062345957 … 0.626745489764677 -0.2460872386568481; 9.900833148443106e-5 0.05863531025171256 … 0.2594174132238036 0.20297545332988484;;; -5.495212610391629e-5 -0.08159561816370803 … 0.40308927998372324 -0.09654348778866496; -0.00013848765828646754 -0.08158788428795113 … 0.12008340425227959 0.07091148844336749;;; -1.1921730942788926e-5 -0.0177826988001586 … 0.19359990219694678 -0.011866545330867624; -3.013562122714002e-5 -0.017781200216558542 … 0.014191575439622317 0.0031486752513073105], [-0.1770232069753312 -0.14625483387518928 … 0.10224342120699907 -0.11365595895186821; -0.9836911507804073 0.005485757033925182 … -0.0035433993353468102 0.02277280189859178;;; -0.02071272909374935 0.9892313058227266 … 0.015349725493037975 -0.016794895787397377; -0.009367097434980159 6.3386007414646e-5 … 0.012162842095401596 0.09570109638365701;;; 0.021945489063456648 -0.00018689726278646053 … 0.6671962105822263 0.15292052509877585; -0.004017421249015087 -4.038283250223126e-5 … -0.10006633528091945 0.13075261902250745;;; 1.533895987275651e-5 0.00023937124705524074 … 0.10435288771434587 0.019761074362571705; -2.882837049887933e-6 -6.374474540880553e-6 … -0.010520112370505487 0.23448927916838572;;; -3.264462103865001e-7 -0.0008509578823451072 … 0.2289344383796151 0.1886863258177118; 4.3274200250321947e-7 0.00012327964062829126 … 0.4342055345703279 0.04399246639740547;;; 6.372400751661756e-8 0.00011912443244449543 … 0.26812124696412853 0.07655527400488173; 6.71611646743449e-9 3.015195748585876e-6 … 0.041872570240061135 0.1535632458507754;;; -1.591940066665895e-8 -3.5790038912564354e-5 … 0.06208253681774641 -0.31384882023731175; 9.712178755748956e-9 1.0841284738577104e-6 … 0.11382040051342812 0.012450577461567951;;; 1.391331385932884e-8 2.9845991891232093e-5 … -0.17518701762977001 0.8459471706451683; -4.9622176442798764e-9 -2.7686855234269966e-8 … 0.4011213917175985 -0.0018265162811623248], [-0.40948521203563043 0.2683883267857295 … -0.016148901595454075 0.03570942032150372; -0.9112781680965891 -0.13622999561406246 … 0.002290120928347548 -0.004623234578162309;;; -0.015454936411996585 0.9532675271185688 … 0.004335796801165789 -0.009330216903486661; -0.015992612149541164 -0.000977144453874975 … 0.0499040158697391 -0.11990386022718846;;; 0.012381988531255547 0.02588583070359203 … 0.04161346401817614 -0.10129733674236409; 0.03529913635654567 0.004367640276581148 … -0.11829917550274115 0.27201012866764257;;; 3.073670590810065e-6 2.7494700370668383e-5 … 0.009753375165729834 -0.023496132509750193; 9.670254357689742e-6 1.206113962448953e-6 … -0.011740525803188727 0.025732586157771804;;; -4.167803179226469e-7 3.237953669662121e-5 … 0.0016802624803624155 -0.0034810664496221395; 1.1783407851632064e-8 6.782747545903236e-9 … 0.9529636630113415 -0.047818545519653234;;; -1.070678344428326e-6 8.314171828784359e-5 … 0.00920561412278515 -0.01912965192769913; 2.925329492359999e-8 1.6825842026662593e-8 … -0.2687962118528479 -0.3426325199912293;;; 7.552796987890117e-8 -5.796880721773788e-6 … -0.028016338276795696 0.05834068874293677; -3.007432377391783e-10 -8.052689502942571e-10 … 0.0002085914994792271 -0.17158528764616013;;; -2.984181292025636e-8 2.305647991494414e-6 … 3.953966361428131e-6 -1.6344969072973212e-5; 4.4934085294340194e-10 3.1875320850635675e-10 … -0.0013201999028908161 0.8636363320118562], [0.5262161018055134 0.4372285261286076 … 0.14605257394356938 0.13556832497970125; 0.8491285543241639 -0.2912941667203518 … -0.07435706997199908 -0.061936131064019156;;; 0.020665118210316902 0.8504491817786678 … -0.11417958664920158 -0.09550632387444485; 0.012841106202548374 0.018480909595997075 … 0.08664321670754677 -0.09082378043936003;;; -0.014281848732895707 0.01751916281977094 … 0.500588089881136 0.14206576052085707; -0.03579663095891023 0.00816382980005043 … 0.14854423123363197 0.3792962023392971;;; -1.3361683880765287e-5 1.788168207034711e-5 … 0.12966200376536866 0.02155245850867533; -3.3808871775026387e-5 7.945745478108568e-6 … 0.032645622877400485 -0.006207480379665947;;; 3.528594672657569e-8 8.900869773736442e-7 … -0.6450272955700052 0.10878086199593827; 1.1709807653784491e-8 1.2422169894873536e-8 … 0.10337804640692089 -0.7126076032169809;;; -3.580684780429951e-9 -9.381762192457319e-8 … 0.22499966356316878 -0.021582659243697788; -1.108850100352008e-9 -1.2322312635850781e-9 … -0.08245480186527945 0.33453573592868274;;; -2.8406040037614432e-12 -2.4113916367102207e-11 … -0.37917175260173813 -0.02940347418753821; 1.4480667996470008e-11 -7.34675602312263e-11 … 2.090971841672988e-5 0.37502427411632383;;; -6.471832690165664e-12 4.706805995580934e-11 … 0.1847207356945212 0.04122311896487102; -2.8529598278505354e-12 -9.363361508142773e-13 … 8.022731249243817e-5 0.14364344515266714], [-0.5950942410493191 -0.5946423697360829 … 0.0003725803493961136 0.007952095862551443; -0.8028275557957177 0.44592101163269277 … 0.015489931524605668 -0.027917215128296233;;; 0.01138004118825213 0.6593843238289487 … 0.02928942803020146 -0.02671962885770745; -0.02754670767478729 0.11209392844974991 … -0.18303702204594566 0.24397738841724712;;; -0.007827800031958779 0.008842267892195513 … -0.3021902533915638 0.3154182200515243; -0.019522565529203964 0.011132749317827291 … -0.2497998186666611 0.423421404519535;;; 5.707751404350326e-5 -0.0001363643256498128 … 0.1297233401368426 -0.13506339526834282; 0.00015616596538051023 -9.87487913483053e-5 … 0.2160589961494333 0.5566588461939848;;; -1.968112596184453e-5 -0.00012655519124423888 … -0.08953755698809213 0.15350881717054934; -2.0800521969495666e-5 -4.566384781958259e-6 … 0.1461585134676516 -0.1673809652413316;;; -6.455821163666047e-9 -4.58454648891738e-8 … 0.3744767204729753 -0.0842667575716065; -6.013293541738756e-9 -2.4161423998509874e-9 … 0.1857983932342413 -0.1607572975167651;;; -7.190610338368023e-12 4.289260736379674e-11 … 0.5480784727798799 0.3558509212579325; 6.264456620271423e-11 6.526702681615167e-12 … 0.09204515307399865 0.2535675792731833;;; 1.0973715228349172e-11 1.0477630220930667e-11 … -0.4725415122898913 0.0009762898154601815; -7.465108813018129e-11 9.529732032177369e-11 … -0.10899551406319251 -0.23786649478509925], [-0.661465298479694 0.6293042777791013 … 0.08997744371301553 -0.017647642037872502; -0.7492089502680909 -0.5544651218061856 … -0.09522910529089995 0.023087268170237468;;; -0.012824655271489824 0.4927392509856723 … -0.07047111985968584 -0.016618753952517856; 0.030620608742628747 0.2314807761266719 … -0.29341262728629025 0.12145270206783318;;; 0.00207786549148113 0.007931744561702786 … -0.1618536576292278 0.227922311287036; 0.006538611391418567 0.010175489006441028 … -0.5477716747971175 0.14204403091547727;;; -0.00013732322024993788 -0.0011790000199121146 … 0.15659407547437293 -0.17841167263131102; -0.0006194828707621962 -0.0011262510623165178 … -0.26548263095997243 -0.4791081055190449;;; -0.0001253529989613695 0.00034810004571857834 … -0.11946996310805444 -0.02860507745150279; -0.00015807831373875072 -5.18341409351996e-5 … -0.07087716954758742 0.2241005929268033;;; 3.619701050486202e-8 -1.1318863708707217e-7 … -0.21904620404610795 -0.10602118500707637; 4.1909862675336436e-8 6.065453651685397e-9 … 0.2447666834383394 -0.44708612509071605;;; -1.5229091890248094e-11 -4.238399915729657e-11 … -0.25222275519344195 -0.19081289303468443; -1.4708770002534e-11 -1.031673038720122e-11 … 0.12611446414472915 -0.32348592454037994;;; 8.036050925094933e-12 1.9713052119091222e-11 … 0.5106657127958326 0.32467099348818534; 8.948177180673856e-12 1.2489240220489473e-12 … -0.05509920075876235 0.37682679030083815], [-0.6947782446841977 -0.620329273666565 … 0.03469642563260309 0.06995233586383173; -0.7190545260377719 0.5984180948762605 … -0.031358796806289384 -0.0678689307897341;;; 0.008312946307537912 0.4032216458103623 … 0.1264489535711168 0.13235869890240556; -0.013149744605315771 0.307325760751915 … -0.025091391624944455 0.10210823740404654;;; -8.882350930934091e-6 0.0038456212952570077 … -0.1578534618241485 -0.09013514091200935; -0.0011399209700406377 0.00440097688397919 … -0.03520881254413787 -0.3551185280612512;;; 8.672409279446993e-5 0.002806123989716009 … -0.47804884414107723 -0.13500086888152682; -0.0006661513963286112 0.0029167695214753404 … -0.2861672014005451 0.5304778141078488;;; -5.627480798620834e-5 -0.00011329122721953374 … 0.3671727974748054 -0.0012264312544426126; -6.703936478657698e-5 7.052101058796793e-5 … -0.0987064148132181 -0.025307210904702074;;; -1.4707057862733021e-7 -3.4514137861171936e-7 … 0.5370716241536428 0.441116268660317; -1.607932647660728e-7 1.277052733741869e-7 … 0.355620535876902 -0.520679435064187;;; -4.486925034961394e-12 -2.679597064647593e-11 … 0.004514845653391057 -0.20635609042448078; 3.670973429458013e-12 -2.620422928919227e-11 … -0.017982125453421424 -0.07348923999506737;;; 9.89483727045423e-13 2.1464690217310928e-11 … -0.23977496392986622 -0.02861887279701411; -1.422551492656997e-12 1.483092609719684e-11 … -0.16525023192653795 0.1164257840740906], [-0.703779724771418 0.6161072275697721 … 0.07859882027286963 0.12509581953763937; -0.7104016009375176 -0.6099752257466399 … -0.07843523096063347 -0.12366179737635143;;; -0.0028682728468794783 0.36596643052611494 … -0.10799231763683864 -0.2837852715743322; 0.003920057235867378 0.3382401546430857 … -0.16676193606766632 -0.14630164830338452;;; -9.314456073252258e-5 0.0012858285242631862 … 0.05860752165423926 0.2435075113542441; 0.00022207182137748592 0.0012991326245262013 … -0.27908766190096174 0.17358808621885916;;; 7.60819646369766e-5 -0.000705287034566761 … 0.060998821420849524 -0.6511105022690629; -8.126312218439148e-5 -0.0006622817255347833 … 0.0056963419794745914 0.23673950442396796;;; -8.337059543575616e-6 1.2951925599497093e-5 … -0.45990211118326835 -0.2903664855014432; -9.731721584675306e-6 -1.7642986251567293e-5 … 0.0976210424590944 -0.035093155545033415;;; 1.488420230732931e-7 -3.010463051182474e-7 … 0.2589259621135431 0.14447661715028773; 1.5348674335320885e-7 2.1700275997795785e-7 … 0.280657633024706 0.15875612449398058;;; 1.8631963772816237e-12 -8.385086348771357e-12 … -0.6832264694995582 0.29247305544341795; -6.466192716442318e-12 -9.92923239206193e-12 … -0.15194541416050006 0.09242202763182113;;; 1.1405166565182528e-11 -1.0054775789463234e-11 … -0.07105837635225194 0.1253614422047924; 1.1348198416739966e-11 5.580663322139313e-12 … 0.036522539172931086 0.23723890128360786], [-0.7060650588803316 -0.618048628469061 … -0.03817631461647789 0.17082270397579818; -0.7081458193350992 0.6161243100496129 … 0.0382643960730778 -0.1704433840051711;;; -0.0007728523957710107 -0.3491066411946302 … 0.007580537845749955 -0.3179835212171839; 0.0010150115252022703 -0.3413664698508563 … 0.12995100419280803 -0.29195462715352466;;; -2.6965067722288145e-5 -0.00036249148801248177 … 0.07400319717745242 0.34698069042594737; 5.274356630889995e-5 -0.0002695917626577811 … 0.4985156061537254 -0.3954343278439106;;; 1.0564623939203336e-5 7.569976087758615e-5 … -0.5585224938420962 -0.6559685265654018; -4.0869338216353115e-6 6.27576170036026e-5 … 0.6435775151850945 -0.2199068383725549], [-0.7067333992255583 -0.6327788538057161 0.06286313362182994 0.31010812795967807; -0.7074798966394047 0.6320592339104206 -0.062398226761793255 -0.3099673885695936;;; -0.00015487200924989633 -0.31740598978632356 -0.8163383389139797 -0.4825402885579492; 0.00027255246353496444 -0.31519118746034347 0.5707419768576617 -0.7582269033179324], [-0.7069908758699585 -0.707222667507645; -0.707222667507645 0.7069908758699585;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^cores, 2^cores)
xes = collect(range(0,1,length=2^cores))
yes = collect(range(0,1,length=2^cores))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="0e503a97.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this exampl we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 8
h = 1/cores^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,cores)
xes = collect(range(0.0, 1.0, 2^cores))

u₀ = qtt_sin(cores,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.8313771637299996e-6
Relative error for Crank-Nicolson: 4.83152836154616e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on <a href="https://arxiv.org/pdf/2404.03182">this paper</a> we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an esample of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h2 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h2><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve a simple differential equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using KrylovKit

d = 6
N = 2^d
h = 1 / (N - 1)
Δ = toeplitz_to_qtto(2.0, -1.0, -1.0, d)
kappa = 0.1
A = kappa * Δ

f = qtt_sin(d, λ = π)

function fg(u::TTvector)
    û  = orthogonalize(u)
    Au = A*û
    val = 0.5 * real(dot(û, Au)) - real(dot(f, û))
    grad = Au - f
    return val, grad
end

x0 = rand_tt(f.ttv_dims, f.ttv_rks)

method = GradientDescent()
x, fx, gx, numfg, normgradhistor = optimize(fg, x0, method)

relres = norm(A * x - f) / max(norm(f), eps())

x_mals = mals_linsolve(A, f, x0)
rel_residual = norm(A * x_mals - f) / max(norm(f), eps())

x_krylov, info = linsolve(A, f, x0)
relres_krylov = norm(A * x_krylov - f) / max(norm(f), eps())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0</code></pre><p>with a relative residual of</p><pre><code class="language-julia hljs">println(&quot;relative residual = &quot;, relres)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual = 1.5117834555699724e-6</code></pre><p>Compared to the MALS solver</p><pre><code class="language-julia hljs">println(&quot;relative residual MALS = &quot;, rel_residual)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual MALS = 8.696932943619164e-7</code></pre><p>And the Krylov solver</p><pre><code class="language-julia hljs">println(&quot;relative residual Krylov = &quot;, relres_krylov)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual Krylov = 0.0</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 14 August 2025 13:17">Thursday 14 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
