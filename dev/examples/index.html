<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics</title><meta name="title" content="Examples · TensorTrainNumerics"/><meta property="og:title" content="Examples · TensorTrainNumerics"/><meta property="twitter:title" content="Examples · TensorTrainNumerics"/><meta name="description" content="Documentation for TensorTrainNumerics."/><meta property="og:description" content="Documentation for TensorTrainNumerics."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in <a href="https://arxiv.org/pdf/2505.17046">this paper</a> where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^cores)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, cores)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(cores) + id_tto(cores) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(cores) ⊗ qtt_basis_vector(cores, 1) + qtt_sin(cores) ⊗ qtt_basis_vector(cores, 2^cores)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-0.7644124946317893; 1.2795165285150494;;; 0.018019662852236204; 0.1691120176304522;;; -1.4439039921991763; -1.918634158869487;;; -0.4450262055656347; -1.5186394911611536], [-1.201635226086127 0.6099571356040907 -0.24059767525145534 1.524660743594128; -0.7437822923722616 -0.23104998542298905 0.42133306032191775 0.8040140863863119;;; -1.1037842806167548 -0.26572882082292026 -0.27418268790540334 -2.230560242861357; 0.9184481723644616 -0.8711336978685194 -0.35336207328254754 -1.7833892836845915;;; -1.711789560082867 -0.1994778128724379 -0.5711633701307887 0.4536655664468972; -0.8638666896856737 0.7756959982641086 1.3935763495402096 -0.7684159245400667;;; -1.7306873839089965 1.2184449590242836 -0.8083099563132481 -0.3498848108007543; -0.403920155241693 -0.41838041584460456 -0.02643556304418345 0.3097802628625767], [0.0695815753367213 0.21703278656114702 0.9187900471044494 -0.3048716807791969; 1.0550841093216194 -0.8962388623983856 0.845792858504656 -1.7336865665301233;;; 0.16950908690694447 -0.5134065113852321 0.6130547537764932 -0.3194507882904747; -0.23830068142756422 0.0529542437812763 1.7091213551128568 0.4903883207121198;;; -1.111798189037099 0.04273213248214367 -0.2927912319323204 1.5063411598326646; -0.6366901529768366 -0.16092217139255757 -0.35644551934261226 -0.6716794035167485;;; -0.293747205732343 0.060683162992905146 0.022537400362926552 0.709198384023709; 2.1446376464621704 -0.24506338619262083 0.33146636084617326 -0.27105565385309033], [-0.9184017802749357 2.2598179150151894 -0.03691020823766939 0.22091739087352547; 1.107293484211757 -1.5942270221032127 -0.03341083058732469 -1.0929154394729759;;; 0.5703084677976008 -1.2688093690364641 -1.8306222495746078 -0.5222598917281792; 1.8782758732037315 0.09079376095222538 -0.02444130068252845 -0.49956161977115576;;; -1.0780939383019925 -0.8575226283242757 -1.392366211416594 -0.24775229594732223; 1.121876598103229 0.2838527206889237 -0.9064254963129352 -0.5449125126360475;;; -2.0664065211669267 -1.1775849973380474 1.2499160127383984 1.686713311998077; -0.19571609090473047 0.3487258657453945 -0.03024871595489602 -0.8630789393980802], [-1.5120374094635032 1.413449187330421 0.1509507757970912 0.11239704808480774; 0.752378486445867 -2.367713678107056 -0.13874973566152796 1.6527210979122215;;; -0.694083369141241 -1.914960683544026 0.6818425514620393 0.34209870537049614; 1.720973003986492 -0.43478408280452646 -0.24517051912751034 -0.00012765901044406233;;; -0.813870594544791 1.1052215596730928 -1.3664135030104951 1.6457405555389217; 0.21287457863123918 1.9419386016713616 -0.05589413171846204 -1.501573882176359;;; -0.6725040408755583 -0.7515530782394002 -0.49410853062692983 0.3459352454974829; 0.5035355588493459 -1.0665100400253937 0.6874896992131914 0.5814265795800729], [-0.12306880475716349 0.6449301451120296 0.9749276409113614 -0.32686686923580816; -0.9358782097500156 -1.0110606176468944 0.06836574954994745 0.0021169845644741178;;; -0.8765391316691605 1.3637257471872393 -1.0787617283951916 -0.5879741497369261; 0.3374163949939578 -0.45642651565301695 0.596313548076932 0.11081987844757418;;; 0.48082692996190624 0.5583863944825894 0.8856586833015763 -1.3592233651471675; 1.0001087136457723 -0.13374570101687797 0.26329149036557736 0.8123578839073089;;; -2.728067155157264 0.3123817886732878 0.5949722479357624 0.32142161290119703; -1.2422202813166192 -1.4406996333775912 -0.6998029451901623 0.900873546714384], [-2.2062070365782986 1.0641324613273535 -0.3704956220525104 -0.34300693209679506; 2.3180820241397266 0.3994301373199993 0.3350960954717134 -2.1149413019797265;;; -1.2257887701009573 -0.1135752958247198 0.4224275297482599 0.6715439280945166; 0.025623573049915808 0.36826440406341293 -1.4111235665578572 -1.3791372311772168;;; 0.7972172034002492 -0.009256240505613102 0.1622035651128216 -0.1852242871182717; -0.048675041957526456 -0.23994331807782984 0.5564409316003956 -0.8373692324710031;;; 0.3279430362829115 -0.8548528661433191 0.4690385644674985 -1.8406083490121368; 0.8763977388896289 -0.8815957540844866 -0.7539768671497564 -2.018739545030829], [0.6709657027230314 -0.12183755085051726 0.3948900553786601 -1.2176836883446494; -0.3917133553342526 0.44435080305288727 0.3489926325419011 0.03136700222470395;;; -1.441236468566295 -2.071947530502048 -0.27731866955901785 -0.35365256742574325; 0.14792780861971566 -0.28575843448648586 -1.8790612990475142 0.357390081600139;;; -0.6826002737862817 -2.820501887076396 0.9103299930710301 0.5964473531002876; -0.33536438482179376 -0.14616945152361543 1.0335351072755166 -0.10981161558456423;;; 0.18039882629583623 -0.47753761848681003 -1.2621736763830083 0.2123596298479393; 0.5343751999632145 1.617636624446265 -0.8400118980774587 1.6354117800682768], [-0.35299594389331557 0.6564326766671288 1.2911866719372291 -1.5883797798550239; 0.3552268471511777 -0.13274713068358987 -0.017334027799356683 -0.5424830958336729;;; -0.26799238222530547 -1.302383171480963 -0.16771324025823156 2.0715921092121885; 0.412282974031746 -0.14376662754371203 0.5642399982158698 -0.7719268302347001;;; 0.32492773446030215 0.9062374350975001 -0.3494189363737872 0.5272064985112748; -1.1268511948953113 0.6183618036269104 -0.40466274197379215 -0.6702299017171145;;; 0.4732797589611627 -0.9317530629428193 0.5080863164327586 0.6668406655890916; -1.8038045091062327 -0.5783872574642874 1.6612518330212198 0.09616352094927974], [-0.967667056756921 0.2967706115793637 -0.5831979618733757 -0.5926354052310399; -0.7350425400442532 -0.8469742834989807 -0.12053072361579983 -0.8911899306823946;;; -0.1560746204103446 -0.09037517133986112 -1.099273724642408 1.0877898558762684; -0.3854951527380747 -0.9136054703318097 -2.136294631478252 -0.5213039686133983], [-0.23666103081584278 1.4373192477585401; -0.5665411852717767 0.3198019248935285;;; 0.9503625459359913 -0.301138359674056; 0.0257149465476059 -2.1561845849248438], [-0.9708660942975769 -1.6602162157421543; -0.33209033902242874 0.20534702461040338;;; -1.9176957805563282 1.4688405640445965; 1.8970516876193295 -2.5674366798928108], [-0.12853818900008215 0.2424644320389685; 0.2514512416876499 1.7270179057170927;;; -0.11506608124239716 0.875305833718961; 0.16245629434683465 0.6174689137703806], [-0.8168752162664837 -0.2928393743460797; 0.2159471486278838 0.831909986297197;;; -0.09836509336479135 -1.0469394488135773; -0.1795323122018949 -1.0217742034855692], [0.716521677423243 0.14823055784780145; 0.9064522227082946 0.1517620311913212;;; -0.7135272779467833 -1.186845889278858; 2.517105628977555 -0.41035468371357353], [0.41421349723335704 -1.9873272331550897; -0.2760263438196925 1.227165703748583;;; 0.4136971918291977 0.010772868486748027; 1.0407664058791313 0.13981215903144284], [-0.42919903727236025 0.63248538351011; -0.5063970454106447 1.7226745035069655;;; 0.4991754478676671 -0.328986081382084; -0.7123852837469199 -0.07615254342569495], [0.8254126450930681 0.4258116149702976; -0.16561511326632952 1.3634939021343406;;; -2.245097975031439 0.7449888918821412; 0.7200447529024067 -0.7858441712268422], [0.4261826714354005 0.3330620738953397; -1.14055731929516 0.8706199541802275;;; -0.5461529825713969 -1.0355043522037164; 1.030525994535763 1.236217181105146], [0.01476930042582191 1.0269771455303203; -0.1105907028287419 -2.4700282933595945;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-184.94669194245324; -183.976776582383;;; -104.60886835925047; 105.16036051008598], [0.6979395926154779 -0.5110584253943727; 0.6981850515958397 0.5106634849329201;;; 0.11216979927046541 0.4876144557581911; -0.11195301855041731 0.4872415993784024;;; 0.008909259642251565 0.03732545005569557; 0.008784058961461469 -0.03745525222803689;;; 0.008530303480180648 -0.006120485164612997; -0.008550782435125541 -0.00602593398841316], [-0.7055387406754585 0.35609325180789014 -0.009307888311757332 0.10066171857568564; -0.7056114994217688 -0.35600081229379027 -0.015225594033082449 -0.10026350804340199;;; -0.04634265223515699 -0.6097633767923593 0.24894675706456848 0.09050263572092543; 0.046304790453171596 -0.6094798025142691 -0.24557512044951124 0.0955732316936956;;; -0.003194605907734784 -0.039876527097967254 -0.5007482920735654 -0.5285253169811509; -0.0031067782922123053 0.03992164482534967 -0.49867734602469355 0.5273394798847916;;; -0.0028145902023986214 0.000304268977740217 -0.4342955575705951 -0.44894239087867327; 0.0028182873382320726 0.00021084921616450195 0.4351543356735913 -0.45112517682615855;;; 1.7478268851186825e-6 -8.111744704220869e-6 0.0001586925498191905 -0.00046004675219880013; -2.8655704451410327e-6 5.96806696306114e-6 7.820632362875147e-5 -0.00022132897185412495;;; 1.6498519829630135e-6 3.561211204739775e-6 -4.767106028924236e-5 -0.00012311571461813388; -9.850629910454185e-7 -4.788080461958103e-6 -9.305172834331571e-5 -0.00026197913456869497;;; 8.898381652825081e-10 4.894598699149477e-8 1.0054857681430597e-8 -3.855832714252336e-6; 6.805048951549373e-9 -5.018254926021874e-8 -8.195715652126624e-8 3.735700331228492e-6;;; 2.015739734660726e-8 -1.0834717998429419e-8 -2.394877762898214e-7 5.771718117913315e-7; -2.0148041555516056e-8 -1.286111573117008e-8 2.8645263060516125e-7 8.351064404674431e-7], [-0.7067545838892384 0.2041326807940765 … 0.03276069275917883 0.16943532206030917; -0.7067789799065497 -0.20412159840518096 … -0.028005220411415628 -0.16767776604650397;;; -0.021883534825042253 -0.6763549623344991 … -0.06491011040930546 0.020132120760566214; 0.021884341829095454 -0.6762678522337054 … 0.08334850904097059 0.07479061394127985;;; -0.0010828185843626324 -0.03053604899515302 … 0.018629121004066062 0.07354649857927692; -0.0010327355958410838 0.030532299564476107 … 0.021368462330850324 -0.07616096536067964;;; … ;;; -1.5547012057363567e-10 1.319227382621551e-10 … 6.343108241794989e-5 -0.0027843893401713416; 4.96076735171856e-11 -4.445326972894362e-11 … -0.0006165468433404019 -0.0038412165976367675;;; -2.213166001046974e-11 2.7402247138455832e-11 … -0.000593107186059821 -0.00029626381911814463; 9.402528545087462e-11 2.885921981051581e-10 … -0.0007962606612653104 -0.001320617201142594;;; -5.42010056041043e-11 2.8841315341770618e-11 … -0.00047924221303037237 0.0024736168365963305; 1.235608782776471e-12 7.267518241135488e-11 … 0.002275738018939341 0.00010683877616710571], [-0.707020167957274 0.10600803028633292 … 0.06192897467643726 0.09258034926297656; -0.7070259479104357 -0.1060145019280529 … -0.05638359653009123 -0.08798978150144841;;; 0.010871314086527127 0.6989326867175508 … 0.16588078449504176 0.13225376084827528; -0.010879389647272353 0.6989231758135026 … -0.18285215247634007 -0.15685195606848898;;; 0.00029712212810986384 0.016074406631165165 … 0.10751316533550136 0.04149581573206648; 0.00027542708636464224 -0.01606525519413773 … 0.15281630582017483 0.1894903843551502;;; … ;;; -1.187434249065584e-10 -8.253907038679693e-11 … -0.32517857368300773 0.05496490006268846; 1.269939252382972e-11 -1.3107571334560104e-11 … -0.28733850505584685 0.1341274275309095;;; -7.542128373094797e-12 -1.169243418685469e-14 … -0.016808947693240414 0.0956576900713295; 2.7083712800453603e-12 -2.5322934976387038e-11 … 0.08522020356655738 0.08593140982303459;;; -2.2211294694919965e-11 -3.1982829634382545e-11 … -0.10566377130639415 -0.025418261987504583; 6.524446731813555e-13 -3.2835959263983396e-11 … -0.08112311501560276 0.004456611575274867], [-0.7070849954877289 -0.053296478300028614 … 0.05406089611192678 -0.12534174175284712; -0.707085813944684 0.05330124863151968 … -0.052349632111339243 0.12596239553339117;;; -0.00549529241753674 0.7050720565810836 … -0.10386142606234881 -0.049142004109027464; 0.005500185278427882 0.7050727142621375 … 0.1131079448086971 0.030764333423359668;;; 5.979670258208589e-5 -0.0055869795942319386 … 0.2007398597908175 0.16015670938808088; 5.336124614912025e-5 0.005582195590443945 … 0.022971292791007958 0.08884196309392187;;; … ;;; -3.0058758976300582e-12 -1.7551038414352875e-11 … -0.40240651312962855 0.03376601651036094; -1.908297809926745e-11 -6.137828069667456e-11 … -0.0319329401874462 -0.061387123678881245;;; 3.551295684110205e-11 -1.9228465095591865e-10 … -0.018762502397031276 0.5032841570723297; 1.3281782035695627e-11 -1.0717985158727944e-10 … -0.08620718609714005 0.32646378102775897;;; 8.170061527743451e-12 -2.2679122045812136e-13 … -0.2089717776092833 0.19688525187318587; 1.13564325487615e-11 3.735137523429332e-11 … 0.04822087132708845 0.207627428564183], [-0.7071012880603769 0.0266103379693075 … 0.02553957332079197 -0.01086835066369999; -0.7071014108515258 -0.02660579292314131 … -0.025655191293243767 0.010869448344896393;;; 0.0027737944251516825 0.7066040044755112 … -0.01610353103141099 0.0005167739421468933; -0.0027692523864494 0.7066045060091584 … 0.013402328505494322 0.00020176315047205494;;; 1.141246654982483e-5 3.743458537059747e-5 … -0.03580727463117632 -0.02534692490829252; -1.1844917788266129e-5 3.622625583182105e-5 … -0.06896678398306888 -0.021986020111409495;;; … ;;; 2.0528214519427376e-11 4.923801613366955e-10 … 0.14395907104627784 -0.17407675295977393; 1.2224871690194672e-11 2.021058961669444e-10 … -0.0519868798457087 0.1071948870318658;;; 9.183292587695973e-12 2.1037170761022774e-10 … 0.10590479412606292 0.060142624089659945; 4.627110991880159e-12 5.3441863189897586e-11 … -0.10180271475540777 0.499541222030058;;; -5.614912291049394e-12 -2.767865264714722e-11 … -0.0316821367574676 -0.07938539224695486; -1.840688960845769e-12 2.3224957300946912e-11 … 0.10778985455687223 -0.05144565675556164], [-0.7071053828603104 -0.01330391048961778 … -0.0937040640322494 -0.018108704713023702; -0.7071054459552136 0.013278363136862195 … 0.09388595976127127 0.018232479215278558;;; -0.0014029956627632776 0.7069784274373763 … -0.048015565586130744 -0.03140649029450363; 0.0013774570646698555 0.7069789681702556 … 0.044426586671409814 0.031079282150132993;;; -9.459911869483998e-7 -0.0015225658939694699 … -0.01993520658685424 -0.010722999947648946; 4.476619306979551e-6 -0.0015207398544973881 … -0.003043186066512095 0.07987760780470182;;; … ;;; 2.600214238054553e-10 -5.370546779670873e-8 … 0.28478445543081876 0.03869558691023763; 9.325398352822969e-11 -5.103231264245331e-8 … -0.6634323751411262 -0.04191319685607629;;; -9.62502955860688e-13 -4.727972132866318e-12 … -0.0007138952149051279 0.03455812409034636; -9.720271370977966e-13 -6.789594862874145e-12 … 0.12478295781034711 0.08611688860751789;;; 8.241859677584694e-12 -2.023187268473959e-9 … -0.00995277957265854 -0.026763253973085044; 1.4132125516702475e-12 -1.9459129704969955e-9 … 0.15618732012268763 0.07266392917486339], [0.7071063990953231 -0.006704666558784047 … -0.03876287152718966 -0.0009545354497627958; 0.707106478051188 0.006625750711054588 … 0.03876752419290499 0.0010426716194989502;;; -0.0007343107505016916 -0.7070398557974532 … 0.0028188383090054494 0.04532450404994647; 0.0006555040878600792 -0.7070406873263865 … -0.002140564334436797 -0.045289069427175754;;; 6.078550139208385e-6 0.004554723303543052 … -0.04866121389735018 -0.05345769374459679; 1.922145005825035e-6 0.004552178795306005 … 0.05551451402351695 0.045910723504770865;;; … ;;; 1.1232407632100576e-9 1.007253415632537e-8 … 0.18797377706250115 0.035959149750405796; 1.107490450378822e-9 7.666879929538727e-9 … -0.03241033699305265 -0.4448052462654843;;; -4.2003508787658846e-10 1.1193991632436699e-7 … 0.6118531639669885 -0.23142664274386265; -6.258558364665203e-10 1.1422790504337834e-7 … -0.30578393973156065 -0.5004681419244181;;; 6.849319805793236e-11 -2.7133707783275562e-8 … -0.034858832963333135 0.3101483827915622; 1.1773645433583678e-10 -2.7685236630870045e-8 … 0.3502417306832411 0.10965866850778289], [-0.7071065964720258 -0.0035426158609691786 … 0.012850602562042481 0.018652094231517168; -0.7071067583728938 0.00321028304250897 … -0.012850512077801636 -0.018652008957518666;;; -0.0005086171820488651 0.7057034331380133 … -4.026013126744773e-5 3.979075935111575e-6; 0.00017933351287509374 0.7057051579293042 … 0.00017654400469243838 0.0001914225958302699;;; 2.2586131561288153e-5 -0.02002078316661435 … 0.000480524372209141 0.0006378631832187048; 4.296615432130908e-6 -0.020019932851710998 … 0.00023290236790014766 0.00037499158669040245;;; -2.202443850145334e-5 0.019307392492996855 … -0.009187090983254848 -0.01313631577688213; -3.834537296647002e-6 0.01930583923885619 … 0.008517908997460915 0.013513660727587916;;; 9.245582636905065e-7 -0.0001628571111862856 … 0.23254115308997803 0.3316042252088694; 7.456188384860078e-7 -0.00016196946009385964 … -0.20927799131519392 -0.3378735103133772;;; 8.954521070842723e-6 -0.006974965106146045 … -0.07373449331108428 -0.10169909977600547; 2.194561761754133e-6 -0.006974021390906931 … 0.05416147935944364 0.10652921538017758;;; -3.8576502291824505e-5 0.03386672545678785 … -0.029850712931009753 -0.022417214508983097; -5.751687269957479e-6 0.03386535272746641 … 0.021111916441608064 -0.008576729092945493;;; -1.0685202314524353e-6 0.0009383961352583998 … 0.7573310969092308 0.370225475815204; -1.5912849047963735e-7 0.0009383582974601473 … -0.564253822051041 0.7845345049608133], [-0.17700119823095364 -0.1417276522163044 … -0.1371342349409015 -0.0988816017066733; -0.9837108973179819 0.005094106518089201 … 0.00513812333774838 0.020151521595566574;;; -0.020030159896020455 0.9898245670307096 … -0.029595774662781495 -0.014890912474601661; -0.008008760174643375 2.2387868638877814e-5 … 0.03350476463545392 -0.24138514096903246;;; 0.022388990882284916 -0.011095155812386756 … -0.8673753842584059 -0.0073047419647069125; -0.004102653018899507 -1.9115433002983054e-5 … 0.02971489586294413 -0.062049534754728505;;; -9.806521052250792e-6 -0.0015346377839719563 … 0.13338299572284382 0.004238560599817327; 1.8264307974315159e-6 3.930854229923265e-6 … 0.035119992328905975 -0.8101491830191672;;; 9.022615699387286e-7 0.002737031555439627 … 0.2315451372041339 0.24368173718432384; -1.5810015785171498e-6 -8.325294828892163e-5 … 0.17648399046313998 0.019206767073643435;;; -5.58278229616589e-7 -0.0012804237687951982 … 0.20078636958890383 0.026536108373747626; 1.8367610797122792e-8 -6.966392299673202e-7 … 0.11361186732107963 0.03831669229502557;;; -5.416614169965464e-8 -0.0001459852758071359 … -0.08611215912619337 0.45356248276489175; 5.350793945118706e-8 1.3769975538993438e-6 … -0.05700506278626518 -0.011456044604148041;;; -7.11294044623009e-8 -0.00017784513887709718 … -0.21962501060159167 0.05505068953761599; 3.7695729738139396e-8 1.2323256684609477e-7 … 0.10019607789672906 -0.01618280761396494], [-0.40887202725523725 0.2548153252232478 … -0.012467560374609318 -0.029740793376022256; -0.911456139663251 -0.1298178212781615 … 0.0005643568518605603 0.0005686895940617629;;; -0.015319786560288502 0.9578124420651292 … 0.0026571059330803707 0.005941236462058881; -0.018551965941662082 -0.001271048350468978 … 0.04329530891562304 0.11490279093989003;;; -0.012796987980653256 -0.0281516682350419 … -0.044651518738257547 -0.11970597990018936; -0.036451838902648824 -0.004204273702134555 … 0.11825673348667091 0.3004207129157243;;; 1.8686896629753743e-6 1.5613224396102897e-5 … 0.009609078813759253 0.025522665144638555; 5.781170100588419e-6 6.710356398360022e-7 … -0.013251241980868854 -0.03231607715504021;;; 1.1792624904993156e-7 -1.0370504459327657e-5 … -0.0005564453639319461 -0.0012149828926759257; -4.494078811406961e-9 -8.815506090905967e-10 … -0.9513214281677254 -0.050315586341930035;;; -3.334361195945036e-7 2.9278006414933465e-5 … 0.005197451418174871 0.009624514444365918; 1.1672757251647324e-8 7.05488318343223e-11 … -0.2749031816171266 0.3341761598317854;;; 4.837113233327394e-8 -4.1534867805590985e-6 … -0.019101358666959098 -0.03569510918570755; 6.694910013514224e-10 -7.157605492282325e-10 … -0.02720133155525283 0.1399889402424742;;; 2.083881324088906e-8 -1.8122257964564023e-6 … -8.537914691278997e-6 -0.00019697430556327373; -3.263308276770873e-10 1.012466838161583e-9 … 0.00019494145331387758 0.862802872036345], [-0.5239297256255687 -0.417714699463427 … -0.09280700862359985 0.06491668625183769; -0.8502962865392106 0.2790858397502227 … 0.045269685272161055 -0.027929591294949353;;; 0.021705810083536975 0.8642960678263187 … -0.0655617312088088 0.032710027426287265; 0.018895821006437743 0.014243707401880079 … 0.0018017707079813446 0.28571509055791433;;; -0.015150232875122162 0.018867013371978218 … 0.21941260434163315 0.21598935387256665; -0.03789648334854556 0.007680072837358971 … 0.14295881252407072 -0.19597043834236283;;; 7.848381627058453e-6 -1.0622343537427988e-5 … -0.050290578454571744 -0.07224253823412442; 1.981663875690651e-5 -4.141241949056307e-6 … -0.0249023583266022 0.0402398768401857;;; 1.3481722168867031e-8 3.8784031553672326e-7 … -0.3059597474451006 -0.012054901090574598; 3.550550135574746e-9 4.225667989435822e-9 … 0.07257371813957637 0.7533610374360974;;; 2.39641309662243e-9 7.017666193274349e-8 … -0.14039758338252903 0.1516217992957572; 5.84657674344353e-10 7.443267996713491e-10 … 0.0860155540851786 0.44633945416768755;;; -1.0436778368307301e-10 -1.20624799921975e-9 … 0.8870044528148392 -0.0999459529172142; -1.5672872756871279e-10 1.3109628470146438e-9 … 0.0006072213117702989 0.12348319591811997;;; -6.742614857214636e-11 2.0311833630170303e-10 … -0.023276713211323973 -0.0008116316474941728; 4.0752471784845037e-11 -3.967410382155611e-11 … -5.4960181299218655e-5 -0.07255655408245719], [-0.5892236769774193 0.5838117401623801 … 0.0801798518076673 0.11397592072327306; -0.8072282287525389 -0.432680551819467 … -0.04883096846333645 -0.07098359915601071;;; -0.011614272049199846 0.679570896988577 … -0.10864487324879327 -0.15206589649431776; 0.023131996043689085 0.0996633038692991 … 0.011263732949001494 -0.0029721696502090196;;; 0.008593476071729755 0.00908038262359566 … 0.34052366518626886 0.45497108864102853; 0.021312134981882207 0.010933514235988264 … 0.15807203026268962 0.2007224196466922;;; -3.3155885721642795e-5 -8.42292586037742e-5 … -0.11485284173495741 -0.16079591485679728; -9.096250233547294e-5 -5.238462403635376e-5 … 0.027292196529834303 0.2771656353934625;;; 1.2931209576143734e-5 -9.496991196931004e-5 … 0.6065585476273792 -0.6015400660239144; 1.2994754836050293e-5 -3.691926859686761e-6 … -0.04279253551312326 0.001341189101041861;;; 3.690368890397234e-9 -2.981401145733771e-8 … 0.052732731275358276 -0.32348297342153964; 3.1370460206419055e-9 -1.5523606990404767e-9 … -0.07636026275249393 -0.036020472454041;;; 6.535632401441606e-11 2.7146256931194634e-11 … -0.21213205802077878 -0.0737525251376161; -5.2653239001498867e-11 -5.499419927026247e-12 … 0.01571523918027642 -0.12061040763304459;;; -1.7769588378898226e-10 -3.5035384939122235e-11 … 0.6330463523418667 0.1977242146028705; 1.396580076554049e-10 3.898932550036482e-11 … -0.005119443693495799 0.2863590783749491], [0.6558819807952735 0.6295621609418286 … -0.07182181312595642 0.18268551276075223; 0.7540441593892947 -0.5465923222487132 … 0.06232197552676893 -0.16760229523077821;;; 0.012594042666081237 0.5058905785921004 … 0.12691522667969546 -0.27718593865788926; -0.03185120812744543 0.22087619804989908 … 0.0785433848100589 -0.3032467012844394;;; -0.002526997883356475 0.008050967939640743 … -0.20891466818099283 0.3168322776683495; -0.00752219873987484 0.01052967372981611 … -0.026518631844635095 -0.14898458382739163;;; -6.058117106374509e-5 0.0007483409694777992 … -0.09358281197723065 0.10700083712349001; -0.00033592510043567236 0.0006050558017314905 … -0.485458591151367 -0.42688748121003256;;; 0.00012095674891965533 0.00035574851869802927 … 0.21689432386594276 -0.6124082295437959; 0.00015248158559188547 -4.022949626291411e-5 … 0.6166396244903077 0.05645271140584648;;; -3.517400157010577e-8 -1.16462099968339e-7 … -0.3019201646141473 -0.2028972925732475; -4.0685561722326404e-8 3.5033334528412025e-9 … -0.32602382976820565 0.09275692021301998;;; -9.143462769444941e-12 -3.241976607470484e-12 … 0.1764629941506095 0.09532299915196421; -1.0697048537052988e-11 1.3820181701207765e-11 … -0.07963980640152203 0.10198155328787104;;; 2.0123488472346602e-12 -2.4444304391726874e-11 … -0.0162382473803409 0.05768786320332092; -1.8164066949875282e-11 2.2461439734968075e-11 … 0.13200163744594828 0.05164457109091694], [-0.6928887706855877 -0.6212416570992699 … -0.09120180167940857 -0.17850206831610227; -0.7208395461098304 0.5961050668340372 … 0.0865382002906635 0.17417526497963914;;; 0.008939473513697926 0.40936418119053286 … -0.20456358803221342 -0.31295504920797934; -0.014597850607329082 0.30179088067203885 … -0.08958269315886891 -0.2892117579248818;;; -6.339153729125999e-5 0.004447575086610042 … 0.20901214465080997 0.265854863536553; -0.0014192771303914 0.005126518971772057 … 0.18002278025279547 -0.17741351751124357;;; 5.827054296946208e-5 0.0026625817790608577 … 0.330912268335347 0.39518328359089394; -0.000675907334380845 0.0027584817022838644 … -0.0472502305717852 -0.22561746212278097;;; -6.464436487765539e-5 -0.00013416476584892728 … 0.7257167275412909 -0.030236578033907297; -7.747109512994699e-5 7.480993554197468e-5 … 0.34958188020471087 -0.433998565693289;;; -1.1203838360158437e-7 -2.690330792810028e-7 … 0.05505595192862829 -0.29709193648618953; -1.2350802862739314e-7 8.889029564583936e-8 … 0.29526981676205327 -0.35068930027534023;;; -1.5345194103682672e-12 -1.3381443979322212e-11 … -0.07846602722106426 -0.09908648835856712; 1.3436960876714495e-12 -5.9217277546528235e-12 … -0.01480200222796682 -0.017970344819285517;;; 6.105511398944416e-12 2.2204015762608247e-11 … -0.014339011368800069 -0.15761159100528083; 5.5333092757826736e-12 4.763227272097443e-12 … -0.028687158699515304 0.10719218538724237], [-0.7033109759923936 0.6164436689045252 … -0.010419665714979192 -0.08664939556784257; -0.7108609799498353 -0.6094533505826041 … 0.009975976472411524 0.08683313661994965;;; -0.003219931552026644 0.3679883850597677 … 0.04957790005180962 0.09159826595670098; 0.004458333029699732 0.33636659413829767 … -0.015694694562071065 0.21345121370690748;;; -9.958194185685186e-5 0.001470245399427866 … -0.05392171070999436 -0.028003779374036916; 0.000256025301114157 0.0015317256875402908 … -0.17478663532284186 0.6320574892462696;;; 8.575571036115962e-5 -0.0008490496633209619 … 0.2285905705377375 -0.1387082737389272; -0.00010229544899344779 -0.0008061809115779271 … -0.10139955825735981 0.2602913282745997;;; -1.0367210406122656e-5 1.5877367924349435e-5 … -0.20367105382450137 -0.2470845332132016; -1.22029024998207e-5 -2.1644373814508768e-5 … -0.01872041369128719 0.028578994033522574;;; 4.78316031893633e-7 -9.682341207730525e-7 … -0.221680577356956 -0.09603555366562855; 4.962053163298427e-7 6.75125643974524e-7 … 0.09545611670959614 -0.27298619791656115;;; -6.088041519085993e-12 -4.712373413980328e-12 … -0.2833719557673975 0.1336650122439563; -2.004209603177058e-12 -6.68617561872508e-13 … 0.029700637224013893 -0.4705156854580298;;; 2.1933775032600192e-12 -2.790283595237941e-12 … 0.8442591420803451 0.21386624788247022; 4.899150460463635e-12 -8.467877660073674e-12 … -0.08397849676791623 0.11456809549619391], [-0.7059380461756499 -0.6181658674437904 … 0.1325659826182716 -0.11542976527437862; -0.7082720874718699 0.6159921463482172 … -0.1324056035373161 0.11503434289822823;;; -0.000865534874063021 -0.34953360752787155 … -0.19473760523509667 0.253293959436324; 0.0011710918922519312 -0.34095544184258914 … -0.279582678924498 0.1579734095201456;;; -3.3540567079853684e-5 -0.0003940976402022922 … 0.1444323518333751 -0.3148572742792815; 5.607745288664433e-5 -0.0003322377592981688 … -0.6501517264870305 0.016374204730180374;;; -1.270197092648592e-5 -9.11274762813934e-5 … -0.059328195225994244 -0.8622698049281271; 5.667189871795762e-6 -7.649943686308253e-5 … 0.6338201643195899 0.20351217900265894], [-0.7067038969608964 -0.6328080023882212 0.06801099384246274 -0.3090277315230338; -0.7075093491849777 0.6320318135382857 -0.06748916405981235 0.308887552720828;;; -0.00017633298776633353 -0.3174766644640509 -0.8240802757989373 0.4691484151807458; 0.00030289075504702154 -0.3151164646757051 0.5583112183094799 0.7674569078829504], [-0.7069813424492457 -0.7072321976753195; -0.7072321976753195 0.7069813424492457;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^cores, 2^cores)
xes = collect(range(0,1,length=2^cores))
yes = collect(range(0,1,length=2^cores))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="bb7b3c6a.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this exampl we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 8
h = 1/cores^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,cores)
xes = collect(range(0.0, 1.0, 2^cores))

u₀ = qtt_sin(cores,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393110550548e-5
Relative error for implicit Euler: 4.831411742733416e-6
Relative error for Crank-Nicolson: 4.831510179825377e-6</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 29 July 2025 09:41">Tuesday 29 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
