<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets.citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Quantics tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li class="toplevel"><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li><li class="toplevel"><a class="tocitem" href="#TT-cross-approximation"><span>TT-cross approximation</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in [<a href="../resources/#FastandFlexible">18</a>] where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^d)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, d)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(d) + id_tto(d) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(d) ⊗ qtt_basis_vector(d, 1) + qtt_sin(d) ⊗ qtt_basis_vector(d, 2^d)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[0.03823937196330134; 1.6744359976661887;;; -0.21195577190968903; -1.282304607616261;;; 0.022388213837234557; 1.6917171012014018;;; 0.21070402397374174; 0.14667153350661574], [0.2683150336810003 0.23071192564861526 -0.40274619485693963 0.015327555880034621; 0.43966304165252595 -1.2052954966070357 -0.6353870359139588 0.6849453008418959;;; 1.2841896141397513 0.3312016864154763 0.8903508355782356 -0.03790141800524233; 1.0920572071092869 -0.24904809626573043 0.06430843795944743 0.2726799969410221;;; 0.7750232710257132 -0.32108178051079617 -1.3548080583477937 0.9664143119313893; -0.3067180845740224 -1.3733765261809667 -1.532534193323018 1.8207384049764603;;; -0.08075034333841624 -0.6204025218142823 0.8543235438914597 0.4717753194911895; 1.0751110811426754 2.4142656638253026 -0.13957143550319737 0.060084913523670964], [-1.4492529357778994 -0.2764240070762379 0.936308159093935 -0.8660965074159345; -0.07856139761140245 1.4382225732991503 0.5123828621430556 -1.352395033140231;;; -1.0390175234426475 -1.1910086437468046 -0.5465066473609177 -0.5292120025085558; 0.7673126365617803 1.2211801065685337 -0.46743127020885084 -0.04579623910156184;;; 1.5264458806130865 0.5364465437095882 0.4750898543897496 -0.3206184016826223; -0.9120820610429023 -1.319712888002145 -1.6983045857313952 2.55279727174481;;; 0.054803736174342185 -1.2434758666094001 -1.1316630526486042 -0.22977000484689014; -0.22443506576619038 -0.11462279045713988 0.9275495538185651 -0.988757649411437], [-0.36056624068771614 -0.9192793775602895 1.0044094134868937 -0.17103918325574996; 0.33854244038437886 -1.3384727054635832 1.1872025037995273 -1.3334076691877095;;; -1.1995903037606297 0.01941329372097549 -0.9619421277097021 -1.5193816255271924; -2.185262358760518 -0.04700876733857674 -0.9519378357551339 2.489037974392549;;; -0.24081780551356105 1.760122638542924 0.42767919750051986 1.2909475083878927; 1.1217189256565054 -1.0929683791730043 -0.4672300332670592 0.2950161482640592;;; -0.27603562571919393 0.16404029490451713 1.259810204574879 0.6329791967007418; -0.8012444426920631 -1.5156903692958354 0.17978044136073595 0.7721463089969145], [1.1741702150821458 0.654882157202911 0.903283533951633 0.6196447844554223; -1.3446815977866773 -0.7563914377476133 1.5493594703298466 -1.1890118600554036;;; 0.5420566788810735 -0.9358328474671119 -0.6939491840634952 -1.5497206910146346; -1.5975480671210531 0.47976479701781616 0.2949172004321427 0.8193333182187315;;; -0.1427340459969516 1.1193418208190633 0.27810328481609575 0.4230612080589392; 0.4758648326475375 -1.3381130600279867 2.0001718187453115 0.0515286692783789;;; 0.38404639385748063 -1.0792621082898126 -1.4396335068450832 1.7130878128823106; 0.21741916165782685 -0.6772065548415964 0.3976365391736277 -0.9260984848779117], [-0.5884142738078517 0.5894800566068681 -1.2580413196266456 1.2116039314696323; 1.6372872232344584 -0.942003943679086 0.04031853116594338 -0.3762508832338968;;; 1.7376298641959622 0.346847788755015 -0.3979697474383741 -0.015768141564747568; -0.7870235506786358 -2.1494060799528687 1.1261514216064774 0.7216754571157;;; 0.09304711638440516 -0.5390188597278538 -0.12593828703676546 -0.8641745482816097; 0.9501291932700094 0.15005359384420597 0.137514503980773 0.6091427682699956;;; -0.49797176220022016 -2.8741454458413753 -0.5411294789422383 1.3438532389688018; -0.4048837455477582 1.3793191561657596 0.14777981900838874 0.6129655475038934], [-2.5651284325283807 -0.14597170271353302 -0.3198932321734328 0.6505837456276854; -0.3683044080919835 -0.9633571309381558 -0.40184253099830425 0.9790566272523907;;; -0.3172075848895868 0.5962550004864771 -0.7214799341712305 0.274822461537511; 0.16608997727544816 0.1750120744723398 1.0192228860133834 -0.21985292270213577;;; 0.426159064489923 -0.4372962450899219 -0.005760695459658549 0.5368102759995644; -0.5930053702450936 1.337824586658212 -2.1189692999754133 0.5064427923920174;;; 0.04105794492284291 0.6588162928598235 -0.482354360644142 -0.8225210848404263; -0.9021540002853008 0.527057119267967 -0.9025438094700571 -1.9916335826715985], [-0.624666755051589 -0.06009843250724996 -0.3149591834666952 1.6016367482927119; 0.5860873946758958 0.06638582435432897 -0.6935180273158165 -0.4616549349492742;;; -0.8094214165425153 0.7499790411286786 -0.4885429533370729 0.685345898647611; -0.6169482091393987 0.3940939415909375 -0.1821663150917987 -0.7074095911059618;;; -0.38384801852949235 0.9646611476318607 1.5687797287655447 -0.16373876778628393; 0.5571087960847921 0.6658092984566907 -2.2591340523970533 -0.9280882856643164;;; -1.4479464655777408 0.41473887952866706 0.6023774830075974 -0.7071642860708702; -1.7663021208120608 -0.2818456447185041 -1.1341387683627502 -1.083545440900221], [-1.3683888557671604 0.737986441650418 -0.6087502783981424 0.5348606808420615; -0.4507304572077816 2.7491916867314297 0.1075675076069793 -0.7897359404677121;;; 1.8114010061024037 -0.7393315271454761 1.8171661086330693 -1.1477792048895092; -0.8279405070835619 0.5134116836253007 -0.7264599111247635 -1.2455943645923508;;; 1.691469146356485 0.20169016607694037 2.7805942786966704 0.22177139648772395; -0.9018358556859001 1.174229526944157 1.7525464874516865 -1.455687071503282;;; 0.10366291838118906 1.9121474018577853 2.0098661139623335 -1.2885066505580243; -0.7688735798469389 1.3764715749730247 0.5692104604576728 -0.42744294672394595], [-1.4270732558875765 -0.3652423308771882 1.7372280579638149 0.9565998972929615; 0.14021568667901305 2.240789186660741 2.0572242295662746 -0.325021632382573;;; 0.8947426512394787 0.7420930414313025 0.035735132260810716 -0.003860348107498993; 0.8904711035832475 0.7844636528778403 -0.7006876354471117 -1.3997218004948908], [-0.4352450990094105 0.4495424358363444; -0.011803126686466764 0.041553421358370396;;; -0.5120448462577554 -0.02255145154142618; 0.10681442496399907 0.621402515680911], [0.2607860275200416 0.5494432725659985; 0.4499227432598943 -1.024838824349698;;; -0.9584662395966145 0.8523345256623343; 1.9765811409337284 0.91643457499768], [0.1964707599320306 -0.6820339206741503; -0.406762761230319 0.6546817085038374;;; -0.5584338492080555 -0.023855122525619773; -0.9441885092743941 0.6590053361836897], [0.12913934396708707 1.7139904832883928; -0.7084082695613716 -0.437885764049375;;; 0.2636700546240833 0.054555128670459974; -0.6861601223300996 1.1853322647215576], [1.5933019743985553 -0.8899488701409458; -0.4230808045143478 -0.8524142226072551;;; -0.22424482075550964 0.7272452301404099; -1.2612576189377704 0.48173675486099354], [0.7888961112683541 -1.3898008302172293; 0.3354660744830621 0.03898599472898356;;; -1.2904162707579532 0.8341818285716732; 0.6401543974184433 0.900882406823512], [-1.8002029760044675 -0.7548106123021192; -0.6864791179056248 0.9510796145778709;;; -1.3907232006100152 0.3126705967437402; -0.48617874701369745 0.5609986343268897], [2.384497352852094 -1.8534755987576539; -1.3661605323842567 0.8878704571195257;;; 0.272554430817452 0.11051067161531176; -2.14096485321886 1.120003696822432], [0.17640904733719184 0.23679229539012128; 0.8362350468868229 1.1415136837984245;;; 1.0150198745930086 0.4691699896228377; -0.6933529133526262 -0.02184909571617702], [0.4505191256135625 -1.2362864157847027; -2.052374779569601 -0.0009719675841206197;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-185.65903200202578; -183.55367249985727;;; -106.00454719562154; 107.22041870432993], [-0.6970773355822105 0.5036161809552524; -0.6981339981893304 -0.50206704574747;;; -0.11497132728743467 -0.49565019571736896; 0.11415011073189534 -0.49448121120758276;;; 0.010946934546612445 0.04461566532113274; 0.010600904096484414 -0.04501515448496815;;; 0.010250629201585622 -0.007261949398895496; -0.01030363861888824 -0.006998676163754766], [-0.7053612025355129 0.3454387342283212 0.003837487398347627 -0.11466559590886073; -0.7056003183803977 -0.3451877424047851 0.024980688119412193 0.11369059293862487;;; -0.047707734282459655 -0.6156511159124256 -0.28744419435613044 -0.09739922093537051; 0.047616004916130876 -0.6150351462960384 0.2757520137088636 -0.10944350095841014;;; -0.0038470513702278026 -0.0459169083869443 0.4935886685298061 0.5262734556495917; -0.0036357019327249154 0.04598386958146131 0.4892309511475456 -0.5247554290488403;;; 0.0033491321087816286 2.5373890408229393e-5 -0.42221249790697823 -0.4441602669747164; -0.0033491128145127077 0.0002532220183638304 0.4236166073196439 -0.4503613732254592;;; -2.348805124725568e-6 -0.0001286149639424051 -0.0019227465571016976 0.003015903633093136; -1.8277100835280702e-5 0.00012216729569185442 -0.001665592168477891 -0.0008619491088071964;;; 2.47787063927342e-5 5.11181875180864e-6 -0.00012438012307653518 0.0026982153121464358; -2.222844002154494e-5 -2.5778321005190978e-5 0.0005417769882395568 0.0029718604057756446;;; -5.327900456573375e-7 3.882478335571869e-6 -2.4950718110288923e-6 0.00023166792262032052; 1.0815697732615135e-6 -3.0729421897680555e-6 1.259385652585014e-5 -0.00019362549044492602;;; -2.9908221217202104e-7 6.656330993558424e-8 -3.287357361074801e-6 3.853198938551999e-6; 2.8632255058398684e-7 2.501230423091277e-7 3.2315053703962324e-6 1.5306016448743306e-5], [-0.706715550560805 0.19602145031290455 … -0.38176872422021507 0.19776867006548118; -0.7067633506058161 -0.19601444159674133 … 0.3841362546096591 -0.19173495535484675;;; -0.022734142679462603 -0.6787748350818428 … -0.14017783810856246 -0.034283104887261884; 0.02274835040824543 -0.6786676341306638 … -0.06794612382638338 0.1445476034712726;;; 0.001144620558362041 0.030139906118017975 … 0.10299084670068163 -0.017357830800217373; 0.0010483183486097731 -0.03010013347875022 … -0.18466057091391203 0.029690484373113623;;; … ;;; -1.843023115913284e-10 2.849333342020991e-10 … -5.7514907220075355e-5 0.0004651719126242937; -3.586860879578753e-10 6.68010658025503e-10 … 2.3157973253230824e-5 -4.352233545872863e-6;;; -2.1219854314537218e-10 6.618287510726012e-11 … 1.2941004262564987e-5 -7.229336268776386e-5; -6.79654821913999e-11 -4.5925223769360945e-11 … 3.80187110421878e-5 -0.0001656672016934109;;; -1.5402975557026905e-10 -2.0106750204066327e-10 … 9.311888260293125e-6 2.559330856704251e-5; -6.292362051348468e-11 3.6379362256174596e-12 … 2.1791359766197795e-5 -0.0001597624999981463], [-0.7070111819961292 0.10130375876136563 … 0.10193124894509452 0.024782658719866416; -0.7070188096879896 -0.10131301236910532 … -0.0987693395720767 -0.034581324918976745;;; 0.011381635201738162 0.6996609323184665 … 0.07933895425807103 -0.29760052482391036; -0.011392899241533054 0.6996550309343963 … -0.1106463777694469 0.28997794769771446;;; -0.0002949245978905432 -0.01447959432831977 … -0.13512387715301025 0.1757158606085671; -0.0002590344067696074 0.014439649115580563 … -0.00439502427914642 0.13201326728269763;;; … ;;; 2.4818511573184974e-11 1.0496616170898913e-10 … 0.10614607563319692 0.1000487548174323; -2.943462183814879e-11 1.7253973964504355e-10 … 0.03625649709528036 0.36117833952097345;;; 5.178215877025197e-11 5.3185701350127006e-11 … 0.10192519605940936 -0.14134477391497796; -3.545092782648759e-11 2.3302222790560976e-10 … 0.16236486093105584 0.2006942537104678;;; -1.9352190977461252e-11 -3.767164022024036e-11 … 0.06643255510790776 -0.40978599546217287; 8.134457100300338e-13 -1.0244866157607879e-11 … -0.1297271954885398 0.07203606137443384], [-0.7070828178563057 -0.050870935729030065 … 0.037038589257210736 0.07081354043351251; -0.7070839893433769 0.05086198629636459 … -0.03603835921591413 -0.06985013276481974;;; -0.005753720659480202 0.7052534245634278 … -0.05879433905057018 -0.055460301848522214; 0.005744892315348266 0.7052552088729053 … 0.06210477296983408 0.06293464134641465;;; 3.402525229474969e-5 -0.0003744804378564291 … 0.08830324239458943 0.012622284045300757; -3.4398701482866144e-5 -0.00036858034279828685 … 0.04580744317404448 0.14804303318453307;;; … ;;; -6.831168801773348e-13 2.943718016004068e-10 … 0.09956546957660108 -0.15360432356805356; 1.412291746409359e-11 2.451865151938894e-10 … 0.18217362791093647 -0.003651138923487502;;; 3.058536192387759e-11 -9.913360183734886e-11 … 0.09823947798935154 0.19933211237820628; 1.9502960358180582e-11 -2.4682235946439723e-11 … -0.07890808186994215 -0.23701594862722883;;; 2.376159835680545e-12 -1.7226920140769316e-11 … -0.12733487598772053 0.379143336384311; 6.17268744429617e-12 -7.947254882487626e-12 … -0.05727744439702207 -0.02612560649581208], [-0.7071005134678804 0.025458980566249678 … -0.09246185520229394 0.08134216778327608; -0.7071011756311136 -0.025333028674565446 … 0.0920408420389502 -0.07998162493948183;;; 0.0029597728265012397 0.7066435479071637 … -0.04802105441525197 0.1626878549940573; -0.00283379534713472 0.7066484167923925 … 0.054579618563667345 -0.16898841658724195;;; -1.3614438999789817e-6 0.0019205723001045507 … -0.015754382831371243 0.11296196549780943; 1.6687456850274294e-5 0.0019182471362008805 … 0.008212862321784416 -0.06597235887212492;;; … ;;; 1.3945203587037756e-11 8.477181204720303e-8 … -0.04455819075400853 -0.10639322856299792; -8.812148498001623e-10 7.619020562142274e-8 … 0.0027207102150812873 0.015879509014355826;;; 1.879802646140881e-12 1.165706505391963e-9 … 0.05652296514863546 -0.416857792754748; -2.3179769939714997e-12 1.0675531526927375e-9 … -0.104099227437538 0.4628522569459668;;; -5.491418570197964e-13 5.041213319390485e-9 … -0.26804478819301014 -0.11109913141125671; -2.513781461074158e-11 4.6982793710592225e-9 … 0.1692814136860703 -0.040910753310324184], [-0.7071049784568659 -0.012852925428321055 … 0.014543080616897125 0.05725962488743066; -0.7071055758555981 0.0125712715087408 … -0.014665123337024182 -0.05701284418033918;;; -0.001592019371814375 0.7069256939099091 … 0.03071406815237665 -0.05958882875934093; 0.00131081002258404 0.706930933737731 … -0.029641581789436478 0.06153628951571779;;; -2.5194399009166768e-5 0.008078358406689516 … 0.006598254378552275 -0.0174439475517342; -7.961134264080487e-6 0.008076622820380666 … -0.06216605457005086 0.0367433673706502;;; … ;;; 2.6593760003905225e-8 -2.6893887544337534e-6 … 0.03983148315443385 0.4713230088750498; 1.680809420932482e-8 -2.681432572783009e-6 … -0.042416413262120964 -0.41776063086620674;;; -2.6367790371752345e-10 2.7350106349806076e-8 … 0.13276779670156222 0.06738330389880953; -1.604963496826894e-10 2.7212655399652564e-8 … 0.07037635301394576 -0.21947385397345504;;; -3.161909265377218e-10 3.579508990835835e-8 … -0.007317373813812458 0.016351908068288713; -1.8516083369718713e-10 3.570429979685769e-8 … -0.06606415626891794 -0.37886836422677256], [-0.707106174202218 0.006625049025963254 … -0.07984397765830858 -0.02436595820335673; -0.7071065926407987 -0.006216928321614152 … 0.07986453883271705 0.02448824751510444;;; 0.0009243242453244059 0.7068132773958918 … 0.011120820628909863 0.06136121032329911; -0.0005176777617618888 0.7068170063175113 … -0.00943716150746735 -0.06092886046857686;;; 2.863826925425233e-5 0.011869226524936273 … -0.04842576385480151 0.06879581216416805; 9.496451758035018e-6 0.011870775977185275 … 0.009557090655338791 -0.0695473629985672;;; … ;;; 1.3883732755284026e-9 3.386957204857732e-7 … 0.038219783379876054 -0.27213476490208655; 7.095503720257274e-10 3.367780285298833e-7 … 0.10599996006981506 0.6545816999776354;;; 1.5717924191096708e-9 2.129679090794935e-7 … -0.019468397098599564 0.07447174249601284; 1.144129886674638e-9 2.1155913235356433e-7 … 0.034073049747061344 0.015665944653803963;;; -1.2142213631334237e-10 -3.234474862470908e-8 … 0.00851561671797721 0.030551546618169754; -5.764042263874971e-11 -3.231021725522519e-8 … -0.015950490849870456 -0.15156573080822938], [-0.7071063318118892 -0.003723893212224229 … 0.0010252815813556458 -0.011537174930858785; -0.7071067744626526 0.0028404367496368795 … -0.001025271321842035 0.011537121556493148;;; -0.0007810291640295675 0.6992021238365771 … -2.0003326856828626e-5 -5.007885562236354e-7; -8.004050852233623e-5 0.6992049826350007 … 3.0286904098684733e-5 -0.00012086471678272;;; -3.953840904252772e-5 0.02618250137458895 … -3.972318024163858e-5 0.00035665687147670776; -1.4523079370015558e-5 0.026184663858025644 … -1.9322754820041424e-5 0.0002696963989758581;;; -4.287941984537121e-5 0.02825471232627175 … -0.00037026276011802744 0.002908521205601132; -1.5123983002034813e-5 0.028258071273713114 … 0.0002772479315562006 -0.00295003672107241;;; -4.61009682237957e-6 0.0015622288249239934 … -0.021746157164884115 0.2085594634714575; -3.043893725627473e-6 0.0015614552278664152 … 0.01307716924402603 -0.2086413793336096;;; -2.832167566844608e-5 0.01579248322506378 … 0.007490265240934748 -0.05342675731268034; -1.2561768635497417e-5 0.015793003775958703 … -0.0018644755944845104 0.05347695091646062;;; -0.0001457787339239549 0.09660763238468062 … 0.04116769071318728 -0.03581499262886613; -4.937971284987405e-5 0.0966155492666926 … -0.042963598106157415 -0.04511930262054133;;; 8.768450874352173e-6 -0.00581096961476315 … 0.6967796803839937 -0.6753375607587656; 2.96995937025657e-6 -0.005811445597301125 … -0.7143189902419895 -0.669010200125657], [0.1769591896782388 0.14140771727586357 … 0.1422689690144271 0.1711677172350491; 0.9837196151487614 -0.005025567043148664 … -0.007267299541553322 -0.03471006277965531;;; 0.01993605182323177 -0.9898103691769512 … 0.03425868623031999 0.023513686105669743; 0.007780846829703427 8.43987056546584e-7 … -0.015029674072736745 0.21263563953823827;;; -0.02249843979666383 0.015411192594920116 … 0.8256164973641084 -0.08607780129922299; 0.004122661725954968 -7.637909787405427e-6 … -0.004043335362579806 -0.04942941245555977;;; -8.86029786698146e-6 -0.0014001814010582486 … 0.128474478304187 -0.007738693320898934; 1.6851828786836453e-6 1.3827395896325412e-6 … -0.0358168642471137 -0.6333380239630758;;; 1.1228400352933287e-6 0.00347279947064016 … 0.3009595168332298 0.23107724051440348; -2.020235208504131e-6 -2.814102115897681e-5 … 0.13425343043943402 -0.049042906971108746;;; -3.430519326802028e-7 -0.001004920964366818 … -0.07335910636943589 0.642445607662011; 4.875318799606157e-7 6.248573185718627e-6 … -0.07694506713014038 0.023409985761196052;;; 3.8345487902850136e-7 0.0008945879416545243 … -0.20670954418506327 0.019775435636372726; -1.2837411328867566e-8 1.7675037086605472e-7 … -0.007526320518053566 -0.2019220903692129;;; 3.403267620245772e-7 0.0008351607593837852 … 0.33719969283929035 0.04214564027463846; -1.0826492315180164e-7 -1.2850942832487625e-7 … -0.04967755326546013 -0.0259669664182448], [-0.4087615097931052 0.2525174306487826 … 0.07887316940532725 -0.058865339689664446; -0.9114891857700935 -0.12871702757212838 … -0.03279893168520698 0.001557714703316941;;; 0.015283970100564268 -0.9585555182241509 … 0.030150058622301436 -0.011683748305218256; 0.018957972090344024 0.0013068416735780826 … -0.03547304496401165 -0.22913765300433617;;; 0.01286258488163757 0.02861967747595521 … 0.16637010223220225 0.22930777348400383; 0.036647534262278327 0.004171175967850209 … 0.01135381050883506 -0.5749027496032831;;; 1.8002236333814744e-6 4.89814624087808e-6 … 0.027263341020834088 0.04856306238426161; 5.237966260848553e-6 5.990060809158958e-7 … 0.006243923225034137 -0.0564447348238798;;; -9.999318918064202e-9 8.980437429768713e-7 … -0.02957364232132819 0.0022233811404400437; 3.60777816857742e-10 6.10210908078308e-10 … -0.0007771675205305213 0.0959531680919996;;; 2.579329220345023e-8 -2.313360523026312e-6 … 0.16736794353355766 -0.012558028112292695; -8.919854738272776e-10 -2.523549454136281e-9 … -0.05620211384332733 -0.6563851377180521;;; -3.6617201657474233e-9 3.2332680274491965e-7 … -0.963977442834289 0.07291127504141019; 2.6808424020806743e-11 -4.853134872952585e-10 … -0.00024103222544123428 -0.15551498351391158;;; 9.825135946646603e-10 -8.770866862472789e-8 … -0.02543987947535598 0.0049359608086674495; -2.5689490377752613e-11 2.160330766948241e-10 … -0.00016647352146274813 -0.2924308993554584], [-0.52356027093132 0.41432895366105227 … 0.08976576625500898 -0.07140693747193896; -0.850476641106162 -0.27699555248288676 … -0.04562639436950551 0.03372017119304461;;; -0.021883581926371066 0.8666009071138873 … -0.06534836903011183 0.053333035326628725; -0.019916743294127067 0.013593872118428798 … 0.04814622343954128 -0.09595288125042699;;; -0.015303519371843374 -0.01911657056485901 … -0.2868820118955416 0.25574441261727726; -0.0382669536019155 -0.007590330483513213 … -0.0870540035715466 0.14454229592757067;;; -7.090767776511299e-6 -9.618887149188397e-6 … -0.06988867011162014 0.06337684170370705; -1.7897404059979196e-5 -3.6614313724636037e-6 … -0.02069880454454828 0.34254142466068255;;; -7.963054567363027e-9 2.2640900818546147e-7 … -0.17141258511486265 0.4902062966636506; -2.290978607271478e-9 8.604842693014435e-10 … 0.011557301871562514 0.05907141046583485;;; 8.553374519721105e-9 -2.5317873369132537e-7 … 0.3195989780877837 -0.17932261530201532; 1.5679891365349667e-9 6.85514958605433e-10 … -0.06888701434086758 -0.08470121630698631;;; -8.095332758470858e-11 9.477889159881052e-10 … 0.8667362239347901 0.29701295051663107; 1.1873013710971352e-11 3.212362426197564e-10 … 0.0017573369515731625 0.39581357183918503;;; 5.587605107220021e-11 -8.872439702830299e-10 … 0.019442381866667538 -0.495701375801425; 1.0091598971492282e-10 -1.2613751790209381e-9 … 0.0078591821506534 -0.01833652269212399], [-0.5882319498389736 -0.5817428222155318 … -0.08608658223613837 -0.07115894814221772; -0.8079638976834663 0.4303310578022661 … 0.05126949452096056 0.05871143883813231;;; 0.011682916249016849 0.6831382365310206 … -0.11714099176137995 -0.0649834698131648; -0.022286769461657925 0.09752263153868612 … 0.02506351322950748 -0.21495672617276262;;; 0.008731210731725966 -0.009127895199966115 … -0.38449354990268403 0.10784179743953912; 0.021635171708532276 -0.010891324781513709 … -0.18106486479463246 0.0278560604412161;;; -2.9874170522037756e-5 7.705609908829486e-5 … 0.13012787497290912 -0.06497184168941295; -8.204507903585737e-5 4.648243335285189e-5 … 0.02970301842510639 -0.12185719283903443;;; -1.19486397270304e-5 -8.989800400377129e-5 … 0.6350685916672548 0.05384121608563457; -1.188827568148785e-5 -3.5156265598914413e-6 … -0.04475893331309266 0.6975397842742459;;; -3.0976246587271477e-9 -2.580264970356573e-8 … 0.12545495177470606 0.09531221154380604; -2.724009639023409e-9 -1.7752983833817533e-9 … -0.08891441688921048 0.40451071829848373;;; -5.566817608523666e-11 -4.0025966358383663e-10 … 0.26965276380237896 0.04028509657939959; -3.0447264240726515e-11 2.1063883716639005e-10 … -0.0017532805935850586 0.482464610096947;;; -4.142713785003518e-12 -1.0489922894353864e-11 … 0.5248788655810647 0.11102129758926893; -2.655755641912215e-11 -3.199427428058979e-11 … -0.0011541550857357957 0.026250960593400496], [-0.6548605970936705 0.6295610046924178 … 0.05171025012452214 0.17849498575812808; -0.7549223031675422 -0.545131579809366 … -0.05697995962861024 -0.1519444864564989;;; -0.01254126036065059 0.5082959640189074 … -0.025513332597888922 -0.33044435042982506; 0.03203688003354045 0.21895631948084418 … -0.20622434869824757 -0.15729240410192583;;; -0.002610184484502195 -0.008060952019897673 … 0.22407883204653103 -0.64890170071094; -0.007702539183165628 -0.010581575855552762 … 0.30731958479816746 -0.1659762297919432;;; -4.9484436217743204e-5 -0.0006922234370705322 … 0.17951519910165362 -0.3185703599092837; -0.00029652757530274174 -0.0005376518328660339 … 0.06756443365231342 -0.06575540594345963;;; -0.00011974974376290697 0.0003560857011618715 … -0.7874017740350677 -0.1559847554963115; -0.00015089861766702105 -3.810311828618077e-5 … -0.1393410511092643 -0.3438164237196267;;; 1.6013866773972968e-8 -5.35110236862451e-8 … 0.11745706527108636 0.23508222434961198; 1.842875200341951e-8 1.3900899349906094e-9 … 0.27319344906867377 0.11328115391177337;;; -2.1321079299167772e-11 -6.607403466105697e-11 … -0.13590220403885378 0.047393134436556655; 2.54717062593015e-12 -6.1813297798528515e-12 … -0.07787545720950148 0.18061849143616687;;; -2.2280540313952167e-11 -1.0701026287176757e-11 … -0.12541285868476312 0.09129494175898713; 1.5276249036894168e-10 1.0198909727717915e-10 … -0.036632313955877245 -0.05333391112592945], [0.6925275367299188 0.6214088475310325 … 0.05634282447843066 -0.08378108439904138; 0.7211797478342472 -0.5956611728942655 … -0.051915989207357904 0.07919694528133438;;; 0.009050238520916397 0.4105104797088231 … -0.15658925270842775 0.19782553895543534; -0.014860270366289924 0.30076094317554813 … -0.015620002287989739 0.06958801837350799;;; 7.528877402273581e-5 -0.004578976601660846 … -0.20743400380637933 0.24944707316220807; 0.0014790666522070538 -0.005280444483482949 … -0.19277573242653814 0.20458071328149413;;; 5.387012992808334e-5 0.0025965257831809183 … 0.35545135797679994 -0.4384261553996231; -0.0006639398590136362 0.002682456525210078 … 0.0868078574053986 0.17888780428228668;;; 6.624701830501265e-5 0.00013811796005714898 … -0.6543970440855853 -0.24422933598983626; 7.948903669505744e-5 -7.556017566102896e-5 … -0.1327146295966947 -0.1702682574177249;;; -8.260519193679055e-8 -1.9903658677105408e-7 … 0.30468114270298735 0.4838918752106853; -9.121732838800989e-8 6.451199622906526e-8 … -0.15525280800028118 0.251410835460512;;; -1.7856024370247918e-13 -2.891745737139227e-12 … -0.3702702465127136 -0.151171651467406; 2.0621278035307116e-12 -3.940838433544598e-12 … 0.019876808328966437 0.29456346787116655;;; 6.075064370673164e-12 9.754308517776213e-12 … -0.23455209452459963 0.34235091511540844; 5.9066044322856695e-12 -2.2367006140116814e-12 … 0.0009441297761066199 0.040162541745731785], [0.7032189324420545 0.6165147977496738 … 0.006388519080194115 -0.10369219421939678; 0.7109510655874364 -0.6093458735717245 … -0.007424052825520054 0.10295148293299744;;; 0.003275039069266989 0.36835620182121265 … 0.07592490773393772 0.1812518971671209; -0.004570726325824684 0.3360280531966023 … -0.10465838575501828 0.17832032789589594;;; -0.00010097729276664066 -0.0014735061969508726 … 0.10620911400007116 0.12420841349776382; 0.0002618389125667184 -0.0015447438404453248 … 0.35521091418892947 -0.019309003588881973;;; 8.692884744362147e-5 0.0008592053015671169 … -0.5290575420800921 -0.13400765305024778; -0.00010675945544563983 0.0008186106881366566 … -0.12109295428855446 0.2787609597936909;;; 1.0632839767342877e-5 1.735794068738123e-5 … 0.3730272887079673 0.6772688333147969; 1.2319743939460463e-5 -2.1187575289691006e-5 … 0.4415222671160774 -0.15981559911571355;;; -1.1066163391954881e-7 -2.2731374918892991e-7 … -0.12086215754017214 -0.0798138755715713; -1.1470378851025308e-7 1.5594426046570544e-7 … 0.44566917209660756 -0.5260619305152165;;; 4.1505588695603595e-12 6.043975316832517e-11 … -0.04217542445208192 -0.11167186599329153; -6.792046755381695e-12 5.932890786294542e-11 … -0.041061045581827806 0.019002873571227707;;; 5.7687770990487495e-12 9.722637912628404e-12 … -0.012657860431774831 -0.14868896532234338; 5.459132025381646e-12 -5.963977446354902e-12 … -0.0148527838873425 0.01570379028937383], [-0.7059223506087015 -0.6181808292819401 … -0.007181534064377763 -0.175782075274078; -0.7082876588769378 0.6159725623986468 … 0.006968587805547257 0.17540936664720191;;; 0.000880909504457815 0.3496754470322584 … -0.0761111906809881 -0.3105503747242388; -0.001202775822281267 0.34081824106298564 … 0.05184443569174055 -0.31730240569825796;;; 3.442632422323281e-5 0.00038729272764496215 … 0.15453874436010712 0.30845132195685737; -5.601370797471701e-5 0.00032958943756577336 … 0.39629085271571507 -0.5189387714718383;;; -1.2727388690987652e-5 -9.153204210647552e-5 … -0.7104576879100127 -0.49317473179571353; 6.146961296425462e-6 -7.732329548545394e-5 … 0.552937895001254 -0.3654434040533385], [-0.7067041102873045 0.6328060865026974 -0.06897669879518688 -0.30881705330419806; -0.7075091331779934 -0.6320322079893866 0.06844424324403517 0.30867701582809204;;; 0.0001832183515732607 -0.31755128087149176 -0.8254054914885198 -0.466762171848261; -0.0003056203353761118 -0.3150443285731009 0.5561145342559067 -0.7690797113560273], [-0.7069791049067176 0.7072344344171149; -0.7072344344171149 -0.7069791049067176;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^d, 2^d)
xes = collect(range(0,1,length=2^d))
yes = collect(range(0,1,length=2^d))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="fbfedd2e.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this example we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 8
h = 1/d^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,d)
xes = collect(range(0.0, 1.0, 2^d))

u₀ = qtt_sin(d,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.831387325067111e-6
Relative error for Crank-Nicolson: 4.831460302207071e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on [<a href="../resources/#QFT1">13</a>] we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an example of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h1 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h1><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve Burgers equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using CairoMakie
import TensorTrainNumerics: dot, orthogonalize

orth2(x) = orthogonalize(orthogonalize(x; i=1); i=x.N)

d  = 6
L  = 1.0
T  = 1.0
Nt = 1000
ν  = 0.01

N  = 2^d
dx = L / N
dt = T / Nt

Dx   = 1/dx * ∇(d)
Dxx  = 1/dx^2 * Δ_DN(d)

u₀ = qtt_sin(d, λ = π/2)
x0 = orth2(u₀)
v  = u₀
v_ref = Ref(u₀)

&quot;&quot;&quot;
    residual: (u - v)/dt + 1/2*∂x(u²) + ν uₓₓ
&quot;&quot;&quot;
function burgers_residual(u)
    t1  = (u - v_ref[]) * (1/dt)
    nl  = 0.5 * orth2(Dx * (u ⊕ u))
    lin = Dxx * u
    R   = t1 + nl + ν * lin
    return orth2(R)
end

&quot;&quot;&quot;
    gradient of J = 1/2 ∫∫ |R|² dx dt
&quot;&quot;&quot;
function burgers_cost_grad(u)
    R = burgers_residual(u)
    J = 0.5 * dx * dt * dot(R, R)

    g  = (1/dt) * R
    g += ν * (Dxx * R)

    Dxu = orth2(Dx * u)
    g  += orth2(Dxu ⊕ R)
    g  += orth2(Dx * orth2(u ⊕ R))

    g = (dx * dt) * g
    return J, orth2(g)
end

solver = GradientDescent(verbosity=2, gradtol=1e-6)

v_ref[] = x0
for _ in 1:150
    x, _, _, _, _ = optimize(burgers_cost_grad, v_ref[], solver)
    v_ref[] = orth2(x)
end

vals_init  = qtt_to_function(x0)
vals_final = qtt_to_function(v_ref[])
xes = (1:N) ./ N

fig = Figure()
ax = Axis(fig[1,1], xlabel=&quot;x&quot;, ylabel=&quot;u(x)&quot;, title=&quot;Variational Burgers&quot;)
lines!(ax, xes, vals_init,  label=&quot;initial&quot;, linewidth=2)
lines!(ax, xes, vals_final, label=&quot;final&quot;,   linewidth=2)
axislegend(ax)
fig</code></pre><img src="2effeaa2.png" alt="Example block output"/><h1 id="TT-cross-approximation"><a class="docs-heading-anchor" href="#TT-cross-approximation">TT-cross approximation</a><a id="TT-cross-approximation-1"></a><a class="docs-heading-anchor-permalink" href="#TT-cross-approximation" title="Permalink"></a></h1><p>The TT-cross algorithm allows you to approximate a high-dimensional tensor from function calls. Below is an example of how to use the <code>tt_cross</code> function to</p><pre><code class="language-julia hljs">using LinearAlgebra
using CairoMakie
using TensorTrainNumerics

function sin_6d(coords::Matrix{Float64})
    return vec(sin.(sum(coords, dims = 2)))
end

n = 8
d = 6

domain = [collect(range(0.0, π, length = n)) for _ in 1:d]
alg = MaxVol(tol = 1.0e-8, maxiter = 20, verbose = true)
tt_maxvol = tt_cross(sin_6d, domain, alg; ranks = 4);

tensor_approx = ttv_to_tensor(tt_maxvol);

tensor_exact = zeros(Float64, ntuple(_ -&gt; n, d));
for idx in CartesianIndices(tensor_exact)
    coords = [domain[k][idx[k]] for k in 1:d]
    tensor_exact[idx] = sin(sum(coords))
end

error = norm(tensor_approx - tensor_exact) / norm(tensor_exact)

max_error = maximum(abs.(tensor_approx - tensor_exact))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.9984014443252818e-15</code></pre><p>And we can check the difference at random indices</p><pre><code class="language-julia hljs">println(&quot;Relative error: &quot;, error)
for _ in 1:5
    idx = Tuple(rand(1:n) for _ in 1:d)
    coords = [domain[k][idx[k]] for k in 1:d]
    exact_val = sin(sum(coords))
    approx_val = tensor_approx[idx...]
    println(&quot;  Index $idx: exact=$(round(exact_val, digits = 8)), approx=$(round(approx_val, digits = 8)), diff=$(abs(exact_val - approx_val))&quot;)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error: 8.022423319143219e-16
  Index (3, 2, 4, 3, 4, 8): exact=0.97492791, approx=0.97492791, diff=6.661338147750939e-16
  Index (2, 5, 2, 7, 5, 3): exact=0.97492791, approx=0.97492791, diff=1.2212453270876722e-15
  Index (3, 6, 5, 6, 8, 2): exact=-0.97492791, approx=-0.97492791, diff=5.551115123125783e-16
  Index (4, 2, 6, 1, 8, 4): exact=0.78183148, approx=0.78183148, diff=6.661338147750939e-16
  Index (4, 6, 3, 6, 1, 1): exact=0.43388374, approx=0.43388374, diff=2.7755575615628914e-16</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Quantics tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 2 January 2026 13:36">Friday 2 January 2026</span>. Using Julia version 1.12.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
