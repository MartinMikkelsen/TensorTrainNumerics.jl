<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets.citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Quantics tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li class="toplevel"><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in [<a href="../resources/#FastandFlexible">15</a>] where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^d)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, d)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(d) + id_tto(d) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(d) ⊗ qtt_basis_vector(d, 1) + qtt_sin(d) ⊗ qtt_basis_vector(d, 2^d)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-1.4054235230417105; -0.6243925995161613;;; 1.170332425217253; -1.9266052190088663;;; -0.22478801514325264; 1.740768208508583;;; 0.6282316696295743; 0.6180737646964395], [-0.0845309507441815 0.07530357287562665 1.4859176678380788 -0.4536088933825396; -1.3274448260936729 -0.5473261079625384 -1.2894568260387729 2.0102978678659285;;; -0.16838639760811033 -0.9759065049895174 -0.3912743149202972 -0.3625472871545591; 1.6627149281094846 0.352694847429223 0.20993019370005847 -0.09893118567474678;;; -0.7585837462457092 -0.13249867236238247 1.8508304097842931 0.5192737026900541; 0.42208115256871115 2.4424324118788254 0.8371099828005196 2.1167465691790617;;; -1.4937858295013622 -0.2654407502397137 1.0321451004198383 -0.12851064991241726; 0.45893677681854633 -2.5518926317014645 -0.1919873693242049 0.8504451223882243], [1.9429616467986748 0.9924147187142577 -0.25971229760276726 0.6330429613086109; 0.31112536994763057 0.5547051257011916 -0.541100595030076 -0.1821537764600131;;; 0.07321419019914661 -0.5590470141446195 0.5741634994006629 -0.2690765145923398; -1.1275007269587258 -0.046516550914814256 2.287801954210832 -0.5505145023856136;;; -0.5433672215913384 0.8530372868748878 -0.1687384194059658 -1.3121910727539698; -0.06804900235812748 -2.180812662517502 -0.9244162474089679 -0.8898715091271178;;; -0.13823132776678493 0.12240618692614737 -2.4036984736168736 1.4690615473395852; 0.23458961022957503 -1.6924106500690639 -1.4409739419369463 -0.2710229043060332], [0.8927946636105389 0.3258779584613812 0.9591529111624191 -1.2275653104216122; 0.7190122355922766 0.4968533258387559 -0.20411269513821897 0.0914950758157924;;; -1.4816438770969993 0.5138070316696469 0.8605863180354412 -0.4936802074275096; 1.1129539225652487 -0.8345035013565658 0.3742497943449176 0.21376156582071326;;; 0.6402526366822718 0.6018306005367933 1.5811567849245127 -2.780733622680028; -0.17763548572101295 1.3415194340317211 0.8844332060764641 -0.12130708635091061;;; 1.7295472381670156 -1.060311314669057 0.8498027409128284 0.915594669369636; -1.1382394432935279 -1.23149137239987 0.633348756442224 0.007200098334245073], [-0.2984583098526827 0.7238130943974871 0.285508392412485 0.9777260719852855; 1.0976743480472166 -0.034344171844530945 -0.7367232093496846 1.0907818630693087;;; -1.6887605640070755 -0.9953542940244701 -0.13013813124630064 0.7131661568358545; -0.7225241026534119 -0.4913524964344078 0.2165537142771358 1.0733677839246551;;; -0.2111527445445954 0.8363716047971258 -0.023163309632909877 -1.0673284249504125; -0.6207537005169501 0.35534832346055045 -1.072453752060371 -1.3086958691143447;;; 0.6834979496705296 -0.0665284119403343 -0.33445396457448034 -0.5319489791345496; -1.3037128557500681 -1.6960086161269405 1.1524764910593601 0.778716658129845], [0.29807878112989233 -0.884196431986457 -0.24957723707228477 1.4423655849887598; -0.7250197163690563 0.5021645552922659 -0.5952949554669374 -1.2708985963226687;;; 0.027945336717103735 0.4336221084687458 0.3623511511458124 -0.810600101944194; -0.9660197524830033 -1.0391676140504704 0.20064903730516417 1.3648145467299084;;; 1.0816621621380305 1.070441949788493 -2.1871504431329227 0.5504593693248159; 0.7566656552399336 1.2683213535436346 0.18508995298231298 -1.1565767499106334;;; 1.2974948732415603 0.5643274365163128 0.9358611610884531 -1.0457877425543731; -0.6175514957397212 -0.6733035984979375 -0.9424941225047659 0.13869940390635743], [1.1749974247423014 0.2626345285297856 0.39901968298587787 0.2498224835654124; 1.0744574984267612 -2.0637582339989082 0.09413778447124287 0.4600097807095182;;; -1.3973578163490916 -2.0561799399518845 0.7907260443804549 0.7171720158100603; 0.960664091260114 -0.5689827620816825 -0.9360672130913049 0.28196209243126874;;; -1.7623946788195761 0.13039723620668914 0.23478305862207122 -0.9133151275067356; 0.40519954938992775 0.6415733968546362 0.4305098997706197 -1.8466089880221854;;; 0.8847161747235787 -0.2733413342565918 -0.25588812883593964 -0.23545419436625262; -0.4336478816269892 0.2957169274952523 0.8334538751313741 1.0118781824399272], [-1.1742529346118535 0.060202642100010514 -0.2429966069766312 -0.8617152137885308; -0.46312786291390606 0.31212174660518893 1.0490825322430066 -0.3900232643104354;;; -0.2172505186587547 1.1564223796148017 0.47492514498293215 1.732082807358116; 0.1639113486058059 1.4856409383119813 -0.3936278426208096 0.5110389884338674;;; 0.18966683952689684 1.0366702956960279 -0.6181327430839809 -0.1737513649877205; 0.24901264368582662 0.6193648182131386 -0.14007791659870575 2.0982278888291153;;; -0.06866786179372046 1.2345793872654236 0.5173959378944732 -0.33831281087590487; -0.09561397763828343 -1.5488549341970972 -0.08199689196572586 -0.48145309754825905], [-0.5489117185223488 -0.3090607119964656 0.27788400526739415 -1.4210926289774368; -0.3965044662075431 -0.09485076631260439 -0.9509147675540895 -1.1902408780653102;;; -0.5048611252675087 2.813071789769493 -0.7863895784609105 -0.8717701248638748; -0.07886422769630522 -0.24804191323840014 1.8835797822527127 -1.1249753440070647;;; -0.5221950485428848 0.9798143077913847 0.5985667313777822 0.2533298270734569; 0.2815042291287924 2.1097957911766843 -1.1486729719391815 -0.560822879235811;;; -1.4246362368694814 0.4697729119332634 -0.7442514893657766 0.7348074886967145; -0.7010920829204345 -1.5649402977489089 -0.3624994873112995 1.3320675696557058], [-0.2276573353998254 -1.561138649495554 0.23124668865246648 0.6486960374701848; -0.43248809353143935 1.35347003105567 -0.016429548484179417 0.47079048248427724;;; 0.010804825162638643 3.0148495595138334 -0.854564690854046 -1.5376854899894534; -0.1741166996045066 0.4143998705379295 1.5227348178656028 0.25626857886609666], [0.8834576296249297 1.0909405842486979; -0.02942774874904919 2.4470639919363797;;; 0.41974029003573077 -0.46000379765564514; -0.22358929357759877 0.14149912841463927], [0.8505551295599681 -0.2123845546543175; 0.01913462115687013 -0.2950392992425895;;; 0.3574873892027056 0.29065416324386195; -0.9955012663379491 -0.5221800846756788], [0.9123054657935931 -1.1806237312121564; -0.7487838141490483 0.7255642887373864;;; 0.8957178191572568 0.5388495416210094; 1.548423232626209 -2.3289951681745014], [0.7827517716312883 -0.19973502542337684; -1.3175787757932123 -0.20091341079994007;;; -1.5005210197328716 0.23450843993510814; -0.32967122874327875 0.9733548875623023], [0.026759994938522994 -0.21423375450342502; 0.0051770828490641345 1.1983270232893544;;; -0.8280380780788976 -0.8222758037527723; 0.14344246125427346 1.45525206792324], [0.7204158441669757 -1.0730540165353972; -0.6765560384417932 -0.3793090837629797;;; -0.9361030843305573 -0.7862027366639809; 0.5132906037887435 0.15198057468183382], [0.2745671207057628 1.6278711127818986; 0.5272709169847983 -1.3400009107173303;;; 0.9230146689598293 -0.045266272230068426; 0.28772686161051464 -0.5629268097597404], [0.4299070492077831 -0.04282748929551568; 0.9788000058484336 -1.356211070909942;;; -0.6233751002505028 -0.19022693014999234; -1.200990821385048 -1.3993593757859124], [-0.9541226961056911 -0.790160781152936; -0.16974060351142983 0.9755633003889629;;; -0.9288770005966888 -0.7807346283284731; 0.42445808806116087 -0.4377465056325188], [0.09181152795621955 -1.2870108079961713; -0.7728531593076654 -0.9113465454452275;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-172.69437163822116; -196.16402969393351;;; -111.95519837341594; 98.56053969168326], [-0.7053600242293157 0.49686891587146487; -0.6901630182353431 -0.5192169743201435;;; -0.10749512777157351 -0.48096829796332247; 0.11929455356027908 -0.49875912852694027;;; 0.007981994073116205 0.043250845095003564; 0.011440500056282436 -0.03858872476966958;;; 0.009229138418633664 -0.005003730807678026; -0.008722224994556464 -0.007686317784567925], [-0.7073753486886213 0.3506790459123855 0.1861838725618428 -0.08283455974947018; -0.7036710990920121 -0.3543935160619628 -0.1638697029575159 0.09678896185300755;;; -0.04637209510105978 -0.607102816010883 -0.13212910017488605 -0.1802914489259496; 0.04771815067685718 -0.6159889409192296 0.3318248231978134 0.005191262563642086;;; 0.002326288476322441 0.04153879972047075 -0.46730688030472517 -0.5130746780854138; 0.0042770792047475414 -0.04104109206443457 -0.5116550069374615 0.5282661548591695;;; 0.002779943605100141 0.0007479243459723821 -0.4141527026375287 -0.4861895436198327; -0.0028709741398356913 -0.0011519866489783604 0.39858769574756164 -0.4142586793649166;;; 5.418145219580004e-5 0.0008984430042020084 0.013156587785639315 -0.014490815262420673; 8.510197608232336e-5 -0.0008346059231614919 0.013260995811598912 0.01675395368184757;;; -0.00010352112950458937 3.983555252854305e-5 0.0019171727452933715 -0.014938980898727689; 0.00010374994305063757 5.522848460605798e-5 -0.0016338530797037271 -0.01494133421981133;;; 4.173874493189295e-9 9.809285621810383e-8 1.0978981989929234e-7 6.487311454613389e-6; 1.0899937995498225e-8 -9.442827591225523e-8 2.608486839081382e-7 -6.47294628847039e-6;;; 2.759970963642344e-8 -9.079768261156765e-9 3.2707548884583787e-7 -8.849674856924468e-7; -2.6730604893191974e-8 -1.804224714155733e-8 -3.0407333337661633e-7 -9.301057570479917e-7], [-0.7070464529709999 0.20151285919587542 … 0.12971973259870964 0.006476567513624045; -0.7064612328415316 -0.2015807193180737 … -0.1301177559809309 -0.0020180775484353658;;; -0.022377496892986664 -0.6767051250179392 … 0.04359894172146901 -0.06665233182032124; 0.02221007585486679 -0.677614917872032 … 0.030868657345792846 0.06945991527817977;;; 0.0006118441199580066 0.028490529455411327 … -0.06024418576198236 0.012559365361946581; 0.0014148346009259225 -0.02899299522005235 … 0.009454478665073526 0.007863407513059726;;; … ;;; -3.4974238166579506e-11 -3.9170668765075073e-10 … 0.0018992035748574615 -0.0023652067363635495; -1.0786194143179236e-10 -2.022506850264431e-10 … 0.0005088484398087527 -0.0032738000926602617;;; 2.5170747809961385e-11 -3.3444618064456877e-10 … -0.0010980483657228623 -0.0030345971900924387; 3.413271415521762e-10 -4.5635970733810313e-10 … -0.0008231482300351773 -0.003919951680817956;;; -1.3709546572502338e-10 2.302656765977627e-10 … 0.0011994383880944768 0.0018534171880873341; -3.8871041008014356e-11 7.239253989683498e-11 … -0.0002486612495247783 0.0020235854689360884], [-0.7070373679495495 0.10458361092943481 … 0.07905492858849593 -0.03914139911665323; -0.707002820109565 -0.10443588554731109 … -0.08053888052038637 0.04695328498080962;;; 0.01114514570464387 0.6991857749929508 … -0.05872026791719844 0.24987127711010135; -0.010985560197569685 0.6991366779863715 … 0.034382460208653445 -0.23472460447795826;;; -0.00015814976067251107 -0.01566603001468397 … 0.05678788417664584 -0.15609629753856297; -0.00040880395493235244 0.015790176772936475 … 0.09733632099029546 -0.27191578065931943;;; … ;;; -6.169188974072579e-12 -1.5169716822875563e-10 … -0.09497819035354582 -0.035335703027967874; -1.7025163070859746e-12 1.77192061076309e-10 … -0.025283702357619713 -0.24340449474573528;;; -2.292840157004133e-11 -2.4967785345066623e-10 … -0.05320577315123248 0.1271894073167019; 3.1307417774991275e-11 2.0241173236508171e-10 … -0.025114691696258292 -0.09573552904937643;;; 5.911281382179579e-12 1.0790702044636456e-10 … 0.006798770902857729 0.05860829854992124; -8.554342247638538e-12 -9.28531958486879e-11 … 0.04426520939168287 -0.20117625630915284], [-0.7070867395799848 -0.05248184051746752 … 0.05928480685624095 0.0847453188296055; -0.7070828086748522 0.052616261127978715 … -0.057416383888809375 -0.08598324285717387;;; -0.005510659659860366 0.705134980490307 … -0.112927042234364 0.08369055650070727; 0.005644811384701181 0.705114900275877 … 0.11749072464438473 -0.0701475578151871;;; -3.3436490883101084e-5 0.006047559745049878 … 0.12206434278019855 -0.032011698961464975; -9.034309560388094e-5 -0.006062330448519026 … -0.44090792381792315 0.08945603691337065;;; … ;;; 2.6621804968959278e-12 -1.5881970167759632e-10 … 0.10261277286287612 0.09184132044023076; -4.3969863277494095e-12 -3.203059260823817e-11 … -0.04497123666557362 -0.01505589921117734;;; -8.026673526909715e-12 1.210927580372726e-10 … 0.07812896852607171 -0.08105721958611234; -1.3122567774360395e-11 4.7571986551085734e-11 … -0.07653957412671873 0.378053413506256;;; -1.0031513679287142e-11 1.2829449283292354e-11 … -0.1713813411536472 -0.28386072376530447; 6.092780813104301e-13 4.183908363902586e-11 … -0.09145304237886148 -0.41749525947842586], [-0.7071050183255673 0.025135795238138164 … 0.02338191577385293 -0.0646484927810818; -0.7070956078385322 -0.027346666453441606 … -0.023030472416202947 0.06385779665147769;;; 0.0017064466076541279 0.7066490927998877 … 0.042476119811543436 -0.09625248539312997; -0.00391746910138974 0.7065657636665006 … -0.0422275991126778 0.10135071159689277;;; -0.00011793767393356512 0.0029890778650615104 … -0.1847639294352945 0.12230281291630454; -0.00012150909057431522 0.0030945443851389345 … -0.08498775328828943 -0.17168953200224574;;; … ;;; -2.348631886891678e-8 1.6040577211784536e-6 … -0.010221359705735985 0.06847946987665385; -3.583221303360126e-8 1.5783803384191185e-6 … -0.0022106303357683874 0.03451365533384737;;; -2.1322147329491224e-9 7.602309179786634e-8 … 0.00927321810131879 -0.07693586265885405; -2.7123575911490413e-9 7.754573811208953e-8 … 0.08716521045397035 0.029082044353568984;;; 1.8903251789206938e-10 -6.704679267366822e-9 … 0.05349805031791303 -0.5773278945871096; 2.397773729017415e-10 -6.880287145758918e-9 … -0.22052426684578003 0.26504190177525466], [-0.7071067383440323 -0.01133780087733714 … 0.012465489322799147 0.04124359962351447; -0.7070995452763111 0.014887263990059234 … -0.01259082735957527 -0.04137860148728373;;; 0.00036700961620290306 0.7069841613858776 … 0.031843963783531104 0.035028360803070015; 0.0031804191940262 0.7069168109290509 … -0.031425353891433985 -0.033745300914160704;;; 0.00011485651001090567 0.005136502614215027 … 0.017208254166851594 0.03042601279034408; 0.00012440321569607605 0.0051545783075517635 … -0.0074894143347706025 0.030700412302408647;;; … ;;; 1.6758784968815271e-6 0.00013149078668645367 … 0.06196618736895241 0.04659734228072956; 2.2030895114717998e-6 0.00013176643835005014 … -0.14497039507476994 0.09591242023047637;;; 7.971516918475194e-8 5.722998202533985e-6 … 0.1754133986972011 -0.04539567812379168; 1.0250559280112563e-7 5.733158332887965e-6 … 0.647865227588684 -0.07188338558476914;;; -1.4048149870386017e-8 -6.952374061025312e-7 … -0.23580187491587437 0.019891480590198234; -1.6742086562474458e-8 -6.993161761653057e-7 … 0.6504384592931625 -0.04590958303257609], [-0.7070963080856695 0.0020464549463617993 … -0.008622527543201758 -0.023083113750141944; -0.7070872427244843 -0.011145682499570162 … 0.008623232209171331 0.023090626608028682;;; -0.0038391709726369686 0.7067033049404732 … 0.000504858948432012 0.003909378877624705; -0.005244540419548456 0.7066184172477278 … -0.0003674082844759014 -0.003410732287714312;;; 0.00014059770185903466 -0.0107690640574889 … -0.0011999225491227442 0.007398933059535394; 0.00015821530832000138 -0.010772278216252727 … 0.0017126341002695604 0.007373757753805217;;; … ;;; -2.411229754505996e-6 0.00022741611024298865 … 0.36380149563789455 -0.423049193837307; -2.852516819294684e-6 0.00022737852786942084 … 0.046773282538496906 -0.1998970264104094;;; -2.448146441565431e-6 0.00020309951549330526 … 0.02709885729758917 -0.19286791908937012; -2.8426529199097116e-6 0.00020309197015032062 … -0.5170349878380297 -0.366947999838162;;; 4.857895239766057e-10 -5.716523737661706e-7 … -0.006871788013243067 0.01020508597485112; 1.6918712050879568e-9 -5.70274494717242e-7 … -0.010911896796556837 -0.04944709142715006], [-0.7070926388575364 0.0014407838760143036 … -0.027101773680209742 -0.03848712684551389; -0.707087937612019 0.008193427008240235 … 0.027100906401897117 0.03848692504861706;;; 0.004463270116998727 0.7055759079799383 … 0.000579125562229707 4.257022631364243e-5; 0.005151943445520862 0.7055292790216359 … -0.0015259961275781435 -0.0004353210971258503;;; 7.754674304849226e-5 0.012751697377107787 … 0.0012182293795917644 0.0011317844967498349; 8.914224695861986e-5 0.012756905374249861 … 0.00024570096988597926 0.0009476832470963839;;; -7.287818749364534e-5 -0.012073733391916938 … 0.0004222827575485996 -0.003971332044463663; -8.445285823640746e-5 -0.012079637224657143 … 0.004338316088104412 0.004726349691807233;;; -3.4599692009579114e-5 -0.005569868658296886 … 0.3533556050475874 0.6619831792119969; -4.003521010468721e-5 -0.005570868672179674 … 0.1787545077655363 -0.6602446722664645;;; -4.43992488694357e-5 -0.007201465858592439 … -0.09058246516089041 -0.2479646534658636; -5.142568187330989e-5 -0.007202109972660589 … -0.5347035286754868 0.2473793496838065;;; 0.0002442383336863822 0.04046024321520892 … -0.0344537201890919 0.005371284182918869; 0.0002836359577576213 0.04046687483461614 … 0.17151370240070332 -0.007147994374738009;;; 6.947260970446019e-5 0.011497856907243795 … 0.1355058428357154 -0.0024538653342575894; 8.06740123304587e-5 0.011499558964461015 … -0.7061271700604778 0.009125932541974715], [0.17692064587383355 0.1464062506322114 … 0.13643908198258273 0.030914135633329592; 0.9837053933460211 -0.0054089381947762735 … -0.005282815528077204 -0.008091747184978999;;; 0.020815539092297632 -0.9892093523050443 … 0.01998917752053294 0.00468580734541455; 0.00942300502944561 -5.048371488493277e-5 … -0.011021303762310211 0.10135365476411431;;; -0.022011628333493113 -0.00045376967481020416 … 0.8698673340503393 -0.08526815839608237; 0.004023985422605173 -1.910407491480194e-5 … -0.026203277921100752 -0.10885805560419021;;; 1.5011794550443742e-5 0.00022225632563186722 … -0.1353356753123354 0.01190353902524593; -2.8137237484975967e-6 -2.90528808440701e-7 … -0.08918667295094176 0.3134906102224725;;; 1.1714019743562567e-7 0.0002856510187151939 … -0.027077589852758318 0.2972127415439565; -1.3453675776751257e-7 -2.470882998816968e-6 … 0.01444912628721725 0.015584977685980205;;; 2.854839907214812e-7 0.0006839911166897158 … 0.30418756486728826 -0.0850199320770567; -2.9745657009400506e-7 -5.201673886627817e-6 … 0.15756053997908992 0.6561240829682247;;; 2.49671683611707e-8 4.25831475689192e-5 … -0.24478104506438297 0.025486351508466523; 1.992592128755996e-8 3.832063552497498e-7 … 0.013472070411523623 -0.19413612918832585;;; 1.460324617102849e-8 3.1148429977189007e-5 … 0.1295441062899522 0.09436849093093293; -5.360976291738209e-9 -1.291838003936296e-9 … 0.04507028364433314 0.5455238019179367], [-0.4094859571982174 0.2690694673918293 … 0.09696744687195946 -0.026895431953450292; -0.9112842860066117 -0.13650339111131238 … -0.038550255774404865 0.002630528416997345;;; -0.015429037406402743 0.9530300722749081 … -0.03815704876820251 0.006402300367229788; -0.015833132602520426 -0.0009459068335929691 … 0.024667309656744317 0.11847323374627172;;; 0.012341202318355034 0.02611846232427738 … 0.18269089777152991 0.09878899517093621; 0.0352299911035861 0.004365593036526914 … 0.06027698911483216 -0.22312439148540186;;; -3.319063631687242e-6 -7.3677245707103385e-6 … -0.030678722595476018 -0.02227082830765707; -9.63037897868019e-6 -1.1997702905166894e-6 … -0.011836048878318808 0.014311194708392101;;; -9.81467131853739e-10 9.541445950578126e-8 … -0.03648913177528181 0.0011184948027504133; 6.621578893808612e-10 3.711873291291423e-11 … -0.0053334725990130975 0.041030198388680675;;; -1.064501787638927e-9 1.0770329983868705e-7 … -0.9464437086515786 0.037608564036444386; 7.816899274865069e-10 -1.219770551964546e-10 … 0.04185949297614289 0.039811165359287255;;; 2.1575401805225213e-9 -2.1553384757711743e-7 … -0.19978121600613405 0.009307716800245749; -1.6807137327748865e-9 7.126652009949105e-11 … -0.10087494209850771 -0.3044025458679407;;; -1.1809940290781127e-10 9.250202712062418e-9 … -0.00013023704279054366 -0.0002884373977805146; 3.294401959801327e-11 -6.891489549976801e-11 … -0.0002850122744726385 -0.9096793786055904], [0.5263497734675584 0.43830432631914557 … -0.17761850675985286 0.06745275197360025; 0.8490578423236503 -0.2919750023494284 … 0.07601829017423833 -0.03329079788313887;;; 0.020606719638742912 0.8496571160993199 … 0.11543834781247742 -0.040020232985945925; 0.012497828118881988 0.018740028009815897 … 0.2953304259721953 -0.22709975281184028;;; -0.014234543230198814 0.017448605980716753 … 0.11829290168329623 -0.13010678404221823; -0.03568249178933522 0.008188877300671192 … -0.6882049019641802 0.1521788555618591;;; 1.333259442531086e-5 -1.784060418551919e-5 … -0.06480338071985965 0.050185986930326075; 3.373973535429445e-5 -7.978827637045561e-6 … 0.10614265678555353 0.07295396272185939;;; 3.522547754606822e-8 9.33744986404131e-7 … 0.16460547161301378 -0.0913737714029905; 9.833747108859031e-9 1.2926223092046798e-8 … -0.25707132649522574 -0.5177098214251692;;; -3.7900692686514935e-9 -1.0612556518776033e-7 … -0.06153006618168243 0.04201560446319918; -7.431276607823026e-10 -1.5991909516054604e-9 … 0.4076026674412475 0.2623658987798769;;; -7.637719964873987e-11 -1.1326434778981476e-10 … -0.30635520470483196 0.04494289851345279; 6.760015347825833e-11 2.1247001464711356e-11 … 0.0027680211110348734 -0.22367393433931548;;; -3.103753744987701e-12 -8.126328357580191e-11 … 0.04539256760906204 -0.0792997012994602; 8.037416078106847e-11 -4.9030520169166637e-11 … 0.003701786209349452 -0.6985175031020014], [-0.5954260202796741 -0.5951876529443861 … -0.06460826691439031 -0.030785010808703255; -0.8025766305373623 0.44663717999376484 … 0.03240139814285844 0.023372975153081784;;; -0.011374240579710605 -0.658289134495204 … 0.10684593869436253 0.042922723607840774; 0.02776957577604678 -0.1127835768259468 … -0.09498231994531202 0.009213344615034128;;; -0.0077868801028054616 0.008830818485045468 … 0.4168574427590311 0.1970716455151497; -0.019427298546220342 0.01114176092719566 … 0.27458717470134425 -0.11528751896954421;;; -5.6824230703060446e-5 0.00013732958132724247 … 0.15717797687225749 0.08128693128539412; -0.0001558304872302669 9.923374753331216e-5 … 0.07534705557222662 0.34692036353795047;;; 2.0120549364273057e-5 0.00012850665384374512 … -0.5634995190303915 0.22619707130694827; 2.1310724524548193e-5 4.613428943623622e-6 … 0.02752037853530211 0.45719371652662927;;; -6.729616520894157e-9 -4.708586605810671e-8 … -0.20842131755780305 -0.28539781247918083; -6.260174607229332e-9 -2.56991492979815e-9 … -0.11718506416315452 -0.2798262283169469;;; -2.8764348253383463e-11 -2.310648443368423e-11 … -0.34708559892552576 0.3006755950792496; -2.326126640800994e-11 -6.979231677442796e-12 … -0.2947629354179744 0.35349038906124375;;; -6.970095322603897e-11 5.071643016057592e-11 … 0.20478078392403315 0.3556121247045992; -8.49854930349058e-11 2.2803458620900752e-11 … 0.2646474100307654 0.23605486882645907], [-0.66175997429695 -0.6292780663271589 … -0.08150758531780755 -0.1731883332272609; -0.7489520459091633 0.5548748505221784 … 0.0798415113537169 0.1703208977121829;;; 0.012833771390250453 0.4920463011323127 … -0.10204926572502035 -0.21228015421737292; -0.0305465958808323 0.23204448025340293 … -0.18630761095455095 -0.40515354052101954;;; 0.002054887100475787 -0.007926776806570739 … -0.03241688035350338 -0.042097062362390594; 0.006488689913418432 -0.010157128744776039 … 0.22205052110616427 0.46798828033700196;;; 0.00013652248595941583 -0.0011848221554952398 … 0.01121783572341439 0.045229706300886956; 0.0006195962761861313 -0.0011328245181557969 … 0.14353703761729797 0.4983214381341583;;; 0.00012574868218593758 0.00034831400562636137 … 0.07757204272778959 0.06345815661878552; 0.00015852607891848395 -5.245009973122034e-5 … 0.02018374742588665 0.17878146331360623;;; -3.559237347369525e-8 -1.1137990431739956e-7 … -0.0030844693380932815 -0.00691184792590367; -4.119299183139081e-8 6.0391623704530126e-9 … 0.1311995601406496 0.2257217799686929;;; -5.610970100594007e-11 1.633711809326583e-11 … 0.5996895182374616 -0.16027587554106915; -4.738286309193636e-11 6.507371395903962e-11 … -0.04512788358219108 0.1220490439507764;;; -5.819809365181102e-12 4.9237555544737136e-11 … -0.686630117080326 0.35890060711933963; -7.91268056352072e-12 -2.575090794290133e-12 … 0.11831590407306976 0.06517166927694563], [-0.6948747291999271 0.6202815635669371 … 0.06947083386329328 -0.07084167824333623; -0.7189630863284335 -0.5985353488026977 … -0.0657529282083685 0.06761545860523385;;; 0.008278267101562658 -0.4029002816928959 … 0.17243083945292098 -0.16583648868600545; -0.013074247661840023 -0.3076158894858992 … 0.04991406575054456 -0.06414774825168955;;; -6.217013167393133e-6 -0.0038179212552186437 … -0.15852579817245135 0.15282569827484896; -0.001126876036917987 -0.004367459545370106 … -0.1577339755999861 0.32569871333046474;;; -8.809550517753488e-5 0.0028056388136427947 … 0.3637222207049956 -0.37522612027110236; 0.0006635499393131632 0.0029163566454799804 … 0.04615139640973046 0.33600344427317796;;; -5.6112080167700265e-5 0.00011286024990329202 … -0.69256319609064 -0.537139836055222; -6.679842861899629e-5 -7.050966778085616e-5 … -0.12779786757970327 -0.043728974928339194;;; -2.177798052250653e-7 5.107035961179579e-7 … -0.3281923205231925 -0.08412996484542785; -2.3793078145115832e-7 -1.8977538686337712e-7 … 0.10090784611501877 0.15118063343375654;;; -1.3754991917364848e-12 -8.19662386185557e-12 … 0.4003807854057526 -0.45466962010969286; -1.6231941749610713e-12 -1.1081775091153238e-11 … 0.00147341861390169 -0.1939272371733362;;; 9.227370660660623e-13 6.868127409087549e-12 … -0.00114647220516561 0.06577803614450138; -2.8783025581094245e-12 7.289220973756824e-12 … 0.003921666994547697 -0.08149099052598019], [-0.7038041953091476 0.6160855840475142 … -0.04065756983937233 0.008797856605879239; -0.7103775953525796 -0.6100065211053181 … 0.03957862677562485 -0.008881336072602957;;; -0.0028581461605855286 0.3658667925419849 … 0.14971963091847626 -0.000715848338789754; 0.003884320134604222 0.33833079799866006 … -0.013612898585507738 -0.030720145126192703;;; -9.237315636240147e-5 0.0012978825148949695 … -0.1554055019621904 -0.009000272868375377; 0.00022069558426396422 0.0013094339597553807 … -0.31988057682145915 -0.004927294063343086;;; 7.630204404549844e-5 -0.000714156731504049 … 0.552925453632623 0.11665887578033256; -8.070276958856842e-5 -0.0006700409701044851 … -0.050526402660519554 0.1166093138692831;;; -8.470824290540772e-6 1.2882929391680802e-5 … 0.5922068175086179 -0.15803114340677613; -9.892486992299239e-6 -1.7924189505990852e-5 … 0.3436495399526263 0.05238188652414193;;; 1.5539142058149977e-7 -3.1105755877847226e-7 … -0.2113949735716038 0.00865129600694678; 1.602208053074263e-7 2.2477295316370956e-7 … 0.13597157862885675 0.5662313080076083;;; -1.2220509570306624e-12 3.820522530759389e-11 … -0.08234498355581066 0.7210012090239801; -1.7610585226715321e-12 2.905292130396313e-11 … 0.01410599401794123 0.22592461697159955;;; -1.73324163511069e-11 3.221710971370888e-11 … 0.021308810857569215 -0.1962925514928155; -1.849196421324305e-11 -3.330126486743743e-11 … 0.003394179567939323 -0.11730850848574285], [-0.7060646264476856 -0.6180529818101066 … 0.017845240257547905 0.17414827209079653; -0.7081462645402317 0.6161227793229701 … -0.01797633334861242 -0.17378580485137574;;; -0.0007616196191981769 -0.3490265592517665 … 0.029865720533230177 -0.31675998063931804; 0.0010137129832496795 -0.34144327435336547 … -0.09480516059920177 -0.3052052952403777;;; -2.756241462514402e-5 -0.00033847824884939185 … -0.11382126602399453 0.33543851180900275; 5.2261049753632644e-5 -0.0002462430674850828 … -0.44965710759114375 -0.4513018857701128;;; -1.044417172855053e-5 -7.161513215703567e-5 … -0.6310937652227474 0.5864763282372011; 4.308715706825644e-6 -5.8981357353882064e-5 … 0.6132310197557836 0.2929792567668826], [-0.7067378066378793 -0.6327739757089665 0.06322077493475424 -0.3100353237145684; -0.7074754952560002 0.6320637353189792 -0.06275958473304966 0.30989529301206264;;; -0.00015466597198671335 -0.31742073941632765 -0.8168712422836071 0.48162788934702044; 0.0002689970151095178 -0.3151770999747284 0.5698997645821772 0.7588659839664081], [0.706991128514543 0.7072224149457743; 0.7072224149457743 -0.706991128514543;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^d, 2^d)
xes = collect(range(0,1,length=2^d))
yes = collect(range(0,1,length=2^d))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="544ccea8.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this example we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 8
h = 1/d^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,d)
xes = collect(range(0.0, 1.0, 2^d))

u₀ = qtt_sin(d,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.831353633461627e-6
Relative error for Crank-Nicolson: 4.831547390434048e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on [<a href="../resources/#QFT1">13</a>] we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an esample of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h1 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h1><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve a simple differential equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using KrylovKit

d = 6
N = 2^d
h = 1 / (N - 1)
Δ = toeplitz_to_qtto(2.0, -1.0, -1.0, d)
kappa = 0.1
A = kappa * Δ

f = qtt_sin(d, λ = π)

function fg(u::TTvector)
    û  = orthogonalize(u)
    Au = A*û
    val = 0.5 * real(dot(û, Au)) - real(dot(f, û))
    grad = Au - f
    return val, grad
end

x0 = rand_tt(f.ttv_dims, f.ttv_rks)

method = GradientDescent()
x, fx, gx, numfg, normgradhistor = optimize(fg, x0, method)

relres = norm(A * x - f) / max(norm(f), eps())

x_mals = mals_linsolve(A, f, x0)
rel_residual = norm(A * x_mals - f) / max(norm(f), eps())

x_krylov, info = linsolve(A, f, x0)
relres_krylov = norm(A * x_krylov - f) / max(norm(f), eps())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0</code></pre><p>with a relative residual of</p><pre><code class="language-julia hljs">println(&quot;relative residual = &quot;, relres)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual = 1.5117834555699724e-6</code></pre><p>Compared to the MALS solver</p><pre><code class="language-julia hljs">println(&quot;relative residual MALS = &quot;, rel_residual)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual MALS = 8.696932943619164e-7</code></pre><p>And the Krylov solver</p><pre><code class="language-julia hljs">println(&quot;relative residual Krylov = &quot;, relres_krylov)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual Krylov = 0.0</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Quantics tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Monday 27 October 2025 10:47">Monday 27 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
