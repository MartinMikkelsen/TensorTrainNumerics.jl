<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets.citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Quantics tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li class="toplevel"><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in [<a href="../resources/#FastandFlexible">15</a>] where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^d)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, d)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(d) + id_tto(d) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(d) ⊗ qtt_basis_vector(d, 1) + qtt_sin(d) ⊗ qtt_basis_vector(d, 2^d)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-0.9111426432795705; -1.0698758793583132;;; 0.008870830888125984; 0.09523821637109967;;; 0.2079964664977716; -0.9105041566018042;;; -0.28197616675914533; 0.5658408251977467], [1.5387133788340401 -0.6405118788382222 -0.03159840577911043 0.34977735525379094; -0.6017246990982208 0.8584398147232878 0.6381846767594322 -0.28012522608440527;;; 0.9450027617787607 -0.28159683631455257 1.1942659416018473 1.0203071218321493; 1.0770006781970929 1.4706510389590814 -0.7367619530923929 -1.6928289356594555;;; -0.3510496889105843 -0.6730900351020308 0.4509028913042264 1.0680387711873567; 1.6409495325480465 -0.18918023638942186 -0.21060608165530179 0.8730130368548096;;; -0.09480567553421351 1.7904396849958188 -0.9168395041385413 -0.3581520079366581; -1.957925899064284 -0.350216605704865 -2.4273531041235112 2.5723879187324377], [-0.7619600941954535 -1.0037039356398372 -0.2854729685737063 0.31365459468917006; -0.09707669005234182 -0.07459832076499337 1.0058310368237664 -1.2968569135116037;;; 0.8007551106550242 -0.17835126866504622 0.05962588396744672 1.222851509422683; 0.08835304390314905 0.6413323608007735 -0.025873873977963896 0.06301840329998645;;; -0.215520089250828 1.8610377741520236 -0.22307992732719073 -0.34060926816381804; 0.5147109179968297 -0.5995416048106128 0.42522317052179354 -0.6792455109100508;;; 0.6711975279739414 -0.8497309631770392 -1.050573973091798 -2.7505291992916505; -0.5022733279910561 0.7585358581479479 -0.29721717877366616 -0.7916168452395328], [-0.3703920498009277 -0.3475513297847698 -0.6906377413236643 -0.29384060522069694; 0.9458052432010458 -0.9501720593933131 -1.0141877422611683 0.8167168388447207;;; 0.6602178136768594 -0.9288070317485494 0.031217357961507108 -0.8811131945416141; -1.3921728333999555 0.7244821550287941 -0.1345151451907569 -0.9709447023645825;;; 0.263625832091835 0.6574623141957421 1.0966021334712746 -0.09676712334413407; -1.1725177685008636 0.29671468234171927 -0.6966909966610465 0.7831892144600769;;; 0.24449331030467086 2.6804885743181166 1.3794516018228167 -0.09928914042233011; 0.25178624771544406 0.9395819699171759 -0.08558618468987886 0.17572735238527692], [0.49047590513127265 1.4570998773840245 -0.44154326298268287 -0.17564553597731014; -0.5145248635178121 -1.5357815654329605 -1.1986402029381078 0.8139907314221723;;; 0.4642101336966034 -1.6513530534461642 0.5549355508402276 -1.942486975947183; -0.8845737767770346 -0.3508513758680222 -0.02053717565315372 1.3503631807953116;;; 0.2585530304585286 -0.44096914418303074 0.7185263443409479 0.486142832202782; -0.27306841712690416 -0.7915726710815307 -1.2242881914697346 0.6168600692087285;;; -0.438546747838099 -0.5825423413077244 0.8577877968502917 0.2754176865731594; 0.059919104466568104 2.0629207528769764 -0.11675819352898854 -0.8035468317102236], [0.8589556035314257 0.9697364150652834 0.7216160627014964 0.4220075427521368; 0.2527997209975309 0.7571182941834677 -0.5679487990850356 -0.662771496278377;;; -0.887501642819921 -1.0998433660715723 -0.32272870219328065 -0.1868066231904003; -0.39812176447566566 1.1181711076036829 -0.40735279247782935 -0.026364163613314045;;; 0.8246180899963383 -0.14055903455401306 -0.9490843046366434 0.2922740948710862; 0.14565360789060625 -0.26667650674436605 -1.8673482212031964 1.1492407815733001;;; 0.7224412889468826 0.048168109380751875 1.6487876147245961 0.16223898762100353; 0.4931300900651514 1.177604174726756 0.3297807820554569 -0.19504748018163684], [0.8085003874940722 0.9310331767280335 -0.6785384568881211 -1.2351643238563095; -1.2596493060527632 1.5023620741891122 -0.9942341804141138 0.8072550461849265;;; 0.2272395019426444 1.6741663285676283 0.17524740707732134 0.43951955470151; -0.9058269879254756 0.2651324805182086 0.7572994790588569 -0.6882279733423763;;; 0.3597082929593516 0.44504740504890195 1.1949979731170504 -0.36494724265126793; 0.7265304305264224 -0.5849279306364649 -0.8483778555536579 1.4990964334804275;;; -0.8439933785815742 0.8930090070158726 -0.8329965462589013 -2.0067537360819547; 0.3577845472651439 -1.7378601152756536 -0.19404107312781818 0.8186254647610377], [-0.8734003243685006 0.6369881288625308 -0.5490138039511363 0.6555003295888276; 0.0069780686913417985 -0.8845028683094122 0.5627093937755208 1.02006082125541;;; -0.7301911267741907 -0.024556431142809036 -0.8598760703182119 -0.7883303106433612; 0.0050238854095527394 1.2755757910606185 -0.048862776847001584 0.6372940016366421;;; -0.5773874509799671 0.59430308705858 1.9333489387822675 0.7769462561128394; -0.28355413280364167 0.20445063813303638 -1.9225076314029765 0.39462470601587973;;; -0.31741423207558345 0.6506590637660288 0.07722968891174836 -0.7175848039867436; -0.938116918830522 -1.3916870307021323 0.6533325548603872 -1.305072147834703], [0.49669143896738654 -1.7587502083812458 -0.9648090407207224 -0.695555210373434; -0.6812457151692776 0.35769726028612475 -1.2637276278818403 -1.104479324178435;;; -1.527337207031297 -0.6818965480018292 1.0448513882217754 -0.4927665202197527; -0.3749486224966865 -1.0165516589933388 -0.00016920620327876096 -0.41931969331549296;;; -0.6712456394537282 -1.2396645431518316 -0.5021302467772101 -0.3001933116302773; -0.5862718715062432 -0.29187591801808976 -1.5103096845937376 -0.5957353483516642;;; 0.12342268340958858 -0.056553380592879426 0.5451645751230694 -2.577797511803509; 0.11199427692151576 0.3858048843102582 -0.5882101647782535 -0.8659148916273056], [-0.4592390121898182 0.23219803585871304 -0.3358327693911883 0.2556532838209679; -0.9857996253934163 -0.9060187288474896 1.7789858789238102 3.0119685081653382;;; 0.6366911975844938 0.1345093729237642 0.5820918814131957 -1.6526385629724796; 0.3848508506732029 -0.876469623643767 -2.710584367235029 2.188220053521743], [-0.5883936397082564 -0.5330335511174168; -0.09267921061288863 -0.5253269781161977;;; 0.5785693052375366 -0.37626028773924314; 1.0811889582025278 0.7053980307843518], [0.3038891680533188 -1.377653163555803; -0.024458022685722985 -0.4057489979040178;;; -0.5450570145565801 -0.7902819810702362; 1.2226518938693323 -2.3203768097870565], [1.6201388306871498 2.086200996133228; -0.8661237738758922 0.11117420381990592;;; 0.6311971112323606 -0.012389322595587487; -0.9306956323297506 0.612223386189251], [-1.9890149265304242 0.7770504423294865; -1.1296621486665597 -2.374601709766972;;; -0.7845506130026106 0.17832773340904828; -0.051388228243906986 0.5022489986528921], [-0.18213068812995672 -2.449124147255233; 0.6108060163014524 1.6838347873703707;;; 0.05398095736883744 0.227857477135923; 0.46533737161343264 -0.2585544879418778], [0.6114354577921453 -0.9583942163930276; 0.9395229491450973 0.21290010030813633;;; -0.10192206299725926 1.6275955399190947; -0.30183644886640265 -0.5944111935687176], [0.40087409100980476 0.10882135912646342; 0.005660964433834413 -0.6728628946331803;;; -1.0405923428178943 0.6746684261622398; -0.9269486095234989 -0.08509623220942507], [1.074109393864729 0.5353986433784114; -0.5917164984294521 1.2976152607996516;;; 0.29695022267078097 0.9969918122231968; 0.6760821966562499 0.742437139525757], [0.06849920871609778 0.9824187663268155; 0.2887361138206259 0.17821130145006317;;; 1.455562550114192 0.9462145637365614; -0.00908104130970497 -0.15026616010271096], [-0.017105259486740458 0.9754637346490246; -0.9294189417902438 0.42404101558534946;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-194.76587171230767; -174.7490919805893;;; -104.56894310437373; 116.54687945400204], [0.6902043328434466 -0.49495588500846105; 0.7028085985516282 0.47648047538558347;;; 0.12494490572261417 0.5161372061582169; -0.11489496860390101 0.5039825522152438;;; 0.017538917729163248 0.058151037673085354; 0.012857979362664754 -0.06351039213582531;;; 0.013679077686935968 -0.010848455628552309; -0.014349599811089806 -0.007496524020566486], [-0.7037847559407394 0.3259832758347966 0.07952201276592771 0.14444698733660444; -0.7067380375110381 -0.32324302808762745 -0.11519765239819205 -0.13483916508920127;;; -0.05105521652012966 -0.6284811610245515 0.3801779563903265 0.06528425012922304; 0.05014196702784373 -0.6229812248582923 -0.2806253183600704 0.17139672721116522;;; -0.006067898972954349 -0.0552485783312475 -0.4874200864457713 -0.5101440028109034; -0.0036032818195524626 0.05562460923018795 -0.4488666370037578 0.4959992464021999;;; -0.004391086874895305 -0.00014452442530198792 -0.39159747006200735 -0.4283960786767763; 0.004287003191495738 -0.002631118491467285 0.40567769837540374 -0.48685759007803686;;; -7.998203862684086e-5 -0.0007614583666659198 0.0081811484921814 -0.01040028153710333; -5.843240960187113e-5 0.0008004001143012531 0.008099432880056039 0.008889568779048125;;; 0.00013955608820143462 -5.848456630087675e-5 0.0014120137078874686 -0.012454279758806022; -0.000138858903306259 -4.730182182542528e-5 -0.001674695636206129 -0.012512343773679213;;; 4.4267166346875664e-7 3.890815921447562e-6 -6.416651471921159e-6 -0.0001832229793251163; 2.137466116232124e-7 -3.9960275430109284e-6 -2.8063490858300264e-6 0.00018498082432204436;;; 8.844515494533378e-7 -5.363088588752623e-7 -6.633403645298534e-6 2.088935456435801e-5; -9.076726949373918e-7 -3.1554583473755083e-7 6.994435260956225e-6 1.9261303310814074e-5], [-0.7064664464455083 0.180593995997812 … -0.3579718583038424 -0.0033088261877754635; -0.7068826638780009 -0.18074401605132395 … 0.35673043449480335 -0.00445047780322531;;; -0.02449993719621381 -0.6831977986864729 … -0.0733208083313426 0.1014340403840512; 0.024817236453579493 -0.6827850011307477 … -0.107623918354395 -0.1065300209859001;;; -0.0016927077479570855 -0.029741542183729288 … -0.04774895056509477 0.07731641444031093; -0.0006891931111663996 0.02869731441567003 … 0.1549537691561767 -0.07345060418162312;;; … ;;; 2.082887393806149e-10 -1.2151258133017063e-10 … 3.533987685914612e-5 0.00011144724982251793; -1.834325837475437e-11 2.882630884679958e-10 … 5.533075694019527e-5 6.615357969404659e-5;;; 1.2179171005779195e-10 6.796902683555225e-10 … -6.115286173105508e-5 -0.0001734964401876881; 7.429191924882244e-11 1.7411307768610038e-10 … -5.4890518003172235e-5 -4.742096817260568e-5;;; 3.9399756457074334e-11 -2.797841506186167e-10 … 2.6478407810967476e-6 -3.0113636653881874e-5; -1.0774957911032956e-10 2.869905096829655e-10 … -1.6093316138906747e-5 -4.7167657985582026e-5], [0.7069782351366887 -0.09236618887332596 … -0.10169868852573151 -0.04595356352706059; 0.7070157417801961 0.09252345356989067 … 0.09715689506236967 0.043413101545693944;;; -0.012369584093738988 -0.7009098101485678 … -0.11727423991111904 -0.059859003580349665; 0.012537680052934132 -0.7009242524524978 … 0.13986528993312933 0.07805859246152427;;; 0.0002453515543157056 0.001974121670699555 … -0.14090160919927072 -0.12815041614673978; -0.00017196067098571315 0.001797438960927668 … 0.21625720916939187 -0.1175231165369068;;; … ;;; 4.056534263871158e-12 -5.052337440317922e-10 … -0.1444056236611242 0.22334742554322798; -6.609765317427064e-11 2.71113035171828e-10 … -0.007402892102254288 0.14871853555688877;;; -3.680356879205439e-12 -1.183369258637519e-11 … -0.22464313102459912 0.27733715952944027; 9.777380762883896e-11 -4.694224856366497e-11 … -0.32686457243425276 -0.2909738092948035;;; -7.214965873728634e-12 9.142270387990263e-11 … 0.01596657487217203 -0.045560639446059925; -4.639668487737475e-11 7.298201081164277e-11 … 0.1780246097139513 0.20836956568893028], [-0.7070752866385178 -0.04636776796197811 … -0.053064160874452274 0.08004546510762846; -0.7070822945436479 0.04620825983302484 … 0.05487510136078202 -0.07994614118967858;;; -0.0063698499359138225 0.7055666597461449 … -0.10580865082968735 0.00033249483835461806; 0.006210808045927023 0.7055831738410441 … 0.09950017427088505 0.009787377752192145;;; 1.0009217862544662e-5 0.0005594381632547959 … -0.21641813958592354 0.0739956724692905; -8.213571459975505e-5 0.0005307102328513494 … 0.1888458610160243 -0.06412759077140831;;; … ;;; 9.232158269287097e-11 2.0000936948511868e-11 … -0.21796225240538475 0.5746246730639866; 4.985312842733188e-11 9.303485361533564e-11 … 0.5588865943385323 0.1645393884817587;;; -1.43707545928626e-11 -1.5602516825481352e-11 … -0.059424955638188795 0.13620460688516328; -2.8038438697114365e-11 5.539551240933124e-12 … 0.1933422076499352 0.0766012263578555;;; 1.102644943067981e-11 3.405994888253132e-11 … -0.1363494652868587 -0.21305570885005815; -3.104668371437811e-12 3.624790840557215e-12 … -0.03740232848444305 -0.2861049038535592], [-0.7070945009125905 0.024044728246604894 … -0.03193923816049114 -0.06849319547854764; -0.7071036094124656 -0.022194798237928085 … 0.032150259111011235 0.06852773338219957;;; 0.004088664833132237 0.7066525164852309 … 0.023247716081244936 0.006834438970263341; -0.002242745705852938 0.706714640959682 … -0.021544997064751256 -0.001286106572841569;;; -0.00022793289001446176 -0.007632455370808019 … 0.06475663109616309 0.11436488279903444; -0.00021933863137364704 -0.007626126205691124 … -0.08569728663557218 -0.02568877001042119;;; … ;;; -3.650804055063266e-8 -1.8427638165502474e-6 … 0.03881064557274992 0.1114831066719042; -2.0697437978867872e-8 -1.8431274994483808e-6 … -0.03447105971381631 -0.03703941647569873;;; 1.9450124278109466e-10 1.3583464763380437e-8 … 0.06833963809232213 -0.12714443413310447; 7.160495816636027e-11 1.3713518732946933e-8 … 0.02191441969852367 -0.12662268736712076;;; -7.324994187526472e-11 -4.1651177455333015e-9 … 0.0024234359574929845 -0.2554241731606486; -3.660264442984987e-11 -4.1559057200124e-9 … 0.019212458314544212 0.23406058272645702], [-0.7070967748967147 -0.013812069422328056 … -0.07580636375966547 -0.04687407602171368; -0.7071065266758841 0.009496371776630975 … 0.07560308780536769 0.04640679702312086;;; -0.0037238292166917385 0.7066072744235826 … 0.04497807351344166 0.1048445236491077; -0.0005692006300429804 0.706678736522661 … -0.0476871995713979 -0.10678338230876526;;; 0.00039456860038602836 -0.020475345610058926 … -0.04371585890764557 0.015357473000294213; 0.0003264347470435899 -0.02047263285890121 … 0.011319560982058432 -0.06080784032252252;;; … ;;; -3.832978152368596e-6 0.0002000022731253891 … -0.38467479272622646 -0.2633759311452329; -2.972253276989926e-6 0.0002000497332154779 … 0.1914595360185026 0.3073267020807913;;; -3.2722775097527153e-9 1.8258232406916026e-7 … -0.05305263496029253 0.1518370560512117; -2.49394996786256e-9 1.830042796619735e-7 … -0.07496439994708985 0.07787484691639103;;; -2.5056090832000557e-10 1.5063558605431754e-8 … -0.008506994899806603 0.18219049732983753; -1.862017373825429e-10 1.510552419193277e-8 … -0.06681419090695144 0.18818146820549453], [0.7070893799258774 -0.010151810800059412 … 0.04119156751927703 -0.08856537899831361; 0.7070985102904858 0.0018086538791259475 … -0.0412008897831245 0.08853266853322259;;; -0.0048892469511440575 -0.7041426309357591 … -0.004994934865535661 -0.015158145054694303; -0.0033499636202424486 -0.7042154002409884 … 0.004239773577791105 0.016774937354146313;;; 0.00043036052941258264 0.03289572106811011 … 0.032231918260927216 0.03125905383251942; 0.0003639279441136649 0.03288394113870505 … -0.0320110865593312 -0.019597287655551944;;; … ;;; 1.4427072958591875e-6 0.00012141498063044261 … 0.14375156863279004 0.053377440604617736; 1.1799996723498922e-6 0.00012132575547363448 … 0.6379052157307888 -0.13720832584166107;;; 8.78493140394706e-7 6.664786522352263e-5 … -0.10379104524317728 -0.7000363841464627; 7.346865885480814e-7 6.662621979589803e-5 … -0.36506839404802194 0.14267562296515407;;; -1.148911116114215e-7 -9.478044704462676e-6 … -0.010214918787158484 0.08590588179390334; -9.437237579585939e-8 -9.472601123061008e-6 … 0.020351336497585512 0.22056593695939852], [-0.7070936138005097 -0.007165881882949098 … -0.014306734543533579 -0.03258482468064237; -0.707097665973012 -0.0007383271663460925 … 0.014306967968453132 0.032584674179779526;;; -0.00422293058741535 0.6942586052121916 … 5.695208530679116e-5 -3.1762301545590966e-5; -0.003510913434870299 0.6942966631552336 … 3.1186589177114664e-5 -0.0003414829127108261;;; 0.00018434856038500061 -0.027829398438583026 … -2.5743311072172646e-5 -0.0012643127319135461; 0.00015673457644667146 -0.02782372039318776 … -0.0005123272899537678 -0.0005543457022058423;;; -0.00014238381571392782 0.021484829474028105 … 0.0010802708322583882 0.023764681149937825; -0.00012054113400851865 0.021480671776032596 … -0.019328830097299427 -0.028196974304515173;;; -0.00023140814744098312 0.034811603429452574 … -0.07402424948117593 0.5090054508243104; -0.00019575163411077087 0.034809420008167294 … -0.3036694817464438 -0.5671599652877312;;; 0.0005979597210440295 -0.09021605907777412 … -0.6235931532462871 0.34096254168227275; 0.0005055882415835556 -0.09021145358883252 … -0.2815325838968671 -0.45765043196888266;;; -0.0005547928068709336 0.08379939605399131 … -0.5804367612847372 0.15610147895997656; -0.0004689963532071001 0.0837951525031983 … -0.16594526175531613 -0.25060410557329316;;; -0.00012376816857071661 0.018561422307559194 … -0.2574299992363049 0.02245691160515068; -0.0001047558921339637 0.018560866084845952 … -0.05173936136905062 -0.048824841274412556], [0.17707909782256026 0.14215054274875225 … 0.10087072814562037 0.164799300948595; 0.9836966030651334 -0.00519182267078502 … -0.004256814134919742 -0.03187860844848876;;; 0.020147024810501516 -0.9898140969539712 … 0.01821114585950851 0.024159862650260832; 0.00823496238427221 -5.0180587814316947e-5 … 0.015709136347005572 0.003140653140717488;;; 0.022195679755839023 -0.005530955083768726 … -0.622682181604332 0.02060287330941842; -0.004197679114228136 -6.370555600798487e-5 … 0.0820027954891531 -0.2850954777148237;;; -1.1042341498915699e-5 -0.0006651244118337327 … 0.09709129406813369 0.002042448332813469; 2.9214673900222714e-6 8.466223682698901e-6 … -0.007135682846027405 0.2676547794923686;;; -7.09679035557776e-8 0.0003759215346592661 … -0.07549930044212193 0.007442653094988937; -1.3193955740358975e-6 -1.6550971017859292e-5 … 0.025407993917335624 -0.17397220051217763;;; 1.6428152096925174e-6 -0.0017611724135791654 … -0.21212877999780747 -0.1790147778719835; 1.317083604147903e-5 0.00017368317598230555 … -0.340364634865652 0.6733178349356885;;; -2.3417533986371503e-8 7.69842608144293e-5 … 0.04290965888056362 -0.17249602763076266; -3.167029214213907e-7 -6.713323771484361e-7 … 0.060474781256329935 -0.2854695594074217;;; -1.0024977601952333e-8 4.159220876789242e-5 … 0.05647235383358852 -0.1886543735895879; -1.569944402401673e-7 -8.421152361019756e-8 … -0.6398541854172274 -0.3941079559411918], [-0.40889652466304455 0.2580386035771029 … -0.01001408347184723 -0.010606868479353096; -0.9114653244220877 -0.1313516063715576 … 0.0002333475506440663 0.00015759164935191374;;; -0.01537945678813233 0.956805035337831 … 0.0021143769309352072 0.00218908339807361; -0.01804658365338575 -0.0012147703660704634 … 0.040488921039817674 0.04495251620299403;;; 0.012712005491307196 0.02583066672016715 … 0.04125043896981082 0.045509184678417164; 0.03620486787850809 0.0042402129607005375 … -0.10062588298125828 -0.10846659100023172;;; -6.185851384059641e-7 -0.00014450126713908977 … -0.008951441146597197 -0.009845648151576016; -6.609598125455971e-6 -7.9488850046608e-7 … 0.010342047816291292 0.010818740404187092;;; 3.941152775960568e-6 -0.0003337067614693954 … -0.006926771947142181 -0.007581782690654738; -7.379021012863083e-8 -4.760611722115586e-8 … -0.06736631920604386 -0.05888352560239883;;; 4.51751300205845e-6 -0.0003828985349321816 … 0.004292314784977135 0.004701078504890313; -9.375463023622738e-8 -5.553717035121674e-8 … -0.12885573719125823 -0.11237952372582433;;; -4.5352895710712747e-7 3.8329080559685305e-5 … -1.1178913835189007e-5 -5.593167294419075e-6; 6.49587294923843e-9 5.537974211945086e-9 … -0.9823205396690722 0.042966066777033914;;; 1.5979520031505099e-7 -1.3479521471693146e-5 … -2.190754607625694e-6 2.063702989662075e-6; -1.6165437461018082e-9 -1.962713483570958e-9 … 0.00891729667390621 0.9827460435352293], [-0.5243288945778953 -0.42146624122460014 … -0.02698672265212048 0.023620097019196044; -0.8501007711826356 0.28140866177001617 … 0.01161350212879279 -0.010541289211050344;;; 0.02151796173066777 0.8617114166653028 … -0.014568748815901002 0.01234932128123297; 0.017750273906790615 0.014985377017238764 … -0.09801095868181461 0.09867053528793747;;; 0.014983739607002538 -0.018539139700630883 … 0.07003051177382114 -0.07082477852833183; 0.03748708047538375 -0.007781078366429857 … -0.08732694318452458 0.06583568656718386;;; -8.788906285321486e-6 1.7377599804905528e-5 … -0.024658806903747724 0.02436344808708279; -2.2625794216861004e-5 4.897615267237593e-6 … -0.0017761741556568244 0.007833849079682325;;; 5.016214426169763e-7 1.561771290191619e-5 … -0.0034824144502948098 0.002854916287971913; 7.030314734085412e-9 1.5853939411275048e-7 … -0.2514283725651137 0.26674024006776215;;; -3.5881424838334996e-8 -1.1209416555761357e-6 … 0.0013040182553571956 -0.0012735251985837943; -1.1884332204638267e-10 -1.1291595030310074e-8 … -0.9551354804055001 -0.1014689475349233;;; 1.9101582665760128e-8 5.932936774325458e-7 … -0.024521330208351424 0.022445857188710335; 2.1862119268696805e-10 6.130056980691189e-9 … -0.0008144372781788493 -0.053290393186458736;;; -1.5873732072849705e-8 -4.957072738900056e-7 … 8.03842254756737e-7 4.7618317789805325e-5; -2.7419693639000146e-11 -4.967032172540949e-9 … -0.007821041432864611 0.9458527359572946], [-0.5903191267634472 0.5860246519565637 … -0.04566161735442103 -0.04321883252146081; -0.8064126900403202 -0.43524466831603076 … 0.027362642319854247 0.037954008366290815;;; -0.01155031847421898 0.6756669470966248 … 0.0636295016431636 0.037719514678815645; 0.024038540694768976 0.10202584646841321 … -0.013654246176014033 0.14636445485213412;;; -0.008443323695586005 -0.009031213100952633 … 0.20785879062666998 -0.07945119701248972; -0.02096039680904186 -0.010977419441584188 … 0.09838109848355941 -0.0637933176006543;;; -3.80338804866333e-5 -9.402417691183438e-5 … 0.07219453090163003 -0.04558561267220967; -0.00010404130698679929 -6.09005418275316e-5 … 0.018422481382753916 -0.06294536841729997;;; 1.4082019323696279e-5 -0.00010071293121260839 … -0.33974860616634306 -0.004340693424163407; 1.4307034279535518e-5 -3.872964069045022e-6 … 0.02780958685849585 -0.3642949544566156;;; 4.263189752514693e-10 -3.6927338506057637e-9 … -0.09694661301530136 0.006891932960985384; 5.668308941835926e-10 -6.467016162661926e-11 … 0.04553120208537343 -0.19685092470810123;;; 5.214678977940224e-12 3.3123231119427495e-10 … 0.12370420842276479 -0.003722077310553211; -9.725313348255361e-11 -1.8890410350462324e-11 … -2.800118722025031e-6 -0.8849715120111646;;; 2.017624183848147e-11 3.600324356930765e-10 … 0.8896733328659155 0.04785243406178233; 1.1531001721026748e-11 1.2898294052920851e-10 … -6.485606148019484e-6 0.020453254771480526], [-0.6569863341908506 -0.6295469559591675 … -0.04465606636842961 0.05012934603608653; -0.753092484518995 0.5481658193858143 … 0.04737172431141512 -0.04108997181492826;;; 0.012648988417910038 0.5032866273808131 … -0.03115814848676013 0.10217727985764496; -0.031636204895445705 0.22296177661351643 … -0.1570881500808104 0.024739000256914136;;; 0.002437149589505082 -0.00803620131172821 … 0.15196761118040508 0.21207507596607397; 0.007326761166690477 -0.010468733004152655 … 0.18718336824176215 0.11630415391862614;;; 7.691673215479997e-5 -0.0008285110789141655 … 0.12044260428689095 0.10272986869672483; 0.0003930125895372685 -0.0007019336660516566 … 0.18117152914897527 0.05215967727845929;;; 0.00012202038607895854 0.0003545569185775719 … 0.04218446927792317 0.5381917046507243; 0.00015390881361022264 -4.259452164705397e-5 … -0.4295915647231332 0.10975308787010998;;; 2.933134256857168e-9 9.498996837923169e-9 … 0.004349031252904805 0.12189985971977925; 3.398118165331651e-9 -3.5543141160306487e-10 … -0.42633158733302035 -0.005575665260007862;;; -1.5516245219266196e-11 2.6265241718352924e-11 … -0.011242966757681536 -0.7650958352437048; -3.261738925936308e-11 8.86635024408594e-11 … -0.20164970507812469 0.07299375472929828;;; 2.7779101303876903e-11 -1.0618118974347902e-10 … 0.001873208827348444 0.05175276054620843; 2.1420461024072184e-11 -8.652148701621652e-12 … -0.67509586810493 0.05481886219973517], [-0.6932728839246672 0.6210598118856862 … 0.04974732056344368 -0.06741525187727955; -0.7204774833128025 -0.5965785287187022 … -0.04586752275834313 0.06771081180452136;;; -0.00882171048110622 0.4081332610133185 … -0.1418873895898233 0.0724418610859174; 0.01430921087241733 0.3028979527046035 … -0.010210907928592554 0.16799244603048427;;; -5.152817498110678e-5 -0.004317231247887217 … -0.17241433491732125 -0.018563098744381716; -0.0013573599754726977 -0.004969225817237728 … -0.17328860983801772 -0.010565268855149136;;; -6.373022821924389e-5 0.00273077675699266 … 0.3423713824274574 0.16446361655851074; 0.0006852701427364519 0.002833643405860799 … 0.09769900766384271 0.4398174337000182;;; 6.288369893661952e-5 -0.00012955348536464276 … 0.6344023611600443 -0.04606125464131674; 7.530003991082366e-5 7.404536020966109e-5 … 0.09625885546039636 -0.2807651040245153;;; 3.4040119029632583e-10 -1.2158475799925499e-9 … 0.47964472782597584 -0.1980047731320534; 2.566895271606841e-10 -1.8525953152071925e-10 … -0.12290004822349218 -0.5727280121191712;;; -9.975265619418873e-10 1.9988074360688624e-9 … 0.35859054239564303 -0.0949861556025532; -1.203135429060265e-9 -1.2160935532899216e-9 … 0.05642152689266605 0.5146500593028324;;; -1.9131951539030283e-12 8.307832448606707e-12 … 3.69805864021693e-6 -0.019648052579532914; -4.152890356867437e-12 -2.321376086637004e-12 … -2.8835895879250716e-6 0.11836480383304922], [-0.7034045331925873 -0.6163771672045103 … -0.0816493993962957 0.00026977485419492814; -0.710769398518883 0.6095588183895325 … 0.0805197007500192 -0.0006244358865433656;;; 0.0031503441426475338 0.3675676880595894 … -0.18939193177165964 -0.033577015588584704; -0.004348728025568258 0.3367576025170734 … -0.09049875887837949 0.036821340847240494;;; -9.862158441473628e-5 -0.0014366882256463878 … -0.16020142752110084 -0.04581571737879843; 0.00024946658475722674 -0.0014876478387690958 … -0.23606048983440045 0.08784302443384566;;; -8.383798761358709e-5 -0.0008179730893566483 … -0.36565440241516206 -0.29731011208648994; 9.740031667028165e-5 -0.0007743429647602294 … 0.2570023170869783 -0.3789144688154377;;; 9.995261856442793e-6 1.5877121396826237e-5 … -0.5575262256118263 0.3771275985850462; 1.1585890449609313e-5 -2.0142803846895827e-5 … -0.47895129819889054 -0.5517287919482794;;; -4.682927030552558e-8 -9.103229697842662e-8 … 0.22783385004464823 -0.23517740159486247; -4.9520093296253674e-8 7.125074963485052e-8 … -0.2280928271268873 0.0797107628431329;;; -1.2293624588511468e-11 -5.027559090914231e-11 … 0.13222631432535123 0.1276074627071161; 1.3910340204530647e-11 -4.016778452259688e-11 … 8.782100139630239e-6 -0.15195467439408927;;; -1.0817673028358977e-11 2.5623749917523237e-12 … 3.53282704215777e-5 0.12786790820765456; -8.261586907645315e-12 -1.32146734086026e-11 … 1.1258351211295159e-5 0.43785290325085435], [-0.7059621173406967 0.6181455653763378 … 0.01571083782083235 -0.17677088630016605; -0.7082481675586808 -0.6160155185144708 … -0.01548748340412618 0.17642435951779734;;; 0.0008427656260440834 -0.3494347323074497 … 0.092204122160569 -0.3054548871545093; -0.001143456620867865 -0.34105140841814724 … -0.03741750241029436 -0.3261051590185608;;; -3.2513236542947425e-5 0.0003742263650759669 … 0.17611007744925702 -0.29780184293181844; 5.52297362015856e-5 0.00030563158570502387 … 0.3530058387294673 0.5577221334042836;;; 1.207929826755461e-5 -8.470938301958971e-5 … -0.7781044943962203 0.4108983301819536; -5.415098119836374e-6 -7.068533252078054e-5 … 0.478055595142315 0.4115845998228838], [-0.7067127744501196 0.632798547549909 0.06659636357834349 0.30933473294455793; -0.7075004857192922 -0.6320402163185562 -0.06608663544636631 -0.309193764940914;;; 0.00017314218690350595 -0.31748749435764184 0.8219160088664613 0.47292254684812446; -0.0002952249359998334 -0.3151076865156175 -0.5618287598036854 0.7648892098849774], [0.7069831918143608 -0.7072303489613402; 0.7072303489613402 0.7069831918143608;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^d, 2^d)
xes = collect(range(0,1,length=2^d))
yes = collect(range(0,1,length=2^d))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="7b4b9cfb.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this example we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 8
h = 1/d^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,d)
xes = collect(range(0.0, 1.0, 2^d))

u₀ = qtt_sin(d,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.83130609101863e-6
Relative error for Crank-Nicolson: 4.831483763392838e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on [<a href="../resources/#QFT1">13</a>] we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an esample of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h1 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h1><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve a simple differential equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using KrylovKit

d = 6
N = 2^d
h = 1 / (N - 1)
Δ = toeplitz_to_qtto(2.0, -1.0, -1.0, d)
kappa = 0.1
A = kappa * Δ

f = qtt_sin(d, λ = π)

function fg(u::TTvector)
    û  = orthogonalize(u)
    Au = A*û
    val = 0.5 * real(dot(û, Au)) - real(dot(f, û))
    grad = Au - f
    return val, grad
end

x0 = rand_tt(f.ttv_dims, f.ttv_rks)

method = GradientDescent()
x, fx, gx, numfg, normgradhistor = optimize(fg, x0, method)

relres = norm(A * x - f) / max(norm(f), eps())

x_mals = mals_linsolve(A, f, x0)
rel_residual = norm(A * x_mals - f) / max(norm(f), eps())

x_krylov, info = linsolve(A, f, x0)
relres_krylov = norm(A * x_krylov - f) / max(norm(f), eps())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0</code></pre><p>with a relative residual of</p><pre><code class="language-julia hljs">println(&quot;relative residual = &quot;, relres)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual = 1.5117834555699724e-6</code></pre><p>Compared to the MALS solver</p><pre><code class="language-julia hljs">println(&quot;relative residual MALS = &quot;, rel_residual)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual MALS = 8.696932943619164e-7</code></pre><p>And the Krylov solver</p><pre><code class="language-julia hljs">println(&quot;relative residual Krylov = &quot;, relres_krylov)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual Krylov = 0.0</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Quantics tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 26 August 2025 13:18">Tuesday 26 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
