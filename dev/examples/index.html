<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics</title><meta name="title" content="Examples · TensorTrainNumerics"/><meta property="og:title" content="Examples · TensorTrainNumerics"/><meta property="twitter:title" content="Examples · TensorTrainNumerics"/><meta name="description" content="Documentation for TensorTrainNumerics."/><meta property="og:description" content="Documentation for TensorTrainNumerics."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in <a href="https://arxiv.org/pdf/2505.17046">this paper</a> where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^cores)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, cores)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(cores) + id_tto(cores) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(cores) ⊗ qtt_basis_vector(cores, 1) + qtt_sin(cores) ⊗ qtt_basis_vector(cores, 2^cores)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-0.1619657589173134; 0.20533237371535742;;; 0.7431978325596765; 0.7673157259003869;;; -0.17387971675020003; 0.054617197945648045;;; 0.26079638734591404; 1.2606399970185465], [-0.4756413935503926 0.5511845158467268 0.9869426734351101 0.001943998284442768; 1.1400680818906785 -1.6951278955263636 0.038769229261241184 0.37081370471298525;;; 0.20265363311483425 0.5906769180380116 -0.6207766022186585 1.9080370244564442; 0.2377465701273699 -1.0242012000742844 0.6686210127379729 1.3120186491767873;;; 0.4099333014317556 -1.6034969616671058 1.2904582981041635 -0.9133791787802898; -0.030622052496799307 0.411147838430096 0.666347583666824 -1.1800763580685143;;; -1.8628996118384433 0.5322525093796415 -0.06638501069624543 0.7169980555165352; 0.12200835402627118 2.072026439486821 0.4288715124441507 -0.030780779310096335], [1.5010779136231973 1.5471991609798383 0.7982263718212831 0.4547324234675636; -0.853045835747382 -0.14827115232402177 1.1596475692715176 -1.1229109875175085;;; -0.4281200934080753 0.08241442443286257 -0.960082673777926 -0.5974173261107889; 0.11201249765574771 1.8917809365482725 -1.8910852212223412 -1.7213302254153602;;; -2.294454883508477 0.5242598015093818 0.9161576095595292 -0.8613721723402786; -0.2768674096659304 0.7240510265065104 0.6216360491004824 -1.3863692316639948;;; -0.20152944344351104 0.4449551348309905 0.16188696496064567 -1.6914047821551932; -0.32208160762385796 0.05173478983468436 -0.998017605259565 -0.7340332147807781], [-0.652082387126283 -0.3547580376006493 -0.20887569772661393 1.2158594358600388; 2.1016610877258577 -0.06477100967011783 0.6510228061382792 -1.4960528666147248;;; -2.1888122390007263 1.2137632737371222 0.6999360556001792 -1.158603101982415; -0.27942857256379666 -0.5819632499501807 -0.34818990156325114 -0.6928728049346501;;; 0.32227921815173544 -0.6168612646088312 -0.04534940659656055 0.1543711574258414; 0.15987808707547452 1.019589113319655 -0.8342831488366527 -0.2109560933601647;;; 1.3224954259988555 0.420442687739032 -0.5648714145907582 -1.581710184611544; -0.12790406230758133 1.5579162690106845 -1.3369107278584502 0.491991510367819], [0.8671858543366152 -0.2973683427974231 -0.6845361084095252 0.21976710940814975; 2.8951932997961256 1.2437511836475887 -0.8238437118819449 -0.6823560106956472;;; -2.2218200535368484 -1.0127664546034825 -0.5233784121330068 1.7753755202161579; -0.6073357392344075 0.6034291008180838 -0.3283595162968744 0.35500286576026235;;; 0.5696006394827113 -0.33200185434591883 0.5177728037421393 -0.45527599098096305; 0.47112204945425346 0.9574979499300671 1.2453258792147412 0.46184166570749957;;; -0.8927375375403037 -1.5572587920132401 0.5734065266549104 0.9272073970558393; 0.9682948317780967 -0.3096989749533191 0.09095775160847587 -0.16261043816001108], [1.0775043737991434 -1.1016370849767287 1.012311986700299 -0.39979798555640594; 1.5196648101467958 -0.52094672785384 -0.7141861020132846 1.3218115369888128;;; -1.293206666352922 -0.013696726114122038 0.4247196499062575 1.4986807174327588; -1.3809892567238389 -0.5149673137832862 1.5651847872104065 0.888565699481425;;; 0.3411259808232233 -0.05975964587754391 0.050048830757478964 0.6483590435068926; 1.742356206473164 2.3246952456669345 0.200012284866585 -0.2383070520906556;;; 2.063394265614548 -0.3800476512393238 0.8657777903233369 -0.585888717687738; -0.6131522517127902 -2.282159680246151 1.008459981846145 -0.20991521129564575], [0.14417446239872828 0.017793140060940515 0.6876977094465544 0.8048811825093053; 0.32889380156456527 0.7357068308547831 0.5240918171742962 1.2684711145468137;;; 0.02384870064097666 -0.1641318010203078 1.2878175657731938 -0.26504692570196986; 0.5027266638166157 0.23803907216638842 -3.8046078848315568 0.6191179767394778;;; -0.17735936067629163 -1.843337046430376 -1.9025619774634 1.3567036070532779; -0.791442405075425 -1.0704584413282643 0.7527265530944621 -0.3670370072249016;;; -1.0152612586952212 0.8783604951211453 -0.6681105560031955 -2.495628443331027; -0.38585015750417645 0.8691440021400336 0.31437431532655474 1.9366445181903509], [-1.6947669817464601 0.20446114903712823 -0.6587653614384862 -0.6734511263481882; -0.256221189944846 -1.0745007482419089 -1.05478785420886 -1.4832531323845304;;; -1.2020326786355147 0.2966076263234006 0.7258475832140885 -0.7284046494721045; -0.754942383705725 -1.6906099250191842 1.5702553581535175 -0.30054252969643996;;; 0.6121613041783206 0.3149711842514362 0.4634500838148976 -0.4716631101672118; 1.9158940469808046 -0.1880147760161268 -0.47315070762589717 -0.01237152448118796;;; 0.7159057451602501 -0.6318242827558428 -0.38642829173444626 0.13333632239711118; 0.5812357573638569 -0.1020782444678038 0.41126091903420026 -0.04688795987553098], [-0.36832992648261026 0.19091962298417245 1.1462637086917535 0.4563059253495302; 1.0195657121584683 -0.33036598003792567 -0.42391113377705797 -1.0061846250097657;;; -1.3730029613313053 -0.4702049436215228 0.4237697178163152 -0.6869486492508867; 0.8168130723129085 -0.7579785790779621 0.3889185824796142 0.5707658438277684;;; -0.893187359837193 0.46286804704422185 0.9502276547874465 -0.805008035718013; -2.6822155606843197 -0.10033343391435007 -1.587209922248711 0.48348535752615796;;; 1.372955627989766 -0.5702959176923942 -0.4592263871926789 0.026491168772085877; 0.08991703568488774 -0.15546581811631516 0.46128820527311604 1.3228715526405541], [0.31290855384432076 -0.968921274639994 1.6150151627412395 0.7138549556928404; -0.7788796950985941 0.8296995619485431 0.007614331780302616 -1.4040726982693368;;; 1.1599136316758432 -1.691304300384748 -1.132473815078038 -2.369417299799812; 2.101210218414608 -1.6995636581230147 -1.4787505550418407 0.7095703962086879], [0.824574641609086 -0.12454812620221037; 0.550463582843401 -0.2840948380671706;;; 1.2811093846823798 -0.025156493798345406; 1.5323741466512646 -0.9928272245789126], [0.29653384310596936 -0.2191478633179281; 1.0176275407700883 1.193230317878358;;; -0.028940859205080043 0.7204502306719499; 0.4158379349002452 -0.12702100872894703], [-0.3973950167634816 -2.361343961637222; -0.5605883255356359 1.199654594941552;;; 0.09509791348225488 0.8039535999995906; -1.4304860683954879 1.6955587207888085], [-0.8974689048736442 1.681351496442432; 1.0008252371975868 -0.1724133823345436;;; 1.3786885079273505 1.0938052734098056; 0.9409214942708493 -1.8292456597715274], [-0.5950549629730737 2.0574726860435057; 1.082831922970107 2.0465872152009656;;; 0.5519210285806642 0.6536378652080541; -0.3244950252297216 -0.3654142776529074], [1.735591737628797 0.4960168475829697; 2.0358854567687166 -2.1394659498773105;;; -0.6488101582629104 0.9072737456446719; 0.9526536308093122 0.1590157946133479], [2.20953336916033 0.6993100350467014; -0.5823055562995236 0.5144242286872229;;; 1.450999330581879 0.643103241663813; 0.049098768124230564 1.197048610385418], [-0.03933056533150039 0.6917779854674686; 0.14707437755338265 -1.067998514556248;;; 1.0158711644650085 0.21329933973023016; 0.24802532666522703 -0.1319972606304556], [-0.09947883021835821 0.14655963283668308; -0.2682333834828816 0.0512537543172363;;; -0.2477870977926524 -0.45773838189633864; 0.7464543204727628 1.6714827363191351], [0.34495624473874953 -0.6219147887170693; -0.26099444951238504 1.3658491135396542;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-190.1930480386214; -178.9957352140681;;; -103.22567731974341; 109.68309486152579], [-0.6931111160274386 0.5091921129417567; -0.7020872397182977 -0.496965402757103;;; -0.11757638837836398 -0.49862825010109896; 0.11135433865650171 -0.4908506610993359;;; 0.011769351382941329 0.04394943028065374; 0.009897988691575533 -0.046370915542196536;;; 0.010115196307783169 -0.007854506449219787; -0.010377273907616908 -0.0063851216169866255], [-0.7047675446818941 0.3464696700439304 -0.06595553680262795 -0.11363996898478648; -0.7062001287280648 -0.3451325193511074 0.09387368747123336 0.10833584720862773;;; -0.04783072633604985 -0.616515538665191 -0.3199952893186404 -0.06757927273857693; 0.04739142390690354 -0.613655068108613 0.23092972317918273 -0.13508608670315408;;; 0.004212812814320568 0.04564366406198973 -0.4973740070130444 -0.5210813969429047; 0.003216460840242338 -0.045747503769759446 -0.4793525182651267 0.5211478257014822;;; 0.003360315029120722 -0.0004105515930294669 -0.4192633154717574 -0.4319851032619778; -0.003308256438134151 0.0006643216629315689 0.4216659237468247 -0.47071965566844814;;; 6.29532429068247e-5 0.0008777062841348373 0.013678711142792205 -0.02299452445322651; 8.27018881492251e-5 -0.000892543585188511 0.013209306027545066 0.01662462793587753;;; -0.00010220855464009327 2.6531828542677044e-5 0.0014401552542382175 -0.01405160988467452; 9.866727344678272e-5 6.045134217906772e-5 -0.002187069513881007 -0.014883727935872988;;; 1.2274078332666632e-6 1.3713373888842132e-5 4.9293478516021285e-5 0.0006955642039274049; 9.682936146765958e-7 -1.3889855523223511e-5 4.120348471031368e-5 -0.0006989517829800858;;; 3.7782780227375383e-6 -2.1359934834619075e-6 3.688974766766904e-5 -9.769821787465923e-5; -3.822154880024874e-6 -1.6485331322169072e-6 -3.8079294282629155e-5 -9.588163829055616e-5], [-0.7066494564904976 0.19641144692021373 … -0.07066284134566161 -0.011344059214106632; -0.7068310155457618 -0.1964278920109305 … 0.0724774544628483 0.010010767903322957;;; -0.022668692466749785 -0.6787727537878019 … -0.049382416314668505 0.009681710141962702; 0.022764719649999657 -0.6784806806779438 … 0.009606023748038 -0.02824877463265915;;; -0.0012710859732563528 -0.02972985181194921 … 0.06300316722129194 0.13582608727101522; -0.0008818621059615712 0.029505306164828028 … 0.10161592471403857 -0.1365665422724078;;; … ;;; 7.602453269228058e-11 1.6726373427857832e-10 … -1.170824930153775e-7 -9.690957538827812e-6; 3.3561164893073754e-11 -1.8432425784505902e-10 … 1.4081759112272817e-5 -6.584499260810432e-6;;; -3.1015886960641335e-11 2.4129604325150944e-10 … 7.1921289716048055e-6 5.070254665642269e-6; -1.352772125318694e-11 2.398032418506493e-10 … -8.79873528012322e-6 1.650726557388357e-5;;; 7.925745098356655e-11 8.440325028380285e-10 … 3.537162311842319e-6 2.028570924311255e-6; -4.634876646482995e-11 1.3247968573742576e-10 … 6.196969349363827e-8 1.6619581472453846e-6], [-0.7070030831178473 0.10159811502770781 … 0.06240240062548372 0.027146710459567007; -0.7070275045195256 -0.10149281425431954 … -0.06201668811499315 -0.033218062607032015;;; 0.011418756515700346 0.6996201503355957 … 0.004640900718425731 -0.1869792091119253; -0.011318252837490267 0.6996314138044539 … -0.021226894569819858 0.17867906172783463;;; -0.00034154645024319714 -0.014439714258511444 … -0.033587580770790444 0.1278350659250117; -0.00020625066363786496 0.014239082136319645 … -0.13011338669021455 0.11057031067338982;;; … ;;; 3.103500158800264e-11 4.3678835323683734e-10 … -0.08379332875875402 0.1880868918190787; 2.091543607107748e-11 4.529672104200463e-10 … 0.3454023365663044 -0.1274348810258274;;; -4.672237791197863e-12 -5.243770731772214e-10 … 0.06132692737440827 -0.02994930405654565; 2.911397449631332e-11 -3.7125893922007937e-10 … 0.13211574872725185 -0.058093473257637314;;; 8.643092241493813e-11 4.814006085096158e-10 … 0.6775450569553592 0.06547851124704468; -1.1638905069087494e-10 1.0586823873886812e-10 … 0.07816603074510657 -0.5429772726713574], [-0.7070805607306337 -0.051151193189678895 … 0.027294086565893577 -0.11502612356218457; -0.7070864386801478 0.050847222125568435 … -0.028683240479880922 0.11602061576895252;;; -0.005887545702932837 0.7052314294112283 … 0.08683316682017277 -0.06782650320608427; 0.0055832774179434535 0.7052559139134897 … -0.08123889682824499 0.0524545830594548;;; 2.4075123191118235e-5 -0.00029395195995402364 … -0.14325855372346297 -0.010945083923665711; -4.269865848168068e-5 -0.0003045794583490762 … 0.011637905765834485 -0.07348231701006927;;; … ;;; 2.5016840815448406e-11 -7.288567830510759e-9 … 0.006983801188634001 -0.0028019035236593924; -3.793073002816516e-12 -1.0161650862032777e-8 … -0.21314555174117172 0.07678400428085082;;; -7.713370964382236e-10 1.4179589885016573e-8 … -0.04127678391827829 -0.16926236558289914; -4.986065696220257e-10 1.1737213165677118e-8 … 0.4246852594470716 -0.13934072256175759;;; 8.029029450921511e-10 -4.3014791956419697e-8 … -0.10266639578595337 0.05631124760533279; 5.274057240554635e-11 -4.329630351831855e-8 … 0.2083094907901421 -0.03680024007157039], [-0.7070968813622043 0.02627077538267515 … -0.038419006744494215 -0.0022845112072390943; -0.7071039527575289 -0.024663060432258733 … 0.038065171685430506 0.002317814608851229;;; 0.0036937065629459313 0.7066104843258983 … -0.04155945799558774 0.005216866324600313; -0.002085424700194843 0.7066694068347047 … 0.04418697786974526 -0.0037502494145020045;;; -4.748027857968628e-5 -0.002180235438017381 … -0.03817010650275743 0.06770013859312975; -6.277679163697334e-5 -0.002177945149015041 … 0.03366567652749597 0.057901299576865524;;; … ;;; 2.452478782725459e-8 -1.501970641911201e-6 … 0.15295650800616423 0.08387371155087035; 3.7881022111664235e-8 -1.509698472404467e-6 … -0.13365742388225463 0.16465238551415823;;; 2.771086471058268e-8 1.5638748672582222e-6 … 0.3294535183808669 -0.0891957195676782; 1.5415148126192296e-8 1.5571053211890137e-6 … 0.10550325086550706 0.018105231156253454;;; -1.8144810354016978e-9 5.8279136134673036e-8 … -0.012995624568236113 -0.014673653717274953; -2.3263022350330358e-9 5.996029895531594e-8 … 0.3517784207867117 -0.006547532332316645], [-0.7071014499273555 -0.01403578726738505 … 0.04300518262587025 0.05916174761792434; -0.707106793316052 0.011460606900056326 … -0.04299264105284487 -0.05900086184420198;;; -0.002734480369833273 0.7068859527777553 … -0.0023149152449003104 -0.0387483458918341; 0.00016145570838498825 0.7069326654077945 … 0.003866004003044098 0.04059802407646784;;; 9.30893210055604e-5 -0.009008785854561637 … -0.002043938054542554 -0.04520716730298751; 7.196465425280484e-5 -0.009009878638775991 … 0.0030349134079336896 0.003319526239153636;;; … ;;; 3.067047416321659e-7 -8.376009922475132e-5 … -0.2984909500596595 -0.21411052536968467; -3.2685050172380384e-8 -8.357851429510264e-5 … 0.22530685605382256 0.10197631690809332;;; 7.580685262441e-8 -7.6983457401816e-6 … 0.7911232246946185 -0.22325413113476578; 4.480999663615797e-8 -7.68846818012721e-6 … 0.10916947222784117 -0.22586251165072416;;; -2.9760831395794343e-9 3.7454847682599355e-6 … -0.186242061013994 0.06124221033568441; 1.229240575792546e-8 3.7357031171051226e-6 … -0.09266436297488584 -0.5147855780879865], [-0.7071037645464073 0.007784608483106197 … -0.015524158531884586 0.029259721948891038; -0.7071065053299604 -0.005097412077105393 … 0.015507064588609351 -0.029267588927814794;;; 0.00205948638589534 0.706681152067275 … -0.00837863544633156 -0.004271337417598118; 0.0006216219310148606 0.7067057432887666 … 0.008684101377569966 0.0036838445654577058;;; 8.439972101377592e-5 0.014128513834814862 … 0.0032515031413817585 0.0012296614088086815; 6.0536054715350426e-5 0.014128687424321792 … -0.0046620193045934155 0.005639183309998167;;; … ;;; 5.576284722455311e-7 7.014915043977348e-5 … 0.089005211265242 -0.1619199627709012; 4.163500560735165e-7 7.015120464056671e-5 … -0.2987455096138211 -0.1998115352904467;;; 1.2114813790711928e-6 0.00019271781433609377 … -0.7207375988090531 -0.16150464360588185; 8.213650934562838e-7 0.00019260957086152515 … -0.43993480141734415 -0.0066014101016147065;;; 1.1806894620519143e-7 4.814926367355217e-6 … 0.22410035694633904 -0.15421109673791766; 1.0877171086642347e-7 4.842302043064914e-6 … -0.09285459737182478 -0.23260542531023148], [-0.7071038152859297 -0.004997273230602586 … -0.0033077724511608375 0.03833395243770299; -0.7071055048864893 0.001607225966787954 … 0.0033067310190421488 -0.03833379051956149;;; -0.002018540365446016 0.6994324994713901 … -0.00090898134598377 -0.00021930222129696523; -0.0013211315142865308 0.6994480491568208 … 0.00045393652072854134 0.0005826318022188129;;; -8.011894338916412e-5 0.024022242236062252 … -0.0007985951871585653 -0.0011528398921863826; -5.724819991924709e-5 0.024022997442108174 … 0.0006596639999885482 -0.0008104975194393471;;; -0.00011791262327217965 0.03535401244151653 … 0.00256433968045207 -0.00250308598529207; -8.320524644839305e-5 0.03535521971080206 … -0.004568044401202089 0.00258769878941567;;; 9.782753520655198e-6 -0.0017238611483256692 … 0.2671930482654115 0.6770441775062286; 8.064210308269436e-6 -0.0017230346229684431 … 0.3281381008613855 -0.6710611721669458;;; -1.220883159686584e-5 0.0025626149469689147 … 0.8010224647424337 0.1558590619616814; -9.659841664045302e-6 0.0025623801950541824 … 0.3870639497004025 -0.13638943178006713;;; -6.489538189625347e-6 -0.0006576676589842119 … -0.16148157632347324 0.14788926664537633; -7.134672821854928e-6 -0.0006580906341524732 … 0.05555270064648097 -0.15325352203229112;;; -0.00031530991487042166 0.09451057910370132 … -0.016115584593461314 0.006397482658461848; -0.0002214368001154554 0.09451344088782088 … -0.0020575523308740576 -0.006391330104452544], [-0.17693767515228642 -0.14184022009612707 … -0.04068778740784203 -0.1658736741750032; -0.983720814983416 0.005039626562203533 … 0.009093288796549626 0.010549793121311431;;; -0.020051119005418682 0.9897854518731568 … -0.005188750231429359 -0.035909087780150534; -0.007945782783477516 1.868109804719237e-5 … 0.04020128869017128 0.0010435321152833872;;; -0.022451845220936448 0.013039885625820976 … -0.05016200410617193 0.8788769493931463; 0.004141129421492154 -1.9182268526561132e-5 … 0.2003283781882062 0.012208591780969811;;; 9.292666626166798e-6 0.0010242990231076555 … 0.006310260919297178 -0.13655656008897712; -2.082755954849956e-6 -2.3498215817232104e-7 … -0.02516162430106437 -0.00019153084150712787;;; 3.760317700327643e-10 0.000993438602979799 … -0.008561383794556251 0.051112238646979245; -2.3448092237502447e-6 -1.722817045408243e-6 … 0.02073675116486908 0.003662734883222799;;; -7.772225412688381e-8 -0.00284082711169749 … 0.012667476015767202 -0.2865414071710824; 6.29621707838431e-6 4.411617620743872e-6 … 0.88118823748314 0.03565014689827515;;; 3.2045098244579694e-7 0.0007523902725867197 … 0.013872264856447766 -0.300157178339692; -5.668354293263488e-8 -6.3124200962376025e-9 … 0.042860981404777225 0.004111858981135061;;; -8.97121480396436e-9 -3.9145070990559675e-5 … 0.007959031610938708 -0.053507672404968176; 4.456186898268317e-8 2.5853305058629672e-9 … 0.4171915653600675 0.029757422568518873], [0.4088029505213426 -0.25445216211340693 … 0.1066987622523078 0.020245173162457546; 0.9114859664875447 0.12960629015422045 … -0.04455752148214155 -0.003423948705122429;;; 0.015295562779471519 -0.9579332850493903 … -0.041114042993389624 -0.005305847284473248; 0.018596337272475356 0.0012699616062650835 … 0.05012932473272256 -0.05798686660145833;;; -0.012794205608610023 -0.028300820462630237 … 0.22895990909374617 -0.03896920179538358; -0.03646931323270117 -0.0041927176081924915 … 0.010394873296343105 0.1232371956454949;;; -1.9520028034155974e-6 -4.477419038938449e-6 … 0.037811075597863925 -0.008990053731297548; -5.65589378462884e-6 -6.533681967193007e-7 … 0.007947860256529507 0.02268524610404802;;; 6.189820196193668e-10 3.3726208381836953e-9 … 0.045377683881755164 0.0064843849851286975; 1.4768531707829053e-9 -1.1433683626970403e-9 … -0.00874365668886632 0.029759202949523413;;; -1.435344194774715e-9 -9.193243257008738e-9 … -0.2234317486008721 -0.002866366246878305; -3.4744506275042077e-9 2.8836835679269027e-9 … 0.06871592717619165 -0.1412489961776877;;; -8.8248015251132e-12 -1.4419629691258846e-9 … -0.9336072914883865 -0.018571752136345647; -5.791949421073502e-11 6.122972642687518e-11 … 3.8119150781666265e-5 0.06654839344630897;;; 2.365061670751902e-11 -2.1579927945751835e-10 … 0.0011608314362388853 -0.014676105570771859; 4.9853365786415496e-11 5.452451285903109e-11 … -0.00011849016138162487 0.9762224107145269], [-0.5238645753856586 -0.41718420318887517 … 0.11380382434587114 -0.01484026319977525; -0.8503293232584533 0.27875431115363936 … -0.057982133590825616 0.005420016325417929;;; 0.02173523059747152 0.8646601453305672 … 0.08389673711385781 -0.004711360316441911; 0.019049533821765708 0.014137187719004907 … -0.06845133212993249 -0.12408604889836819;;; -0.015174249870422764 0.018908890947225268 … -0.37587497753039506 -0.12718465178229807; -0.03795240942531922 0.007668203300404003 … -0.10775436182415137 0.0693188311796106;;; -7.676688693873227e-6 1.0395660058292826e-5 … -0.09261486810004732 -0.03905647340773013; -1.938103569849235e-5 4.038805149277841e-6 … -0.023681261726526927 -0.06604292144294359;;; 1.3194490507009621e-8 3.8709427652376045e-7 … 0.48035360638971736 0.05252357241345012; 2.9818495543738993e-9 3.510526781195996e-9 … -0.08026301117899143 -0.2981365686093916;;; -1.4635293814232306e-9 -4.650298046540182e-8 … -0.12923170377987736 -0.007182130195430531; -9.147520024452353e-11 -3.8745969171224607e-10 … 0.05938643819712674 0.15243814801069164;;; -3.051717630552693e-11 7.199055265141904e-11 … -0.09828277391562189 -0.009723497995687157; -1.1246712237478572e-10 -1.5481873412529088e-11 … 0.0014635709171996747 0.9049306043273394;;; -3.4449185700506215e-11 -3.229677909488273e-11 … -0.7367901514676937 0.15341211109331354; -5.965790452722386e-11 1.057716584820414e-10 … 0.0007097726093706528 -0.0006339677790525583], [-0.5890675183654551 0.583495599760891 … 0.014782197711416993 -0.1822703787264646; -0.8073441326547571 -0.43231696994284685 … -0.014456484644075547 0.11831202742576763;;; 0.011625890631171016 -0.6801221368010416 … 0.007612789450371503 -0.23242630388131996; -0.02300377326690845 -0.09933142683265625 … 0.08647080792344398 -0.0781066982226052;;; 0.008614955440666186 0.009090117403058758 … -0.11728349089465685 -0.5864392438533756; 0.021362317756349856 0.010927972931252092 … -0.0015832146486879051 -0.275690333662835;;; -3.236792992103683e-5 -8.288573792693693e-5 … 0.053962742110952124 0.19027131590050866; -8.889390179962653e-5 -5.1106760475155865e-5 … 0.24817134340583488 -0.09858331025099805;;; -1.2819659497185705e-5 9.441164420652198e-5 … -0.06866561874090785 0.19726105793784035; -1.2880171576036977e-5 3.659997693615848e-6 … -0.3217619890451447 0.32358326310330504;;; -2.2465339384160383e-9 1.9148062058723713e-8 … 0.16289959551728597 -0.031640836921777646; -2.199624371539143e-9 8.907989067643207e-10 … -0.19858215589126463 0.09448505165765025;;; 5.0278543450923215e-11 2.4419171931554667e-11 … -0.13535689979045265 -0.5213000331676517; 5.006031562852077e-12 -4.3240464227721156e-11 … 0.23385547497307377 -0.00882422666951589;;; -6.023830680818287e-11 -9.328494980127796e-11 … 0.1196554188652184 0.005582213319621982; 5.700480297858263e-11 3.7613404406744864e-11 … -0.8076102005660303 -0.03754686793185884], [-0.655723769104012 0.6295646734536803 … 0.05193857570366482 0.0447710650850312; -0.754180276533522 -0.5463678453699244 … -0.040875708830944456 -0.046410863121749066;;; -0.012586628611117954 0.5062571735375991 … -0.11366286841721156 -0.03684271811573506; 0.03188137874362266 0.22058380820670376 … -0.005949466706573466 -0.14539688379683038;;; -0.002539620845778269 -0.008054588237830123 … -0.2732876193167734 0.12572391908893807; -0.007550225267420712 -0.01053859111741766 … -0.16050905907372162 0.15530655562876475;;; -5.7877446218513184e-5 -0.0007363615331289257 … -0.1354316843939057 0.10255668888469949; -0.00032685784707806 -0.0005902649664142049 … -0.02681626485392693 0.1497510866438937;;; 0.00012086832487285236 -0.0003560171372390999 … 0.5223101596538079 0.06621711612901347; 0.00015237723125113912 4.000050798497508e-5 … 0.020239650542724214 0.43155540685520044;;; -5.70524726148639e-8 1.88886629609493e-7 … -0.20395507771765123 -0.04181948111656799; -6.607725546949299e-8 -5.778074608307782e-9 … 0.0965735168598029 -0.4527935620619087;;; 2.2564198844443013e-11 -1.2580497070786736e-11 … 0.7341693074542912 0.08543676550851928; 1.537131805378793e-11 6.071447726645249e-11 … 0.00025329553476839006 -0.22996120332647466;;; -4.454005769579925e-11 1.16166983615139e-11 … -0.0013866363239878204 0.0033359632034984108; -2.0754628912426685e-12 -1.6221943398700358e-11 … 0.0043080983595800695 -0.6654965606933706], [-0.6928332102133885 -0.621266944753124 … -0.05587510893405189 0.07277291734838529; -0.7208919098431514 0.596038029009867 … 0.051594070687298585 -0.0731863579897925;;; 0.00895854324823644 0.40953768421728975 … -0.15494890306727305 0.0774840849168706; -0.014636510754705671 0.3016350548905933 … -0.016442784678948802 0.1824287788742855;;; 6.506445179036457e-5 -0.004476559243000269 … -0.1972219857099583 -0.022951139881562624; 0.0014294863241242472 -0.0051576113953172515 … -0.18788782137289145 -0.09657060105495402;;; -5.77595581923389e-5 -0.0026519350260940525 … -0.3551909127638344 -0.16129778970961983; 0.0006729703738970118 -0.0027446422309949535 … -0.08618673177623393 -0.37969434547098574;;; -6.50355692307489e-5 -0.00013480917878741866 … 0.6504933905362495 -0.120581893173618; -7.800090892948003e-5 7.526965250932659e-5 … 0.12400131723622057 -0.17436448426849815;;; -3.731699056882757e-7 -8.920684473986281e-7 … 0.30459411540846626 -0.08823657859348123; -4.1267047826078423e-7 2.999629394249111e-7 … -0.14602944119160613 -0.69643865791624;;; 5.93923555512177e-13 1.1262763907538074e-11 … 0.4577435997205873 -0.1413445523242207; 1.3551034191232133e-12 -5.271816621934512e-12 … 0.00015725477573554707 0.2701841498694606;;; 5.108661610193208e-12 8.663207789246908e-12 … 0.00012811089041899482 0.00962530583594954; 3.737071792025097e-12 -2.9830816866140027e-12 … 0.00013841740939047974 0.3730958854872787], [-0.7032951717686403 0.6164562443469835 … 0.04887182051027412 -0.10896879319927413; -0.7108764685943667 -0.6094359400496275 … -0.04759256662880307 0.10869738989910738;;; -0.0032289478560409337 0.36803175355664697 … -0.16264880255657266 0.1502061001318536; 0.0044751872999866295 0.33632760425745656 … -0.0011830987835980383 0.23069131214575642;;; 9.988398846539965e-5 -0.0014718895860804102 … -0.1599537481109979 0.07854750179459517; -0.00025703761302402656 -0.0015349235773323094 … -0.2920072641228309 -0.18925342465737824;;; -8.612711051673461e-5 0.0008522689796050849 … 0.5500796245660577 0.09349949673765211; 0.00010313777650058334 0.0008094643041953306 … -0.02731939800439378 0.3480526912373914;;; -1.052700247397258e-5 1.6825829324652533e-5 … -0.6241669734825289 0.320229566504186; -1.2199901884376534e-5 -2.1036578201085684e-5 … -0.2890809331561916 -0.4027298288766762;;; 7.80766806765494e-8 -1.5691972553284642e-7 … 0.22730908920380932 -0.18849987332229962; 8.134054201317882e-8 1.1169648648543043e-7 … -0.1342918501071764 -0.6335887180803145;;; -1.1668432050121678e-11 -1.7777422240568343e-11 … 0.108344655403153 -0.07670829341873325; 1.0540585616888673e-11 -2.6027891209104383e-11 … 0.00026296379219943475 0.14467386322298242;;; -9.667429694050019e-12 3.55177435328624e-11 … 0.01041717487230998 0.006624157676280587; -1.4706432788216802e-11 -3.0747941422823055e-11 … -5.082507643672782e-5 -0.009859019996372674], [-0.7059344648788746 -0.6181720322623104 … -0.005895524999973601 -0.17604110877138734; -0.7082756436473389 0.6159857242874415 … 0.005688456201144322 0.17567281660223782;;; -0.0008625706008412379 -0.349540356843003 … 0.07413478650103579 0.31067958912343335; 0.0011812810355433176 -0.34094898623636816 … -0.054433231049978756 0.3181202995365762;;; 3.401875919081796e-5 0.0003759163309613034 … 0.15398706869627987 0.3090645393390525; -5.5759432493563294e-5 0.0003150609365589662 … 0.3961569155356748 -0.5205199093481713;;; -1.254764146987675e-5 -8.786772551340795e-5 … -0.7176509931844391 -0.48875531669404965; 5.9468403936841865e-6 -7.367496888710222e-5 … 0.5438737665744722 -0.36753589260511865], [-0.7067082805815044 -0.6328026644901703 -0.06830565948969958 -0.30896364001829135; -0.7075049705821633 0.6320362325791528 0.06778280004429778 0.3088242369485243;;; -0.00017891363757877726 -0.31751875189253215 0.8244533684881358 0.46846392964142386; 0.0003012457079849054 -0.3150759126272602 -0.5576885081193601 0.7679261725222842], [-0.7069811166444134 -0.7072324233999868; -0.7072324233999868 0.7069811166444134;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^cores, 2^cores)
xes = collect(range(0,1,length=2^cores))
yes = collect(range(0,1,length=2^cores))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="3c8dbbb9.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this exampl we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 8
h = 1/cores^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,cores)
xes = collect(range(0.0, 1.0, 2^cores))

u₀ = qtt_sin(cores,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393110550548e-5
Relative error for implicit Euler: 4.831468731612433e-6
Relative error for Crank-Nicolson: 4.831517695272846e-6</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Saturday 9 August 2025 18:22">Saturday 9 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
