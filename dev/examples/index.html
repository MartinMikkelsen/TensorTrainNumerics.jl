<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets.citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Quantics tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li class="toplevel"><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in [<a href="../resources/#FastandFlexible">15</a>] where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^d)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, d)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(d) + id_tto(d) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(d) ⊗ qtt_basis_vector(d, 1) + qtt_sin(d) ⊗ qtt_basis_vector(d, 2^d)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-0.29063206034769007; 0.9030466121329068;;; 0.5066856794500185; -0.2640343588208154;;; -0.3937598385682782; -0.4383798747886711;;; -0.6503617919454631; 0.05047350944388074], [-2.68706433575683 0.8919873544825584 0.8585915111300229 -0.35799693954172795; 0.9575084118678219 0.5699199440262643 0.09209033734890622 0.05930525238375624;;; -0.7914404534684117 1.4620212796680878 0.33282864667746326 -0.1987558875141207; 1.2490400539719986 -0.2790855116773746 0.9927644295640609 0.6688996359847982;;; -2.43135162044876 -0.796341490736189 0.35044015959894415 0.08893549312120703; 0.22043161365161187 0.5333870865668847 -1.0717065845754419 0.11223547641874433;;; 0.9242904219008293 -0.5600678579030943 -0.8837677859103961 -0.3607425611611605; 0.23450855089333103 0.7056694297693697 0.1269811048171747 0.5528130491210589], [-0.7561374764500625 -1.9358106042937244 0.307062835380063 -0.8643592623460618; -0.9893845625884442 -1.6113027064807006 1.0615919542272063 1.2867937105535907;;; 0.3377546903683039 0.0180430444986379 0.9405932206021965 -1.5620955868232598; 1.3645440032219027 -0.04349105257792335 0.7165769371892582 1.112276044953855;;; 0.11514851971538516 0.13772630587960183 0.48326387925499636 0.4643844496427388; 0.07186152948952976 -0.47839846930875735 0.009617454696948755 0.3421339847210514;;; 0.5723655360153604 -1.5868496095189295 2.861739589359015 -0.15140045457211054; -0.23380348834564227 -0.6140829882849246 0.7745169632660704 0.6540257539394863], [0.375792629728832 -0.8447554590275937 -0.7239070811918757 -0.17616467690603388; 0.5198679414230768 -1.4848282930305507 0.9187508773235453 0.9127238261138316;;; 0.07962755798706442 0.13085576318454264 -0.014067437521958229 0.24089006019273765; -1.114697955705949 1.1807731821338288 0.34935025287282234 0.09562193412022371;;; 0.6221602032024377 -1.182585842362401 -1.9261942174308138 -0.7931268330807633; 0.024113364211331388 -0.579358497407248 1.9614871721742542 -0.05838565755748797;;; -1.8278010532145417 -0.8319842053175045 -1.1329738086955379 1.2814374172089262; -0.6985171136227198 0.33454095906501957 0.783115027034969 -1.6771709137876218], [0.6528293804035784 -0.7535860681554793 -0.0725761636863226 0.5164302434868657; -0.3936697391987359 0.11524275827601733 0.29415652999847963 -0.7420257642421724;;; 1.1239594252691023 -0.7671662370182024 0.6850190253148233 -0.5780301549236844; -0.19243001308592558 0.17719548378863362 0.39643929640995407 -1.3349522759165582;;; -0.689141382560863 -0.05891618051313555 0.29863187016892273 0.27978002646421435; 0.7167586859652192 1.618473960034714 0.40032614228956964 -0.26051323074221455;;; 0.3588557677098917 -0.46601636993045026 0.7206373562633733 1.2639041684128016; -0.7765672431146703 -1.5388237258523574 0.4284191046365381 0.09508358407249029], [0.7296920345615248 1.3639140654754087 -0.9187661751304937 -0.6070977848021931; -0.40507491667193835 -1.4699214323622505 0.5769974112127085 0.4841538853416791;;; 1.106542406492303 0.16725303441696993 -1.7852924403423542 -0.005831408602616527; 0.1617292602958481 -0.34179816967689736 0.9581007306111553 1.5706970803822076;;; -0.7028975789795109 0.08071946740851682 0.5867665564533184 0.6623232355192022; 1.2805493554489047 -1.1960612533512267 1.8899417218187766 1.517899867072008;;; 0.5312755029938206 -2.7886504572823836 -1.2532629820862073 0.8220573619870363; 0.2233410889467727 -1.2684727959330087 -1.2776261551951817 0.6477824976666067], [0.6594715553516817 -1.6973077651695017 0.7167952903886928 -1.1542577296453278; 0.7764106204506199 0.660299795229231 -0.36178523402608265 0.32973025486202523;;; 0.19168907284671471 0.7997910391430816 0.1137190789251553 -1.0853634617931198; 0.29889938365038377 1.0835509689849823 2.430555857591914 0.18227064410697405;;; 0.18882550844086798 -0.18114656406872903 0.5870347794613571 0.13373616338941122; -2.3431094093315874 0.8372893735101569 -1.648953722037644 -1.568387544162222;;; -1.127604271523879 1.6199194532757946 0.08219502932965884 -1.3522228327828112; -0.7806165492616903 -1.941798940268724 1.175294260528488 -1.209802611193358], [1.3413836418008114 0.9149615274403862 0.9444219711171826 -0.054941889532486216; -0.9952849883222915 0.9330352739696207 -0.16065340379059787 0.8399019558088185;;; 1.6620689043640255 1.67089616117108 -1.4272448745964839 -1.1397001235464008; -1.311006230980339 1.4620617488291714 0.08351588802275851 1.0423425371819601;;; 1.2911320287297148 1.5113936819931997 -0.7590899456025 -0.9670937906446009; 0.9567375655115148 -0.4909810594433632 -0.023401482719527696 0.3846152187149512;;; -0.007502411205173044 -0.3290651606888904 -0.6585975559092683 -0.8628202162467167; 0.29384748913063036 0.15366728355855133 -0.5999462035595793 -1.676189667936589], [-0.4303479193898887 2.60093709385529 -1.475593085702601 -0.5453711933286298; 0.5124387864703197 -0.16941885000932183 0.5111340928380477 -0.7924138789928894;;; -0.608879459934823 -0.1495391354912025 0.35718715319741 -0.04834875307817782; 0.8250632094275171 0.7973657325698547 1.5374893487109105 1.4312224584983415;;; -0.5747238044446672 0.46813091668518636 0.7441654247633014 -0.5692210614132126; 0.8792371599347535 0.6671807432796825 0.8513151862652013 0.9236603369418759;;; 2.2372451457610256 0.6537572077696503 0.2331111165780432 -1.2062237854535842; -0.06766664675505157 1.3901811107603885 1.2618258087831304 -1.141868992780279], [-1.2256180143193756 -0.26340528865953455 -1.004797449604015 -0.0645102058660291; -0.09105826434709692 1.4097852484547393 -0.7689716498096154 -2.087002973717777;;; 0.6497097475201801 -0.7798491079122681 0.5215693909629252 -0.4322769316838943; 0.4998546116839491 -1.4397147804994068 -1.1733970318625047 1.8838149058114875], [-0.11143219629227821 -1.3208530423250036; 1.2757910420747083 0.3279308715162372;;; -0.09691801191057577 -0.6493821739972216; 0.2270259643844054 0.19412004880137707], [0.2649420803419983 0.9442633746817127; -0.6661873146826178 2.9495437942245153;;; -1.5525927374282973 -1.0529539305752857; -0.8297768371775047 -1.0879850023200033], [-1.0743457367684213 -0.7474133582249322; -0.3300881551980093 1.2631766713362043;;; 0.7997604684100896 1.4233543226660001; 2.095745653076263 -0.34141774858773466], [0.12774964360124902 2.1300383770208735; -0.9389081526551494 -1.2437417287736503;;; -0.5247033706759904 0.3165539022898282; 0.8843615285571362 -0.6118955409982981], [-2.488316428346302 -0.18427247394396712; -0.23655161021957752 -0.9094231427762443;;; -0.3721665594682189 0.5321230721884137; 0.4971792063358001 0.6013887552744597], [-0.560648107583921 -1.0560149708675501; 1.179578323236476 -0.7246397713063858;;; -1.2296862575320988 -0.8251802009582516; 1.1086249848615035 1.205783921797278], [-0.3918038462459493 1.8007858492565931; 0.7251115278773036 1.2788269800463548;;; -1.3664182123844963 1.0823770572573255; 1.9973299475336317 -0.2194843226689286], [-0.0764519510893743 -1.160550287915374; -0.9543873761562792 -0.5369212009023997;;; -0.745023779011943 1.0593257198702735; 1.6746752342533655 1.896828560637469], [-1.5164180777203882 0.5318312653965991; -0.7569807462852096 0.7332413565056736;;; 2.401546778292681 -0.007152538085357345; 1.302498828780597 0.22616679157197989], [2.3756646559463532 -0.18098282068101618; -0.10637985628662754 0.5074087960398833;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-213.34430875360113; -154.69527627552526;;; -90.81256418193516; 125.24198668503402], [0.6728585384691805 -0.5219936151614826; 0.7192606364653953 0.45774579842156643;;; 0.13568581820241166 0.5231676029942264; -0.1023057665912392 0.48431164327479115;;; 0.023798592450614307 0.05922183503178113; 0.009539540588622789 -0.07747314955117644;;; 0.013095712337857727 -0.01415323362596371; -0.01481686142627778 -0.004439871148368327], [-0.7013710989447285 0.33706540026546167 0.26798630096383796 0.11670378337974902; -0.7092505379334273 -0.33004996568601846 -0.29254020499238576 -0.0927896147392512;;; -0.05077098644176509 -0.6276768771490827 0.4148976568740929 -0.03319450860603197; 0.048659195049130154 -0.6141853384648583 -0.11669646785258507 0.23603443825257475;;; -0.007981727103881607 -0.0557858991710125 -0.4837573180413895 -0.4807022948688484; -0.0016109371995048452 0.05566862594974943 -0.4192911289537727 0.4546241537093937;;; -0.00414710325779989 0.0011667011643045973 -0.33919366398262724 -0.41252686787860593; 0.0035678313896036267 -0.0038825082887038944 0.3606526429970703 -0.5508343555526074;;; -0.0004655628083054101 -0.003210157143574004 0.030147993446259694 -0.0602800472646417; -0.00013885608740177633 0.003764921340333701 0.030411619703562303 0.04826942344169034;;; 0.00043845815245761226 -0.00024074082281587503 0.004898576076906806 -0.04268319002834282; -0.0004317452669336354 -9.183507016742324e-5 -0.006229677282550613 -0.04260827361578609;;; 1.928916029483056e-6 1.2504007364104812e-5 -3.6571802431617476e-5 -0.0005019466354368793; 1.979601871254719e-7 -1.3492415908857698e-5 -1.3920108870079586e-5 0.0005098783647017266;;; 3.321876891069768e-6 -2.827852032372156e-6 -2.002017375785159e-5 7.047324517307527e-5; -3.5452204236307846e-6 -5.035729226657989e-7 2.2905513660958215e-5 5.974660769225467e-5], [0.7062411989083675 -0.18691681771805818 … 0.12735411316670875 0.004561953240457553; 0.7071576711317598 0.18727588964567143 … -0.12665390079185856 -0.0007729195197840492;;; 0.023538277409166933 0.6817281714382412 … 0.023855587102669492 -0.04423593578160089; -0.024289784458693953 0.6807809645407272 … 0.042844648377942794 0.054763423391383376;;; -0.0023744605573510287 -0.0300135140447979 … 0.003877194798497363 0.09754006221505923; -4.989350612323645e-6 0.027673552084067805 … 0.13636779802699156 -0.11368199106318737;;; … ;;; -1.0940916829026835e-10 -5.408529232107919e-11 … 2.4782830956917488e-6 -2.1430245288569668e-5; -8.801297482859444e-11 -4.461454711191404e-11 … 1.2882123871292042e-6 4.479884920464951e-6;;; -7.625806210031158e-11 1.3730362144243923e-10 … -2.2598274616180595e-7 -8.192093343639628e-6; -1.6297186681919725e-11 -4.1301482526241195e-11 … 4.30818262382805e-6 -9.410227992774835e-7;;; 1.894872583784682e-11 2.1073412298762292e-11 … -8.704383863504922e-6 3.807056401565349e-6; 1.593006140174339e-11 -5.6307202123439766e-11 … 1.4956598330669379e-6 1.4945320879901956e-5], [-0.7069531549369732 0.09587964087310512 … 0.09935956356676207 0.09140059803036381; -0.7070560828547318 -0.09585816620714617 … -0.10504130056282371 -0.09661270298830374;;; 0.012007781913510861 0.7004263423615239 … -0.17753486268458302 -0.1597436654589143; -0.012011513913275563 0.7004731477667727 … 0.14724219549687637 0.1349692353872382;;; 0.00021887380534262255 0.0014669395709023204 … -0.2155477030853965 -0.16212873295736144; -0.00016686600430948498 0.0012025264559605824 … 0.08438221785884077 0.17054199424861888;;; … ;;; 1.9730380375776401e-10 2.7039091351365795e-10 … 0.39600388859873303 0.07002095675759985; 1.4607185760463555e-10 1.5337551618762893e-10 … 0.13344119562965528 0.17746525697855217;;; 1.9841156060868813e-10 -1.9328173073619396e-10 … 0.5282291208630668 -0.15444380957160647; 7.467226594601675e-11 -2.8269611886628104e-10 … 0.05130859853436984 -0.5958505758965512;;; 1.508555298121369e-11 2.6183367363655044e-10 … -0.34811640456415505 0.23220146587524734; 1.1301756741770183e-11 4.011285707830306e-11 … 0.10229031782289176 -0.20567262154185664], [-0.7070632009276501 -0.04907376107334326 … 0.08014871133917656 0.023066577366795887; -0.7070967072140109 0.04695555699916491 … -0.07963585760315321 -0.02483474083570406;;; -0.007118781352595181 0.7053729291986401 … -0.022071757231260574 0.10003493718532588; 0.005000157150384011 0.7055301426564676 … 0.03328049134538997 -0.09916932437460026;;; 0.00024025372243138875 -0.0024448201293897852 … -0.05155014580425831 -0.05150443867619289; 0.0002930521333264053 -0.0023696562314782905 … 0.06112515712215641 -0.07207502928810526;;; … ;;; -1.295261066986092e-10 1.1076782079081232e-9 … -0.1392145778940413 -0.26671258327147457; -9.372242983111419e-11 1.2585380522043899e-9 … -0.26039531968513774 0.06941371456038833;;; 3.9880343371619194e-11 3.577290742658442e-11 … 0.260568366773891 0.25177829159894477; -1.7558837037987962e-11 -4.667552463974516e-11 … -0.047727955676373585 0.21781220667026374;;; -2.7884838901321515e-11 3.3534358014775423e-10 … 0.10163026448413127 0.3598067249804705; -4.515642239332251e-11 4.251542051302758e-10 … -0.024943461989823633 -0.04102197022705376], [-0.7070648666852204 0.02851980362759139 … -0.004790804442297967 0.10114159840122934; -0.7071059961279158 -0.0195160715241777 … 0.004897402709901951 -0.1006854824686858;;; 0.0075393984041794435 0.7064033280966231 … 0.01080561829841727 0.043944398357650565; 0.0014390115322035766 0.7067131770909275 … -0.010585390689862079 -0.05248554684177047;;; -0.0008051368025823308 -0.011499153624057238 … 0.07867020862344923 0.01989720739012754; -0.0007570519859558693 -0.011505724059512936 … -0.052406241676067104 -0.14424986130421574;;; … ;;; -1.067840905395928e-6 -2.1494334331265097e-5 … -0.016047709466429895 0.0021680278446136597; -8.886110016848192e-7 -2.15695382815385e-5 … -0.0300441413872442 0.049335413764789726;;; 6.947634267543573e-10 3.1266435529672605e-8 … 0.10921348414986909 0.04956946038039875; 4.241584420680315e-10 3.172810291119578e-8 … -0.08143982499508709 -0.06982844662355543;;; -3.6717015729109075e-9 -1.0084660049468325e-7 … -0.1553100088953883 0.15129899868379326; -2.8124199994131717e-9 -1.017679362448792e-7 … 0.2807601214606246 0.020752895570662965], [0.7070459238379634 0.019812283167863265 … 0.011113014357941941 0.015006448676147623; 0.7070793621162449 -0.00440694918428351 … -0.010702339163486582 -0.014891666829681993;;; 0.0091818718856056 -0.7062596030457369 … -0.09464746302349204 -0.026468211585428333; 0.006143646469779957 -0.7065239221150591 … 0.0954619704908552 0.027034967521716746;;; 0.0010120757480788555 -0.022802046216747092 … 0.0067722754135239515 0.017228144678549422; 0.0009344538040614839 -0.02282527394680939 … -0.06208685639775201 -0.003145251828986402;;; … ;;; 1.8827688312333882e-5 -0.0005413546008311589 … 0.2224469130269823 -0.24318805331163182; 1.6476171791623217e-5 -0.0005416672148946988 … -0.35412567393126837 0.05785805905918106;;; -8.476153648447953e-8 2.2794187494675925e-6 … 0.4107568956162628 -0.3125293354576207; -7.505593931838843e-8 2.2819268201531503e-6 … -0.016291835563542426 -0.03965993481081317;;; 5.794304381700492e-9 -1.552374571141964e-7 … -0.14083050315574897 -0.1722841754451038; 5.129429131742118e-9 -1.553904893052793e-7 … 0.12760468837023656 -0.07690875279373133], [-0.7070324044699083 0.015685362396714028 … 0.025811119804031973 -0.11856181299836137; -0.7070524632062055 0.0032879374847415415 … -0.025799487068629143 0.11859050152438731;;; 0.01015610081557098 0.7049783030007541 … 0.005501300102751841 0.014581467315018769; 0.00866751680532865 0.7051440047497752 … -0.005964371353264468 -0.012507137719364814;;; 0.0007233905047721483 0.026460011221733918 … -0.052538234663861476 0.007197015247037463; 0.0006727060393485204 0.026467462305296067 … 0.05370565354245203 -0.003997005815825419;;; … ;;; 1.1167358829156066e-6 0.00011457226833019715 … 0.1881306648439553 0.053377888783873055; 8.604663564789245e-7 0.00011409954311808793 … 0.4225189088067638 -0.3547502841627051;;; 1.9265690157224414e-6 8.576888637853331e-5 … 0.15508785043922832 -0.14961236569486772; 1.7435486991017935e-6 8.570314041166441e-5 … -0.24268708311787854 0.04632655702639774;;; 1.0927663221990812e-7 -1.5601408489529697e-6 … 0.018397401973288225 0.10850759968568754; 1.13876571288385e-7 -1.5186967428064016e-6 … 0.1495571021762 0.03793371785541728], [-0.7070538540923522 -0.011553263547471172 … -0.020313739764737337 -0.03083410587059511; -0.7070622312767074 -0.0050347354174174975 … 0.020313712838203657 0.03083388543433741;;; -0.008504665805013929 0.6960280596106421 … 0.0004589025291747018 -0.00025462933507899654; -0.00780146292838566 0.6961051224068765 … -0.0008331935089721776 -7.993798672409042e-5;;; -0.0003413535943966678 0.026663716446008408 … 0.0003901129807039904 0.0010991081071715016; -0.0003154677581514734 0.026663491075291985 … 0.0004585894583197021 0.0007081907224110072;;; -0.00024073153214652606 0.018831863854608277 … 0.0054511044558197995 0.008982560069100448; -0.00022194965060301562 0.018831281613437334 … -0.01440000232374601 -0.007949431009044107;;; -0.0002205519680707616 0.017038546752882657 … 0.07548187585394366 0.6017958627877805; -0.00020335207691417852 0.017038724571092668 … -0.5113102230935285 -0.4625062142043345;;; 0.0005576747367185594 -0.043505672587619414 … -0.6058221253792732 0.587139321251355; 0.0005137986417350067 -0.043507085677077735 … -0.5144511950392635 -0.2209346058692479;;; 0.0012826683673699787 -0.1006243839531618 … 0.15921833665500099 -0.12430180621514647; 0.00118121791357394 -0.1006270315474296 … 0.12536888242579727 0.03187126164672825;;; -0.0005824832572865179 0.04513923578066658 … -0.24059426692871497 0.1079915838615023; -0.0005369444451518036 0.04514159442261679 … -0.03415829269427403 -0.014457834487779013], [0.17698832908572157 0.1415060363576917 … -0.14790253469900103 0.25821542477275833; 0.9837145370845904 -0.005059334556597718 … 0.00765932329427224 -0.04599616791308033;;; 0.019963229216561906 -0.9898236208086113 … -0.033654067711990414 0.03850792424636646; 0.007847232959737866 -8.750025261891634e-6 … -0.01996857528058755 -0.21151695462223308;;; -0.022438555599649718 0.013721038858471295 … -0.8571398607246451 0.05269244042119924; 0.004152395296121022 8.981732623814412e-6 … 0.05650753249122585 0.3887799795896687;;; 9.084364106344513e-6 0.0012279837962965966 … 0.13374545199916082 -0.01594905699602041; -2.098477435403467e-6 -2.9631338370124064e-6 … -0.002413039528045925 -0.050332094026082456;;; 7.046838570916615e-8 -0.0031054008208238836 … 0.25907958023959704 -0.19620997599149614; 7.670058465726434e-6 6.300615884360149e-5 … 0.27200864514482165 0.6458092396381687;;; 1.7776414647452043e-7 0.00046360071129744693 … 0.10704733535597344 -0.025242355650966528; -1.313883739288075e-7 -3.831153937659523e-7 … -0.014365320376915775 -0.09542054430611474;;; -3.620868588218412e-8 5.225739653377429e-5 … -0.10371308575786478 -0.0012639722212175835; -3.1846150711344097e-7 -1.6018607584723086e-6 … -0.07564682899040011 -0.29858271069315917;;; 1.349589800348107e-8 6.585387216606498e-5 … -0.07185360149066222 -0.05113085024578221; -8.229980407126866e-8 -4.884183899003541e-8 … 0.2152698554246682 -0.41375720493582346], [-0.4087641699815425 0.25344365015909814 … -0.026755985868348573 -0.011517850366655667; -0.9114952819602041 -0.1291409204835886 … 0.006767271319367399 0.00013267767532478317;;; -0.015293254789557013 0.9582591748831807 … 0.008220833313921797 0.0022095364871546593; -0.018782749691402544 -0.001291491126776316 … 0.03477947210718132 0.04775962969712419;;; -0.012832604494569976 -0.028445078925465796 … -0.010321627046371967 -0.04814958920384661; -0.03656300318063434 -0.004183547544009506 … 0.11273769279083234 0.1169009777294464;;; 1.9229444783106252e-6 5.95546904142114e-6 … 0.0037692495889854525 0.010182148776012478; 5.587796477855424e-6 6.46365167208014e-7 … -0.012995383901378882 -0.011492771676083587;;; -2.8856920041189593e-7 -4.770755741257704e-6 … -0.04669398320524102 -0.0009778131485434873; -7.673967920705458e-7 -1.0975628626344612e-7 … -0.5470351484881465 -0.09536807736090887;;; 1.1915037550511178e-7 2.354868231558618e-6 … 0.2312939371816605 0.006645123289300824; 3.2681913636517644e-7 4.6911311067559916e-8 … -0.5882376338731167 0.04888071609027117;;; 1.3599157449426676e-7 2.050694487137561e-6 … -0.21958865206552358 -0.007055436036078963; 3.565674324326226e-7 5.1099846462740304e-8 … -0.48558660432674766 0.08751370050010339;;; -3.444718459416509e-9 -1.3388753187092272e-7 … 2.620314613823316e-6 0.0001563054565387693; -1.1162525367924956e-8 -1.6831071204770371e-9 … 9.704495213993448e-5 0.9808789507369411], [-0.5236938272427234 -0.4157072475688426 … -0.10916858238843194 0.024506034155674216; -0.8504141892203291 0.27783392890264835 … 0.046189022665681756 -0.010432193434465633;;; 0.02181092405790792 0.8656698117418439 … -0.06698851281162954 0.012436011671445948; 0.019492173117123927 0.013852684462328024 … -0.1722543433765203 0.10355500968390484;;; -0.015239820314343538 0.019012692171519862 … -0.028503757165351272 0.07644310297318728; -0.03811257445915067 0.007628227602216704 … 0.3543753076313947 -0.07445164112245527;;; 7.400059298620164e-6 -1.0265967909166403e-5 … 0.02419693798857579 -0.025655961234403637; 1.8698441481760556e-5 -3.862360994583337e-6 … -0.04438623142946828 -0.008305459680287631;;; 3.12084465731891e-8 9.719476460200264e-7 … -0.1411249629551744 0.0045559443852613065; 2.879574600341973e-9 8.356864455627365e-9 … -0.07130328660790064 0.2553856917825919;;; 8.286944347099395e-9 2.607588859800876e-7 … -0.0717293414822317 0.0018862110510508138; 5.048736964614975e-10 2.2833413902348563e-9 … 0.5430818092516845 0.15945293760620805;;; 8.962761713411696e-10 2.8858454503188666e-8 … -0.7055181877167065 0.024721095121665357; 3.4415328886774704e-12 2.651362816727246e-10 … -2.293895015244692e-5 -0.03784001368887182;;; -4.959488424187748e-10 -1.592154425452277e-8 … -0.000537444405679002 0.0015197665817997651; 1.2341968200896176e-11 -1.494603369063471e-10 … 0.0005065296476581988 0.9399903250446138], [-0.5886323633222554 0.582590803350608 … -0.0482068894672589 0.033176358148531586; -0.8076670502450182 -0.4312880909524237 … 0.028724482932723956 -0.025273238481279735;;; -0.011656535958430025 0.6816857890952269 … 0.06596980375748526 -0.04251659274866274; 0.02263458591232578 0.09839184593698776 … -0.014579083524035653 -0.017007955337787473;;; 0.0086754044441981 0.00911169559341515 … -0.2172964122118547 0.190049361714567; 0.021503632578820403 0.010909983247117143 … -0.10157681242762397 -0.1230285173516754;;; 3.122648293203775e-5 8.011697531511566e-5 … -0.07399470923822937 0.07391454612070926; 8.573011140535251e-5 4.8906375152531384e-5 … -0.01913574874782323 0.1165508507457064;;; 1.238793901385058e-5 -9.218561580487243e-5 … -0.3504647863074645 -0.2733727542937093; 1.2394895208369795e-5 -3.5842510393489277e-6 … 0.02835348133548008 -0.5179704382092402;;; 1.257028667518165e-9 -1.0288960504922263e-8 … -0.10505069424769045 -0.07864631816759093; 1.0926558544288517e-9 -5.453025966818979e-10 … 0.047951918186667684 -0.25392437120912004;;; 3.163093227348939e-11 1.4725358640373723e-11 … 0.889684389906049 -0.03800390446883289; 5.6123075180558684e-11 1.2842669717589842e-11 … -0.0005617474224436329 0.007765621343059897;;; 6.263608117678366e-12 -2.3653115750534793e-11 … -0.020148136952337373 0.07845305131579366; 2.733605194218331e-12 1.3735786293000147e-12 … -0.0006032868715318612 0.710290837876114], [-0.6552764591558985 -0.6295651052823332 … 0.05528183308428165 0.044273724458906996; -0.754564979907356 0.5457291022308669 … -0.04437679599281193 -0.044883273444323156;;; 0.012564318738138682 0.5073093313045455 … 0.11575734651739927 0.041992124047919695; -0.031962705264427696 0.2197437024821057 … 0.017513614583433656 0.13143942073484646;;; -0.00257597416381311 0.008059971632396926 … -0.2646790059238048 0.09210912526855752; -0.007629068501112191 0.010561725647936069 … -0.1430337175692434 0.12325859448888943;;; 5.4027304556539496e-5 -0.0007154417297593664 … 0.12736122516005446 -0.07866780503221492; 0.00031272181041832914 -0.0005651566109323427 … 0.0022299410539084095 -0.1863607617479781;;; 0.00012034152805308207 0.00035608946325709477 … 0.5189894006484871 -0.02476049532335648; 0.00015170792043091614 -3.9114883529727664e-5 … 0.013320990109580856 0.401140083800951;;; 2.4319900839794048e-8 8.082088400841326e-8 … 0.19444122817755918 0.02520421902254063; 2.8204746727247793e-8 -2.421619714466731e-9 … -0.08146284763312384 0.40204427891925976;;; 1.53113119314143e-11 -2.697871559060728e-11 … 0.7483685967723378 0.08607444470548065; -2.792323441837183e-12 2.0675140988462882e-11 … -0.01699600657584991 -0.2591750122809104;;; -3.3800564890313374e-11 4.2149093285341495e-11 … -0.010830351235613073 -0.03382275359960197; -1.475583414623151e-11 1.4964160238469954e-11 … -0.009793017143887911 -0.7161453488149875], [-0.6926746981926742 0.6213410651356694 … -0.0535306850427307 0.07240865039824813; -0.7210412229762282 -0.5958434660095743 … 0.04933133410290841 -0.07311065311649388;;; -0.009006696019882732 0.4100368519748959 … 0.1495227640085487 -0.0711087494173847; 0.01475173339971124 0.3011868987053394 … 0.014097109036040766 -0.18933904263716067;;; 7.028013994130449e-5 0.004529370368068338 … -0.19498992302650794 -0.0384376946115216; 0.001454764027314196 0.005220295324537497 … -0.18313709130119674 -0.12646722792273996;;; -5.5783041029606326e-5 0.0026276272640377934 … -0.3437999531522393 -0.19075325733837378; 0.000669432049761897 0.0027168796407327223 … -0.08769637914340976 -0.37984932607292676;;; 6.565775115257592e-5 -0.00013653004562717594 … -0.64469652719229 0.11841817829379235; 7.874967622108e-5 7.53715096876562e-5 … -0.1103780432681722 0.1906163677531605;;; -8.579496694351018e-9 2.0575867121952898e-8 … 0.3042147144826102 -0.10287161700251661; -9.474806906629778e-9 -6.681690153632234e-9 … -0.14180346691732781 -0.6752272137677926;;; 4.3758844524263227e-10 -8.759490083301356e-10 … 0.4839601202940568 -0.1582133753017382; 5.350807103642605e-10 5.414882240548894e-10 … 0.0025753882169346877 0.2812675084372792;;; 2.071894332270071e-12 -8.781166444320801e-12 … -3.251608365652025e-5 -0.0014779474091673635; 2.063141335366945e-12 -2.460367023930239e-13 … 2.7133719637823137e-5 0.35964631024184074], [-0.7032549725095536 -0.6164850096716272 … 0.04847984162001469 -0.0988370958734862; -0.7109158227583318 0.6093908670683484 … -0.04720563319736335 0.09865778168492181;;; 0.003257115438508105 0.3681986700129884 … 0.1606870085346146 -0.1297622990339625; -0.00452010143497208 0.33617363704668507 … 0.0018085174988706715 -0.21618143106524187;;; 0.00010039648921161168 0.0014854976304221055 … -0.15780952476411692 0.062246803765088406; -0.0002600455685764579 0.001551800062134553 … -0.28513769733657895 -0.15241403250898777;;; 8.676460291706173e-5 0.000861805064630927 … -0.5404627330980304 -0.14362695058896058; -0.00010476772879798056 0.0008190848982324647 … 0.023125862526221962 -0.3872407369296848;;; 1.0677459398403565e-5 1.7132638013855345e-5 … 0.6307322161857599 -0.3616165262932047; 1.2366357958769713e-5 -2.1238983930466128e-5 … 0.2851906244054774 0.41290920075959486;;; 6.422977951077846e-8 1.2789137417928895e-7 … 0.23813222471404624 -0.13534367561206073; 6.732936938657603e-8 -9.369355118951439e-8 … -0.13961205494757817 -0.6121091731084094;;; -5.897933677362072e-11 2.0239609189825378e-11 … 0.12409800685588085 -0.11702581836296864; -8.373131090944284e-11 2.3597509731447965e-10 … 6.928617907458861e-5 0.04357120450604951;;; 1.4089722707004032e-11 1.627284463901846e-11 … 1.5860812556404364e-5 0.045676129299811644; 9.423460482973832e-12 1.5550252914368313e-11 … 1.7159674707385183e-5 0.08544321354550223], [-0.7059238853192649 0.6181793994604706 … -0.020653008704911813 0.1754736951628659; -0.7082861586150306 -0.6159764959196545 … 0.020411933090388194 -0.17512049731766052;;; 0.000874545861196438 -0.3495855886848233 … -0.10048232017792788 0.30327039901653435; -0.0011900685732564933 -0.34090588475417866 … 0.028063186111085082 0.32362038905957374;;; 3.42663610106067e-5 -0.00039302536955593254 … 0.1801815595796359 -0.29320842286515875; -5.640618186720527e-5 -0.0003340633652041511 … 0.3487265556634754 0.5586945914999889;;; -1.2871444132429744e-5 9.190862126245202e-5 … -0.7680780843302983 0.41446866550695177; 5.9101987329401335e-6 7.724393105797881e-5 … 0.4942196055094759 0.41466082777718466], [-0.7067019338822942 0.6328095972121383 -0.0685591431537745 -0.30890780859871; -0.7075113080528489 -0.6320300318719195 0.06803091649624898 0.3087678451361272;;; 0.00017937546774002798 -0.3174976869702429 -0.8248697453581326 -0.4677446844014338; -0.00030569398704732853 -0.3150956541381325 0.5570110784208068 -0.7684095872716178], [0.7069802441207028 -0.7072332956125803; 0.7072332956125803 0.7069802441207028;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^d, 2^d)
xes = collect(range(0,1,length=2^d))
yes = collect(range(0,1,length=2^d))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="faf69a0d.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this example we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 8
h = 1/d^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,d)
xes = collect(range(0.0, 1.0, 2^d))

u₀ = qtt_sin(d,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.831340757469423e-6
Relative error for Crank-Nicolson: 4.8314370036189775e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on [<a href="../resources/#QFT1">13</a>] we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an esample of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h1 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h1><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve Burgers equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using CairoMakie
import TensorTrainNumerics: dot, orthogonalize

orth2(x) = orthogonalize(orthogonalize(x; i=1); i=x.N)

d  = 6
L  = 1.0
T  = 1.0
Nt = 1000
ν  = 0.01

N  = 2^d
dx = L / N
dt = T / Nt

Dx   = 1/dx * ∇(d)
Dxx  = 1/dx^2 * Δ_DN(d)

u₀ = qtt_sin(d, λ = π/2)
x0 = orth2(u₀)
v  = u₀
v_ref = Ref(u₀)

&quot;&quot;&quot;
    residual: (u - v)/dt + 1/2*∂x(u²) + ν uₓₓ
&quot;&quot;&quot;
function burgers_residual(u)
    t1  = (u - v_ref[]) * (1/dt)
    nl  = 0.5 * orth2(Dx * (u ⊕ u))
    lin = Dxx * u
    R   = t1 + nl + ν * lin
    return orth2(R)
end

&quot;&quot;&quot;
    gradient of J = 1/2 ∫∫ |R|² dx dt
&quot;&quot;&quot;
function burgers_cost_grad(u)
    R = burgers_residual(u)
    J = 0.5 * dx * dt * dot(R, R)

    g  = (1/dt) * R
    g += ν * (Dxx * R)

    Dxu = orth2(Dx * u)
    g  += orth2(Dxu ⊕ R)
    g  += orth2(Dx * orth2(u ⊕ R))

    g = (dx * dt) * g
    return J, orth2(g)
end

solver = GradientDescent(verbosity=2, gradtol=1e-6)

v_ref[] = x0
for _ in 1:150
    x, _, _, _, _ = optimize(burgers_cost_grad, v_ref[], solver)
    v_ref[] = orth2(x)
end

vals_init  = qtt_to_function(x0)
vals_final = qtt_to_function(v_ref[])
xes = (1:N) ./ N

fig = Figure()
ax = Axis(fig[1,1], xlabel=&quot;x&quot;, ylabel=&quot;u(x)&quot;, title=&quot;Variational Burgers&quot;)
lines!(ax, xes, vals_init,  label=&quot;initial&quot;, linewidth=2)
lines!(ax, xes, vals_final, label=&quot;final&quot;,   linewidth=2)
axislegend(ax)
fig</code></pre><img src="2effeaa2.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Quantics tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 8 December 2025 08:58">Monday 8 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
