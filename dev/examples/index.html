<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets.citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Quantics tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li class="toplevel"><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in [<a href="../resources/#FastandFlexible">15</a>] where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^d)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, d)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(d) + id_tto(d) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(d) ⊗ qtt_basis_vector(d, 1) + qtt_sin(d) ⊗ qtt_basis_vector(d, 2^d)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-0.24940003874984318; 1.9868035888427935;;; -1.6819142854730893; -1.032835579260149;;; -0.6320383989181846; 0.01721607573709534;;; 0.15490869785048814; -0.8030934305839471], [0.08205098289183466 -0.3313275398775223 -0.37604961767638534 -0.12489963004395578; 1.7834309068309997 0.5097489770633185 -0.9986053505644567 -0.560045490854112;;; 0.20844814333795628 0.5298987640050087 -1.2677005918564646 0.47405883591886094; -0.3239901091590904 -0.7064853904714158 0.7881728958525273 0.2099320195255922;;; 0.25767863043302386 0.6127213248399258 0.15348014092005435 0.6723309650046273; -0.558552360976662 -0.2751748866084569 -0.4158676296645732 1.5408497144633604;;; 1.5633634984593017 -0.6662365916020542 0.4250474031862548 0.2715160916978827; 1.000174635846298 -0.12674674260377247 -0.1737201818099953 1.5757516716929336], [0.31095796079827015 -0.17997196325695425 -0.1324795900923072 -1.199467953151221; 0.17174527059053932 -1.3458004933284884 -0.7137170599199597 -1.7865395576119616;;; 1.0849385159116025 -0.9382578706209685 0.00690735904048722 -0.25593468708317335; -0.18722302480799738 -0.8782378240969821 -0.2140570585944324 0.7365001635871024;;; -0.2603962924833912 -0.7030044010066759 0.5249137129620746 0.668815993017286; 1.1327118336585202 2.337293503836721 -0.8645199825878103 -0.31080463415620146;;; -0.3611887366301462 -0.9341207308043651 1.0892119543185843 0.9898239399693028; -0.6351186956489449 -0.4832498089703152 0.8345955472024265 -0.2934010007046753], [-0.3758395398975491 -0.4961801610568669 0.33528526607284775 -1.5996781893225351; -0.4757275412204626 1.0670375285095113 -0.1812666018675164 -0.1050103124860406;;; 1.0744309051205825 0.49274951522462523 0.21196055881360065 0.9353080481541849; -0.4297237688710056 0.5700806247292997 0.9549611467265438 0.1917901570414634;;; 0.01544074369615966 -2.069865676242809 0.27600410766302563 -1.3312444129072765; -0.3098491409806819 -1.3731404998736665 -0.0545480923212366 -0.6219167357013091;;; 0.5995164881832378 -0.14011160553781207 -0.43385152656588427 1.7706382812905117; 0.9393119562208356 -0.16804039512354946 -0.8421917589608161 -1.2152078141411995], [1.1808335225970872 1.7927583876457607 -1.759204448783602 -2.775057593810769; -0.7113592941613059 -0.12524232149105868 -0.11029768713665371 0.8091648178237737;;; 0.40055649586333425 1.6921288917032498 0.45158579088299455 0.15314135458003192; 0.7715475477631082 -0.15863712536077637 -2.035404385805114 1.5574574036145725;;; -0.71875700877278 -0.42746526189808814 -0.3356542736421837 0.3530824977488814; -0.12371146646814328 -0.25117084365883435 -0.909360209059299 2.0164932422402706;;; 0.5411735450309251 -0.45439241382279194 -0.4427389956100504 -0.32928695678433245; 0.2860463476146793 0.4935819125314121 0.038627598133035346 0.21411164225185228], [0.05322204170420526 0.6268966440598343 -0.5661224356498503 -0.7420313882389686; -1.5305403023064188 -0.21008285416377673 1.374254828060253 -0.0850512969215755;;; 0.4910421012726915 0.4844895344994156 1.555482546824399 0.9381208072841878; 0.7472785522361802 -1.1143474300364022 1.169805782214765 0.17396422914313292;;; 0.019967640353820065 -1.9054315103580972 -0.7013953176127707 0.6167179186163818; -1.2636067765886534 -0.5077335577708206 -1.0040452316474944 2.05788915688209;;; -0.6813458293021657 1.6261882815621804 0.5661639364713447 0.9530653266332061; -1.4770013788869851 0.6139356723074721 -1.1246673775643414 -0.1167894421735798], [1.139040658086185 -1.5295554778955445 0.6087784899085278 -0.7909503021891591; 0.5454153019936638 -1.087085343286755 0.607903656268734 0.8544067436784599;;; -0.612704945288168 -1.5745151831838253 -1.4462434670072974 -0.21172107518926264; -1.664629705026018 -0.34882026589934856 -1.6516980955550298 -2.416055042709392;;; -2.1827862218233913 0.35828299894441074 -1.519653367696147 -1.1782197433902342; -1.350556361862907 1.0304139853804164 0.0632440736556885 -0.3914074208665133;;; 0.12032607169886227 -0.9002877484556853 -0.0916461324333788 -0.5781640939741666; -0.6207192598473723 -0.8254177292303955 -1.2297803558164884 0.5316483119780054], [0.29437856585299443 0.028028172781160092 -1.030462584093612 -0.3667343679219046; 0.2713919847464727 0.8077447630310411 0.8452851779967165 -0.5624152831790264;;; 0.44943788426681314 -0.3563451763102306 0.864151836033064 -1.3342187812253943; 1.7232801738502488 -0.9733645229619529 0.4147732360400018 -0.6788629327585888;;; 0.5770704528314041 0.3999338529916507 0.765207971507941 -1.627105481730891; 1.3597387334263527 1.9972345912167941 -0.6363436568188244 -0.6287392511260046;;; 0.19952937448812613 0.46238661729960295 -0.29698572555262304 -0.24453995101781875; -0.5644992444957132 0.6937948215012261 0.6835861949503574 0.24699487608051818], [0.6650084032594002 -0.16524403477281818 0.7879342207398884 0.19555925024437196; 1.6251866616582455 0.23159649777385102 1.4266022630073896 0.9489570254303891;;; -0.3663966227383919 -0.43725174292778346 -0.5490777695600446 0.2363015875700714; 0.04686560998091461 1.9206453497980593 -0.030613986565231316 -0.006829929631041465;;; -0.2845248856508107 1.8538607652968508 -0.07389121175658343 1.1846566288476055; 0.26943848116974467 1.1347025494584775 1.0111336180989896 1.3897457532148678;;; -0.5382268004374051 -0.044902287726745274 0.3834918204951106 0.7993733358574301; -1.0453836716968452 -1.3238644450956236 -1.609409884496543 -1.8399266419479263], [-0.09566506297735218 0.4861626277416964 -1.8772181918754067 1.5570695812254618; 0.018523293413780274 0.7186044466014486 1.600903183251829 -1.1910158055183786;;; -0.34975507682620893 -1.1476991322030254 2.41656979670757 -2.7564168401538445; -1.0670231289389704 0.5430068461054445 -1.2766624392952115 1.0686328125330455], [-1.771485066380584 -1.066043380098661; 1.0651378989736606 0.3321251225604927;;; -0.35504327597324487 0.3862985185366407; 0.45417686447704697 -0.15339525147364885], [0.39032528001073896 0.1206432725800534; 0.5018595414494758 0.24922701782647957;;; 0.8878203100397797 0.3448457777928516; 1.0400267017323719 0.8328094428775239], [0.16733764910059026 0.12251571666179474; -0.55784093489318 0.10669322063906717;;; -1.995447238663462 -1.1114320720339452; 0.30667278525990516 0.25694077988888914], [0.5404532071716996 -1.087287083638583; -0.21981963775605143 1.1186562564698777;;; -0.3045786230357844 0.19252634682049155; -0.5619339430915853 -0.20807884148829536], [1.1409712787249406 0.3459660659220763; 2.0338307738931896 0.046479439364896236;;; -0.44329670568071217 0.9815048776105348; -1.7319741578668757 -0.012977653923419872], [0.7078983374180796 -0.4717796165779184; -0.021136638349376242 0.6753708119620478;;; -0.23834584012820695 -0.5380006520969428; -0.47285291929619616 0.15905987529143886], [0.8434412761926379 -1.722346031787174; 0.6381908356571545 0.11981911470028375;;; 0.6536754405654147 1.8316721581468123; -0.13227714469548962 0.4301730759941999], [0.1070144364942281 0.4305941897193802; 0.9011937781880228 -0.6755534228341469;;; -0.9206753888365444 -1.5058976994386273; -0.2289250935870847 -1.9102883962641992], [-0.9160398452763914 0.3502402927486874; 1.0833980243242618 0.3930837891593426;;; 0.22232810285224028 -1.7394756720178863; -1.2347676317826584 1.5961520935824902], [2.2669520469934863 0.22321550328301934; 0.8819670269501018 0.8321048583682432;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-181.33131547837982; -187.98498265784644;;; -109.69184751076628; 105.80934032685008], [0.6994725717094128 -0.4948034158689191; 0.6950905662965227 0.5012768034424432;;; 0.11456020438242408 0.49711624999007253; -0.11804099828933057 0.5019309182423601;;; 0.011185879802872403 0.04932599186774818; 0.012428276808180289 -0.04776689960199941;;; 0.011271046656388955 -0.007163852706702999; -0.011085391395892692 -0.008116792854101086], [-0.7059699482494769 0.33867149258591156 -0.0593355969866148 0.12009706872041677; -0.7048586746244215 -0.3397341191127119 0.028671111926280784 -0.12387651806354356;;; -0.04840448285828682 -0.6173938957483214 0.2703737328496404 0.13113977475989794; 0.04877677092740965 -0.6197066768740708 -0.31805916776683835 0.08450858693015666;;; -0.0036727746400123124 -0.04839087562820448 -0.47792820421019494 -0.5175699424136626; -0.004360605733224834 0.048252791525690925 -0.4929007693321844 0.5218122726473856;;; -0.003590976839624536 -0.0007540359725185472 -0.42088932629804127 -0.46170125677192647; 0.0036204260354792506 -3.26358697231456e-6 0.4157488765563012 -0.4386957389788772;;; -2.6000861517695462e-5 -0.0003039000444624908 0.003916894693537995 -0.0038036733595107554; -2.4735150740229404e-5 0.00029976403411156687 0.003982227097865063 0.004495260457416757;;; 5.2560309321349884e-5 -2.4741784853801273e-5 0.0007573480218064971 -0.005897184758909533; -5.316461278090891e-5 -2.01334246711026e-5 -0.0006330214881903631 -0.005813577405603715;;; 1.1625854998982014e-7 1.4988915142329983e-6 -1.4529862617163806e-6 -8.809894380587327e-5; 1.2577074893463474e-7 -1.4961788718849043e-6 -2.047322823564594e-6 8.81141803915266e-5;;; 3.41455292371269e-7 -1.5231667434373921e-7 -3.4360541272815505e-6 9.859530448759492e-6; -3.373101372933956e-7 -1.7549782279563246e-7 3.3531651838819133e-6 9.950672750351756e-6], [-0.7067981334376353 0.191397086720295 … 0.37223835923868087 -0.0007721961285377831; -0.7066432716227764 -0.1913704647476372 … -0.3718139564151632 0.008795837712302988;;; -0.023356594950104115 -0.6799759987487015 … 0.093428881369031 -0.11912937206284496; 0.023269274811166567 -0.6801199374059412 … 0.10751223424363622 0.11183182088584769;;; -0.0009937988761287645 -0.02984859170457346 … 0.14686657679046433 0.049071811169912376; -0.0012519104262992884 0.03004041298553141 … -0.04053489418167445 -0.06069127566963062;;; … ;;; -2.8781537321387073e-10 -9.232406817120026e-11 … 3.350095641174985e-5 2.1216192991653703e-5; 1.614835751627988e-10 -4.4592818890681473e-10 … 4.89425175209782e-5 0.00032078717397843014;;; -2.0293406177203714e-11 1.3430799178842036e-10 … -0.00010454758370912478 4.33340188632837e-6; 3.45462188531002e-11 3.4538707001950193e-10 … -1.9425342746572024e-5 -0.00013517888395460752;;; -6.085137951716044e-11 -7.757461634497419e-11 … 6.269320917047963e-5 -3.8069250560293922e-6; 4.981900582514889e-12 -1.888222690275777e-10 … 3.337126794287153e-5 0.00018085843503028726], [0.707013480906467 -0.0986509100736282 … 0.01407424038806728 0.018119907331575036; 0.7070063400366997 0.09859797046778367 … -0.023093448150796194 -0.013339217329243562;;; -0.011726367395927686 -0.7000562748829848 … -0.2659462486276852 0.14199070765986788; 0.011670727011359404 -0.7000379132474491 … 0.26067633113993255 -0.1394227903273034;;; -0.0001727653927955041 -0.001824212541750084 … -0.21867573552826006 0.10369051629877733; 0.0001980230925838219 -0.0018397834223124964 … 0.22635963342207346 0.20017616471486405;;; … ;;; 1.966199755058039e-11 -3.2057848993472804e-11 … -0.30087187253363035 -0.21658957356580957; 5.488061880182523e-11 -2.707686463471665e-11 … 0.1548059203584963 -0.05220939315132351;;; 4.351290440846452e-12 5.7979567252397587e-11 … 0.31674751164607395 0.31207437232371615; -1.9501018359571655e-11 3.906722379008516e-11 … -0.047973474207623934 -0.28679655387860536;;; -4.141489838621309e-12 1.906547520531961e-11 … 0.07720572811186688 0.28759679679910055; -5.591156970349307e-12 -1.536300766579912e-11 … -0.07167283254307207 -0.24585467694941418], [-0.7070826245997786 -0.0494652895247116 … 0.03499098839961389 -0.1087745692701065; -0.7070815754704834 0.049489269971604376 … -0.0371255615275468 0.10869816778560114;;; -0.005895486774790365 0.7053564673006284 … 0.12859721412631664 -0.0030675652119392365; 0.005919370842759842 0.7053523065930359 … -0.12377898886439657 -0.011572673689208978;;; 3.88475988132869e-5 -0.0001716990221370093 … 0.02659679523967522 -0.030030878186704905; -2.9172243740430096e-5 -0.00014676425014488882 … -0.01852610318847046 0.011931944368819622;;; … ;;; -4.596439380843563e-11 -6.6126771822402e-11 … 0.46207695894260964 0.4857570373990439; -3.730556453746542e-11 -1.3240142559028655e-10 … -0.3563268857807252 0.25930052073363286;;; 4.833532631841829e-11 -1.1399905692748141e-11 … -0.12900187142839079 -0.28395836515955214; -4.776598669700174e-11 8.330354807442725e-11 … -0.2791435929815616 0.009399717886137067;;; -9.611262885699689e-13 5.1447506714108006e-12 … 0.3207701007167895 0.046316143691314024; 2.991144133982569e-11 -3.3645235927516655e-11 … 0.07730443171988875 0.09603155591834861], [-0.7071015889216655 0.02445565018160242 … -0.02746261601938666 -0.1309886431701173; -0.7070993580029231 -0.024946084543179585 … 0.02699673044723046 0.13138616384451568;;; -0.0027310699164573428 -0.706674751315979 … 0.05461398911023447 -0.051808410094282005; 0.0032213492142884425 -0.7066572684937046 … -0.056032702699879436 0.04389114609527704;;; 5.233604221219731e-5 -0.0031428148612239423 … 0.016600981311417785 -0.11239677413714233; 4.018276885910153e-5 -0.0031473563839107344 … -0.05438556924891236 0.01944578046764663;;; … ;;; 9.597305329806372e-10 5.290375768785774e-7 … 0.025737021180733143 0.08401545961391242; -3.5610996109489294e-9 5.314035789868407e-7 … 0.01758512612041142 0.02227158727873585;;; 7.832865781960663e-11 1.3669077088037419e-9 … -0.07876158072814841 -0.14597701475935596; 6.105487452994801e-11 1.1912519582210201e-9 … -0.05415060138882368 -0.11308898531530463;;; 1.9861770991751974e-12 5.038972154605022e-9 … 0.2896335274002142 -0.14838271852026774; -4.394814923585509e-11 5.053441184680322e-9 … 0.07933032790803421 0.16214348761498024], [-0.7071063516106074 0.011678354548986686 … -0.05993425191743035 -0.019950225143510456; -0.7071033731445642 -0.013076654162285331 … 0.05988505279465452 0.01992940351534493;;; 0.0007917773887872441 0.7068812103248843 … -0.010936524891021815 -0.004549900447676539; -0.0021872652274502586 0.7068565888023692 … 0.01316233990486764 0.00521746636022407;;; -5.946962322661412e-5 0.011553639856176879 … -0.07226367639708375 -0.007082448518162289; -9.067936836995322e-5 0.011553233806801039 … 0.048526924722312584 -0.02322885376647406;;; … ;;; -1.300250896333513e-7 5.395182084368211e-5 … 0.319342186355572 -0.11160341642185859; -3.526302421879522e-7 5.4079767506688644e-5 … -0.24995240389713327 -0.0599050269806302;;; 1.05500277841389e-9 -5.268353670847423e-7 … 0.049924152912945184 -0.28454509364770714; 3.160399586514016e-9 -5.258295041494386e-7 … -0.05149062282892284 -0.2035019354690026;;; -4.535012803624884e-11 -3.657060834518375e-8 … 0.21310922695540832 -0.19991060878207187; 1.2455663103877126e-10 -3.645714361863302e-8 … 0.5362216920408557 -0.11677894841616014], [0.7071066889748192 0.005178160273807174 … 0.038746326542468436 -0.041858693023829045; 0.7071043938582112 -0.007373613678918775 … -0.03874816748204381 0.04185830624509708;;; -0.000357046816878124 -0.7064135895947345 … 0.001251916410223572 -0.00021833249057963224; -0.0018310332749785373 -0.706394045251988 … -0.000552892178170106 -0.0005161970104825929;;; -4.8160797850493734e-5 -0.017717440647869016 … -0.009308341325337656 -0.006108436976401846; -8.008307300987249e-5 -0.017720726403964014 … 0.009017277708582227 0.002040567770646659;;; … ;;; 2.71448290636915e-7 0.0001276267123643728 … -0.3342885996493747 -0.014602222407162972; 5.294333509790796e-7 0.00012753033855631603 … -0.22277324841333718 0.061799543979986916;;; -1.2830117739028974e-7 -1.2930873338439662e-5 … -0.45652501811000545 -0.18156715665148385; -1.53513572647015e-7 -1.2917055151838234e-5 … -0.24063752868589247 -0.6670390480886198;;; -1.2362592657068705e-9 5.981434527012263e-8 … -0.031061770358759233 0.21905058094849855; -1.124289063467726e-9 6.015735874083225e-8 … 0.04798979946668704 -0.2748084556957269], [-0.7071051740505656 0.0013804221803376516 … -0.015127146429927794 -0.039392332438152454; -0.70710328275064 -0.005111497374497249 … 0.015126637546584722 0.03939213859501278;;; -0.0014945657358081124 0.6985310366526926 … 6.62631643987259e-6 -4.821194909423081e-6; -0.002202872325939076 0.6985117214529065 … 9.355666509454276e-6 0.00041600821724604894;;; 4.531405188130868e-5 -0.02489464747276569 … 0.00088689453086407 0.0012529682269708782; 6.93861205786918e-5 -0.024899215726296033 … 9.232364404725427e-5 0.0009507671027261858;;; -3.37161215383464e-5 0.018701738892071062 … -0.0025079293088576017 -0.009233168002542626; -5.234224683120248e-5 0.018705944101688275 … -0.005256960267814415 0.010975084675888152;;; 3.927677293329643e-6 -0.0025798911120091263 … 0.40592168006588064 0.634948893869367; 6.533108730748221e-6 -0.002579395408706678 … 0.21488132419740996 -0.6427113998076569;;; 3.9668015473606466e-5 -0.02233300834604078 … -0.2987880168181048 -0.2908486771519199; 6.222678816259893e-5 -0.022335246899067587 … -0.6604790899861996 0.3041306416908863;;; -0.00018483436729971081 0.10273388090631197 … -0.045125955610699126 -0.03943901384091479; -0.0002886276330463373 0.10274557332591426 … -0.15539072556017486 0.042251900469168754;;; 8.768449338889374e-6 -0.0048222648065911426 … 0.21969055577202096 -0.0002046074481953406; 1.364946701489656e-5 -0.004822661033926793 … -0.43428995245687635 0.0045837166419215114], [0.17695683369425708 -0.14326630415809488 … -0.16581309723796991 -0.040210965552462986; 0.9837112821723237 0.005177732248270206 … 0.010529952186955181 0.006473983885308812;;; -0.020337885360070116 -0.9896510443354557 … 0.029724639929580073 0.005816123431311034; -0.008525480503121116 -3.6873343510685646e-5 … 0.015602080904237573 -0.11676644535858607;;; -0.022259326560168793 -0.0058776333899089395 … -0.8794481386029205 -0.009512928333544944; 0.004074454326210955 2.662793208587308e-6 … 0.035143231956635525 -0.08398970709086884;;; 1.1399584105003047e-5 -0.0006956843489927576 … 0.1370632088993965 0.0026303342002790826; -2.2205390958915553e-6 1.8435373728438022e-6 … 0.009651386550992421 -0.47377663270600845;;; -4.605766104090665e-7 0.0019150564466842144 … 0.28922835498211746 -0.12235377145808; 2.2242899206323553e-6 -3.79330920912527e-5 … 0.15691857565207978 -0.31840255071813955;;; -9.577675070083107e-8 0.00016691690065966244 … -0.16239339170788425 0.013439929482410197; -9.853888128863918e-8 1.9181166934064223e-6 … -0.032464051780289736 0.222706688299668;;; 5.418064620649471e-8 -0.00018103592750682608 … -0.04577168829667695 -0.43242017655559556; -1.535184932370001e-7 1.5669270588426662e-6 … -0.024974830308713176 0.16904560735559412;;; 2.7399074123149528e-8 -7.864329361611106e-5 … -0.060935204701259287 -0.5754420426440939; -4.5757055073589665e-8 3.1213727858628994e-8 … 0.18865500839883867 0.2005748023976903], [-0.40908776374794564 -0.26012421870351166 … -0.014913042449239642 -0.013911082578550978; -0.9113986762008259 0.1323094628737662 … 0.0008198904675278286 0.0004524468937622319;;; 0.015367296403083893 0.9560664808946336 … -0.0033041610849070557 -0.002895592641543661; 0.01756891957556403 -0.0011648064415017505 … -0.054389063409129586 -0.057807535420251126;;; -0.012626321438474643 0.02732973171361116 … -0.05447436605929979 -0.05718766534091796; -0.035991801689361 0.004267199880517259 … 0.13989007747814033 0.13726409394399305;;; -2.3417889529852064e-6 1.3168466426778043e-5 … -0.011921891561400697 -0.012397766325603295; -7.055539421151614e-6 8.415932597287458e-7 … 0.014924414889866025 0.013882129522984532;;; 1.173388102219056e-7 9.789500089218231e-6 … -0.00044353111212584647 -0.00041091445247927363; -3.1953721308178468e-9 1.6769334433046183e-9 … -0.9401898726341917 -0.024432236125391804;;; -1.1268788994377809e-7 -9.370178541414724e-6 … 0.017479877226704413 0.014850328921703088; 2.290897824098046e-9 -1.1275910697594336e-9 … -0.08497692449806017 0.008574886601799116;;; -2.996823750122922e-7 -2.4977662759039735e-5 … -0.002644050895475866 -0.0023254723108006325; 7.398466697278549e-9 -3.60774508185675e-9 … -0.2870807129956509 0.1703419973497218;;; 1.5553002059838938e-8 1.2868162804389978e-6 … 1.0181872083141033e-6 -0.00032789143665369174; -4.187197806191152e-12 -3.8957816825701116e-11 … 0.00037059938074037775 0.9716402767610955], [-0.5248049469589614 0.4254943977248265 … -0.16715662384297275 0.030314394180109918; -0.8498597996333791 -0.2839161890134801 … 0.0677358863906281 -0.013846566701023431;;; -0.021293636114606745 0.8588935193598993 … 0.09991863144303632 -0.016161706965696996; -0.01651453668389502 0.01583037784383941 … 0.3637066266505303 -0.12462061319283772;;; -0.014801011789947286 -0.01831243842911514 … -0.2282456207199093 0.0887222834439399; -0.03705224845613845 -0.007879788107818655 … 0.6855586440722378 -0.0823704349297506;;; -9.651285218796858e-6 -1.2999336307514683e-5 … -0.09319332057294613 0.03078104520593702; -2.4389344270605784e-5 -5.347266020201576e-6 … 0.09081514098545597 -0.03178693747650145;;; 2.0115867917283097e-8 -5.49222035115421e-7 … -0.06422989699575249 -0.0008683002238533805; 5.287754734814683e-9 -4.164039417969018e-9 … 0.18040339199308864 0.31560835495903555;;; -4.336250542118845e-9 1.211969912168589e-7 … 0.05287170375913256 -0.01408792085587893; -6.965859947704994e-10 9.46793602897235e-10 … -0.42310463543304333 -0.21110693657072113;;; -4.420580565310877e-11 2.7054132987964584e-11 … 0.13648558766474717 -0.02027888108478328; 9.818572863654649e-11 1.1359460825247127e-10 … -0.00017433305301181164 0.8606934405883174;;; -6.122090613695622e-11 -1.0327418918899746e-10 … 0.22152426978773934 -0.03273088243946017; -1.498905110670317e-10 -3.2146319999828246e-11 … -7.562090430226677e-5 -0.2825485084383568], [-0.5915317812858109 -0.5883485787313278 … -0.05219848287974943 0.07415409318275391; -0.8055069998899891 0.43801791194688483 … 0.050485318369241854 -0.05576202361414359;;; 0.011489156482343485 0.6714482351216468 … -0.03794027073888472 0.08214977362348674; -0.02498526534865376 0.10460104116238193 … -0.23039594840839595 0.13165837791202675;;; 0.008282909944263936 -0.008979675006197606 … 0.1868274833404186 0.053597250768949625; 0.020584929158441064 -0.011022136386450639 … 0.1410644836437889 0.04102500338456459;;; -4.090412429572528e-5 0.00010182872985378529 … -0.09301590389186468 0.0020945988826332725; -0.00011219586173714675 6.716477326204563e-5 … -0.18342206422091337 0.0781252455791594;;; 1.5427162586675636e-5 0.00010727422038462143 … 0.06087751397627547 0.4523764561679818; 1.5848871451639964e-5 4.073421356430269e-6 … -0.5038594401023384 0.43685233111815863;;; -5.428676209514346e-9 -4.4119128732689926e-8 … -0.06282793598332637 0.07631809755808043; -5.247219112805067e-9 -2.1514129743703462e-9 … 0.3605219937722133 -0.24904450815727974;;; 1.1060467810912095e-10 -2.670210145410514e-10 … -0.4334758130105772 -0.6467189725255221; -2.4778910256018893e-10 2.7106877847267874e-10 … -0.11032063963938234 -0.11793475304803797;;; -1.7897232543596197e-10 1.7125297177957724e-10 … 0.05830459369950992 -0.22938348271129771; 9.26119512594382e-11 -6.895894772351206e-11 … 0.49812676144421464 0.09242695479954105], [-0.6581685253715198 0.6295107361346077 … 0.04732587079021093 -0.1099923469920886; -0.7520711133665873 -0.5498390966722624 … -0.03609829113373015 0.09324844633302008;;; -0.01270066485556479 0.5005052530307889 … -0.11324936890648184 0.21563168348328846; 0.03139294873837269 0.22519708676526515 … 0.012039440063880576 0.07884431081613011;;; -0.002341897052643045 -0.008017079624239318 … -0.28777158428264105 0.46103527755734774; -0.007119864710523681 -0.010400871316693386 … -0.19784894293299096 0.1280333735917126;;; -8.630351747857882e-5 -0.0008876934429598462 … -0.15630205245375217 0.253982847198618; -0.0004298250542525526 -0.0007730127460606634 … -0.032842817686232074 -0.03972966410389781;;; 0.00012329781617035962 -0.00035411908152145643 … 0.5643746012462494 -0.14509665880129263; 0.00015548642336930867 4.499312123989522e-5 … 0.02469040344328856 0.08664226805930043;;; 3.348278291667715e-8 -1.0895136855499018e-7 … 0.1669123052900298 0.11583924546698536; 3.874593292897343e-8 3.9813025517904555e-9 … -0.1328096398259857 0.18508361806125162;;; -8.420822173302404e-11 -5.4494601332940556e-11 … 0.6840738702035104 0.41911191487843363; -7.53153384465229e-11 -1.34366394124209e-10 … -0.049590926052533416 -0.18017827094512534;;; -5.904905601484614e-11 -8.7594715492836e-11 … 0.006801947802077979 -0.025559782850634503; -1.2119280377655602e-11 -6.41236852158454e-11 … -0.03053072982225793 -0.5886036436475606], [-0.6936804922087628 -0.6208652564809475 … -0.06075378076082686 0.08371911433834121; -0.7200927452459025 0.5970771592256024 … 0.05644572748208356 -0.08428704995545454;;; 0.008690228440454936 0.40682640785046115 … -0.16687852840725637 0.08786980912897879; -0.01400457354611183 0.304073723619912 … -0.021459621792782903 0.2110018089328126;;; 3.900012853394279e-5 -0.004190111820285004 … -0.18901245140186082 -0.014451434959188195; 0.0012967005215480552 -0.004816723231131249 … -0.19863777836704127 -0.1782269137505129;;; 6.954601230981495e-5 0.002762345899869499 … 0.38896291162501123 0.17981539379768643; -0.0006840129943992721 0.002869506519112317 … 0.08449627915489821 0.3363405617481477;;; 6.140511902775813e-5 0.00012582938000071158 … -0.6633808089659989 0.19122234509255118; 7.340553976729864e-5 -7.341612848367342e-5 … -0.1557283023379559 0.11687342810968504;;; -1.2318119825036438e-7 -2.9447005513378833e-7 … 0.30794553885119286 -0.08043794591003328; -1.348786658813225e-7 9.969540326968232e-8 … -0.15704249214839178 -0.7429013826359832;;; -9.107785329001509e-12 -8.270526084508005e-12 … -0.38390016674149857 0.14190685858830326; -1.1311218508202268e-11 1.4792300892475673e-11 … 0.00038345566571566374 -0.24600882384829323;;; 2.7748559676045783e-12 8.883864317759895e-12 … 0.00046353339791277746 -0.08004569916658497; 2.2658449903825076e-12 1.0692467312575044e-11 … -0.0012476992735257644 -0.24606581942168496], [-0.7035076126486117 0.61630575720569 … -0.05246772993375746 0.10707137415998146; -0.7106683918434085 -0.6096716900658616 … 0.0512333737512299 -0.10675657732223576;;; -0.003071461829243477 0.36713066479973183 … 0.1689647516481912 -0.1531682166714978; 0.004237751762749302 0.3371610659410734 … 0.007685067575917192 -0.2207025488036152;;; 9.723518658098235e-5 -0.0013848685890074874 … 0.16537816348871504 -0.08582780549396045; -0.00024117226642029945 -0.0014285135898879694 … 0.3059855281560162 0.1732222337491965;;; 8.19752582470536e-5 -0.0007875801632766874 … 0.5565417163550905 0.05503455811722661; -9.385993222994886e-5 -0.0007450763744311379 … -0.06712230593562522 0.3279852044638211;;; -9.538204179993302e-6 1.5105043999591092e-5 … 0.602526110907666 -0.3311858727879097; -1.1090644636938861e-5 -1.956742014663012e-5 … 0.32089605946305033 0.4533602155864467;;; 1.230871074951614e-7 -2.531935022815193e-7 … -0.20424215457013323 0.1494423419260647; 1.263238879541375e-7 1.7146624616380423e-7 … 0.12890909534069303 0.6317186686809679;;; 8.417018391622681e-12 -1.3279133005942556e-11 … -0.07757485568080197 0.06673866178057719; 7.208412505748068e-12 9.212641014627947e-12 … 0.000253424084866737 -0.12457376038783677;;; 4.850950445016071e-12 1.184751532614633e-11 … 0.020751282824120216 -0.019137319478112796; 3.738449031431309e-12 -9.67854479861197e-12 … 0.0001367594011121604 0.005763671605489167], [-0.7059941116333425 -0.6181163177549779 … 0.019536064031130857 0.17413435029658544; -0.7082163529317281 0.616048872415739 … -0.0196753828029019 -0.17375006919064456;;; -0.0008234523553070916 -0.349357827968639 … 0.02684939648819551 -0.31810995505546474; 0.0011088980076168313 -0.3411229614478279 … -0.09788703187834584 -0.3037040829247186;;; 3.1052581030477414e-5 0.0003709760234126387 … 0.10658378522239907 -0.3336658534181903; -5.407254243678173e-5 0.0002973130588495929 … 0.4637171245144084 0.44391456558974535;;; -1.1669865287791965e-5 -8.303124556505135e-5 … -0.6126702376881518 0.6020853869261452; 5.125334110138402e-6 -6.94116001017369e-5 … 0.6222298332793887 0.2741499071356222], [-0.7067205133874549 -0.6327910172276234 -0.06615697154157238 -0.3094267273359708; -0.7074927593454694 0.6320475796148182 0.06565989495014977 0.3092872948763336;;; -0.00016851617033582927 -0.317469653119128 0.8212851655266575 0.4740291845831566; 0.0002881551783992971 -0.31512601442518307 -0.5628522987404725 0.7641287861359882], [0.7069856227669675 0.7072279188499301; 0.7072279188499301 -0.7069856227669675;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^d, 2^d)
xes = collect(range(0,1,length=2^d))
yes = collect(range(0,1,length=2^d))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="6f0edb13.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this example we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 8
h = 1/d^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,d)
xes = collect(range(0.0, 1.0, 2^d))

u₀ = qtt_sin(d,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.83141503413828e-6
Relative error for Crank-Nicolson: 4.8314507554232535e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on [<a href="../resources/#QFT1">13</a>] we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an esample of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h1 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h1><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve Burgers equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using CairoMakie
import TensorTrainNumerics: dot, orthogonalize

orth2(x) = orthogonalize(orthogonalize(x; i=1); i=x.N)

d  = 6
L  = 1.0
T  = 1.0
Nt = 1000
ν  = 0.01

N  = 2^d
dx = L / N
dt = T / Nt

Dx   = 1/dx * ∇(d)
Dxx  = 1/dx^2 * Δ_DN(d)

u₀ = qtt_sin(d, λ = π/2)
x0 = orth2(u₀)
v  = u₀
v_ref = Ref(u₀)

&quot;&quot;&quot;
    residual: (u - v)/dt + 1/2*∂x(u²) + ν uₓₓ
&quot;&quot;&quot;
function burgers_residual(u)
    t1  = (u - v_ref[]) * (1/dt)
    nl  = 0.5 * orth2(Dx * (u ⊕ u))
    lin = Dxx * u
    R   = t1 + nl + ν * lin
    return orth2(R)
end

&quot;&quot;&quot;
    gradient of J = 1/2 ∫∫ |R|² dx dt
&quot;&quot;&quot;
function burgers_cost_grad(u)
    R = burgers_residual(u)
    J = 0.5 * dx * dt * dot(R, R)

    g  = (1/dt) * R
    g += ν * (Dxx * R)

    Dxu = orth2(Dx * u)
    g  += orth2(Dxu ⊕ R)
    g  += orth2(Dx * orth2(u ⊕ R))

    g = (dx * dt) * g
    return J, orth2(g)
end

solver = GradientDescent(verbosity=2, gradtol=1e-6)

v_ref[] = x0
for _ in 1:150
    x, _, _, _, _ = optimize(burgers_cost_grad, v_ref[], solver)
    v_ref[] = orth2(x)
end

vals_init  = qtt_to_function(x0)
vals_final = qtt_to_function(v_ref[])
xes = (1:N) ./ N

fig = Figure()
ax = Axis(fig[1,1], xlabel=&quot;x&quot;, ylabel=&quot;u(x)&quot;, title=&quot;Variational Burgers&quot;)
lines!(ax, xes, vals_init,  label=&quot;initial&quot;, linewidth=2)
lines!(ax, xes, vals_final, label=&quot;final&quot;,   linewidth=2)
axislegend(ax)
fig</code></pre><img src="2effeaa2.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Quantics tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Tuesday 4 November 2025 13:17">Tuesday 4 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
