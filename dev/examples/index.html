<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets.citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Quantics tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li class="toplevel"><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li><li class="toplevel"><a class="tocitem" href="#TT-cross-approximation"><span>TT-cross approximation</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in [<a href="../resources/#FastandFlexible">18</a>] where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^d)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, d)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(d) + id_tto(d) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(d) ⊗ qtt_basis_vector(d, 1) + qtt_sin(d) ⊗ qtt_basis_vector(d, 2^d)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[0.15780161434661602; 1.290262285190572;;; 0.2367674720995576; 0.7205829114720272;;; -0.12532270694384776; 0.6354508641925883;;; -1.1770063036719862; 1.1471326077452473], [-0.9513138025372833 -0.9801885726254913 0.2134127679121538 0.3277039563038403; -0.36520230922587366 0.8707695500925919 0.1258297274281721 -0.2694448353373867;;; 2.202695014335123 0.05352425185632779 1.8593144836910744 1.0970189346880532; 0.8699840386423331 -0.22214479033479662 -0.6861552880273766 -1.5061381113239427;;; -1.41038539898658 -2.1583326577717137 0.22183501781387308 1.892145124657354; -0.10816793221864662 -0.8202482257279973 -1.9604989640822044 0.5049652463893752;;; -0.8507094245854947 -0.38121155350621616 -0.46397675059780685 0.18013934192132963; -1.0980324635986092 -0.017755445896309868 -1.653777764175403 0.31156956122163587], [2.392637553529767 -0.3813288288907506 0.3462571643990764 0.38776522513553474; 0.8441728347519742 0.5282748733719619 1.3396356439516706 1.0180844898062889;;; -0.12192294927467211 -0.2878926810459108 0.7674438317422553 0.6622322027153852; -0.11241597142065406 -0.7632146363682009 1.2197837325549066 0.7793741721363417;;; -1.1450177147328156 -0.7365163158226623 1.758288079893004 -0.08033402068686214; -0.1513442375187036 -2.0778541550460727 -0.5311070581481325 -1.3204141463881842;;; 2.342866447423812 -0.029904883481797623 -0.15924408743038881 1.022688057386898; 0.3860133841248722 -0.4680816379475109 0.723338521344258 -0.5221372642819764], [1.2908856373882813 -0.8739163769574287 -0.9162479720719666 -0.9884840472847268; -0.14882058232851184 -0.5494316094814348 -1.8830075316918424 0.27657966716941285;;; 1.0060879067149566 -0.02809828444359511 -0.4270508311875377 0.8928289470142281; -0.5023530500250939 0.09865278194544234 0.06433152626051483 -0.17062839401943344;;; 0.1611843410863189 0.44555456442909713 1.1572918587215613 -1.8516468344572967; -1.220804715237489 -0.46551625738694835 -0.5416610667536046 0.6275030296702793;;; 0.521894069412561 -0.1426016651980637 -0.656308553521683 1.8497097598156116; 0.36788847937612246 -0.038042425203309374 1.4721542671856138 0.10507821146594253], [0.8119927882307895 -0.5427847870572337 0.40339002940545315 -0.07592445950494957; 0.6003986355507426 0.858814369401379 -0.4445166881389895 0.13937862905709114;;; -0.30075160968025394 -0.5948320256311104 2.0119880967425687 0.39854288679754546; -0.27494675987661427 -0.7762077431394377 1.3532915602002331 -0.6367039268300164;;; 0.3612294737393301 -0.43364489245048793 0.47971146702030143 1.1717384285144172; 0.11275193120567953 -0.15484205556791875 -0.4172413821809005 0.8438313844306673;;; -1.7030659247581712 -0.6316825758409386 -0.8177743863797121 -0.25682663356526797; -0.44929505428552957 -0.15597537225159147 -0.026640076058457925 0.2681300987763321], [-0.5786233854154837 -0.4464480736105519 -0.831693207962055 -0.833621358192405; -1.2539878363193524 -0.6174771610628982 -0.6013990016961329 -0.02468994897428741;;; -1.7973690233187023 -0.8418879658698719 0.5336761940844297 -1.0184134022318767; 0.19311984563891924 -1.4617788861085834 -0.778258809025175 -1.5077094394318347;;; 2.5015959149365035 -0.826774050555956 -0.6248163705643524 0.3999463672203681; 0.33835199875391136 0.6613392424300436 0.41455830308901515 0.09823520632499926;;; 2.154306252781535 0.24533339170534343 0.8931794274860391 0.737568984344649; -0.29702843652579647 -1.1045963533928325 0.3992996572338465 0.3170666385716545], [-0.9789136852283421 -1.29779045582149 1.778647963186089 -0.4308561881423953; -1.8631736253051234 0.14189632194406898 1.6766922006674687 1.3928092172948154;;; 0.05565474560574541 0.20981123735764473 -0.7870234062713286 -0.07991280900303989; -1.2302727210724944 -0.7134589840119311 0.8124432517734144 0.6684183483077825;;; 0.4169466571061827 0.12398975881584727 0.3760452172575994 0.9148419535538881; 0.6762815923142045 -1.3517514953690941 0.5399482083208778 -1.5805364039980758;;; 1.6909050919137611 0.39096393261057766 -0.5426153692729713 0.14656196633660856; -0.8456808242939619 -0.5108570153823561 0.6161649006778519 -1.309926893112327], [-1.8133798939878585 1.1844748535258134 -1.6976191335855926 -0.5288775290402163; -0.45305235829583185 0.24458529661723455 -1.346682162823428 -0.01098550680469797;;; 1.1861214241269145 -1.2549251440469398 -0.2871374310649913 -0.1723056011870142; 0.7955270721042117 0.600548631801026 -2.6015320312119212 -1.3995357731948999;;; -0.9798560889537955 0.4603499249125702 -2.4915672296095 0.9607923498725263; 0.15988927516308024 1.28436278493518 -0.7145266702651922 -0.44824534162699864;;; 1.3665415843934199 -1.6911421045599853 0.014046947223094077 -0.8318321995155323; -0.6359402162192452 -0.4854860762240472 1.7433115312739824 0.41469596228353245], [-0.6330966351944031 0.1634108969389673 -0.9152679628100404 -0.6615242224878779; 0.4777386691182471 0.10345709428608071 0.40348468265249593 -0.40566842079215554;;; 1.447880065932739 0.7064830589617596 -0.12202212873591987 -0.010275568496804888; -0.12663671001166182 2.092857247501685 -1.8830107286119493 1.285304196948169;;; -0.2846387679978696 0.755224190079084 1.1311414762695917 1.4275804908841878; -0.0005106228826772741 1.069115122009479 -1.0421124012205913 -1.0024195064006982;;; -0.6088791382711944 0.011143656270248322 -2.9393869201188614 1.0463110842064887; 0.6998710192365354 -1.1890832400430007 -1.2797601318379763 0.8518610712153615], [1.1870447219822844 -0.14269631156325313 -0.511897338010167 0.09210948412796001; 0.5779631730684992 1.102854783163056 1.6369706753291087 0.4619695796909618;;; -0.14811367491763497 -0.5146142110213932 -0.38258702620506907 0.8558962835008618; -1.228678893502223 -0.48965347173525486 0.43081300298022285 0.6816117963655992], [-1.2770445699441593 -0.9833685232205793; 0.21084030735847528 -0.5763898292042893;;; -1.9932565955442656 -0.3082097826226361; -0.4053822354004889 -1.002599203028606], [-0.40603496155303537 0.6319307311553345; 1.5036105223553435 0.7677325455589681;;; 0.2882670305523927 0.20609817041448583; -1.9714241533715935 -0.27121353680047355], [-0.9297276473223752 0.30720426203779827; -1.8524166645306936 -0.23068896152291593;;; -0.5695190029896848 0.35935825707724595; -0.3058481192133452 -0.8941435094798033], [0.7945025294104006 -1.7278315054263587; -1.5404732639236354 -1.3784908084503218;;; 0.09931821898590995 -0.18400779602860715; -0.4616819184998959 0.8352529640422633], [0.6516462593183138 0.08038837876042867; 0.8869810867768086 0.46813295159084106;;; -1.4813117945339953 0.7923908198492448; -1.3463055944329134 -0.5800056623053544], [-0.24927987317774727 0.7610381816455903; -0.34644030921684205 0.36958217650532516;;; 0.026896151935739288 -0.4451148246093104; 0.26586642190637577 0.41127661962723866], [0.721195292547803 0.60336854903465; 1.1284644793187195 1.2835821718839988;;; 0.7778342831927156 0.6125771347623118; -0.09577834300909271 -0.9454681347321688], [1.3019584897552123 0.7162602945998101; -1.035442019484098 0.6117365383903284;;; -0.6531038107997533 -0.16357087558185437; -0.5979758076756696 -0.37915666156887884], [-0.13323848240119743 0.24952438533008975; -0.176346300210245 1.4306549590651976;;; 0.39764770601093746 -0.5579483413929275; 2.1017420979367016 -0.002741765589485464], [-0.08323820701349385 1.976363269263418; 0.8431277444371784 -2.884033895355213;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-185.64378328948368; -183.21175742135776;;; -103.11463944336184; 104.4834242530178], [-0.6975751801677513 0.5164824071829807; -0.6991530725375845 -0.5143039718715563;;; -0.1108449246514446 -0.4836922126715623; 0.10974980252518078 -0.482114750784857;;; 0.008044529775649543 0.03360085144109317; 0.007753504550294075 -0.033977625846353575;;; 0.0076397535545835 -0.00564303195333899; -0.007683461029138462 -0.005405365742578613], [-0.7055035772846316 0.36252408180302165 -0.007390683139380157 -0.09074049028350907; -0.7057679601375347 -0.3622522440418156 0.029559553400803292 0.08954919610823232;;; -0.04547562102090468 -0.6064386546263725 -0.23927192313132256 -0.07683149199147675; 0.04537841002717227 -0.605748185781484 0.21736495362542982 -0.09336501759462858;;; 0.00290251204125439 0.03638105667207717 -0.5022257633587147 -0.5247505968837732; 0.002727384434128032 -0.0364267971088453 -0.4978327332992411 0.5240732217669966;;; 0.002569616940268835 -0.0005041580170879942 -0.4436680200727974 -0.45364422190210574; -0.0025669866065729957 -0.00030324035271364755 0.4445671413087893 -0.4617772125055733;;; 3.624873221868381e-6 -0.000174730858649359 -0.003812929010973272 0.008278542700336369; -2.9724465659987002e-5 0.00015994071518297511 -0.002972452238766506 -0.0014932296227038078;;; 1.1561980942132805e-5 6.7326255893065235e-6 -2.2142176246172637e-5 0.0017518340116100593; -9.707600082741892e-6 -1.6658415723135155e-5 0.0005070103237816514 0.0024418316813183054;;; -1.2009045692258739e-9 -1.3597218747357478e-8 -6.596204556122796e-8 -8.146548038956605e-7; -9.227851565962343e-10 1.3305331612644278e-8 -5.285902233269908e-8 8.402977523338729e-7;;; -3.1408724326477605e-9 1.2742667903213968e-9 -3.802151692355164e-8 9.657246515563749e-8; 3.042930512211708e-9 1.2637588413811348e-9 4.557083258251428e-8 7.32852990754581e-8], [-0.7067597013789209 0.2091645774297478 … 0.010442118081022965 -0.03266942083310069; -0.7068037542830103 -0.20915142657160854 … -0.007205960523962724 0.033869176717392174;;; -0.0213980493707637 -0.6749070323654646 … -0.048342153239932704 -0.029143182573218487; 0.021405590025969846 -0.6747795831881855 … 0.054655407141921575 0.009152499790955513;;; 0.0010161181354585587 0.02895624102373103 … 0.014798186330755646 0.016186222674094176; 0.0009304528718276146 -0.02893081698135182 … -0.009182025156060156 0.0023185554270557366;;; … ;;; 1.8095031501808826e-11 4.463316182927449e-11 … -0.0021190527946323237 -0.004115313070706256; 1.0833772951607034e-10 -7.894305467363634e-11 … -0.01493437008253224 -0.01017896001987082;;; 7.358209183553774e-11 3.3463872264556827e-10 … -0.00041248220448425346 0.011290678742310115; -1.5634408707444568e-11 -1.7402432718420496e-11 … 0.00898772982060968 0.013062401786661161;;; 1.0511519864060868e-10 1.8926956207231216e-11 … -0.0025595785774825516 -0.0037056527354153677; -4.970279188981889e-11 -7.242187721495493e-11 … -0.002923299118695392 -0.010400730171742431], [-0.707023229186186 0.10899624525071581 … 0.06240794320771484 0.016503066918132702; -0.7070314926828352 -0.10898163332329742 … -0.06701996035201259 -0.01563252520177563;;; 0.01059834148877188 0.6984704467075715 … -0.16240343466259824 0.02673597657740806; -0.010585789623233052 0.6984608069229298 … 0.13678453297295695 -0.03112241818913497;;; -0.000295874760262892 -0.016286705749835827 … -0.009865943913933422 -0.1066092291822905; -0.00026169860837810016 0.016270846093468946 … 0.26631075711758584 -0.13667655867249437;;; … ;;; 1.59268339194626e-11 -5.911277884901394e-10 … -0.22202329992981717 0.0010544829037045594; 1.3541612191242123e-11 5.729734954894953e-10 … -0.05278144430674776 -0.041272224863444416;;; 4.351608288845311e-11 7.304102672440612e-10 … -0.11660347384007252 0.08037095715401825; 3.304027414837183e-11 5.980099399905207e-10 … -0.10566053451438245 0.23411767151804924;;; 3.3181078852592607e-11 1.488181414749955e-10 … 0.22836596787415622 0.12339627588025137; 3.1684626738421395e-11 2.5891816299762736e-10 … -0.07244608495650107 0.0897478185725574], [-0.7070857892313989 -0.0549017479792569 … 0.03345174540809588 -0.024641525991229343; -0.7070873764070479 0.05485680061588592 … -0.0335090665726909 0.024700839530617944;;; -0.005366466851373644 0.704945037733782 … 0.0032248425178968017 -0.004829440877151128; 0.005321562187707602 0.7049493675033739 … -0.0034008101352385727 0.003074685758419177;;; -6.355460374240746e-5 0.006054454253431076 … 0.38328362334836247 -0.17146839605245903; -5.347262974296458e-5 -0.0060459981426141075 … -0.39638780629807485 0.12959290831789416;;; … ;;; 6.23471679318504e-10 -2.9189603993193433e-8 … -0.08911319287024975 -0.019740763269329123; 1.1723336644075736e-10 -2.6233544193481352e-8 … 0.018153701241434055 0.07231630595289096;;; 1.288675720124979e-10 -9.267146629710627e-10 … 0.04875507669640744 -0.1479440977278029; 2.0596012181629268e-10 6.001019240202889e-10 … -0.13702501234107128 -0.2130751239972323;;; 2.4562010230975734e-11 -8.822120573429137e-10 … -0.09904638027848961 0.24636011731387017; -1.198353866282452e-11 -1.0125602452648473e-9 … -0.16161024291085807 -0.3015644402641772], [-0.7071011013243635 0.027530255845079992 … 5.017320107336753e-5 -0.01806394506458494; -0.7071021800900663 -0.027290662644457904 … 0.0001402260521238541 0.018799945609167847;;; 0.002813409994323489 0.7065681419484356 … 0.024728519949234896 0.09748671867448634; -0.002573649056392461 0.7065778691476613 … -0.02475322987038861 -0.09515734470470802;;; 7.820653925399584e-6 0.00015716007679822722 … 0.017881945230795986 0.02977889840531835; -1.123357857898449e-5 0.00015438589838501478 … -0.029412569657645334 0.11774391254404301;;; … ;;; -4.028057159795828e-9 -1.8901874492250114e-6 … 0.4284608345506261 0.09739813265020558; 1.131634580782487e-8 -1.8682203723191423e-6 … -0.5555030164774658 -0.09707368903863711;;; -1.3394530914812829e-9 -5.727299120594085e-8 … 0.493461799879989 0.023203386292313454; -9.424043739106808e-10 -5.544051843754321e-8 … 0.08543801152804958 0.10891834892998227;;; -3.713989410827774e-10 -5.3439838125465996e-8 … 0.097260431255647 -0.19115821575711311; 3.017512757242937e-11 -5.21152381165316e-8 … -0.0038845904744013865 -0.23101543407916825], [-0.7071050868318131 -0.013882330649674757 … -0.03957773074014966 -0.05694767102947334; -0.7071058393573249 0.013500014612739279 … 0.03955879854416814 0.056977433634888414;;; -0.0015430299237469136 0.706969775123308 … 0.004175171863547501 -0.008877248924723132; 0.001160652452709486 0.7069772845384967 … -0.005723149234963506 0.006562161947395304;;; 1.1984791042311723e-8 0.0006861820007764665 … 0.009584925118585032 0.017109849073174532; -6.750333284518913e-6 0.0006859899948123517 … 0.004348567170171964 -0.03447862566891835;;; … ;;; -1.3996721025471206e-7 2.4963346491300815e-5 … -0.5179930786242801 -0.15628489412625163; -4.499848441495948e-8 2.477042253237435e-5 … 0.41139294892461403 0.035803180346914425;;; 2.1591647869612863e-8 -5.549321884911319e-6 … 0.1412672035416399 -0.04583146697040637; 4.774867303604477e-10 -5.502040201302591e-6 … -0.33027552285014233 -0.2421167681442797;;; -1.4432643685704267e-8 1.3901615044152418e-6 … 0.08939519886968664 0.01866127499338863; -9.247597008524647e-9 1.382390929472071e-6 … -0.044931434441969384 0.027356830381796895], [-0.7071062312274846 0.007060634513595343 … 0.023759193306132242 0.01257456517719248; -0.7071066247597672 -0.006651730569850148 … -0.023754565106413335 -0.01257574341220059;;; 0.0008809354186400306 0.7070626291554752 … 0.002218101558957086 -0.0007367715385954484; -0.0004720654493384602 0.7070666256650534 … -0.0026752797999465066 0.000515183608046441;;; -6.18484525919005e-6 -0.003251757457783997 … -0.0014418823829912782 0.004972472242621801; -4.202395747527833e-6 -0.0032515707043719306 … -0.0002122345236478017 0.005738857268912835;;; … ;;; -2.328178793754148e-7 -3.9464820303357786e-5 … 0.4644932784370823 0.6350495855470067; -1.5710365071069802e-7 -3.9336706313587896e-5 … 0.46185474142915817 -0.16079248929494333;;; -2.2240621600718843e-7 -3.4724147431088423e-5 … 0.3216980133192961 0.2144896732646671; -1.56240787517387e-7 -3.462701620315203e-5 … 0.5418570509206442 -0.36555900914150385;;; 4.094264291628976e-8 2.7017929026868425e-6 … 0.07361546800436782 0.09016576400999786; 3.6303473443952486e-8 2.713840202015043e-6 … -0.22351515289606888 -0.003507133769229371], [-0.7071064475913365 -0.003808262465709015 … 0.014467705788998475 0.03386305215526617; -0.7071067808002324 0.003108237337066733 … -0.014466439925317409 -0.03386295774373497;;; -0.0006855591480827225 0.7064821491257258 … 0.0007150536243352909 -6.514232343665439e-5; -1.2789292379285177e-5 0.7064855490641254 … -0.000493093711965371 0.00039779223671175805;;; 2.1114429430620635e-5 -0.015335857549898158 … -0.00048350949712763135 0.0008659877291051917; 7.551272474578383e-6 -0.015336175321700151 … 0.0014540245097125139 0.000666968576821648;;; 3.454026932530454e-5 -0.02487975011316134 … 0.0032053490971318 0.00033400602936307217; 1.1510971609672126e-5 -0.024880521696808284 … -0.003875925994968464 0.00025467476607748534;;; -5.1297000445652335e-6 0.00026912605424253506 … -0.01951521304031495 -0.5613553268559673; -4.873742693145298e-6 0.0002682058564382055 … 0.5592435126864654 0.562283600063652;;; -5.4321460533241546e-6 0.00022281413524287083 … 0.06876759081759996 -0.22648685826000955; -5.219947057559068e-6 0.0002224085981792934 … -0.7761059742153654 0.21260553927698253;;; 1.0396450491614239e-5 -0.0004155668230685078 … 0.20822576201071158 -0.3727931522558459; 1.0001160967118256e-5 -0.0004152093961217092 … -0.18823183076392094 0.3618031876249855;;; -4.648016205398965e-6 0.0037389443525582817 … 0.010931138269096537 0.0038063256993802375; -1.1278911465811702e-6 0.003739054370026612 … -0.02099317710713763 0.005850543791714601], [-0.17693198038507696 -0.14104274414066964 … 0.05868239123162805 -0.25387504119220533; -0.9837231596571905 0.0049739629286177905 … -0.011435619783007393 0.04076828529943668;;; -0.019973533343610263 0.9898991136821119 … 0.00834866742670193 -0.04187232922090444; -0.007816818291992694 3.858709673708611e-6 … -0.006629089364878769 -0.2986395119031536;;; 0.022514368761877342 -0.012884494969770907 … -0.0013488378588019864 -0.3665626720484722; -0.004108271861251406 2.144322876618437e-5 … 0.1752334057730657 -0.06547817950847844;;; 9.057135005563903e-6 0.0014506215968869518 … 0.001500310434197249 -0.06221911542310808; -1.7075586065436096e-6 -2.1385701183262253e-8 … 0.01563749970355078 0.12123541861180506;;; -9.44670199756914e-7 -0.0030304824788334704 … -0.013897126865786353 -0.4020198050379908; 1.8794993525874908e-6 -3.686544758015655e-7 … -0.7709041623243057 -0.06997772263178173;;; 8.916009026110401e-7 0.002111428626430566 … 0.0005850280875759712 -0.13077025220796243; -7.2937755204125e-8 -7.424870189812684e-8 … 0.03665007347541925 0.5736026459876492;;; 1.9923421759686551e-7 0.00043464841025365 … 0.0058595141787631255 -0.3299793157920969; 6.926480671616535e-8 -3.024308172537439e-8 … -0.36818821338139107 0.16198847941101616;;; 1.9936892596034712e-8 5.37289113202462e-5 … -0.0038841635377132215 0.19457761217356678; -1.6881727093842358e-8 -1.5936274812741433e-9 … 0.4836472903073825 0.009849245779648729], [0.40877887108345234 -0.25277209444360077 … 0.056126489135527174 -0.02061660697726472; 0.9114826417595867 0.12885130325532 … -0.018516255176162504 0.0022885913479700833;;; -0.015296340286427396 0.9584761125988468 … 0.01913300472810093 -0.004829755682700061; -0.018922271448921228 -0.0013079262698097289 … 0.03314870666636789 -0.07007179487037604;;; 0.012861049457933349 0.02842514605679914 … -0.042369291997228865 -0.05679534978446317; 0.03663046981992904 0.004177280383408305 … -0.1256083501776989 0.15484985638472457;;; -1.695892970865665e-6 -1.650719259217644e-5 … 0.004657454646971752 0.012447321433825874; -5.314713081826372e-6 -6.104593560304091e-7 … 0.013292538629111143 -0.012144566319401565;;; 1.6173837300306977e-7 -1.4383933546685372e-5 … -0.016153717882214022 0.0018688774472136783; -3.4526893258900784e-9 -1.4810823494224364e-9 … -0.895491963899599 0.025466375343165003;;; -4.529927098242035e-7 4.025296317478414e-5 … 0.09261323192072364 -0.01153361939182346; 8.907071162791149e-9 4.258638629361756e-9 … -0.3027948676675815 -0.17931248998241198;;; -1.2712555065594012e-7 1.119824086789647e-5 … 0.2733539169826987 -0.033900585427864935; 3.51698084906625e-11 1.0798931298013652e-9 … 0.010847816154963393 0.10013666352774105;;; -1.164294865283555e-8 1.0313647062638142e-6 … 5.602519604900441e-5 4.989881349774614e-5; 1.5589687572239201e-10 1.263865170685736e-10 … -0.0015080038260140594 0.9607367448098842], [-0.5235937387466146 0.41464263958190894 … -0.1646483582315203 0.059049740192356974; -0.850460468520029 -0.2771885689790604 … 0.08414871889796995 -0.027571011357268846;;; -0.021867125026753434 0.8663886439258188 … 0.12009404123426527 -0.034848539634271335; -0.01982257777331424 0.013653036214272555 … -0.08707113688242737 -0.14911918514715788;;; 0.015289221658200748 0.01909321641243763 … -0.5314190815453921 -0.04012164403963324; 0.03823247053248062 0.007598679108328362 … -0.14691819461038924 0.1142059120782515;;; 7.194857550773919e-6 9.760064258731906e-6 … -0.12987911658684126 -0.020015966950992517; 1.8161048101117827e-5 3.722372942349312e-6 … -0.032037977185532376 -0.04118397565618224;;; -1.1560322080260814e-8 3.446402657803923e-7 … 0.6410561136816508 -0.036185868565577144; -2.662079894624615e-9 1.9071876954024938e-9 … -0.11486985726308012 -0.3330364245067435;;; 1.7734499949667645e-9 -5.585084138317318e-8 … -0.25746773212721735 0.02479225358335283; 1.4438044188327963e-10 8.464404953225764e-10 … 0.0929711906935936 0.1826111030709746;;; -2.2296421462011926e-11 -5.696755838203873e-10 … -0.21375260116700998 0.06186492957211204; -1.2441691314757547e-10 6.257206145109077e-10 … -0.0010921100245307985 -0.849418995436657;;; -2.9046448304376313e-11 9.561376884130065e-11 … 0.2777529111551738 -0.06624153430416524; -6.867137570436886e-13 -1.1047460808626021e-10 … 0.000623962142247579 -0.2822065411064857], [-0.5883232439868461 -0.5819350748512545 … -0.011654089572999583 0.16469451973499785; -0.8078962864191227 0.43054945488262103 … 0.009297863755060445 -0.11090912869416458;;; 0.011677840782790315 0.6828086307255177 … -0.016493922773245535 0.20207213678012662; -0.022363582472255332 0.09771938563476225 … 0.004003719242346105 0.11903938544652891;;; -0.008718954108351176 0.009126130317618709 … 0.11223948348954223 -0.46378952348130603; -0.021606038227128508 0.01089624890538208 … -0.08945547561353057 -0.1648106830029613;;; -3.0318709101111125e-5 7.803006036931794e-5 … 0.046322248276377445 -0.14499779968016135; -8.324346091801902e-5 4.722927550100144e-5 … 0.2602365198544528 0.2420993279547289;;; -1.2083954412498387e-5 -9.060650231465415e-5 … -0.21216303421072177 -0.13171354052435175; -1.205431557502874e-5 -3.526095876581504e-6 … -0.3171807094543497 -0.20101656576628704;;; -3.7599190991637445e-9 -3.087051638903162e-8 … -0.25763212034809413 0.42788882909159215; -3.277118881510581e-9 -1.6068800851396506e-9 … -0.18068983877392267 -0.07432778714070147;;; 2.0897095006641347e-10 4.416462266859112e-10 … -0.4158317510801135 0.020535607611021685; 1.4513908061540825e-10 1.737976382131187e-10 … -0.1282968830816185 -0.36641773826869817;;; -3.939240963443237e-11 -9.428339259371195e-11 … 0.051035279864050015 -0.4488168192511866; -9.827831697110132e-12 -7.611539976987627e-11 … -0.6873137958274506 0.034377797294979445], [-0.6549537260147149 0.6295636946425499 … -0.1299376711907307 0.13561484045739725; -0.7548423309485144 -0.5452668963291427 … 0.11202163200489662 -0.12900739032666075;;; -0.012546787832775649 0.5080694874396096 … 0.23573897801787966 -0.17830692725906608; 0.032019883101736625 0.21913733160657195 … 0.12483403138104172 -0.287276075676807;;; 0.002602283567023626 0.008061956737262132 … -0.47878265588466695 0.06550051755117449; 0.007686000259808056 0.010577383967119746 … -0.03772667518471788 -0.22492836202065006;;; -5.101193463187977e-5 -0.000699449977001915 … 0.23057516913413506 0.0264801505581432; -0.0003017925286470934 -0.0005461389914348912 … 0.05577827814527582 0.3810151003282896;;; -0.00011992115116393386 0.0003561071670420897 … 0.5530264896513408 -0.306195719225866; -0.00015115256366121023 -3.8423982312069815e-5 … -0.31033266080891114 -0.2681840909332682;;; 1.8154714526838996e-8 -6.065720252964345e-8 … -0.02112492105235621 -0.25885566490107814; 2.094440514155528e-8 1.597859205578216e-9 … 0.3428198537885131 0.4044666164161126;;; -2.4373234988367145e-11 5.7457557991038287e-11 … 0.1742992265491884 -0.16841594192161466; 1.0400126784880403e-11 -1.1530895393778666e-10 … -0.23699662657602352 -0.20191244467121588;;; -7.459998404556523e-12 -4.342154678567163e-11 … 0.013955690617712643 -0.12748988271409722; 5.92530769953925e-11 -1.432897068897226e-10 … 0.07496626003495939 0.41015089208988303], [-0.6925601793165724 -0.6213939224560989 … -0.03766517907113263 -0.16883210823503472; -0.7211490502217772 0.5957025081073732 … 0.03304065218901437 0.16642530300380207;;; 0.009041225623689683 0.4104006230216842 … -0.13828018239434248 -0.25332093838285247; -0.014834687669173672 0.30086000928961987 … 0.03326612141455263 -0.3281279431318191;;; -7.414463240950188e-5 0.004568855017425842 … 0.21454886319782898 0.13336426340668256; -0.001473422574415675 0.005267097020992119 … 0.23222684384733278 -0.16294560616863787;;; 5.4370392109369e-5 0.0026075374364010295 … 0.3981493353122171 0.06458924553971877; -0.0006660119059936686 0.0026940173880450687 … 0.18513870969299306 -0.46072249946144483;;; -6.612946212130474e-5 -0.00013768966328270077 … 0.6871121936178883 0.35605467650830946; -7.93572611158561e-5 7.560431282854612e-5 … 0.11701243287802703 0.04100338556080793;;; -8.597276210359555e-8 -2.0688437591479188e-7 … 0.3032875553308929 -0.0947782435541185; -9.495183860912279e-8 6.736673196733566e-8 … -0.3139985082136958 0.5917133375430532;;; 1.2054989182487334e-11 3.162954060497575e-11 … -0.07059434461921517 -0.04677755793842142; 1.5149757519058487e-11 -9.011560563336144e-12 … -0.03572273216672023 0.14274430861581833;;; -7.39647737218025e-13 4.225582065245296e-11 … 0.04248755507414102 -0.0013429665616664322; -8.070940560890162e-12 4.0376403680080007e-11 … -0.006595551915988217 0.032479573463204243], [-0.7032259209177958 0.6165057399288028 … 0.07739631527518054 0.025039627169369413; -0.7109442578553312 -0.6093582723353759 … -0.07732075857593391 -0.024464028648603708;;; -0.0032775143044377645 0.36832031928157993 … -0.1012025553575598 -0.07557883030596503; 0.004552609449067281 0.33606128809760516 … -0.16987621114100318 -0.008883070401493671;;; -0.00010073765317867342 0.0014952525679539416 … 0.0500657796389472 0.07161271582060043; 0.0002621901425028699 0.0015640433551887135 … -0.4095088921920592 0.2026162582296786;;; 8.724818729729836e-5 -0.0008692266971252314 … 0.00870707288130737 -0.22729464173307187; -0.00010602932457887304 -0.0008266138079204091 … -0.11939806450810318 0.1702028238113136;;; -1.0783288893373028e-5 1.7252174316089456e-5 … 0.3403883952196558 -0.1080588075206209; -1.2510979035553073e-5 -2.1512085633081857e-5 … -0.04977807654993948 0.042790673400390375;;; 1.1120243982657048e-7 -2.2579630008370525e-7 … 0.2206316634887366 0.16206300775851254; 1.1537078675485302e-7 1.5593574073483288e-7 … 0.42909594569479115 0.03799644556409526;;; -4.436850604853046e-12 3.034803324779598e-11 … -0.20331902867291637 0.6222399682659034; 2.947419869451719e-12 3.468079672445048e-11 … 0.0851311732988412 0.6133434290233379;;; -1.0076914420982071e-11 -2.6748579730440068e-11 … -0.3827528337610231 -0.15596678631502342; -8.82906093751101e-12 1.4062777609888612e-11 … -0.46708259062002283 -0.19301709987470364], [-0.7059162473968132 -0.6181852659322998 … -0.04245120377009152 -0.17073027068732335; -0.7082937489700256 0.6159693476492364 … 0.04254959428379623 0.17030803974467845;;; -0.0008821603549105557 -0.349617259092072 … 0.014101851908568287 0.31940638319572856; 0.001197498794073177 -0.340875662340407 … 0.13880411287843136 0.2900161837600716;;; -3.4508911658821394e-5 -0.0004015271629018824 … 0.06186623137216646 -0.33948637148551375; 5.678069627341568e-5 -0.0003440078566306565 … 0.525613980630895 0.3871884780176263;;; 1.3068724785194429e-5 9.415362455569849e-5 … -0.5443500463930758 0.6723272210423752; -5.935473931184406e-6 7.924234040299344e-5 … 0.6328566370976458 0.19628223483508886], [-0.7066983234857566 -0.6328134370031493 0.06881001766203744 0.3088524162120677; -0.7075149129407229 0.6320265147041157 -0.06827802255906334 -0.3087122354440677;;; -0.00018007645842512722 -0.3174905128893418 -0.8252588483709584 -0.4670627099043258; 0.0003084175273080393 -0.31510222608622185 0.5563731897658392 -0.7688688871998415], [-0.7069796075189635 -0.7072339319859676; -0.7072339319859676 0.7069796075189635;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^d, 2^d)
xes = collect(range(0,1,length=2^d))
yes = collect(range(0,1,length=2^d))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="787f5537.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this example we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 8
h = 1/d^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,d)
xes = collect(range(0.0, 1.0, 2^d))

u₀ = qtt_sin(d,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.8313839096882625e-6
Relative error for Crank-Nicolson: 4.831430279603403e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on [<a href="../resources/#QFT1">13</a>] we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an example of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h1 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h1><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve Burgers equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using CairoMakie
import TensorTrainNumerics: dot, orthogonalize

orth2(x) = orthogonalize(orthogonalize(x; i=1); i=x.N)

d  = 6
L  = 1.0
T  = 1.0
Nt = 1000
ν  = 0.01

N  = 2^d
dx = L / N
dt = T / Nt

Dx   = 1/dx * ∇(d)
Dxx  = 1/dx^2 * Δ_DN(d)

u₀ = qtt_sin(d, λ = π/2)
x0 = orth2(u₀)
v  = u₀
v_ref = Ref(u₀)

&quot;&quot;&quot;
    residual: (u - v)/dt + 1/2*∂x(u²) + ν uₓₓ
&quot;&quot;&quot;
function burgers_residual(u)
    t1  = (u - v_ref[]) * (1/dt)
    nl  = 0.5 * orth2(Dx * (u ⊕ u))
    lin = Dxx * u
    R   = t1 + nl + ν * lin
    return orth2(R)
end

&quot;&quot;&quot;
    gradient of J = 1/2 ∫∫ |R|² dx dt
&quot;&quot;&quot;
function burgers_cost_grad(u)
    R = burgers_residual(u)
    J = 0.5 * dx * dt * dot(R, R)

    g  = (1/dt) * R
    g += ν * (Dxx * R)

    Dxu = orth2(Dx * u)
    g  += orth2(Dxu ⊕ R)
    g  += orth2(Dx * orth2(u ⊕ R))

    g = (dx * dt) * g
    return J, orth2(g)
end

solver = GradientDescent(verbosity=2, gradtol=1e-6)

v_ref[] = x0
for _ in 1:150
    x, _, _, _, _ = optimize(burgers_cost_grad, v_ref[], solver)
    v_ref[] = orth2(x)
end

vals_init  = qtt_to_function(x0)
vals_final = qtt_to_function(v_ref[])
xes = (1:N) ./ N

fig = Figure()
ax = Axis(fig[1,1], xlabel=&quot;x&quot;, ylabel=&quot;u(x)&quot;, title=&quot;Variational Burgers&quot;)
lines!(ax, xes, vals_init,  label=&quot;initial&quot;, linewidth=2)
lines!(ax, xes, vals_final, label=&quot;final&quot;,   linewidth=2)
axislegend(ax)
fig</code></pre><img src="2effeaa2.png" alt="Example block output"/><h1 id="TT-cross-approximation"><a class="docs-heading-anchor" href="#TT-cross-approximation">TT-cross approximation</a><a id="TT-cross-approximation-1"></a><a class="docs-heading-anchor-permalink" href="#TT-cross-approximation" title="Permalink"></a></h1><p>The TT-cross algorithm allows you to approximate a high-dimensional tensor from function calls. Below is an example of how to use the <code>tt_cross</code> function to</p><pre><code class="language-julia hljs">using LinearAlgebra
using CairoMakie
using TensorTrainNumerics

function sin_6d(coords::Matrix{Float64})
    return vec(sin.(sum(coords, dims = 2)))
end

n = 8
d = 6

domain = [collect(range(0.0, π, length = n)) for _ in 1:d]
alg = MaxVol(tol = 1.0e-8, maxiter = 20, verbose = true)
tt_maxvol = tt_cross(sin_6d, domain, alg; ranks = 4);

tensor_approx = ttv_to_tensor(tt_maxvol);

tensor_exact = zeros(Float64, ntuple(_ -&gt; n, d));
for idx in CartesianIndices(tensor_exact)
    coords = [domain[k][idx[k]] for k in 1:d]
    tensor_exact[idx] = sin(sum(coords))
end

error = norm(tensor_approx - tensor_exact) / norm(tensor_exact)

max_error = maximum(abs.(tensor_approx - tensor_exact))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2.749734149204262e-15</code></pre><p>And we can check the difference at random indices</p><pre><code class="language-julia hljs">println(&quot;Relative error: &quot;, error)
for _ in 1:5
    idx = Tuple(rand(1:n) for _ in 1:d)
    coords = [domain[k][idx[k]] for k in 1:d]
    exact_val = sin(sum(coords))
    approx_val = tensor_approx[idx...]
    println(&quot;  Index $idx: exact=$(round(exact_val, digits = 8)), approx=$(round(approx_val, digits = 8)), diff=$(abs(exact_val - approx_val))&quot;)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error: 4.948372083866076e-16
  Index (3, 2, 4, 3, 4, 8): exact=0.97492791, approx=0.97492791, diff=1.1102230246251565e-16
  Index (2, 5, 2, 7, 5, 3): exact=0.97492791, approx=0.97492791, diff=0.0
  Index (3, 6, 5, 6, 8, 2): exact=-0.97492791, approx=-0.97492791, diff=5.551115123125783e-16
  Index (4, 2, 6, 1, 8, 4): exact=0.78183148, approx=0.78183148, diff=1.1102230246251565e-16
  Index (4, 6, 3, 6, 1, 1): exact=0.43388374, approx=0.43388374, diff=1.6653345369377348e-16</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Quantics tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 3 January 2026 15:23">Saturday 3 January 2026</span>. Using Julia version 1.12.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
