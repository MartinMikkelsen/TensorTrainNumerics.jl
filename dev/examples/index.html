<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets.citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Quantics tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li class="toplevel"><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li><li class="toplevel"><a class="tocitem" href="#TT-cross-approximation"><span>TT-cross approximation</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in [<a href="../resources/#FastandFlexible">18</a>] where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^d)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, d)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(d) + id_tto(d) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(d) ⊗ qtt_basis_vector(d, 1) + qtt_sin(d) ⊗ qtt_basis_vector(d, 2^d)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-0.5911341625154602; -0.7498251371913911;;; 0.4625158341226881; -1.359475449120961;;; 0.22014011105876624; 1.1810969949934518;;; -0.025049258327758398; 1.9653398974478955], [0.0037519998476039794 -0.6104217803723699 0.8940350200566382 -1.3335686301069338; 0.1119395143279985 0.0845596447016756 1.6743047975437122 0.43601103578249883;;; 0.4710768990662377 0.9598040094672675 1.7110437111792 -0.160856535647564; 0.919758243246925 -1.0710224307048217 -0.5640211662645891 -1.306774603763797;;; 0.4633873817843821 1.363812898397327 -1.3663771394915603 0.9325378125140895; -1.2131641432303955 -1.3117334373107612 0.06843527534537507 -0.9524742738341578;;; -0.5053392092974868 0.40949838801200256 1.8256738884483241 0.7269039694353484; 0.15083716116757762 0.6188424837476438 -0.9377673744652826 0.6468519211997539], [-0.16974192940047073 0.5639912221516863 0.2788210159161019 -0.9487481437054331; -0.5118533216959598 0.6576774383774208 0.6338122536836981 0.2622205349626691;;; 1.3203195229211946 -0.3973226592877082 0.16466499841151394 -0.33448132518044676; 1.1727980981369759 -0.5418146038022963 -1.062030761972616 0.07947761959883438;;; 0.3065288474379035 -0.6088702165032153 0.13956198225108424 -0.00098086121650241; 0.04711012226921656 -1.1691304745767714 -0.6285843582534411 -0.8044213041903532;;; -1.1247647957409814 0.6563200036265053 -1.1001311992458849 2.813568946934404; 0.3408534762291857 -0.9585086843763011 -0.12591508724694894 0.7044679026414671], [0.10982090362741283 0.9307298890673067 1.329862120228519 -0.043307332666123036; 1.7249484988063069 0.534980037221124 -0.43675904533083115 -1.2269146925653105;;; -0.5714250884921298 -1.3412680437271642 0.3762403539259919 -0.9982290040518663; -0.03914895856092812 -1.2001743611660383 -1.4857056871926888 3.206853481319105;;; 0.25167452434570176 0.5363185674155496 -2.3131078031942693 0.29001451035107806; -0.09081276539039353 -1.1269455505048025 -1.641759775300979 -1.0627278191881246;;; 1.3508720236341556 -1.4733271480153904 -1.3876604267652901 -0.09130012757602061; 0.8723031886577243 -0.9976191638642915 0.02315399067426033 0.7108035023496834], [-1.3640085712779164 -0.8733114474432869 -0.4217990827893488 0.3478192711465474; 0.27667540877903846 -1.087737424090103 -0.003865198424871276 0.22609214117781698;;; 0.6964471948458419 -0.7785551204594048 1.4345387463329369 -0.4153188158885496; -0.589852424708509 -0.48070441783938256 0.09262750989566981 -0.203726009631458;;; 0.17416036361227952 -0.09455856717310623 -0.8858578548355335 -1.0197627689072808; 0.16391127872962574 1.0597973176355167 0.4759723003045295 -1.6710504365451755;;; -1.2062958606250065 -0.22090040323066096 -2.5783243841082557 0.01230192413830283; 0.9549268100507258 -0.9478677205019287 -0.8828240656468992 -0.7778670652003444], [0.08606181011696296 -2.5667752556265953 -1.8449177684398834 -0.48051723481428; -0.6691276355464836 0.21726647603305557 2.00695225991995 2.179413135739007;;; -2.4479838041316215 0.39225562824587873 -0.16432507922915437 -0.7340460004175833; -0.4906682494147132 1.5513876720343718 -0.15122273226328353 0.6529501277726749;;; 0.7991444663052599 -0.7080816364881476 -1.1803002134425302 0.31207758477493297; -0.03125880941556627 0.2011777050236178 -0.9669738950498021 -0.6460306451319756;;; 0.7078637385393414 1.3149301204731536 -0.5248912501536148 -1.345733460272235; 0.689537291132482 0.44664977127822497 -1.4750366552771181 0.005656302885692961], [2.0058980132618287 -1.5384898411885715 0.6217873605544384 1.0441015074178852; -0.5417321058492552 0.4614779800062233 -0.16904445138216362 -0.4123734430249063;;; 1.236655265117177 -0.44537037837146537 0.9672593398586915 -0.9106864289468295; 0.2666453714635747 0.12580868983157517 -0.7111867211623939 1.9678574238839064;;; 0.8736516592171448 1.3377518334339271 1.1327097422677166 1.6147210381101353; -0.2483346335333546 -0.13216903558013213 0.4220756183314905 1.5436946191770287;;; 0.5598854887959206 -0.6187297567270952 -0.010058180381478038 -1.5661909383998804; 0.3172392716463999 0.22723795516138895 1.06575676062184 -1.6588197022156193], [-0.554124161292599 -1.152521212436011 0.637688974771112 1.3629466299896154; 2.1511942932754793 -0.7126308972312229 0.8889735953469716 0.6214453488626732;;; -0.42553553672248906 1.8115389357781049 0.660445082475396 -0.4619639584255968; -1.2132177182782526 0.4795170367092837 0.38756914581030877 -0.8131736182851739;;; -1.8752457064213894 -2.382481049361131 0.9572907158520256 -0.22487379657658216; 2.6902047021860507 -2.579526461126593 -0.10409165743261188 0.22629698515394894;;; 0.2986800451508372 1.0050929144888932 1.1230014716712287 0.010940798881162414; -1.5949212743765964 0.039176293632787365 -0.9867860229993266 -0.7571603424873556], [-0.8558801545654733 1.3551358597248857 0.05344878646336362 1.0221860949429862; -1.3526814106065008 -0.40465063829033365 -0.32955545172165374 -0.9697689998994553;;; 1.1347546633582561 0.8629723431673121 -0.6412826362153699 -0.5542991275320571; -0.6704742804262204 -0.12251271627051682 -0.1621635695622189 -1.538130594901603;;; 1.373574373605971 0.9879749046433293 -0.7953056092709545 -1.5483174491462175; 0.133430112091956 -1.8364296022142672 -0.4674918964713707 -2.1196187090844543;;; -0.36500080615194863 -0.5419090605942888 1.7398870913464193 0.9323771926035568; -0.14931676548649658 -0.9246430229767005 0.12398195418287718 -1.058291381965374], [-0.5973386061620968 -1.0470517295741415 0.08086801019058146 -0.9201239591428255; 0.2187110073210747 -0.09188186724903186 -0.8799058578880645 -0.12899519011541596;;; 0.8851154564488112 0.7053225962604196 0.05112756148621472 0.03354544497844986; -0.04282634128788319 0.3547368973563038 0.4084604330077543 1.5163897235581174], [-0.22176172152335466 -0.12003130727504885; 0.1995887155003918 -0.645678397232209;;; -0.3696892491444218 -0.6317480820784739; -1.645195204223149 0.07347630120967544], [0.8836530897846828 0.9140787295282662; 2.093990680276767 0.8826664781509711;;; 1.4442377391959622 0.08050583155204787; -0.15276025143370692 0.10043899066735026], [0.2600197885731627 -0.13371187485455763; -1.280066269890129 -0.6984206943768739;;; 1.0405532011724776 0.5681055698016789; -0.7948406285833987 0.03585051103502812], [0.1837341071958001 -0.5756775922454528; 0.7018547049460223 1.5646805769480014;;; -1.4782351969714638 1.9271239694167983; 0.8573465242046321 0.9239871083953922], [0.49389283705381515 0.0030645730530042894; -0.9865818293156507 0.30927120261165286;;; -2.7115720178122915 -0.4458141162941923; -1.6802315852140495 -0.3022641790831167], [-0.5314258670167163 -1.057547721950502; -0.23087055687432934 1.6181990703650422;;; -1.5587463437080056 -0.8794712102639344; 0.16967891897417534 -0.9297208881485088], [-0.28527789964439104 -0.01366469514657657; 0.5609976193128606 -1.3096349450993339;;; -0.20729222708363065 1.9175908894098868; -0.6490663432735975 -0.25954143904591687], [-1.4864231339170113 1.021781766513118; -0.27080712579716354 0.8928045400627201;;; 1.5649697649699756 0.9637567075943172; -0.6588654799113085 0.2920306284021271], [-0.3443727934384377 0.8674529398827763; -0.9464365416472513 -1.7854172693770483;;; -0.9045783609976461 0.2665264133607103; -0.52272466159831 0.43273280495111094], [1.0371809541484769 -0.6666074919335032; -0.26087593862120584 0.8845909270859372;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-179.52472084353192; -189.36012689893468;;; -107.1118978259954; 101.54848262483351], [-0.7022538392071825 0.5071904327893731; -0.6940953638299967 -0.5184710247514421;;; -0.10845211982473912 -0.4813654173701761; 0.11415889874621346 -0.4894359170873759;;; 0.007854460942555907 0.03708448496493599; 0.009147202179163405 -0.035244374047341216;;; 0.008206824855156504 -0.0052760703227612595; -0.008021155305847134 -0.00634173161201152], [-0.706322406415765 0.35816303677025474 0.105268122937815 -0.08893900577809744; -0.7048772905077065 -0.35954509524733796 -0.08261314008329647 0.0945826643250513;;; -0.04572096769542205 -0.6065100071276069 -0.17754684211481112 -0.1260042443298451; 0.04619358433533005 -0.6096597776727024 0.28762767693484376 -0.04762798096506281;;; 0.0026291145876810185 0.038152786701946925 -0.48799568348225714 -0.5229862116999461; 0.0033319825995409996 -0.038074335645612224 -0.5047525272062937 0.5227126835845793;;; 0.0026587845857372104 5.3460379248672796e-5 -0.4340272035227896 -0.4745321262684177; -0.0027025162838976626 -0.0007223638432986527 0.43138934585654276 -0.43793839812554664;;; 7.194345794264168e-5 0.000816972081065424 0.014632972668422806 -0.017126098019072528; 5.562375988391443e-5 -0.0008028630101730995 0.015121644635862786 0.02340399086481993;;; -8.248152186892672e-5 5.2545940769297614e-5 0.0021995586325842097 -0.01527187625364802; 8.512599130249052e-5 2.6232274478866064e-5 -0.0014905278406975532 -0.014501426168602677;;; 1.688961153928841e-8 2.421757217165091e-7 7.921011794089956e-7 1.552815749814238e-5; 2.012941110778986e-8 -2.400306558884175e-7 9.534834703643018e-7 -1.5495166260119113e-5;;; 6.776631572904497e-8 -3.1773129653010635e-8 8.652544087456502e-7 -2.223637343505571e-6; -6.676715812029104e-8 -3.913505964072067e-8 -8.546292191393282e-7 -2.2864400267722704e-6], [-0.7068600240107454 0.2063762795510899 … 0.0318664262604242 -0.00015507703110813578; -0.7066857675025716 -0.20638667167844738 … -0.03139270783072309 0.0013485657686772845;;; -0.02172014409986166 -0.6755464817275788 … 0.0015777677571267828 -0.02030922415529034; 0.021656688650912553 -0.6758147557321124 … 0.017211686183758443 0.01687998022601484;;; 0.0008583206425420544 0.029227863372687974 … -0.029872366255593412 -0.03287312887349687; 0.0011451585427785472 -0.02940763452027082 … -0.018998430008500756 0.03556758568630556;;; … ;;; -1.2702595064459775e-11 4.044804432957424e-10 … -0.00019747042756692985 -7.238338292099458e-5; 2.1728930329483682e-11 -5.514336859951921e-10 … 0.0005871295830824834 -0.0005786577937108524;;; -8.503404339341611e-11 -1.1792981465095351e-10 … 0.0004893328229701895 0.0001384422312383149; 1.027344387396489e-10 6.343205207323443e-11 … 0.00013058971108898229 0.00015752158258535128;;; 1.1867520270597594e-10 2.6174300759923073e-10 … 3.821596659592731e-5 0.0003368292159301975; 3.0918458604694176e-11 -4.443533608349759e-11 … -0.00033147765076282226 0.000440524077931434], [-0.7070316425156803 0.10734043220937751 … 0.1656410426844774 -0.1514061126765552; -0.7070183212431368 -0.10737744335164469 … -0.16289953022260506 0.15684887408998055;;; 0.010732805009460706 0.6987271070882151 … 0.05924265295221011 0.1957923746294058; -0.010766371813435798 0.6987072933304438 … -0.11551112328294286 -0.15110175475994897;;; -0.0002393562318937504 -0.016272347220681903 … -0.19193309339562017 -0.15543112182321603; -0.0003294418532103866 0.016321093495037305 … 0.1021370764815179 -0.03689708687534193;;; … ;;; -1.130628563249332e-10 1.038639951605402e-9 … 0.03802015030819774 0.05523853279024148; -1.0795827286715428e-10 8.665088303567757e-10 … 0.13921516811666343 0.07468793872133156;;; -2.525596777376918e-11 5.330921889504774e-10 … -0.14358997851895744 -0.36272709632366035; -4.202962552544101e-11 7.251510925091626e-10 … 0.05587708108967884 0.43333365804589163;;; -2.924364689074446e-11 1.0384413058443658e-9 … 0.10055103816152733 -0.028149303708298955; -1.2150654958107053e-11 9.587353428906615e-10 … 0.002981650125050795 0.18836429861385337], [-0.7070895564703794 -0.053652046297084637 … -0.04622274266070971 -0.0033246349758153004; -0.7070822078744878 0.05438841372856295 … 0.048399410008612496 0.0037802013072068684;;; -0.005054280671752171 0.705042501626702 … -0.14340415971048345 -0.02883988601770983; 0.005792483358174477 0.7049836647164708 … 0.13635900690618113 0.02950961780427121;;; -4.858349987948371e-5 0.006019715494641754 … -0.1836200886692086 -0.10760005566464205; -7.110586480193215e-5 -0.006071021405803029 … -0.1646714548911549 0.06283535301841034;;; … ;;; -1.5712957849721194e-10 -1.187353185575659e-8 … 0.10135313213359884 -0.10847623787664178; -3.17405785340428e-10 -1.218950833951761e-8 … 0.34199322926889536 -0.17060645282694753;;; -4.73474132883293e-10 -5.5028114171541355e-8 … 0.16095494347193373 0.2017838107395244; -1.2862984037420045e-9 -5.564559291306252e-8 … -0.16203138296170677 -0.2685894737114478;;; 3.1348940296744586e-10 3.449069383952727e-8 … 0.30872652615365154 0.0024764168802072733; 8.5493682552336e-10 3.467095020589894e-8 … -0.1527667899065977 0.3558731920291561], [-0.7071040671636661 0.02626053309653428 … 0.056878584245373974 -0.07185454019846521; -0.707098185422751 -0.027694054838859797 … -0.05678079675881068 0.07157296196027135;;; 0.0020180562138496193 0.7066147886684078 … 0.01054297920009172 -0.03329722207234503; -0.0034524756570543293 0.7065588670607937 … -0.013386563118148606 0.03962760299716829;;; -2.6462157026971993e-5 0.0006816746547118417 … -0.12196074158961188 -0.05547775681068136; -1.0624636968303928e-5 0.000540783078337192 … -0.057668822808983174 -0.05452900605715747;;; … ;;; 2.806441675797422e-8 1.4065759061216214e-5 … -0.08098413753318592 0.05851993219219464; -8.046874153425988e-8 1.4074345568220087e-5 … 0.07270353854088293 -0.031317029835840296;;; -1.879609182601051e-9 -2.1114694690227256e-6 … -0.10276466955013984 0.08079658545958049; 1.4353862905225034e-8 -2.1169176937136546e-6 … -0.07407810399283149 0.17927856301412556;;; -1.3054739101313526e-9 2.5891760436705133e-7 … 0.007909451517617875 -0.002609673422444968; -3.2887719115225012e-9 2.6043950989357094e-7 … -0.35369792722953997 0.4666517181392149], [-0.7071066541001514 -0.012586937587218853 … -0.0162678036640236 0.10081240573338461; -0.7071030752095503 0.014401589967240194 … 0.01624992249084055 -0.10101055819243865;;; -0.00046604239042826015 0.7069865586475028 … 0.004267085276144825 0.053068303271971345; 0.0022808174096472034 0.7069521679442261 … -0.004882522202300013 -0.04928077820536688;;; 1.8964006292585448e-5 0.0017683293830199882 … -0.00806257300292998 0.03943646609271192; 1.6867232636349918e-5 0.0017498600048154282 … 0.009447356343281444 -0.024327251983990186;;; … ;;; 4.0314849218311147e-7 5.449713346835854e-5 … 0.3083293261942227 -0.1824631255223607; 6.031767513377953e-7 5.4305616220253294e-5 … -0.2232384501394198 0.12050219166510992;;; -1.9125723838954574e-9 1.4231844551399244e-6 … -0.8777650562353234 -0.012071059929619711; 3.498237254177777e-9 1.4190966881411559e-6 … -0.23304206413782685 -0.4027652603590352;;; 6.796773908921404e-10 2.3542368383474276e-7 … -0.06175332923044241 0.004582432865874767; 1.5660842805861279e-9 2.3489244861039703e-7 … 0.019391488811439345 0.21703659572862505], [-0.7071066404821094 0.005623058216113257 … -0.012267010613871235 0.09902979888952933; -0.7071044289533759 -0.007896055704049767 … 0.012264603192201646 -0.09899827960387647;;; -0.00045029311257487644 0.7070485897085705 … -0.0011416087905287893 0.01535839037771134; -0.0018223251624171258 0.7070268501825695 … 0.0013742100919329377 -0.017193142205502276;;; 1.5358107406095022e-5 -0.003666265468044482 … 0.005038021569109872 -0.0059118745942504155; 1.859284990021828e-5 -0.0036639575409656584 … -0.004520628938026156 0.008889002738037376;;; … ;;; -3.118905648618832e-8 -6.770710696922683e-5 … 0.6440013528519795 0.16175652425655976; 9.944490790827454e-8 -6.776925000064591e-5 … 0.32369333505859577 0.11358438038137857;;; 2.024217843983092e-7 -2.9373921681614715e-5 … 0.4934957360311226 -0.06736565548897033; 2.5849895914046625e-7 -2.9359037602473206e-5 … 0.3442553999871507 -0.5770104060144824;;; -7.858107499056398e-9 -8.676267910411928e-6 … -0.05145827781361801 0.04388964199117992; 8.905450978121737e-9 -8.685794474398508e-6 … -0.04120729865588319 0.1782107282715187], [-0.7071053142672002 -0.0016323075234842134 … 0.00609693428889501 0.04243635758081329; -0.7071035967617867 0.005194556007299221 … -0.0060972079790599844 -0.042436115007205254;;; 0.0014386742443673706 0.7059497104721242 … -0.00017223233119633398 8.017819923054107e-5; 0.0021194876359162413 0.7059325557398248 … 0.0003651309723048998 0.00039625585685324036;;; 2.653266685811103e-5 0.015777362871357135 … 0.00029447961832822255 -0.0013294137243117117; 4.055496678644218e-5 0.015776726625873736 … -0.0007671218766038247 -0.0009074349958968877;;; -1.4106689703521895e-5 -0.008512900546637597 … 0.00372781635275619 -0.0019329313566414806; -2.1989469946637685e-5 -0.008512470027920178 … -0.004128201196417748 0.00030383083495208674;;; 6.803686157600205e-6 0.002318331648942586 … -0.07030255647282188 0.727256546607651; 9.037212469253635e-6 0.002319175631535629 … -0.3090084741120343 -0.6304074720367911;;; -1.0925998094878832e-5 -0.004128771459464112 … -0.09969237953417863 0.1532450314795603; -1.4898190465181786e-5 -0.004129157589325779 … -0.7728944406644954 0.0294970279284467;;; -5.2811647716166204e-5 -0.032998480554170984 … 0.01793030248853567 -0.028903119959826272; -8.437323343288717e-5 -0.03299700825745825 … -0.13289928640161153 0.04769219173105892;;; 2.836956465199146e-5 0.014129312939327707 … 0.05325530965264797 -0.10060842087403297; 4.191592444424883e-5 0.014129175373416415 … -0.5209039806547051 0.18024976941903217], [0.17692454636504706 0.14229087505505303 … -0.2032535357741537 0.017940806808823404; 0.9837187227060988 -0.005070050078236165 … 0.017717385150712184 0.0027280895954677024;;; 0.020249928134439737 -0.989788857782319 … -0.035340920416027946 0.004217949361944269; 0.008292169037538499 -2.8225254368312517e-5 … 0.005913843821285429 0.01598505924489692;;; -0.022348802559189373 0.006433288915155582 … -0.8660439145061449 0.23357787046889755; 0.004109834105638402 -2.220385611941073e-5 … -0.03840241195841636 -0.20783172015508397;;; -1.0695917535077848e-5 -0.0007987057223547238 … -0.1357973119492888 0.0355386465217562; 2.0631097543920566e-6 -9.053504066715292e-8 … 0.0038035655251722937 0.028024516409091663;;; -5.041837192024322e-7 -0.001884076979210835 … 0.27809573234946366 -0.08750731750981636; 1.7510434060727512e-6 -1.8829496554747893e-6 … -0.17832782905885516 -0.6589212726918735;;; -1.0233427760964715e-7 -0.0001864463348882502 … -0.14787187316806036 0.040351306662337195; -9.16627458861138e-8 1.1534315861352909e-7 … 0.018935886563542625 0.07971827874506217;;; -2.6476002861526047e-8 -8.123502016894422e-5 … 0.07536042207739492 0.011133100278801045; 5.091370667810694e-8 -2.837956783724628e-8 … -0.08056323778168269 -0.3022317972904021;;; 1.1383416228414483e-8 3.066718299062932e-5 … -0.14899623488463756 -0.008264816303770111; -1.1876108545626508e-8 -3.2275222719405323e-11 … 0.14627282715552084 0.5985332395343986], [-0.40896548479033173 0.2580047366388607 … 0.012050849085766903 -0.022375427752875047; -0.9114376968162986 -0.13129427910503202 … -0.00037750726080255215 0.0004130347437118855;;; -0.015336530703872975 0.9567790951221866 … -0.002513979611068427 0.0044980679657639; -0.017982666951747245 -0.0012011912550337663 … -0.04723592501896262 0.09418820511853669;;; 0.01268591586719474 0.02738160117748787 … -0.047965424199052385 0.09484232500127573; 0.03618064508052152 0.004233963684622527 … 0.11897929205409921 -0.22704507196363524;;; -1.9234514520428514e-6 -3.334031621854694e-5 … 0.010361571549843344 -0.020391402910685082; -6.552124867607845e-6 -7.747317045689794e-7 … -0.012367103295852654 0.022577521418505296;;; 3.936649790651151e-7 -3.341942409623068e-5 … 0.00023148330224156857 -0.00041246737897622607; -8.958037891466134e-9 -3.761570593138416e-9 … 0.9515300512005094 -0.03816601230161541;;; -4.497119047845734e-7 3.8095302445142885e-5 … -0.010969796652702497 0.020197533709302475; 8.26657379387854e-9 5.356606434855206e-9 … 0.09845581407567612 0.045461127834745;;; 9.282970344533801e-7 -7.879639015288143e-5 … -0.0028049494039987066 0.005157870804673943; -2.085203965802695e-8 -1.0641475824512783e-8 … -0.25625753992344014 -0.2720332911812307;;; 1.77996370699835e-8 -1.5022083423632265e-6 … 1.1920335794656328e-6 8.591718777076027e-6; -1.686354873687831e-10 -5.007997070784081e-10 … -0.0009221481623563078 0.9225926780456111], [-0.5244292299864439 -0.4222121793545687 … 0.1624128839794285 0.05368565153719076; -0.8500489659382354 0.2818720277889233 … -0.06480983750880838 -0.024115827552846046;;; 0.021467951733425385 0.8611916367503584 … 0.09614713255204833 0.028302358680017597; 0.017525166528765415 0.01514493884425326 … 0.3473525262249495 0.22070449482687463;;; -0.014947695511665741 0.018543092264849348 … 0.2170774700996328 0.15621652634498565; -0.03740721373761613 0.0077964564537018 … -0.6729873625770159 -0.1474365837782076;;; -8.931962988399813e-6 1.2070023520838046e-5 … 0.08845959858696308 0.053865130084418095; -2.2564829012093225e-5 4.850419588314603e-6 … -0.0909018623121595 0.018732126727127905;;; -1.8661322013832165e-8 -5.2086138610225e-7 … -0.07499430410998162 -0.006298967311804584; -4.774006211494267e-9 -5.822837232891941e-9 … 0.2161583621955047 -0.5570000926509188;;; -3.128052910489458e-9 -8.703240370203741e-8 … -0.03452367778964848 0.0017688443284316633; -8.077819362853016e-10 -1.5057965623961128e-9 … 0.39323782368949184 -0.319094018149467;;; -1.382831065261863e-10 -2.645304923905573e-9 … -0.33944642162514255 -0.05731312978632573; -1.2559997324372855e-10 -2.1061106268810404e-10 … 0.0006760007447150192 0.09820678704476987;;; -1.998608400328377e-11 -2.721363727659982e-10 … -0.00015855795793015196 -0.0039422904626542545; -3.064137072562784e-11 -1.0712809301747092e-10 … 0.00012395006903242103 0.6874397973885462], [-0.5905521033100855 0.5864699992982216 … 0.05180488955234135 -0.04804783145333061; -0.8062390855476533 -0.4357752989487567 … -0.031186631094372773 0.030582019297978873;;; -0.01153713483375379 0.6748641645617924 … -0.07213556342452176 0.057926267239208816; 0.024217245326654847 0.10251377064434988 … 0.01385270305613174 0.04677629014085023;;; 0.008413142331819818 0.009021694638946413 … 0.2332354994696869 -0.03964929817901983; 0.02088961906896166 0.010986395739687993 … 0.11056369995477078 -0.18326455233651356;;; -3.784185733611422e-5 -9.456567109439573e-5 … -0.08062044281413266 0.0009065879976602647; -0.00010372848253667813 -6.105728117181254e-5 … -0.018571776302952318 0.10320137711328649;;; 1.4350886386675631e-5 -0.0001020606980812464 … 0.37715970048470726 0.07431978525543645; 1.4616464674222144e-5 -3.912131684123737e-6 … -0.025563105188010655 -0.7690913421976577;;; 4.5200228981681605e-9 -3.492007379083618e-8 … 0.12178106031928887 -0.2257705202703109; 3.806803328542386e-9 -1.5803800915658629e-9 … -0.05463466690683709 -0.37257384112631886;;; 3.7424117718347707e-11 -4.0302124502728914e-10 … -0.8696329681045458 0.008456482445888097; 6.722362347036667e-11 -8.160085611056902e-11 … 0.001995002554227279 -0.0272330485587668;;; -2.5761332324763675e-12 -1.2978403784661371e-11 … -0.022280527210012786 -0.24423334488448117; 9.163579400326175e-12 -2.6730137525041904e-11 … 0.0003567806231923661 -0.31325990372601836], [-0.6572126280010215 -0.6295419792230174 … 0.050734249163843115 -0.040627007261214716; -0.7528971786869704 0.5484864909917234 … -0.04015444952797908 0.04152225575114229;;; 0.012658424160002395 0.5027539101162491 … 0.11210038359321393 -0.04113278781815993; -0.03159121186207459 0.22338929150535494 … 0.0060205690803057715 -0.11442513107930335;;; -0.00241892994126201 0.008033607693432155 … -0.26669761648045126 -0.021141688387081928; -0.007287647176538007 0.010456790021797939 … -0.15628728244313184 -0.23129519873940002;;; -7.627338163922527e-5 0.000830308106222307 … -0.13841653383306657 -0.02515090170858736; -0.0003923175410411706 0.0007038242614680877 … -0.047736608065821605 0.5941592519641846;;; 0.00012238333701215082 0.0003549024258925692 … 0.5248588348316439 0.18174909619212104; 0.0001543381618404922 -4.304765139213594e-5 … 0.02973430913580963 -0.3922053204707142;;; -2.1558836098034156e-8 -7.03510842357897e-8 … -0.22557408448090752 0.32330098274833213; -2.494913613442947e-8 2.4326682654202016e-9 … 0.09927285028112884 0.2581398831315307;;; 2.4950231696351766e-12 -7.181225563421123e-12 … 0.7272568877770373 -0.0559174984186721; 6.8773853616653786e-12 -4.170999842436053e-11 … 0.007385091211498444 -0.31293012129240105;;; -2.3294477169838046e-12 -5.2491424712198636e-11 … 0.009796675979747 0.12710778717176496; 6.975495690417415e-12 3.182724031207102e-11 … -0.008177513603492302 0.3146620697198939], [-0.6933519389689173 0.6210225127313929 … -0.056640824585371834 -0.0463040594202851; -0.7204028820357381 -0.5966749167797855 … 0.052370896411825144 0.04529853996348157;;; -0.008796149710670758 0.4078817922711545 … 0.15883450058455603 0.08260589485359202; 0.01425159459976341 0.30312393692501155 … 0.015286526992572273 0.07330564352163332;;; 4.889480613684722e-5 0.0042948965537164185 … -0.18944940818052017 -0.08039049187767773; 0.0013461328617190374 0.004942480400796643 … -0.2006555501486082 0.2677215728268884;;; 6.476127272643382e-5 -0.002732367545458323 … 0.374607846613966 0.15774577580134203; -0.0006839965433086014 -0.002835932347727096 … 0.08450371371534598 0.2527008219352862;;; 6.273829034563483e-5 -0.00012917685630036378 … -0.647467960792549 -0.12617045579680708; 7.508980674167395e-5 7.40475057273013e-5 … -0.14723169257363214 0.32019715184756853;;; 1.1102208971090761e-7 -2.647732476170569e-7 … -0.3065827262402884 0.4286238463707347; 1.222322322822764e-7 9.036031649606408e-8 … 0.13726598925954991 0.6381299637006037;;; -4.713642009026853e-13 -1.3541736890204364e-11 … -0.4372948161876427 0.12000313629296663; 4.258700720876499e-12 6.249695808592688e-12 … 0.0014030946227557382 -0.05100303311871763;;; 8.340867099160034e-12 -1.2808929271936828e-11 … -0.002209937501591162 -0.298125899262999; 6.530523425093824e-12 -1.0967643696524717e-11 … 0.0009618336073644515 -0.038380360267282095], [-0.7034252380971794 -0.6163622498763703 … -0.04894520850737815 -0.09573959575173749; -0.7107491077871648 0.6095820645983675 … 0.04769450273584189 0.09555466052857436;;; -0.0031363789435516795 -0.3674849970445379 … 0.1638608834489712 0.12722463036759504; 0.004326157234956988 -0.3368331373201405 … 0.0003761815965845206 0.20772836938425507;;; 9.822024970278424e-5 0.0014293433131154214 … 0.16224839633060054 0.06332598828480163; -0.00024770992780710955 0.001479609488399579 … 0.30584690720414326 -0.16172049566446525;;; 8.370860763347036e-5 0.0008167374623958304 … 0.5586279632616661 -0.12867305225023887; -9.71096083692713e-5 0.0007733137345614014 … -0.046316389078615426 -0.3447048936684623;;; 9.967368483422956e-6 1.5699479825535793e-5 … -0.6080431831237647 -0.4009588365431611; 1.1583014863833633e-5 -2.0254836254640435e-5 … -0.3049458842836815 0.4489268462710265;;; 1.1942870349470807e-7 2.41019815416618e-7 … -0.21371735996589505 -0.10422569402531358; 1.2375246301132107e-7 -1.697760875080618e-7 … 0.13357191199020707 -0.5892047775598924;;; -9.011613711050192e-12 -2.154260171732287e-11 … -0.09025319819668316 -0.15375922425783256; 9.143829309781466e-12 -1.5240722952224753e-11 … 0.0016049945183547862 0.00529526105610122;;; 6.527673672684929e-13 -9.341334317575862e-12 … -0.004907685827587189 -0.08406927798749923; -3.0764226674476413e-12 1.0807531281081156e-11 … -0.002101585511934274 -0.07588140482388643], [-0.7059675938002259 -0.6181392713165607 … -0.01722643603900797 -0.1748036449761499; -0.7082427253638874 0.6160231990518703 … 0.017003733674664255 0.17445064036111382;;; -0.0008422028613922147 -0.34941309891166306 … 0.09332786700578873 0.3051718933324885; 0.0011335376803703785 -0.34107108652217843 … -0.03307528346064992 0.3192931569128551;;; 3.2136305255806315e-5 0.00038396604124502824 … 0.17439871818837657 0.301358460552192; -5.522903995115543e-5 0.0003154064248894997 … 0.3598413141420736 -0.538453719571447;;; -1.2198448598898192e-5 -8.68797663497904e-5 … -0.7386635625423468 -0.44892042525164005; 5.28477162184383e-6 -7.262528944407448e-5 … 0.5329967306744648 -0.40206190714156126], [-0.7067110086200853 -0.6328010653860068 -0.06681285143156832 -0.30928692960598797; -0.7075022500533321 0.6320384850371829 0.06630517412509025 0.3091464757774495;;; -0.00017091580804716455 -0.31745583993175264 0.8223037542048233 0.4722693048480544; 0.0002953852410921276 -0.31513799322116515 -0.5612095888244225 0.7653311410021274], [-0.7069836631821199 -0.7072298777579967; -0.7072298777579967 0.7069836631821199;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^d, 2^d)
xes = collect(range(0,1,length=2^d))
yes = collect(range(0,1,length=2^d))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="a98e980a.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this example we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

d = 8
h = 1/d^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,d)
xes = collect(range(0.0, 1.0, 2^d))

u₀ = qtt_sin(d,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.8313840006490276e-6
Relative error for Crank-Nicolson: 4.8314871111009415e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on [<a href="../resources/#QFT1">13</a>] we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an example of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h1 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h1><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve Burgers equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using CairoMakie
import TensorTrainNumerics: dot, orthogonalize

orth2(x) = orthogonalize(orthogonalize(x; i=1); i=x.N)

d  = 6
L  = 1.0
T  = 1.0
Nt = 1000
ν  = 0.01

N  = 2^d
dx = L / N
dt = T / Nt

Dx   = 1/dx * ∇(d)
Dxx  = 1/dx^2 * Δ_DN(d)

u₀ = qtt_sin(d, λ = π/2)
x0 = orth2(u₀)
v  = u₀
v_ref = Ref(u₀)

&quot;&quot;&quot;
    residual: (u - v)/dt + 1/2*∂x(u²) + ν uₓₓ
&quot;&quot;&quot;
function burgers_residual(u)
    t1  = (u - v_ref[]) * (1/dt)
    nl  = 0.5 * orth2(Dx * (u ⊕ u))
    lin = Dxx * u
    R   = t1 + nl + ν * lin
    return orth2(R)
end

&quot;&quot;&quot;
    gradient of J = 1/2 ∫∫ |R|² dx dt
&quot;&quot;&quot;
function burgers_cost_grad(u)
    R = burgers_residual(u)
    J = 0.5 * dx * dt * dot(R, R)

    g  = (1/dt) * R
    g += ν * (Dxx * R)

    Dxu = orth2(Dx * u)
    g  += orth2(Dxu ⊕ R)
    g  += orth2(Dx * orth2(u ⊕ R))

    g = (dx * dt) * g
    return J, orth2(g)
end

solver = GradientDescent(verbosity=2, gradtol=1e-6)

v_ref[] = x0
for _ in 1:150
    x, _, _, _, _ = optimize(burgers_cost_grad, v_ref[], solver)
    v_ref[] = orth2(x)
end

vals_init  = qtt_to_function(x0)
vals_final = qtt_to_function(v_ref[])
xes = (1:N) ./ N

fig = Figure()
ax = Axis(fig[1,1], xlabel=&quot;x&quot;, ylabel=&quot;u(x)&quot;, title=&quot;Variational Burgers&quot;)
lines!(ax, xes, vals_init,  label=&quot;initial&quot;, linewidth=2)
lines!(ax, xes, vals_final, label=&quot;final&quot;,   linewidth=2)
axislegend(ax)
fig</code></pre><img src="2effeaa2.png" alt="Example block output"/><h1 id="TT-cross-approximation"><a class="docs-heading-anchor" href="#TT-cross-approximation">TT-cross approximation</a><a id="TT-cross-approximation-1"></a><a class="docs-heading-anchor-permalink" href="#TT-cross-approximation" title="Permalink"></a></h1><p>The TT-cross algorithm allows you to approximate a high-dimensional tensor from function calls. Below is an example of how to use the <code>tt_cross</code> function to</p><pre><code class="language-julia hljs">using LinearAlgebra
using CairoMakie
using TensorTrainNumerics

function sin_6d(coords::Matrix{Float64})
    return vec(sin.(sum(coords, dims = 2)))
end

n = 8
d = 6

domain = [collect(range(0.0, π, length = n)) for _ in 1:d]
alg = MaxVol(tol = 1.0e-8, maxiter = 20, verbose = true)
tt_maxvol = tt_cross(sin_6d, domain, alg; ranks = 4);

tensor_approx = ttv_to_tensor(tt_maxvol);

tensor_exact = zeros(Float64, ntuple(_ -&gt; n, d));
for idx in CartesianIndices(tensor_exact)
    coords = [domain[k][idx[k]] for k in 1:d]
    tensor_exact[idx] = sin(sum(coords))
end

error = norm(tensor_approx - tensor_exact) / norm(tensor_exact)

max_error = maximum(abs.(tensor_approx - tensor_exact))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.9984014443252818e-15</code></pre><p>And we can check the difference at random indices</p><pre><code class="language-julia hljs">println(&quot;Relative error: &quot;, error)
for _ in 1:5
    idx = Tuple(rand(1:n) for _ in 1:d)
    coords = [domain[k][idx[k]] for k in 1:d]
    exact_val = sin(sum(coords))
    approx_val = tensor_approx[idx...]
    println(&quot;  Index $idx: exact=$(round(exact_val, digits = 8)), approx=$(round(approx_val, digits = 8)), diff=$(abs(exact_val - approx_val))&quot;)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error: 8.022423319143219e-16
  Index (3, 2, 4, 3, 4, 8): exact=0.97492791, approx=0.97492791, diff=6.661338147750939e-16
  Index (2, 5, 2, 7, 5, 3): exact=0.97492791, approx=0.97492791, diff=1.2212453270876722e-15
  Index (3, 6, 5, 6, 8, 2): exact=-0.97492791, approx=-0.97492791, diff=5.551115123125783e-16
  Index (4, 2, 6, 1, 8, 4): exact=0.78183148, approx=0.78183148, diff=6.661338147750939e-16
  Index (4, 6, 3, 6, 1, 1): exact=0.43388374, approx=0.43388374, diff=2.7755575615628914e-16</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Quantics tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 18 December 2025 10:42">Thursday 18 December 2025</span>. Using Julia version 1.12.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
