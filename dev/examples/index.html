<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics.jl</title><meta name="title" content="Examples · TensorTrainNumerics.jl"/><meta property="og:title" content="Examples · TensorTrainNumerics.jl"/><meta property="twitter:title" content="Examples · TensorTrainNumerics.jl"/><meta name="description" content="Documentation for TensorTrainNumerics.jl."/><meta property="og:description" content="Documentation for TensorTrainNumerics.jl."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="TensorTrainNumerics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li class="toplevel"><a class="tocitem" href="#Discrete-Fourier-Transform"><span>Discrete Fourier Transform</span></a></li><li><a class="tocitem" href="#Variational-solver"><span>Variational solver</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in <a href="https://arxiv.org/pdf/2505.17046">this paper</a> where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^cores)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, cores)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(cores) + id_tto(cores) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(cores) ⊗ qtt_basis_vector(cores, 1) + qtt_sin(cores) ⊗ qtt_basis_vector(cores, 2^cores)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[1.053104489572928; -0.6973096935192995;;; -0.019902200782751144; -0.5283036067829031;;; -1.7512509082997514; -2.4349304785532166;;; 0.4651520364458659; -2.6210593616136624], [0.5966604386646437 1.4725956039388384 -0.17251946822639885 -0.413837918181391; 1.5869109396858856 -0.2273704657775509 -0.5767331232553521 0.9420742697355595;;; -0.4402562754129398 0.12596883907640902 -1.3304191145338473 -2.616166539207233; 1.5193939092675366 -1.373312109489385 -1.5811774283045346 0.0029858301601268246;;; 0.023697341914992384 0.9099761181041026 -0.49427621564518726 0.4855133393112925; -1.8255623732001225 0.4617948502006429 0.47410956572241736 -0.38693755974821026;;; -1.4427765791415268 0.35279151417149424 -1.0687023086314351 0.5108936997639839; -0.37149888128295117 0.680962731948496 0.49061586150394715 0.5476626169391917], [0.6622548487472257 0.5945553806156737 1.3735448288660914 -1.0904021507520103; 1.5389856633438688 -0.17909758986384616 0.6455110289419216 0.02792341536587972;;; 1.7278916887063664 -0.09702852862599327 1.2047927642511218 0.8883042051721862; 0.2102252786734388 -0.5477521761556458 -1.8258132758483983 0.47597374181367835;;; 1.638478746286715 -1.3600208313523199 -0.5561612246117802 1.3986026947466619; -0.05655913368947735 -0.5224987197112008 0.6303340612608006 0.35944917363371065;;; 0.07346751013328635 -0.5132387162453238 -1.048841935166337 0.03411440239878531; 0.04705871752110999 -0.45147836629537524 0.4132384987808862 -1.3637245554732527], [-2.1747162535172118 -0.12183574522346673 -0.20455435264553687 -0.8256084364977716; 0.3237939462655872 -0.989954977672969 0.3587013361892523 0.8075757632071899;;; 1.0527650792428762 -0.2934128599632043 0.04036115184151751 -1.8235590609388717; 2.006190609487064 -1.1736139794968279 -0.8631197503935061 2.4370128876648787;;; -0.5921416892205014 -1.2374586477613256 0.9796030397217492 -0.24565047115608277; -0.6314755322596682 -1.0272826160623587 -0.15916843559490554 0.3757200537936026;;; -0.0520263512849105 -1.164536790161351 1.1913824089618168 0.19365386609150861; 0.401784664093211 0.8290238142860011 -0.8877578764420941 0.900672253222395], [0.16244105502968156 0.21486397533591794 0.38104747353315127 -0.14692225772809164; 1.6045866180777577 -0.8886349615413507 1.4079003378543662 0.03377078543816286;;; -1.3817961724924814 1.2846247912599031 -0.6074069550760055 -0.2643524749884296; -0.48429222609678296 1.408548506275523 2.3581697157862247 0.4049338665471599;;; 0.8558350665216734 -0.6154863005801544 -1.2432110678335309 1.8179513211315934; -0.3861060198329001 1.2129283437214584 0.3511294310510592 0.43586553808213796;;; 1.08267234335711 -0.4238466495628088 1.423938076144872 -0.9884325272730958; 1.6944501456349843 0.8035323715205608 0.4593080097430948 -0.9116969260856084], [0.20614922180568596 0.38789753533441906 0.11907319364992103 -0.202917147131783; 1.4596315038198708 2.9059003471764866 0.3701290524262302 -0.1953930661534895;;; 0.10924060457643951 -0.9735500153583246 1.514885009392977 0.48616823288727046; 0.40301692325387306 0.33572458582998693 -0.9435077836816896 -0.9761587931937377;;; -1.223269103869782 0.3232562339617353 1.5540615343484128 -0.78483236652634; 1.127046734183431 -0.17037588245613366 -0.24740563724321965 -1.586717042096455;;; 0.7827505186410183 -0.9350033429791723 0.10838685034170832 -1.2176350251741042; -0.05335912953224836 -1.2241875740604702 -0.03338983685046036 -0.2658717052740996], [-0.8277066293013221 -1.1224596006553103 1.5574882361635496 0.6258715264333514; 0.968711398647901 -1.5380861079066317 0.49626990436156476 -1.5711752863667052;;; -0.9946743681893828 0.1583662566209978 0.8283243589970128 0.23439545096715972; 0.15244852243705914 -1.79047055327081 0.30626998496644914 -0.7111203448384796;;; -0.7050369167498941 -0.2510599332322707 -1.0897904269999896 1.0661102577569208; 0.2523385323393077 -1.1575975496103614 -2.9518657208314334 -0.03359905338508322;;; 0.1435100114782552 0.28272005578885556 -0.9999831301250849 0.4393404158460895; 1.2699321949681333 0.25248693363484975 -0.9767228886309482 -0.48217532505202204], [-0.10957445070640887 -0.9873701577998373 0.7063138350468203 2.638329296363421; -0.14934937792915942 -0.9587544314366739 -3.193465131015577 1.093492834120537;;; 0.8521096405577617 -1.4245836118516457 -1.1987189063709496 0.11149253861620155; 1.0574722046902387 0.9931945843308903 -0.6293371869990265 0.24420611512373644;;; 0.6179392750469253 -0.9457227906809064 -0.2808254552153593 -0.05398376109570812; -0.675063732087621 -0.18278720916334837 0.7538035069016261 -0.8160319801247272;;; -1.0441142870440574 -0.04823795696723862 0.03475212971520446 1.7927501892807176; -2.045466017585855 -0.9259943638932632 0.4809405196835141 -0.8528442848639011], [-0.26757059966667357 -0.05802427516776823 0.23432708911752737 -0.2597891046934952; 0.7811851684454353 -0.3187443373397687 0.2721594501101467 0.29416374463961886;;; 1.6396344347933531 0.48911849439832383 -0.5444273765884459 -0.027386508222961976; -0.09172014305964454 0.06500697878150624 -0.46551809629799484 0.3931096833064653;;; 0.7394092022797647 -0.9031963457176284 -1.6124359321121007 0.43452613555602443; -1.8038299250192658 -0.026634056992317825 -0.31936207807512995 -0.043729535140933855;;; 1.216681227218899 -0.4026783975304864 0.4487931786402982 0.6628380366240163; -0.8715682551031135 -0.36387598541042554 -1.2057853718690812 1.1777126811435585], [-0.48219183136431565 0.10511982440625581 -0.19313307320892026 -0.7335886131846848; -0.5183760857047854 -0.579993898609428 0.9768439019675412 0.4573069783216658;;; -0.11651734675239031 -0.1232830734243101 1.0942796339188579 -1.0370000807106128; 1.4898653657082392 0.4172009899597583 2.372066144451817 -0.5733184787804144], [0.16159016789421474 0.30722319259877945; 1.4483609090432668 -1.6056648418492714;;; 0.7476563215869148 2.0973617117342918; 1.6844026488548167 -1.475952880275728], [-0.6075359571740017 0.43296910007713324; -1.2603809081781678 0.5081263071220753;;; -0.0754929635365635 0.6971446490004777; -0.5922504685732524 0.7494801169737773], [1.5398143931132764 -1.410396416452559; -0.8510041537111777 0.7800773891758691;;; 0.26131823688199096 0.9345641811439556; -1.0837578193679829 -0.46087977985458556], [1.6082531242334994 0.8007897630743287; 0.5053008884576277 -1.1445603339498793;;; 2.294290454905502 -0.8826793426933308; -0.7812629178744043 0.34334435186287304], [-0.7808025163517806 -1.2767129425390193; 2.040527738006348 1.6726773398357966;;; -0.057236361767452865 -0.7196731140388397; 1.2896914488318796 -0.2910067350207064], [1.5453745316360443 -0.3920036873723579; 0.9651162230185557 -0.22552518452734907;;; 0.6890419795818513 1.4332608663256983; -1.2158944011431103 -0.9102077519011452], [0.18483489985596754 0.013742301241424632; 1.9504389963878068 0.722867176093008;;; -0.12147774028716012 -0.6694004361576447; -1.2996480631960075 -0.028571723054275952], [-0.11440812833401015 -0.7277724659504873; -0.977273987736655 -0.02604608029460729;;; 0.29611454749210564 -1.5513523994955258; -1.2713517455899406 0.30877758565937885], [0.08935453936456647 -1.474111165486702; -0.05017418144640544 -0.8322101808126254;;; -0.6927523821246625 0.4300679242313806; 0.7388578019005146 0.31819673218210237], [-0.2739530355361611 0.9850929798797718; 0.5005029576204856 0.12119477041627504;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-180.1549252973073; -188.98049386123262;;; -108.8054364241124; 103.72411919571138], [0.701628245740159 -0.4987352533122284; 0.69374058545646 0.5094461345952311;;; 0.11126661610570965 0.4903239346339798; -0.11670271599825079 0.49714970781424495;;; 0.01003133880464172 0.04600219606095018; 0.011523913388354535 -0.043982729086731405;;; 0.01031513415923207 -0.00651027159379452; -0.010108944475702228 -0.007702211257574425], [-0.7061306951857985 0.34662526882558253 -0.08532851508086708 0.11038327072911912; -0.7048732366906341 -0.34775417679095827 0.057273332217877386 -0.11481061299319245;;; -0.04716769370813818 -0.6131596799215133 0.23754925798665283 0.13126988712925464; 0.047525300228687783 -0.6154497441377287 -0.3175311580956475 0.07389773743707197;;; -0.0033202341360935067 -0.04568600903337895 -0.4817248403201361 -0.5222781690087323; -0.004076994862728655 0.04567103706634002 -0.49551494079182484 0.5200921268962222;;; -0.0032917649550926417 -0.0005515677542803117 -0.4213829581625921 -0.4676864157007526; 0.0033478816608079427 0.00027414254414749546 0.4203770988136371 -0.43471724095581643;;; -7.725391058833813e-5 -0.0008222619407869074 0.01210234899663952 -0.014689232394484662; -5.670676190588596e-5 0.0008126343734209166 0.012522367201426176 0.020168651717068657;;; 9.045031100120873e-5 -5.577146250870885e-5 0.0019411070523435723 -0.013346742730083348; -9.362133221477882e-5 -2.4344956768488606e-5 -0.0013013867131159236 -0.012649478163042896;;; 8.440604457222413e-7 1.1638619591353539e-5 -3.2531885949095e-5 -0.0006016287741954916; 9.901549292784834e-7 -1.1535009563346179e-5 -3.843157496529762e-5 0.0005995640300213424;;; 3.2095079065687018e-6 -1.446378678935236e-6 -3.253340950880519e-5 8.376410054666173e-5; -3.1819875234427453e-6 -1.7576867000267382e-6 3.1681330496075355e-5 8.469865783676985e-5], [-0.7068073211248872 0.1974640975158423 … 0.08910668888263205 -0.009425399572011878; -0.7066822284276343 -0.1974302533941818 … -0.08734564752807884 0.011280907354966882;;; -0.022619806489275314 -0.6782538182609024 … -0.0041610025936015885 -0.03597102432853016; 0.022531978988327647 -0.6783822451453578 … 0.053411841846948936 0.01840793692284865;;; -0.0009437172226871869 -0.0297638462270753 … 0.10475629794495357 0.12479934698364972; -0.0012150693251966136 0.029951538943239715 … 0.057456741381578726 -0.1266383274823186;;; … ;;; 1.4523291780957394e-10 2.1075923262881433e-10 … 1.5731305925599817e-5 -9.756236906672356e-6; 4.636848467699865e-11 3.6835451060867383e-10 … 1.0303280012306107e-5 6.0176659969225424e-6;;; 7.296254078166481e-11 -8.65198934606403e-10 … -2.950967727603701e-6 1.5214431927239003e-5; 1.6095444187539715e-10 -6.040943360206885e-10 … 5.919215772633791e-6 -1.644691052108966e-5;;; -1.9712275668851185e-10 7.597598319122251e-10 … 1.2114504994384723e-5 -1.5248108659252964e-5; -2.1136084977375904e-10 1.665561183374388e-10 … 3.379109202232419e-6 1.815266765012104e-5], [0.707022677494709 -0.10206830392796672 … 0.06920103944931043 0.03668327970270143; 0.7070102525450476 0.10216359748624804 … -0.06820907948984509 -0.03020211585309857;;; -0.011249006075273942 -0.6995506639572875 … 0.022566125902201743 0.1876654711570252; 0.011342230195212763 -0.6995275835134295 … -0.03702868003831976 -0.20371107639835873;;; 0.00023717114007077344 0.0145083157947629 … 0.1385123176005735 -0.2464686241474516; 0.00031535283088575584 -0.014560007000038183 … -0.17697208219922772 0.10061063955340843;;; … ;;; 1.258564619158216e-10 -5.170571875450364e-10 … -0.1123838958762287 0.02743416224335173; 1.5459509169746931e-10 -7.329272549052536e-10 … -0.06414815955873453 0.011084891549328065;;; 7.400252459396655e-11 -5.26903198777139e-9 … -0.2868258515217873 0.08962317462883451; 1.8638487370377082e-10 -5.567458574545648e-9 … 0.04136641623460304 0.39874611997858467;;; 7.744086768038035e-11 -2.917552101796602e-9 … 0.20865632715894872 0.0229860043200335; 1.441207984550504e-10 -2.9357876182827383e-9 … -0.3191477241339322 0.05152564913590324], [-0.7070856491027432 -0.05116622260083918 … 0.0044731895772195 0.10367620347296021; -0.7070819169946734 0.05140697343666653 … -0.0041212811068116716 -0.10258125065065574;;; -0.005580618834008269 0.7052326415612189 … -0.019063702232782115 -0.058993799344614864; 0.005821726468542676 0.7052137711631835 … 0.023530980063484773 0.07473494928498038;;; 3.97727874308803e-5 -0.0002671917553063791 … -0.020969420727349208 -0.013591494167452596; -2.288662885665345e-5 -0.00024080448387771918 … -0.20729310135832654 -0.06652810826274365;;; … ;;; -1.4268102466392031e-11 1.248650190265711e-10 … 0.3372030803606515 -0.49248586148225726; 3.376255247302128e-11 2.0124400122259047e-10 … 0.057323133605491496 0.04183154839663095;;; -1.0984769685039412e-11 -4.614803810913745e-11 … 0.07844654676351921 0.27557396473787615; 1.4848201573645643e-11 -1.2352375469594736e-10 … -0.07759184781516006 -0.07456140594179003;;; -1.3395770721185244e-12 -6.620108319283658e-11 … -0.09747464347593347 0.293338425255707; -2.1061661778833278e-11 -4.216636877247589e-11 … 0.0344823594806193 -0.11120672367549957], [-0.7071036007505866 0.024902388164476645 … -0.0028887379581024253 0.08667573712100007; -0.7070975812256433 -0.026313055217117517 … 0.002877306397251322 -0.08678873222275144;;; 0.0021672750597456704 0.7066613446005998 … -0.001070298413258646 -0.017334045600528022; -0.0035784850454776947 0.7066096681334415 … 0.001975324552456495 0.011746254933450833;;; -5.485886997181201e-5 0.0021864717282708635 … -0.05765186144150157 -0.10087909669393422; -3.9613234680565245e-5 0.002191225159086259 … -0.041722765291560014 0.06695311230346762;;; … ;;; 1.7538002286899554e-8 2.177559311262006e-6 … -0.021460798292071308 -0.05904709456022509; -6.857400722949102e-10 2.1765385258925636e-6 … -0.012409843469487834 0.11752410697469026;;; 1.6250914022982405e-11 -6.0374446812961825e-9 … 0.017914473484094823 0.11159815086096952; 6.914553314480982e-11 -6.065872734023296e-9 … -0.010192860232830484 -0.15071703845970855;;; 2.746707252295096e-10 -1.8571502356598286e-8 … -0.052043465030290594 -0.12850131535730355; 4.116628481076905e-10 -1.8730249207596697e-8 … -0.0031648400863895773 0.11513901269052994], [-0.7071067577153123 -0.011625335324811066 … 0.038293763813303884 0.01286444517632101; -0.7071018556116331 0.014011673109756217 … -0.03854691664851706 -0.013106048737839262;;; -0.00024701027289661615 0.7069306103329486 … 0.06297656711176802 0.06026077929328024; 0.002631819804131631 0.7068870734878661 … -0.06119200641648658 -0.05976531414559213;;; 5.2697217669580284e-5 0.008874735703722741 … -0.09374815371193133 0.09825576907939802; 7.313695357183866e-5 0.008872957920917381 … 0.054585999630999256 -0.0894834144074346;;; … ;;; 5.907939857705277e-7 0.0001739799856675418 … 0.10802803138683786 -0.16370375161601855; 1.2804030121726052e-6 0.00017418905623431126 … -0.17228113372571635 0.22631078501624044;;; -1.8002764252311838e-9 -1.0875347942872567e-7 … -0.15141350257045974 0.07085667112822164; -2.2247716427301764e-9 -1.0910411948417e-7 … 0.22031984119562487 0.6245886281941441;;; -1.1332446048193597e-11 -7.18400720647589e-8 … -0.1349780271886877 -0.08737752683870893; -2.9635304633673316e-10 -7.19160058451089e-8 … 0.11170323610867573 0.15044270095212142], [-0.7071063130133655 0.004947283001733618 … -0.030611930859301775 -0.17738571248811386; -0.7071032143948878 -0.008006724084320559 … 0.030691971050184653 0.17743617445498458;;; -0.0008121137874244326 0.7063077886125345 … 0.04102825968315407 0.027327110532262805; -0.002240820957566864 0.7062799640717279 … -0.040439518090469105 -0.02404933948951745;;; 4.183127324871855e-5 -0.01737516853977673 … 0.029382141962400462 0.043030652476533655; 7.22886539349797e-5 -0.01737413949010007 … -0.025669084481755786 -0.045138007831323566;;; … ;;; 5.830359864311799e-7 -5.22255279025548e-7 … -0.1784395155544494 0.2945360691600481; 5.827610336928259e-7 -3.553188371848822e-7 … -0.0591534279716544 0.08376414992778869;;; -2.370937740956449e-7 -3.9514835456958357e-5 … 0.0024683706759490755 -0.11787569352804841; -1.5687990851799365e-7 -3.9631063829639396e-5 … 0.5453370906543441 0.412762918760436;;; -1.7441431986475864e-8 -2.58451160278748e-5 … 0.06702848858636223 -0.195032952468327; 3.467427466887133e-8 -2.5880064474313807e-5 … 0.1827470042349794 0.02960967090143565], [-0.7071065008996524 -0.002385719034320848 … 0.011433589474204182 0.03612318574511525; -0.7071055440228793 0.004336371255930747 … -0.01143351888775573 -0.03612312481452493;;; 0.0006276784088397098 0.7007755699011787 … 0.0005410801792041075 0.00022436997503684473; 0.001315287711364808 0.7007656545260551 … -0.00036033536087787076 0.0002065816171617875;;; -1.1912719826445355e-5 -0.022819576193420028 … 2.256262551854118e-5 0.0008740405291134017; -3.335129461884352e-5 -0.022821092267060042 … 0.000285826651561131 0.0010746332801816851;;; 7.81713858983952e-6 0.015338749704329612 … 0.005758819239286682 0.006218537282296612; 2.263234331049648e-5 0.015340059911806288 … -0.0032144292392732596 -0.004973717634245782;;; 5.344578634204303e-6 0.0044493527027913565 … 0.3356152471075345 0.6142331962749062; 9.702116551837325e-6 0.00445018067929125 … -0.007989058082965404 -0.6285651169046181;;; -1.0324981709700195e-5 -0.015578226226852449 … 0.18620733714048368 0.2965673349348709; -2.5566425670194743e-5 -0.015579026619467739 … 0.8040275259449925 -0.3600638548752303;;; -3.678618402162109e-5 -0.07950000798879917 … -0.09261898602913156 -0.049391891048848606; -0.00011455016481927146 -0.07950343019502344 … 0.04172750072673528 0.04644256082040964;;; 2.5893913867147007e-5 0.039612521124415025 … -0.1627381208798466 -0.04897321365571392; 6.465025594834764e-5 0.03961421136038656 … 0.41116485186380786 0.018848874893330675], [-0.17691339701163541 -0.14058205978074595 … 0.18909478160627394 -0.08906343581557816; -0.9837303131156504 0.004915257950059733 … -0.016275576079105732 0.00866862532876021;;; -0.01976710099944752 0.9898292667578124 … 0.044864798829362174 -0.020351906621051463; -0.007410070128105419 -3.851720969121831e-5 … -0.03170614860704661 -0.035582871028846656;;; 0.022656159263169523 -0.020729313500816107 … 0.8144815018385978 -0.34452956945223834; -0.004167965622380847 3.860665008431631e-5 … 0.08562582476071558 0.020145517030397745;;; -7.796510915388096e-6 -0.0017060098165741597 … -0.1293723156733914 0.05503193489119091; 1.7211096342434836e-6 -1.3956686787457699e-6 … -0.011891757211397609 0.010541814179228393;;; -5.261200181605661e-7 -0.0038301657671983478 … 0.2409701197956657 -0.11011095152574216; 5.8181973620782896e-6 -3.0827095648996754e-5 … -0.3087825048798505 -0.5928046069227054;;; -2.583708215913366e-7 -0.0016962238752707647 … 0.1504293669162202 -0.07029219643290506; 2.4421616455351294e-6 -1.2266795283380662e-5 … -0.2745023316920345 -0.5698526892616196;;; -2.5408699362606065e-7 -0.000612944700294081 … -0.1348437619295602 0.057821810536286565; 2.163829738611955e-8 1.2355092004815186e-7 … 0.008630056782583422 0.03219699564533805;;; 2.0348604695564817e-8 7.31151604621944e-5 … -0.057334513685317175 0.00905833345676634; -5.6343324753746834e-8 2.1992675157920885e-8 … 0.020767945090657807 0.41278231921243735], [-0.4085729310305569 0.24877026366982896 … 0.05096908599294035 0.010915700925953021; -0.9115461914241374 -0.12693039638384063 … -0.021303748001952547 8.938479252131872e-5;;; 0.015233736833243357 -0.9597541683981939 … 0.01930918545254163 0.0019506207282873685; 0.019608347823132484 0.0013635988452179162 … -0.02357450305154494 0.04493677210753145;;; -0.012976785967714188 -0.029242691906753954 … -0.10811574379223049 0.04669076170108441; -0.036969580607601624 -0.004119730926346296 … -0.004606614438145809 -0.1145901867116682;;; -1.5510521026200827e-6 -3.803120761573768e-6 … -0.01751968432980119 0.00968984651860585; -4.4980345399428036e-6 -5.039444574021292e-7 … -0.0037049329979253393 -0.01047995235948364;;; -2.202865084465538e-9 2.0844909031140316e-7 … -0.017863148979520068 -0.0007231906422905625; 1.6336725692777342e-10 1.881821400050137e-11 … 0.002281055891761714 -0.01822722269758323;;; -6.101357143640987e-9 5.859729437425986e-7 … -0.10587740701199434 -0.0008477808036347467; 6.942889839892868e-10 -7.132261738699959e-10 … 0.03352133324349156 -0.12710853529084745;;; -4.963885359309637e-10 4.551266106666837e-8 … -0.9855611456488804 -0.009508512546165058; 6.96408531000902e-12 -1.0227228378482768e-11 … -3.621407821384345e-5 0.009687210415286564;;; -8.851981014510029e-11 9.642279745628506e-9 … 0.00015331537237603816 0.0007883472987280341; 3.581529010781887e-11 -1.3217615999413734e-10 … -5.387053966104179e-5 0.9826841465868617], [-0.5229543293909398 0.4086975595859579 … 0.05187957865980564 -0.03461753958352694; -0.8507682243648619 -0.27352882272348045 … -0.026500758105942667 0.013198167906078247;;; 0.022176006544527997 -0.8703752915637358 … 0.03726406038221976 -0.02072809515256076; 0.02159120247883962 -0.012565671816066187 … -0.02940653288145393 -0.04341928404989893;;; 0.015559653918578923 0.019543125941960983 … 0.1673166602969524 0.01321128727442558; 0.03888623653073911 0.007437056293985848 … 0.046016504651502796 -0.14614169359356677;;; 6.05535710940502e-6 8.251042230679104e-6 … 0.04040925933223272 0.008726168045919523; 1.5275154293456648e-5 3.014871289246808e-6 … 0.010309972899138018 -0.025115891794274477;;; 7.136323311134993e-9 -2.621090359023293e-7 … 0.2047622271909506 -0.16901777494938106; -1.5404822192383848e-10 -8.971167992172292e-10 … -0.03834448612218366 -0.29314018663609775;;; 8.179060227956586e-10 -3.269082167011413e-8 … 0.07854254646069539 -0.062159458276173515; -3.099353089389431e-11 6.05366891785464e-10 … -0.0274515917070673 -0.13732801826148477;;; 1.744329538402501e-11 -4.202489122558852e-11 … -0.9550815647245875 -0.03204775603201703; 7.256584810510401e-15 2.501015924575794e-10 … 0.0002908126148369026 -0.06662623793684325;;; 2.8210168618671227e-11 -1.357197767807506e-10 … 6.431768100956321e-5 0.015605873368041008; -2.9029679885878287e-11 -3.4775232235827927e-10 … 5.1903019513038e-5 -0.9116704677454637], [-0.5865982691732657 0.5781680519865169 … 0.04909669370343145 -0.024231339996864932; -0.8091703458045185 -0.4263840771251993 … -0.029066988954592796 0.021519336002413327;;; -0.011818778741478915 0.6891195215948989 … -0.06566910320930008 0.01859412154853736; 0.0208257544158666 0.09397175167425922 … 0.01488243139494118 0.09905845397921081;;; 0.008964464953784232 0.009214248162183691 … 0.21824620382159485 0.08168314087415317; 0.022182405672238677 0.010816756509749417 … 0.10056749047836902 0.02806690033696325;;; -2.5419189386789327e-5 -6.692722680618796e-5 … -0.07304562730607488 -0.04012337026078981; -6.986588995768912e-5 -3.847252925567753e-5 … -0.018235471796725095 -0.043626200212210225;;; 1.0472492100938424e-5 -8.197563881360184e-5 … 0.3534877122742795 -0.017312986869696723; 1.025811917330391e-5 -3.2119060753966365e-6 … -0.02911677342386762 -0.3103876155718072;;; 3.7324596487824605e-9 -3.1452154891651366e-8 … 0.1080088899900756 0.047356035479443455; 3.0756143932710835e-9 -1.649378207236428e-9 … -0.04874794450497045 -0.1746329125469681;;; 1.4640021774058884e-12 -4.690977233750742e-11 … 0.8872742288245311 -0.04710004841444831; -4.756468715871952e-11 -3.128578941661396e-11 … 0.00018445459141829944 0.10310535810294423;;; 2.1078803965780114e-11 1.1243842952773755e-10 … -0.04120669868864437 -0.05266239170930218; -1.5706663107913326e-11 -4.6898334149480176e-12 … 0.0002653408693155993 0.9125878086568073], [-0.653122535711462 -0.6295244163820594 … -0.051449458750872853 0.032234846654257715; -0.7564122002795147 0.5426331234057793 … 0.040348162626500796 -0.03429184073625208;;; 0.012447082935951622 0.5123860904215096 … -0.10970854314482284 0.021934639191585455; -0.03232281709558802 0.21570613631925098 … -0.007833572333039182 0.1166318647518645;;; -0.0027523522959997902 0.008076078622218427 … 0.2682910869930754 0.1197237361500368; -0.00801068880617689 0.01066446822364549 … 0.14507948866881618 0.13769381550111132;;; -3.4272553862061595e-5 0.0006156401592515828 … 0.12412783441989424 0.0876673956334915; -0.0002424052883486088 0.0004459511784392601 … 0.03182750452110735 0.051959722434778095;;; 0.00011751951369106818 0.0003558622811541628 … -0.5169388085240025 0.012516125132174897; 0.00014802515077222156 -3.474001508435257e-5 … 0.018431446795803174 0.3922033446550947;;; -9.728960440060956e-9 -3.3004735544546366e-8 … 0.19968825359324813 0.07727473092742733; -1.1272651030167618e-8 4.838835452232943e-10 … -0.11609262168359312 -0.3774283623608097;;; -1.1709174823350261e-11 9.320610971348445e-12 … 0.7430406198392496 -0.19390775724041043; 2.21250058088507e-12 6.5711290291253076e-12 … 0.01706063000933439 0.28157637219769766;;; -1.7323841303268458e-11 -7.987398985185978e-11 … -0.006133984737581282 -0.06269235808836685; 1.456277992292191e-11 1.3626596213370353e-10 … -0.028677097838521865 -0.7188898705981043], [-0.691899333490819 0.6216973473692792 … 0.05508432488664686 0.07376636142680665; -0.7217706079675339 -0.5948883814850854 … -0.050613137320689415 -0.07434048765407547;;; -0.009233693372508033 0.4124667350831275 … -0.15229292001088782 -0.07577369477622796; 0.015306979074437314 0.2990070444543966 … -0.015286752713078293 -0.18897640121015236;;; 9.709599808870273e-5 0.004798850572880513 … 0.21733741010768534 -0.041086837677702756; 0.0015839395845157304 0.005538738733054005 … 0.1896594793681702 -0.13988505159481607;;; -4.7423725893464515e-5 0.0024636404773295726 … 0.334779992715144 -0.17218206105788691; 0.0006363658090671001 0.002529581004625241 … 0.0783356168286104 -0.3652502844849199;;; 6.880800001641091e-5 -0.00014450689447273582 … 0.646249279121772 0.13528321755206618; 8.276561107740318e-5 7.670773705826652e-5 … 0.115062292575333 0.18687751093764418;;; 1.8233247247877252e-7 -4.4024642612718035e-7 … 0.29938814767660943 0.09121096216213277; 2.0246441022799907e-7 1.4066291208369352e-7 … -0.14618136656903866 0.6814528125998113;;; -2.5430776956363355e-12 -4.468595896850934e-11 … -0.47714677738653966 -0.13422493433819052; 1.9415528631316053e-11 2.6855237637777993e-11 … -0.002005035323216227 0.27421287694532903;;; -2.6556182968148572e-12 -2.1457954341542317e-11 … -0.0010473026805644483 0.0033910645466893145; 2.078916887453079e-12 4.513685480734594e-12 … -0.0017169264274791358 0.3796382906960487], [-0.7030584250125781 -0.6166248536882604 … 0.049458021104252764 -0.10259672730010677; -0.711108123598493 0.6091700090577463 … -0.04810054579968128 0.10237041057308191;;; 0.0033939197304809444 0.3690180860298075 … 0.1634068845585539 -0.1377751730902842; -0.004739375217597137 0.33541717466459303 … 0.0020626101473597957 -0.22114736890196238;;; 0.00010261650862483953 0.001550912247465026 … -0.16024386796393741 0.0676647698930909; -0.0002746707959495157 0.0016338536736330376 … -0.28678803612150344 -0.15832748789173703;;; -8.990136907627355e-5 -0.0009110189977500274 … 0.545072465764341 0.11737843099983267; 0.00011330660270640085 -0.000869130601220447 … -0.016879785571091516 0.3802126079594258;;; 1.1472878305946557e-5 1.868045517944472e-5 … 0.631027849346006 -0.3383910458404368; 1.3266862455436933e-5 -2.2410502844132802e-5 … 0.2804113803714416 0.40521022835773646;;; 2.2765638292682078e-8 4.6119389862749636e-8 … 0.2321503574507508 -0.15758126232487074; 2.37504634627266e-8 -3.201913812486353e-8 … -0.13671512385678197 -0.6292491040359933;;; -1.256592898358167e-10 -1.6134913811607223e-10 … 0.11750804532805105 -0.07434141246084984; -1.4638485453010677e-10 2.864353733152817e-10 … 0.0003725369714946262 0.11401717311001588;;; 1.929745308263378e-12 4.866698301153825e-12 … -1.991739201676502e-5 0.03158685489325367; 9.547936721056616e-13 6.231379433302953e-12 … -6.130851845847675e-6 0.06407968993815541], [-0.705872491575006 0.6182247551364768 … -0.02368443356327027 0.1750148381594864; -0.7083372198300191 -0.6159225058739579 … 0.023426103800257746 -0.17465194458920272;;; 0.0009139404868812213 -0.34978985149924374 … -0.1057196587622491 0.3022918993863558; -0.0012523634753760261 -0.3407115529355589 … 0.022525428708292904 0.32292371188586444;;; 3.6459335963060145e-5 -0.0004109405395329371 … 0.18211936715547608 -0.289759269336636; -5.813193044172738e-5 -0.000361509040950156 … 0.3469946785302214 0.56143438993257;;; 1.3717369317546716e-5 -9.902957009515984e-5 … 0.7637457943839187 -0.4146480235241723; -6.550819194866882e-6 -8.373168489656866e-5 … -0.5003257087335229 -0.4148546694500406], [-0.7066887203889405 0.6328224002305253 -0.07035402303056748 0.308507979937202; -0.7075244980658327 -0.6320174437328255 0.06980159622417349 -0.30836791762223525;;; 0.00018836383739231043 -0.31753369778566853 -0.8274943381776643 0.46306094153311383; -0.0003187958563250978 -0.3150589014048981 0.5526582749691543 0.7715611564372971], [0.7069760699278897 -0.7072374682872192; 0.7072374682872192 0.7069760699278897;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^cores, 2^cores)
xes = collect(range(0,1,length=2^cores))
yes = collect(range(0,1,length=2^cores))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="617185b4.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this exampl we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 8
h = 1/cores^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,cores)
xes = collect(range(0.0, 1.0, 2^cores))

u₀ = qtt_sin(cores,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393355746132e-5
Relative error for implicit Euler: 4.831313012373924e-6
Relative error for Crank-Nicolson: 4.831479823191514e-6</code></pre><h1 id="Discrete-Fourier-Transform"><a class="docs-heading-anchor" href="#Discrete-Fourier-Transform">Discrete Fourier Transform</a><a id="Discrete-Fourier-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fourier-Transform" title="Permalink"></a></h1><p>Based on <a href="https://arxiv.org/pdf/2404.03182">this paper</a> we also have access to the discrete Fourier transform (DFT) in QTT format. Below is an esample of how to use it. You can use the <code>fourier_qtto</code> function to create a QTT representation of the Fourier transform operator where the <code>sign</code> parameter determines if its the Fourier transform or the inverse Fourier transform. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using Random

d = 10
N = 2^d
K = 50
sign = -1.0
normalize = true

Random.seed!(1234)
r = 12
coeffs = randn(r) .+ 1im * randn(r)

f(x) = sum(coeffs .* cispi.(2 .* (0:(r - 1)) .* x))

F = fourier_qtto(d; K = K, sign = -1.0, normalize = true)
x_qtt = function_to_qtt_uniform(f, d)
y_qtt = F * x_qtt</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{ComplexF64, 10}(10, Array{ComplexF64, 3}[[-6.692998526848724 - 0.12354817562882091im; -0.0022806148305551943 + 0.12354817562882091im;;; -6.6933654067473825 - 0.11317829823260839im; -0.0019137349318961413 + 0.11317829823260951im;;; -6.694272164209603 - 0.08210347888611554im; -0.0010069774696709693 + 0.08210347888611619im;;; … ;;; 0.05796283522321057 + 0.0014290918476729843im; 3.523470688106915e-5 - 0.0014290918476729956im;;; 0.05797485750205915 + 0.0011600591396387784im; 2.3212428032483376e-5 - 0.001160059139638769im;;; 0.057978314031102644 + 0.0010702400270735186im; 1.97558989889976e-5 - 0.001070240027073519im], [1.4120752997552524 + 0.05215207529126031im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.5058735744406938 + 0.017898362339652005im 1.0117471488813876 + 0.03579672467930401im … 9.44119791763556e-9 - 2.6684299082363617e-7im -4.715939148186342e-9 + 1.332897920182006e-7im; -8.70889413449713e-7 + 2.461453914966158e-5im 1.7452192239615181e-6 - 4.9326316578799906e-5im … -2.4197645407977027e-5 - 8.561392552677505e-7im 1.2074924862629859e-5 + 4.272240957749548e-7im;;; -0.3062594056548169 - 0.009412184589660344im 1.2262486783185658 + 0.03768595739446423im … -1.6872762036722136e-8 + 5.490162271944501e-7im 8.428040941946727e-9 - 2.742367391016016e-7im; -2.6029309394020325e-6 + 8.469575525932069e-5im 5.216114267230103e-6 - 0.00016972510898942715im … -9.642186907645231e-5 - 2.963306313137396e-6im 4.811542470989351e-5 + 1.4787178797484532e-6im;;; … ;;; -7.653274982704723e-10 - 3.097647146659974e-11im 1.533693369304722e-9 + 6.207592043947587e-11im … -5.945814849934711e-10 + 1.4690167693432504e-8im 2.967064109404555e-10 - 7.330646921304051e-9im; -2.9098095918588405e-13 + 7.1891896976791976e-12im 5.825378062800971e-13 - 1.4392607705792227e-11im … -7.802442495177351e-5 - 3.158022387380519e-6im 1.9486841808511366e-5 + 7.887258730667871e-7im;;; -1.9218999614860401e-10 - 6.885154871547842e-12im 3.8514073012223483e-10 + 1.3797562970875054e-11im … -1.1815232077196126e-10 + 3.2980658381220254e-9im 5.895970198015943e-11 - 1.6457821366192743e-9im; 9.49037061644247e-14 - 2.6491114960401437e-12im -1.8999496067713927e-13 + 5.303458156286289e-12im … -6.441898476253532e-5 - 2.3077927865449937e-6im -3.220949238127491e-5 - 1.1538963932727565e-6im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -8.992832211630796e-5 - 3.0821154334568117e-6im], [1.405672899468546 + 0.10399625487293773im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.503637748704958 + 0.03647603669797375im 1.007275497409916 + 0.0729520733959475im … -7.12337959269921e-11 + 9.485861503900092e-10im 3.5581739713190016e-11 - 4.738248897097524e-10im; -3.6326712419048867e-6 + 5.015759747165163e-5im 7.2796931364593125e-6 - 0.00010051333956226914im … 4.524443993145084e-8 + 3.3976224149284172e-9im -2.2577536095472223e-8 - 1.695455680920217e-9im;;; -0.30501069250697627 - 0.020667228328390193im 1.2212488878831842 + 0.08275063868817345im … 1.490350717302128e-10 - 2.116169584186984e-9im -7.444386897619282e-11 + 1.0570387857550324e-9im; -1.2599944167820667e-5 + 0.00018595225422157215im 2.524951682166749e-5 - 0.0003726369346132345im … 1.8034483785691947e-7 + 1.2701131409553386e-8im -8.999377994677047e-8 - 6.337984711562436e-9im;;; … ;;; 3.43750582731547e-20 - 6.261558000126238e-19im -6.888658654254819e-20 + 1.2547974570380155e-18im … -1.0287572305460213e-8 - 7.431316280446569e-10im 5.133675926819415e-9 + 3.708354931635459e-10im; -5.001403750351591e-20 - 3.3188536818522375e-21im 1.0012705907638794e-19 + 6.644275792478182e-21im … -1.223586448319395e-8 + 1.6963418029494949e-7im 3.0559450546640894e-9 - 4.236666196216597e-8im;;; 7.915639140696253e-21 - 1.5748783469476085e-19im -1.5862610433035477e-20 + 3.155990470638791e-19im … -2.5995205445020124e-9 - 1.7564916344215652e-10im 1.2971980202652128e-9 + 8.765145078784347e-11im; 2.0393667560855977e-20 + 1.2612047319863786e-21im -4.082763701108251e-20 - 2.5249018520354053e-21im … -8.856644276784516e-9 + 1.31291296233126e-7im -4.428322138393255e-9 + 6.564564811657776e-8im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -1.1808955242301205e-8 + 1.7919853194817623e-7im], [-1.3802462534236168 - 0.20555523528193867im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.49464245198651596 - 0.07288194505774458im -0.9892849039730319 - 0.14576389011548915im … 2.4634216424909343e-10 + 7.1611268043732066e-9im -1.230494971470928e-10 - 3.577028946590262e-9im; 1.475863739933395e-5 - 0.00010016539192803377im -2.957557792185068e-5 + 0.00020072648130605735im … 1.327448319560935e-7 - 2.41903680527995e-9im -6.62413158283511e-8 + 1.207129337223128e-9im;;; 0.29977126298314627 + 0.04274791868439431im -1.2002704512699385 - 0.17116071480491876im … -6.649688921993367e-10 - 1.6807544747154648e-8im 3.321557570941588e-10 + 8.395464533567318e-9im; 5.4817918876463146e-5 - 0.0003844125581183908im -0.00010985175381451485 + 0.0007703392351102304im … 5.291194416671966e-7 - 1.2106142356341892e-8im -2.6403560625746373e-7 + 6.041079546093078e-9im;;; … ;;; 1.5446241664684545e-21 + 4.78980114182852e-21im -3.0953805364815042e-21 - 9.598617935604906e-21im … -1.34643341838023e-7 + 1.0322887123634237e-6im 6.718934867981502e-8 - 5.15129862987675e-7im; -4.881114839912557e-22 - 1.3800024796671148e-22im 9.771890019880945e-22 + 2.762736157773256e-22im … -0.0015772593983544483 - 0.00022969866828864566im 0.00039392542022217514 + 5.736795388537908e-5im;;; 3.9404680681580747e-22 + 1.1979377039472876e-21im -7.89653353039404e-22 - 2.4006171558610707e-21im … -3.16146351316345e-8 + 2.5249028194958605e-7im 1.5776156180377415e-8 - 1.2599627057148457e-7im; 2.0378281637208773e-22 + 5.538487298134312e-23im -4.079683475818348e-22 - 1.1087919734101412e-22im … -0.001303487951789547 - 0.00018363886578470708im -0.0006517439758949202 - 9.18194328923742e-5im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.0018202453593026198 - 0.0002535584307061944im], [-0.8873868208771029 - 1.0041092543901555im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; -0.3185763666575573 - 0.3593563921703512im -0.6371527333151146 - 0.7187127843407024im … -1.4220128687614517e-6 - 2.5271668375721296e-8im 7.103045837531132e-7 + 1.2623361068453713e-8im; 0.0001498847548998774 - 0.00013287572358174697im -0.00030036162064926697 + 0.00026627636484189364im … -1.3341593564863888e-6 + 1.3618576461464754e-5im 6.65762048857735e-7 - 6.795838385744588e-6im;;; 0.19408780192228184 + 0.21689516483179172im -0.7771186980399288 - 0.8684383378855057im … 3.3896124206796803e-6 + 4.010195203692751e-8im -1.693130751008298e-6 - 2.0031153932214887e-8im; 0.0005820553060552443 - 0.0005208499462727752im -0.001166403203509175 + 0.001043751409118647im … -5.0637382631309054e-6 + 5.43483069616541e-5im 2.526853290482248e-6 - 2.7120319246770026e-5im;;; … ;;; -4.761452541633137e-18 + 6.427133402887883e-18im 9.541808190434397e-18 - 1.2879782715140881e-17im … 0.000288743552102587 - 0.00036333750838013376im -0.00014408801011941633 + 0.000181311680219408im; 4.356289583681411e-19 + 3.227334875843688e-19im -8.721200812241144e-19 - 6.461057053235734e-19im … -0.01903855021513214 - 0.015830264807113102im 0.0047549368871990265 + 0.003953657669040542im;;; -1.1894629773610206e-18 + 1.6212528383828691e-18im 2.3836341575238556e-18 - 3.248923015767797e-18im … 7.25688210892154e-5 - 9.21871830488081e-5im -3.621288212128526e-5 + 4.6002726001786396e-5im; -1.7777988942708645e-19 - 1.3043316735538946e-19im 3.559111068050978e-19 + 2.611240962470656e-19im … -0.015463081744772815 - 0.012747673280960964im -0.007731540872388146 - 0.0063738366404819165im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.02146655865517202 - 0.017646473503262657im], [0.9346810841552255 + 0.6342906908452209im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.33551420488754596 + 0.22692707489045im 0.6710284097750919 + 0.4538541497809im … -2.9694797309091286e-8 - 6.783802651699601e-9im 1.4832742449537898e-8 + 3.3885531028812963e-9im; -0.0002110807043640692 + 0.00031208516976655485im 0.00042299527055257894 - 0.0006254032135176191im … 5.198153027933376e-7 - 1.895857098576865e-8im -2.5939427650285127e-7 + 9.460561814850126e-9im;;; -0.20433334130525996 - 0.13682361189035436im 0.8181413699809761 + 0.5478354954832734im … 7.208396264606699e-8 + 1.8188083061575332e-8im -3.600635077508853e-8 - 9.085051301314094e-9im; -0.000824448904854473 + 0.0012312377749490832im 0.0016521451376660362 - 0.0024673251322371997im … 2.0700097268080377e-6 - 8.360050648608896e-8im -1.0329544336047626e-6 + 4.171744350185727e-8im;;; … ;;; 2.7802012441152905e-19 + 1.6976692611655116e-19im -5.571439969252797e-19 - 3.4020783194200916e-19im … 0.0003573649795689999 + 0.00035085722467715697im -0.00017833128538284585 - 0.00017508380350530285im; 1.1470851367571706e-19 - 1.852059443498903e-19im -2.2964404992429913e-19 + 3.7077843455282044e-19im … 0.04575168890026765 - 0.04758660987776795im -0.011426626016440455 + 0.011884903214148333im;;; 7.098165690535168e-20 + 4.2900823271165196e-20im -1.4224427760888784e-19 - 8.597145912176312e-20im … 9.09033532360909e-5 + 8.841768406206499e-5im -4.536207651935145e-5 - 4.412169196520731e-5im; -4.693314391625306e-20 + 7.656758224581813e-20im 9.395903693554415e-20 - 1.5328647706059099e-19im … 0.03727986340175666 - 0.039143597458733435im 0.018639931700882524 - 0.019571798729371124im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.05181320546056359 - 0.054575653197049316im], [0.26253263533174626 + 0.4557075993656021im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.09454805219981509 + 0.16372038754772897im 0.18909610439963018 + 0.32744077509545794im … 2.2106571728140154e-5 + 1.2059090955467864e-5im -1.1042374914118358e-5 - 6.023593576213586e-6im; -0.0005572359381954608 + 0.0002251591396343751im 0.0011166732039706612 - 0.00045120775711813795im … -0.00010889917695964525 + 3.370132411587773e-5im 5.4342038542165806e-5 - 1.6817378286575213e-5im;;; -0.05814670512883998 - 0.09995571732029225im 0.2328167527144743 + 0.4002181287863566im … -5.381603564067256e-5 - 2.9396452278249257e-5im 2.6881416968111798e-5 + 1.4683695699011964e-5im; -0.0021984035585912083 + 0.0008994738063595305im 0.004405466158749146 - 0.0018024904477217676im … -0.00043256256402119303 + 0.0001351191486775038im 0.00021585281099433735 - 6.742573326288135e-5im;;; … ;;; -1.0926544289601973e-10 - 1.4810475349960875e-10im 2.1896467282630604e-10 + 2.9679748724327785e-10im … 0.0006178715959395666 - 0.0009237989731497065im -0.00030832857779836993 + 0.0004609916128766386im; -8.353067399647533e-11 + 6.067478304813674e-11im 1.672266657005572e-10 - 1.2146964912162377e-10im … 0.2654118659850059 + 0.1772706970589056im -0.06628743562991254 - 0.04427390567769784im;;; -2.7927674987753817e-11 - 3.749602476612685e-11im 5.59658949526344e-11 + 7.514046851814971e-11im … 0.00015400829234288728 - 0.00023259046634773695im -7.685234585052726e-5 + 0.00011606597728837969im; 3.430851703680891e-11 - 2.5164403723665827e-11im -6.868483443635096e-11 + 5.037853724761995e-11im … 0.22051503365852487 + 0.14580835480792165im 0.11025751682928724 + 0.07290417740397723im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.3084831221943268 + 0.20328830486410734im], [1.2305455144758934 - 0.33278947354380317im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.4404212311990841 - 0.11966310807731799im 0.8808424623981682 - 0.23932621615463598im … 1.0503620820219066e-5 + 5.130836345633418e-6im -5.246626228568826e-6 - 2.5628857901720307e-6im; -0.00020226506402050445 - 0.00016456864575164449im 0.0004053291642002487 + 0.00032978741019417366im … 0.00032248422030149856 + 1.4339055846602951e-5im -0.00016092362144627009 - 7.155366525525888e-6im;;; -0.26587588174989757 + 0.07324388552220318im 1.064554892266922 - 0.29326517376497546im … -2.5549455585282464e-5 - 1.101090906733356e-5im 1.2762098893385667e-5 + 5.500011926059765e-6im; -0.000807080163383254 - 0.0006591014328086179im 0.001617339242964632 + 0.0013207989252356244im … 0.0012851560407239214 + 5.061102765942778e-5im -0.0006413050204294154 - 2.5255381524565793e-5im;;; … ;;; -3.724491288656948e-5 + 0.00023393821367481937im 7.463768917692305e-5 - 0.00046880516896475466im … -0.0019997905663034455 - 0.0017106630088919708im 0.0009979299667681222 + 0.0008536503313797429im; -1.6221018985331542e-5 - 9.424841181328252e-6im 3.247414140698649e-5 + 1.886833530850391e-5im … -0.5218226722120032 + 0.20437317954689735im 0.130326828704924 - 0.05104283462767584im;;; -9.02664312778337e-6 + 5.868041506408269e-5im 1.8089016048989566e-5 - 0.0001175931024223643im … -0.0005080723373730295 - 0.0004323716863382666im 0.00025353538043226766 + 0.00021575967026803272im; 6.812811718229319e-6 + 3.875136885424862e-6im -1.3639086889432516e-5 - 7.757931801833413e-6im … -0.42843488173443495 + 0.16896271324688603im -0.21421744086726568 + 0.08448135662346203im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im -0.596980545761148 + 0.23597190444899518im], [0.00905846219466977 + 0.09597978603285341im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.003350176767825623 + 0.03360313847691902im 0.006700353535651246 + 0.06720627695383805im … -0.00032115984682588964 - 3.324428553772648e-5im 0.00016042141131716116 + 1.6605734673562733e-5im; 0.0006855672853595657 + 4.6213265567015365e-5im -0.0013738428636873065 - 9.260909390335237e-5im … -1.4987221490113104e-5 - 9.29072055302564e-5im 7.478809212281825e-6 + 4.636184666153202e-5im;;; -0.0022099112958239974 - 0.01892617098550845im 0.008848383937503503 + 0.07577952457325911im … 0.0007786059783438724 + 7.684472867628623e-5im -0.0003889181302293468 - 3.8384380580190426e-5im; 0.0027165683006875694 + 0.00017031136899950614im -0.005443836583069849 - 0.00034129355806646083im … -6.306206343824425e-5 - 0.00035321249723648467im 3.146856615077155e-5 + 0.00017625637710777354im;;; … ;;; -3.1379065056035265e-5 + 3.9705391364142727e-5im 6.288270592678317e-5 - 7.956841430426897e-5im … -0.0038445897298508332 - 0.001510665788555804im 0.0019185165516802125 + 0.0007538482707006032im; 4.630361058030746e-5 - 7.812791775180651e-5im -9.269886182851335e-5 + 0.00015641046047722867im … 0.14899563229135235 - 0.09868720537489149im -0.037212120671383624 + 0.024647435221127775im;;; -7.411302456252515e-6 + 1.0249458429595586e-5im 1.4851940768814776e-5 - 2.0539486872561708e-5im … -0.000972058119762302 - 0.0003761716579116111im 0.00048507093787171534 + 0.00018771505035991345im; -1.895048513191069e-5 + 3.2357661839216626e-5im 3.793842014148686e-5 - 6.477926876843939e-5im … 0.12385969082076849 - 0.08529584073869147im 0.06192984541039817 - 0.04264792036935533im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.1732911194224519 - 0.12085363155051715im], [0.4254034624266781 - 0.9001123197411989im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 102, 204, 357, 459, 510, 561, 408, 204, 102, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h2 id="Variational-solver"><a class="docs-heading-anchor" href="#Variational-solver">Variational solver</a><a id="Variational-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Variational-solver" title="Permalink"></a></h2><p>You can also solve differential equations by optimizing a variational functional. Below is an example of how to use the <code>variational_solver</code> function to solve a simple differential equation based on - <a href="https://github.com/Jutho/OptimKit.jl">OptimKit.jl</a> </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using OptimKit
using KrylovKit

d = 6
N = 2^d
h = 1 / (N - 1)
Δ = toeplitz_to_qtto(2.0, -1.0, -1.0, d)
kappa = 0.1
A = kappa * Δ

f = qtt_sin(d, λ = π)

function fg(u::TTvector)
    û  = orthogonalize(u)
    Au = A*û
    val = 0.5 * real(dot(û, Au)) - real(dot(f, û))
    grad = Au - f
    return val, grad
end

x0 = rand_tt(f.ttv_dims, f.ttv_rks)

method = GradientDescent()
x, fx, gx, numfg, normgradhistor = optimize(fg, x0, method)

relres = norm(A * x - f) / max(norm(f), eps())

x_mals = mals_linsolve(A, f, x0)
rel_residual = norm(A * x_mals - f) / max(norm(f), eps())

x_krylov, info = linsolve(A, f, x0)
relres_krylov = norm(A * x_krylov - f) / max(norm(f), eps())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0</code></pre><p>with a relative residual of</p><pre><code class="language-julia hljs">println(&quot;relative residual = &quot;, relres)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual = 1.5117834555699724e-6</code></pre><p>Compared to the MALS solver</p><pre><code class="language-julia hljs">println(&quot;relative residual MALS = &quot;, rel_residual)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual MALS = 8.696932943619164e-7</code></pre><p>And the Krylov solver</p><pre><code class="language-julia hljs">println(&quot;relative residual Krylov = &quot;, relres_krylov)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">relative residual Krylov = 0.0</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 25 August 2025 13:00">Monday 25 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
