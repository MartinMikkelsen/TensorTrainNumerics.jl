<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics</title><meta name="title" content="Examples · TensorTrainNumerics"/><meta property="og:title" content="Examples · TensorTrainNumerics"/><meta property="twitter:title" content="Examples · TensorTrainNumerics"/><meta name="description" content="Documentation for TensorTrainNumerics."/><meta property="og:description" content="Documentation for TensorTrainNumerics."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in <a href="https://arxiv.org/pdf/2505.17046">this paper</a> where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^cores)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, cores)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(cores) + id_tto(cores) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(cores) ⊗ qtt_basis_vector(cores, 1) + qtt_sin(cores) ⊗ qtt_basis_vector(cores, 2^cores)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[1.549810994246656; -0.6811423347038006;;; 0.5290960564474517; 0.0701590441152072;;; 1.4069588334151335; -0.9070951730057982;;; 0.369505832377665; 0.2761109710977353], [1.8307931929263508 1.3360511912271038 -1.3166435689387306 -1.0151819387931043; 0.22327831453663458 -0.8696651108169899 -0.3633131299822744 -0.7431094218341623;;; -1.1723860884668853 -0.7136370282596275 0.2863985652758616 -0.4647920237053402; -1.6958080551260064 -1.5205378707452557 0.04086558251298605 0.3799157021152031;;; -2.6170767491254012 1.1186485315134223 1.6147386801383699 0.8735665718515666; 0.16288332410273135 0.25750764737386006 1.4968640096585346 -0.11447638572467392;;; -0.3664148015450627 -0.37229647451029346 0.18997273610863552 -0.8137236681951029; 1.617350425869725 1.758167066181021 -0.45295198186860963 -0.05250987973929413], [0.2075919555754428 -1.4213242057669349 1.1361568076752322 1.6472926827172514; -0.877901023268103 -0.026492298264639808 -1.7345795815193832 0.7926975976155575;;; 1.4776617466177469 -2.424541726743366 -0.6868906685467131 -2.1228627882174425; 1.0630567857032336 -0.4221941758789969 0.3713389354473702 -0.8334778197103787;;; 1.496328581134005 -1.1330719096921555 0.815389641224439 0.7145952524451459; -0.18597673161294476 -0.405584197257798 0.20385384646629334 -1.1528088173167224;;; 0.8310110254941061 0.7813471856009808 0.13225134311055997 0.1834026589064023; 0.580169192253045 0.2149013556221063 1.4047518996413573 0.07672918877798238], [-0.20800144118913586 -0.06510777878006367 -0.7264654963241364 -1.221972907788886; -0.9132023728301419 0.3005485379743804 0.10418102329363023 1.3818172934636113;;; -1.7071563779778343 0.19186202434641922 -0.7304508765656028 -2.058162320386259; 0.3295926755442206 0.8816401329433761 0.6653580049948533 -0.9864107641347578;;; -2.407058441072678 0.020637957397083007 0.21798780155330816 -0.5952075374060407; -0.16954742613204293 0.6383303744337707 -0.6206434420161945 1.4133157190774517;;; -1.3883590410140632 -0.2779024563844335 0.9224812531778342 0.6606043409461692; -1.614162576140948 0.7086105136421071 0.03784081380246556 0.8010692647281514], [-2.0305444905898833 0.035716362972186395 -0.9340241417887705 -1.0391290268897249; -1.4092698278729965 2.11657984017023 0.3797170409574933 -0.17202643240808532;;; 1.133694484208569 -0.7878880979287081 -0.22168239265916984 -0.2922796974572242; -1.3580425593339933 -1.758843485939951 2.1634354835260368 -1.0295786937973057;;; -0.5696500561057805 -1.1435336975877213 0.4574613612002696 1.5356870205061748; -2.4512241951164624 -0.17972817383927817 1.1417413557201 1.127988386799409;;; 0.4413366370278165 -1.4499051317578822 -0.5564576348168011 -0.04480421918292768; 1.6796575822431807 0.2385660914245729 1.6686963318847425 -0.11949934773505845], [-1.8746404606553817 0.6775750925528475 -0.2596600469145001 -0.5124853471527968; 0.41769837351148875 -0.8288300030871645 -0.7184604549347854 -1.0757009278555818;;; 0.3800300367362994 -1.384234766270893 -0.6048914436606755 -0.13257175299237728; 1.7414925509005534 2.0749121379792603 0.22344626556794225 2.303988537681003;;; -0.751084273703055 -1.2127602574943106 -0.447228419140548 -0.4624648584305152; -0.7097942303256828 -1.365858028755694 -1.393287574499815 -0.4289278677520962;;; 0.7205710546059116 -0.2769960257755932 0.7301364816363335 -0.18416691736624266; -1.005467863586814 -0.7979529938246923 0.8665819532417807 -1.0891639479112727], [-0.7689876950265017 -1.231806856833518 -0.13018209420219154 0.9851332408939215; -0.9533086680698902 -0.30270323939537186 0.0017006988457487107 -1.0625985612464823;;; 0.033720557686226865 -2.2229485015024397 0.0740834644608312 -0.42430265038394677; -0.6359361480283076 -0.9694896230517438 -1.4664160506040198 -1.4864457690996653;;; 0.4921655390880003 1.4141799807206552 -1.6870883776902827 -0.8402516047670086; -0.21037693049934025 -1.0150153092433776 0.5015646650335487 0.5921899131413776;;; -0.27112882360754953 0.5556395802195059 -0.5181685601015853 -1.1079571544666742; 0.26147704850253584 0.9580118338006044 -0.05312931292258463 1.6665361824861329], [2.8218168508973114 0.8851505672287945 2.199453130120004 2.0236313056915765; -0.14957371503468145 0.5338492356009047 -0.6209158299200517 0.5678014247876101;;; 0.699064350597101 -0.45520708857245745 -0.17308689585632492 0.032798258556575206; -1.5462729544129983 -0.4652545544619103 1.5093748729955552 1.3419657999106862;;; 0.6054072795197971 -0.15103637248254767 -1.4876841147000344 -1.0330507857959002; -1.3895305909582614 -0.25049682980970955 -0.9189506638223685 -0.8623352011571883;;; 1.13369974255407 -0.4033747405608829 -0.9608657738772888 -0.2478956374896979; 0.04219768883676054 0.2955054306576362 0.9558722888904579 0.2474779759982839], [-1.0179363544574915 0.20838851345794246 0.8044359392777748 -0.008365564133497472; 0.8824761898282304 -1.289188012303089 0.3965384649705557 1.6902365423707044;;; -0.07561871103567182 1.3086177697031947 0.08271427663079088 0.629140196262174; -0.42927245438731826 -0.6170457899466311 -0.3960580726338114 -0.5228537489129244;;; 0.6875808252275512 -0.3471627844883805 1.3945561943245706 -1.8879001260798427; -1.1016853884273807 2.0906379909332333 -0.6419992059125909 -0.6020994017328923;;; 2.185253138977705 1.2076110719842068 -0.6110434131920712 0.4499006843058491; -0.9619636924731823 -0.5402652749543412 -0.21655380586002174 -0.25983101902827527], [0.9557961138636781 0.5180158760832455 -0.6295306961708917 0.5817361165366023; -1.16654314391509 -0.12941052111013926 -1.432976933447095 -1.4550651234835337;;; 0.7070758531900935 0.05936801711126494 0.4839861075351369 0.6200809797644561; -1.1472429195274485 -0.970442947861307 1.7325851860025343 1.734221388685023], [-1.9945221532243123 -1.4584869043255366; 1.7940821257262687 -1.2210114962436007;;; 0.6232120127148252 -0.73379099547371; 0.012847346964110865 0.39314142840204436], [0.8889962402851389 0.0044159407338967656; 0.4369791591949661 2.4615674378872767;;; 0.38988817755031624 -0.33169605624183446; 1.1465271263159824 0.5164806111477332], [-1.9236423296181282 3.2128008041462355; -0.7114542524383336 -1.4801575330854684;;; 1.0428072839220814 -0.606623860266521; 1.0886874675540719 0.34415623683189134], [0.11092956742251807 -0.18436203276623703; 1.1933345822888317 -0.25485650308909924;;; -0.501860298539664 -0.2247532238809004; 0.39761325806095477 0.804493974201897], [-1.1879814464773315 -0.4476003122390436; -1.556727843984369 -0.822532374975954;;; 1.4457845026920904 0.49628050203686147; 1.5993574130221087 -0.8667029901149313], [-0.43411320325061753 -0.010793409183599726; 0.08627657082620169 0.3484600133282764;;; -1.80308860396032 -0.6553948819568234; 0.39944640816649524 -2.091746002840837], [1.7598559730757914 -0.2963665399758122; -0.5261024792795749 -1.110168615571722;;; -0.33514019299020564 1.3198253727876144; -0.7038059997897784 -0.7593101714398802], [-0.1474869188768536 -0.12245809955827783; 0.8693888002410838 -0.49720998790427007;;; -0.9409583729496872 0.12148323867579143; 1.8219712751991446 -0.08213092880499598], [0.2704882967148087 -0.4037399999819238; 0.3905957594844142 -0.11978936446740691;;; -0.5881468292938856 -0.5869592340761872; -1.5742560223242614 -0.8910682736825498], [-1.1580254811291348 -0.25476451146535795; -1.246763812889379 0.7603110732227566;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-183.05985959708804; -185.6486862820663;;; -104.00974744255238; 102.5593563028703], [-0.6994786526708149 0.5167183284388357; -0.6975336238772911 -0.5195738862284853;;; -0.1087421349627738 -0.4789300370631693; 0.11023152402240766 -0.48137126306131245;;; 0.007031307798900843 0.031053677846867436; 0.007326562421342466 -0.030611476882223692;;; 0.00700491480556369 -0.004945927745186104; -0.006959208012458503 -0.005197776086373892], [-0.7059001160869323 0.36600405005785336 0.03947686379433349 -0.08278945156279889; -0.7054301855419483 -0.36648390025802297 -0.018996149484525986 0.08483575676340409;;; -0.04490730716213361 -0.6033260541061966 -0.19515959915629336 -0.09423570536431287; 0.045082354667569616 -0.6045635385509037 0.23035992303950978 -0.06432574391253984;;; 0.0024703456192423636 0.033419818146907324 -0.49630527989539147 -0.5198700526555794; 0.0026438009187216395 -0.0333730069792418 -0.5035509698879082 0.5222787860780144;;; 0.002352966151135767 -0.00037064707597008964 -0.4523916363831735 -0.469227914059141; -0.002359071071114468 -0.0006098272973267404 0.4498576961119602 -0.4579141737792313;;; 1.7235558371803445e-5 0.00012981022767146407 0.0025633251675498186 -0.0016155689539198756; 3.1779166093527076e-6 -0.00013562546787593282 0.002895838358967725 0.004420175373979665;;; -1.0274404534229967e-5 1.1414986830542707e-5 0.00037562574358051187 -0.002168061810895406; 1.123613539762892e-5 -8.435224980584456e-7 -0.0001143939781501371 -0.0018855152011401375;;; 8.706345528900468e-10 -2.1268053122778366e-9 -7.912162213405986e-8 1.9213783480699992e-7; 2.7786700924500487e-10 3.2884459889673323e-9 -4.2891187742993326e-8 -4.3467988594042747e-7;;; -2.11631118271421e-10 2.0606562741888814e-9 6.408655688561461e-8 -4.6541622877092177e-7; 3.080381078715623e-11 -6.632809604700976e-10 1.0693649037850463e-8 -1.9689797756340141e-7], [-0.7068261547505639 0.21207501875425683 … 0.19145804920295462 -0.18184187416776196; -0.706750678387985 -0.2120915665898679 … -0.1878136484693891 0.18631266754393028;;; -0.021191558902582706 -0.673945960305964 … -0.00044821995385242107 -0.13039908572224362; 0.021178488092533795 -0.6740692730387435 … 0.11757445290013517 0.01441799930144144;;; 0.0008597406147408848 0.027047544636412214 … -0.0035248633175739125 0.0010321918255353914; 0.0009288356457889856 -0.027109531704132578 … 0.0535499716545885 0.00962865075730806;;; … ;;; -2.8806843725306727e-11 8.973004071730705e-11 … 0.006082280531132739 -0.015177691658608213; 2.942266030863304e-11 -2.7358250489892946e-11 … -0.027185748519968838 -0.02478174152492291;;; -3.837197755645991e-11 -1.5061367262376957e-10 … 0.003269959661431803 -0.020148643486415662; 3.9888190175972115e-11 4.791857809572259e-11 … 0.005109751591392797 0.0052271943192242435;;; -4.9998058159381314e-11 -2.1268225967640663e-10 … 0.003083474955644063 -0.019639451026273534; 3.5274333151858365e-11 8.479296716105024e-11 … 0.013682935656198351 -0.0037264867493632435], [-0.7070305529236949 0.11072078024345511 … -0.024190026359670762 0.061634866816377434; -0.7070284018053155 -0.11070520769644725 … 0.024125693623568704 -0.056354813190697656;;; 0.010458359858779338 0.698193869568322 … -0.001865148719288546 0.16261989255431136; -0.010442098385269952 0.698174220344213 … 0.0038206476088862643 -0.18550086559768286;;; -0.0002688727309366278 -0.016732375451263454 … 0.0012909252372725203 -0.29419266141019756; -0.0002868123588922117 0.0167492561811651 … 0.27070273673934275 -0.09302714834332368;;; … ;;; 1.0952960818482926e-11 -3.226145182595236e-11 … -0.500307665763506 0.21742616482316918; -1.9295045352170934e-12 7.967040442647834e-11 … -0.06875869187998408 -0.2235698118818252;;; -2.7947445729607738e-11 2.0203148332908764e-11 … 0.08201735463856519 -0.35796681728855556; 5.201436475886477e-12 2.6694264524396943e-11 … 0.3585760894545363 0.09851214328230148;;; 4.939059798092113e-12 -4.4238973748227343e-11 … 0.04355389916951686 -0.0764000214720965; 1.3637723658158824e-11 -3.477594844965042e-11 … -0.06097605985351904 -0.06969257304463479], [-0.7070869653334285 -0.055800612029818314 … 0.21240699482903824 0.09573419099104466; -0.707087473872681 0.05582137205097807 … -0.21171425373678787 -0.09404138759105746;;; -0.005248689448275736 0.7048709510750857 … -0.029322543161615117 -0.10426488421634543; 0.005269568326900283 0.7048668521353993 … 0.06282238017413216 0.11882222741380925;;; 6.03890407968186e-5 -0.006652692980524708 … 0.09024081282811441 0.07194823106427624; 6.215483863684037e-5 0.006653647683189606 … 0.0890225594206205 0.13099782569154572;;; … ;;; -1.2921634805253853e-11 5.612023787328232e-11 … -0.09382491844342762 0.14558844893491674; 9.590542537844501e-12 2.5559887110067082e-11 … -0.07980170991434542 0.2197454131462425;;; -2.6754365931658065e-12 -2.4649410549977512e-11 … 0.42843763042045097 0.2054357684470685; -1.0354636212618486e-12 -1.0446536943815653e-11 … -0.16058999385116463 0.29122196393760924;;; 2.2952837106551004e-11 3.270221188333079e-11 … -0.40906373693959786 -0.07453587604796003; -7.348096368921182e-12 -2.1733346973109423e-11 … 0.09531387698671719 -0.19682422351268877], [-0.7071021259848831 0.027787231108020085 … -0.07921198369647493 -0.021284128339673962; -0.7071014773733905 -0.027972237134428153 … 0.08026698490740093 0.022157322932231754;;; 0.002559460138897625 0.7065579614455483 … 0.14302364888185945 0.11655851912872568; -0.0027446106682825037 0.7065507751248514 … -0.13663691697397368 -0.11594871052650665;;; 1.0265054931847652e-5 0.0018610695924791546 … 0.1781694471839865 0.4524415828632327; 1.0420205357001678e-5 -0.001866282957155142 … 0.2284611812684098 -0.04440509849997612;;; … ;;; -1.6863267616594613e-11 -9.125057046220785e-11 … 0.046017773575262544 -0.23817846644348714; -5.353955217889904e-12 -1.1949887346311285e-10 … 0.032978944465974915 0.1449680801088699;;; -5.6814625591912345e-12 4.5624540754163057e-10 … -0.1820188657199595 -0.0699764256059876; -8.60337083230583e-12 4.175973951893525e-10 … 0.11877675890807815 0.3148047735663818;;; -4.168528802669208e-12 2.4785360021539673e-10 … -0.0573651402111191 -0.2724152596945131; -4.794872760066729e-12 2.304080654125768e-10 … -9.912284599235523e-5 -0.022124440913498647], [-0.7071059496072595 -0.013676474798092081 … 0.007441952683939212 -0.013855147091479782; -0.7071050210945394 0.014168517446136602 … -0.0075051462045048 0.013512389198989625;;; -0.0010851000066205308 0.7069741084691311 … 0.017032401466775274 0.09084692920668211; 0.001577232709611523 0.7069643886911496 … -0.016666358185704094 -0.09107573369964746;;; -6.50039849153341e-6 -0.00021425921370273867 … -0.06135274503228308 -0.03273936290454868; -4.671590218387056e-7 -0.00021560970784525899 … 0.025310680988299878 0.0950150627359009;;; … ;;; 2.6282860990028423e-10 -1.313326699542779e-7 … -0.013946171029915204 0.10379547699421374; -2.3975446715342034e-10 -1.3216926744603327e-7 … -0.03632322368342455 -0.3370245744491941;;; 1.2160971085629217e-11 2.7670272781453e-8 … -0.10154187434842821 0.33491904984606746; 1.1379377005380923e-10 2.7720682209850184e-8 … -0.09153915058129349 0.14307493217520606;;; -2.1548293696009765e-12 -2.1577979658616646e-9 … 0.04010063158783713 -0.08626970593780864; -1.1133303308510307e-11 -2.1662644569929006e-9 … 0.012853464059103722 0.08243039726528682], [-0.7071067275942001 0.006574748981124718 … 0.009769990705078096 0.08694099165004197; -0.7071059919281331 -0.007353918812194485 … -0.009799989213856058 -0.08694109069006702;;; 0.0002768744953955795 0.7070732650495064 … -0.01596920447854541 -0.000898086932687578; -0.0010560605891098637 0.7070655665128353 … 0.015785549896181215 -0.00091413710342167;;; 3.8076596500887563e-6 -0.001609371333527648 … -0.04527856426872611 -0.04557313196986532; 3.519914531546745e-6 -0.0016099892190033162 … 0.049872123087827055 -0.0036774033338051932;;; … ;;; 5.6851807483960975e-9 -2.406795751632406e-6 … 0.2555375130123205 0.3320420494057342; 9.715689119436442e-9 -2.4109619605669276e-6 … 0.036120426742414474 0.15113250019095822;;; -2.153474463147441e-9 -2.6758750894299736e-6 … -0.44930676974320555 -0.0909401881575324; 2.7223435975757163e-9 -2.671585232974151e-6 … -0.052274623116063464 0.13846827434649409;;; 1.2227666560487133e-11 -2.499733208592798e-7 … 0.016556741527836254 -0.09090702183303288; 4.683640549259295e-10 -2.4973269745613327e-7 … -0.16936132670022755 -0.10299824983604731], [-0.7071066442755131 -0.002730944050276594 … 0.0009131260412423195 0.03404776824619391; -0.7071059180670185 0.004275699961051728 … -0.0009128733428086035 -0.03404756313813031;;; 0.0004399649239145163 0.706938890012154 … -0.00024157992469454076 -4.806590541367233e-5; 0.0011046895934915077 0.7069312128757165 … 0.00026686502764770485 0.00040565316526815887;;; 2.5533558192856046e-6 0.009670317292177355 … -0.0006944189151211387 -0.001139478144429683; 1.0666123461819885e-5 0.009670739867822964 … 0.0006748963359469502 -0.0008028175027270191;;; -2.5435436754489482e-6 -0.010878474694807233 … -0.007945917275261331 -0.0018158775101421918; -1.2294434040962615e-5 -0.010879520230716939 … 0.006535053296719384 0.000118053399427877;;; -1.5525065900954015e-6 -0.0010951025469695525 … -0.14493631538242505 -0.6221140862540546; -2.5794861696027683e-6 -0.0010961193567567543 … -0.24640205058310144 0.5525015018666236;;; -1.2458006633193792e-6 -0.0011477877035863653 … 0.25723333493736966 0.44017968513924277; -2.319620729354747e-6 -0.0011482227066698652 … 0.5333656790244966 -0.2986032005271191;;; -2.8047807260065747e-6 -0.003647129562677693 … -0.2627935201063443 -0.0730010333744524; -6.207541396289681e-6 -0.0036475421968524373 … 0.03554079946583952 -0.007254467459133198;;; 1.1017804278980568e-6 0.001506616564491564 … -0.6076681551314832 -0.12970730494369045; 2.504049606080086e-6 0.0015067832636495222 … 0.3576853497835072 -0.016262109344813255], [-0.1769294002901289 -0.14241514978973943 … -0.03840870367514874 -0.0964655506040414; -0.9837192960216543 0.0050815002027901025 … 0.0070321285519683975 0.00363856119079552;;; -0.02018105150399426 0.9897389707222065 … -0.005569004454154899 -0.01954845641478577; -0.008185709958826622 2.046382613083478e-5 … 0.07125946647093426 0.10619591590060462;;; 0.022387993955184135 -0.010025032002103583 … -0.012058670044838753 -0.5590161162099956; -0.004102545279845127 2.1377824128364414e-5 … -0.20999239495957522 0.12143123914811912;;; -1.0128136833075966e-5 -0.0008669184497191304 … 0.0028844759443918877 0.08628192078521979; 1.9164220068144946e-6 1.069581059768508e-8 … 0.18240254996773944 0.558806381335518;;; -8.937743839081811e-7 -0.002591257530672023 … 0.07666723396797635 0.0066952715693494895; 1.3840008097470876e-6 9.113510865491135e-8 … 0.7159204008026705 -0.17026667649424823;;; -2.0803842666234936e-7 -0.0005752785786493706 … -0.1843376166407426 -0.4578343631310513; 2.547326722644721e-7 1.8199938000663135e-8 … 0.4543511419462001 -0.10843505498312235;;; 3.359407964142888e-7 0.0007536057135387267 … -0.010812190032308903 -0.24251402391013618; 6.480898779051389e-9 -1.5204549160179815e-8 … 0.09976640071851016 0.10045577704295104;;; -3.0458635932445454e-8 -7.82762285916915e-5 … 0.10882962348141596 0.07869839325367084; 2.2525865755180313e-8 1.8918234168242743e-9 … 0.36755386015968344 -0.08101760909840316], [-0.40893047116882275 0.2567807519799979 … -0.13351154522103648 -0.014273499651789406; -0.9114450509550456 -0.1307179315873598 … 0.055254500185812225 0.0013692853667373597;;; -0.015322913050811777 0.9571733907219201 … 0.05155752532828019 0.003345088407218486; -0.01819129800492138 -0.001226377857997439 … -0.058245885391831696 0.04793803907318051;;; 0.012723622667070252 0.027861167364686874 … -0.28046501004206026 0.04273166777377372; 0.03627923972466743 0.004221210649298232 … -0.025806956029098403 -0.1160216855146611;;; 2.0808623550144277e-6 1.009669170743315e-5 … -0.04659262842342086 0.00941484339944865; 6.209744141067753e-6 7.271491921202131e-7 … -0.011266188808265904 -0.011152275083320675;;; 8.58456353434682e-8 -7.327158916363036e-6 … -0.04990152575593484 -0.0013545749077875132; -7.36909129277283e-10 -4.386074331597618e-10 … -0.012274625317406208 -0.020125139639996514;;; -2.465883746299709e-7 2.102236195055331e-5 … 0.36446348959104136 0.00943832895855445; 2.0568040482412095e-9 1.3488714075683405e-9 … -0.10136524062207633 0.13152892359708152;;; -7.149968592639191e-9 5.763308007439167e-7 … 0.8634773173955296 0.023163648435270308; -4.040777055506154e-10 1.0360330683132742e-10 … 0.010100858266541212 -0.09003640022893032;;; -9.617314943710171e-9 8.134422706597596e-7 … -0.0013239473399817893 -0.0004113517176397305; 4.3871271429496346e-11 -5.709395244666068e-12 … -0.000437339959598888 -0.9775203499172692], [0.5242480302426568 0.42058127073015955 … -0.16191721516512747 0.037393039317716974; 0.8501389911034269 -0.2808612739960946 … 0.08072700915486983 -0.01731624380618856;;; 0.02155454061568223 0.8623227863537277 … 0.11787342180982309 -0.022053911121434233; 0.01802422881873514 0.014813093940694607 … -0.04860437984663805 -0.10082650019008908;;; 0.015021149722537624 -0.01865979809110518 … 0.4589315140421254 0.03940737979350398; 0.037584465938251946 -0.007754717734116582 … 0.20475181195189504 -0.0846303026491685;;; 8.457501571944062e-6 -1.1425585524788756e-5 … 0.11045600709526979 0.017016299497941447; 2.136114544397893e-5 -4.544931883397753e-6 … 0.03939981931421751 -0.029618072694760002;;; 1.607956867934799e-8 4.4530036402249385e-7 … 0.5748659406102526 -0.042862465663404396; 4.506529566332086e-9 3.2897370429142536e-9 … -0.1192564192308525 -0.25816754201217484;;; -3.0639546736051826e-9 -8.4683356221825e-8 … -0.3520224800610116 0.02625531663832429; -7.835241563470008e-10 -4.998409463496168e-10 … 0.12682422287038453 0.15240970381395547;;; 3.914251295121068e-11 1.9171687980801057e-10 … 0.2889383260115907 -0.022223134767541574; 5.0581592504804536e-11 -7.623516009296472e-11 … 0.0025119663005653613 0.7801974650832385;;; -2.961110539030966e-11 -1.4640389675361102e-10 … -0.3413550941140874 0.026368733337648876; -3.029944412594198e-11 5.339963549644442e-11 … -0.0017326584980369506 -0.5248471618180182], [-0.5900693171253539 -0.5855175090697572 … 0.027528768578093856 0.01486853548808555; -0.8065990434962738 0.43465707331400266 … -0.010026195324157484 -0.01960804353990761;;; 0.011563706571871682 0.6765665682188746 … 0.051175197930452526 0.002474981058642243; -0.02382828454815354 0.10147930063206972 … -0.09911793752630907 0.1266265280163408;;; 0.008478425019961832 -0.00904354951854222 … 0.29231225736352323 -0.13858124325854132; 0.02104239962116799 -0.010968059888702492 … 0.12772314652745487 -0.13855289484474942;;; -3.574880371294588e-5 9.033575458809033e-5 … -0.11518214662402074 0.05778250168750968; -9.810456954533302e-5 5.733621934507453e-5 … -0.37242873706558954 -0.4128333477499989;;; -1.3844491497371993e-5 -9.957066747819935e-5 … 0.11875708741169631 0.5211711697695707; -1.4040570917135032e-5 -3.8325131860201885e-6 … 0.12701698975337666 -0.39342994611936627;;; -4.075699353961045e-9 -3.17568748236377e-8 … -0.30149027755976465 -0.4593346159232371; -3.3858394647254645e-9 -1.788889223765209e-9 … 0.14841865941923402 -0.22100160233775198;;; -1.0000713829442688e-10 8.3984329311204e-11 … -0.16290593142489254 -0.04110089175143605; -2.262996744912174e-10 2.6623522447976332e-11 … 0.5943569369107836 -0.22277699731716977;;; -1.5779459885487303e-10 2.3655426357452756e-10 … 0.2024431448040676 0.027531591672812376; -9.959651272998836e-11 -8.407316032495802e-11 … -0.4111275247161869 0.18129760418564111], [0.656733331968653 -0.6295529673705156 … -0.005931061654148977 0.10877991022383525; 0.753310676228674 0.5478056390188208 … 0.006291716159252933 -0.10605062723989445;;; -0.01263556070561168 0.5038817600329356 … -0.002433945097598258 0.13043912676927905; 0.03168800585953559 0.2224847219810928 … -0.025793604838312854 0.2589601356631384;;; -0.002457718010543959 -0.008040745510799615 … 0.0560256841130612 -0.02318238770066155; -0.007372232834459888 -0.010483894032654383 … -0.026087956097102953 -0.2588071360786108;;; 6.925904574318114e-5 0.0007952643576244662 … -0.032415307208544845 0.0764491034340518; 0.00036763670930267195 0.0006613431851613418 … -0.29580828343006954 0.11028400470291157;;; 0.0001219303786136171 -0.0003554084938731846 … -0.47168856392750114 -0.6079468106652882; 0.0001537406307533423 4.204045303472052e-5 … 0.36404528113300705 -0.2910532344161991;;; 2.1715338879335893e-8 -7.086708361268816e-8 … 0.06499017166252055 -0.009853853856436215; 2.4988379978856827e-8 2.274443857731892e-9 … 0.3858881049064238 -0.3744339717321925;;; -5.815069081623053e-11 1.891103088227312e-10 … -0.41448644425413667 -0.33389690086241325; -1.2937377407145738e-11 -7.719638521201221e-11 … 0.4257989300831656 -0.26330295690300454;;; -5.1375490566824134e-11 -4.344193557563306e-11 … 0.08682035009488534 0.08116876147705361; -1.3696935857297118e-11 4.995919329699857e-11 … 0.19515972114656446 -0.15908089514619445], [-0.6931865620118333 0.6211005487804816 … 0.13454517871402988 -0.0018878100199898908; -0.7205588570771275 -0.596471875918275 … -0.13525246878608627 0.0011642676239915965;;; -0.008848993260882173 0.4084144176296524 … -0.14889927761558044 0.018020410459958416; 0.014375478985637189 0.3026445767537389 … -0.32982105604226075 -0.0159627425308454;;; -5.3914314430897225e-5 -0.004355104150452624 … 0.005085212977696545 0.03531383695251976; -0.0013728759881469147 -0.005013440338800681 … 0.2786072681365718 0.09069539715535492;;; 6.244251875515413e-5 -0.0027071242188132557 … 0.20322416292845555 0.08312143273810288; -0.0006806167406267138 -0.0028072054454735423 … 0.5722470894772692 -0.044585197994949165;;; -6.352850244891027e-5 0.0001311277267486781 … -0.1280305071281759 0.1896912144651229; -7.607089142019884e-5 -7.444605456647506e-5 … 0.22813002436871807 -0.29100034089948384;;; 9.936064931948163e-8 -2.375351847348651e-7 … -0.05595162505760783 0.023356553569608085; 1.0942820415694647e-7 8.006727314107929e-8 … 0.5212636627196128 0.42862303651151346;;; -1.3097174660554743e-12 5.12424663335594e-12 … 0.14025556310752538 -0.2083144387819226; -9.013083162008766e-13 1.6540370522108979e-12 … -0.1159464373015581 0.6102198102284698;;; 1.8794949422407887e-12 7.329246551621843e-12 … 0.02112013017859665 -0.07098994412669386; 3.431383683892516e-12 1.0466205213852075e-11 … -0.09692270750117665 0.5052879536131245], [-0.7033838441050376 -0.6163926688786092 … 0.03744343126903312 -0.07736982225041458; -0.7107896459357453 0.6095353249565519 … -0.036251154455502546 0.0773907971345289;;; 0.003165461827232613 0.36765770910558626 … 0.14367122970706736 -0.0881473597840894; -0.004374605366614929 0.3366733677526408 … -0.019417328385913625 -0.18358754817408446;;; -9.877946132280486e-5 -0.0014412306345380895 … 0.14759026399875202 -0.03164834196611578; 0.0002505709350973205 -0.0014960328688435995 … 0.3590892367892707 0.18729247460763498;;; 8.452215264471111e-5 0.0008280548421453396 … -0.5268980583323283 -0.20058380998793782; -9.916089476348906e-5 0.0007849521483897154 … 0.09339164623405734 -0.2939672582590759;;; -1.0144729153814646e-5 -1.6050108362685074e-5 … -0.5893862776136893 0.3350162055034055; -1.1784139348926052e-5 2.0534438686322593e-5 … -0.24121278889993802 -0.42713122866687186;;; -1.2196116384008196e-7 -2.4685389107769674e-7 … -0.2238904018308591 0.16244692975913433; -1.2631891146688792e-7 1.7254483450981163e-7 … 0.1709646148372139 0.5472029514804034;;; -9.616548261771319e-12 -8.965917033597726e-11 … -0.029448261275808907 0.001032714052081231; 9.138110977453634e-12 -7.891024487064183e-11 … -0.21554924170111006 0.3422639856807726;;; -6.859109318892828e-12 -7.424946119459568e-12 … -0.07857819407283825 0.20866546725610385; -1.039184648468957e-11 3.182635361057873e-11 … -0.027839635449871777 -0.05133740082860974], [-0.705957848789844 0.6182218188885653 … 0.041377840366750775 0.17070713296686651; -0.7082523086650231 -0.6159410530034419 … -0.04154176413893194 -0.17041761458337895;;; 0.0007020653684867081 -0.34932660563671664 … 0.012735684854356513 0.3183388499771723; -0.0012960396817847386 -0.34115853904170707 … 0.1374371161079644 0.29112178566039426;;; 1.4907061265804497e-5 -0.0003080928943327992 … -0.10774978156598222 0.3937066040888273; 0.0001005279975184823 -0.00027696920495026716 … -0.4668399455311194 -0.37142849952704005;;; 4.4143709589346275e-6 -4.494806949861997e-5 … 0.5406237904544303 -0.6395135393753054; -6.360589788460771e-6 -4.5330803878271785e-5 … -0.6750461944413093 -0.23191335988826242], [-0.7068413418091555 0.6326073851242531 0.04388280474846664 0.3134605449543769; -0.7073720031650784 -0.632084558969002 -0.043301632824677035 -0.31339899177550384;;; 0.00022703756802967736 -0.3188759990375496 0.7827251357646453 0.5344711475224496; -0.0003392662657716915 -0.31399857298564415 -0.6193065718078097 0.7196277865515183], [0.7070437395208856 -0.7071698172322701; 0.7071698172322701 0.7070437395208856;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^cores, 2^cores)
xes = collect(range(0,1,length=2^cores))
yes = collect(range(0,1,length=2^cores))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="3d5ea1a4.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this exampl we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 8
h = 1/cores^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,cores)
xes = collect(range(0.0, 1.0, 2^cores))

u₀ = qtt_sin(cores,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393110550548e-5
Relative error for implicit Euler: 4.8313716144573315e-6
Relative error for Crank-Nicolson: 4.8314642177489825e-6</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 30 July 2025 12:26">Wednesday 30 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
