<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · TensorTrainNumerics</title><meta name="title" content="Examples · TensorTrainNumerics"/><meta property="og:title" content="Examples · TensorTrainNumerics"/><meta property="twitter:title" content="Examples · TensorTrainNumerics"/><meta name="description" content="Documentation for TensorTrainNumerics."/><meta property="og:description" content="Documentation for TensorTrainNumerics."/><meta property="twitter:description" content="Documentation for TensorTrainNumerics."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorTrainNumerics</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TensorTrainNumerics.jl</a></li><li><a class="tocitem" href="../theory/">Tensor trains</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Partial-differential-equations"><span>Partial differential equations</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li></ul></li><li><a class="tocitem" href="../resources/">Resources</a></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MartinMikkelsen/TensorTrainNumerics.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Partial-differential-equations"><a class="docs-heading-anchor" href="#Partial-differential-equations">Partial differential equations</a><a id="Partial-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-differential-equations" title="Permalink"></a></h2><p>Let&#39;s consider the following 2D partial differential equation </p><p class="math-container">\[\Delta u(x,y) = f(x,y),\]</p><p>where <span>$\Delta$</span> is the Laplacian operator, <span>$u(x,y)$</span> is the unknown function, and <span>$f(x,y)$</span> is a given function. In this example we assume <span>$f(x,y)=0$</span> using Dirichlet-Dirichlet boundary conditions given by <span>$u(0,y) = \cos(\pi y)$</span>, <span>$u(1,y) = \sin(y)$</span>.</p><p>We want to solve this equation using quantics tensor trains (QTTs).  We start by defining the dimensions and the resolution of the grid. Lets say we want <span>$2^{10}$</span> points in each dimension, which gives us a grid of <span>$1024 \times 1024$</span> points on a <span>$[0,1]\times [0,1]$</span> grid. </p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 10
a = 0.0
b = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>We follow the same convention as in <a href="https://arxiv.org/pdf/2505.17046">this paper</a> where we define the finite difference operator using the following inputs</p><pre><code class="language-julia hljs">h = (b-a)/(2^cores)
p = 1.0
s = 0.0
v = 0.0
α = h^2*v-2*p
β = p + h*s/2
γ = p-h*s/2

Δ = toeplitz_to_qtto(α, β, γ, cores)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 10}(10, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To get the 2D Laplacian operator, we need to take the Kronecker product of the 1D Laplacian operator with the identity. </p><pre><code class="language-julia hljs">A = Δ ⊗ id_tto(cores) + id_tto(cores) ⊗ Δ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TToperator{Float64, 20}(20, [[1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 1.0 0.0;;;; 0.0 1.0; 0.0 0.0;;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [-2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 1.0 0.0; 0.0 1.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;;; 0.0 0.0; 0.0 0.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; -2.0 1.0; 1.0 -2.0;;; 0.0 1.0; 0.0 0.0;;; 0.0 0.0; 1.0 0.0;;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  4, 4, 4, 4, 4, 4, 4, 4, 4, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>To build the boundary vector we take the Kronecker product with the QTT basis vectors and define some random initial guess for the solution. </p><pre><code class="language-julia hljs">b = qtt_cos(cores) ⊗ qtt_basis_vector(cores, 1) + qtt_sin(cores) ⊗ qtt_basis_vector(cores, 2^cores)
initial_guess = rand_tt(b.ttv_dims, b.ttv_rks)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-1.2990888929405193; 1.027965379181967;;; -1.5095795851820395; -1.4828645363083306;;; 0.8377412839889408; -1.211286688393017;;; 0.5818679851890525; 1.27276411226151], [-0.5533061504978702 0.6147169154363327 0.9180373070216201 -0.6875979140068784; -0.17480618622823257 -1.3604610513781128 0.5152606347960683 0.9049493062907557;;; -0.30268957073304603 1.401078980265818 0.3696738870367844 -0.2505139677950692; 0.8627301806641767 0.8930063777848491 -0.4877838385535133 0.5116361657525685;;; -0.27206210853112506 0.25618339234750476 0.8212257403012079 -1.2512795082899102; -1.2255390993553936 -0.31698695242642394 0.26719717942430193 -0.39703145775553095;;; 1.4789369206718348 -1.2142247084138524 1.0172298759701413 -0.9394999636152288; 0.20013482335713018 -0.7092405676434936 0.8613068613897558 0.13040247575146546], [-1.6672620635501552 0.09085971666321645 0.8417529836394604 1.0269154984134141; 0.788248771614566 0.7047654856018363 -0.9676971922171854 0.18441739258475817;;; -1.491129293279072 -0.6565998396266376 0.734420453633813 -0.9812254149954591; 0.1746984821889441 0.5873207773884442 0.0950882776714532 -0.11924629530858047;;; 0.633105338378958 0.6394003471027305 -0.21910608371480372 0.04537603810820303; 0.667954099278575 0.8982022204457132 -0.3529135036573182 0.6841601545674337;;; 1.6600232286427608 0.06916239151995059 -0.6855785536553096 0.6371933393763071; -0.8777280762868651 0.17806145082473332 0.37889271010098424 0.7786395201305772], [-0.1832673201467286 0.750982042739337 2.288155787908124 0.741996115509503; -0.5254924675345537 0.1175346977406912 0.6577078870804206 2.2379201493620475;;; 0.565170471528364 0.6631634177715612 0.3093759554795972 0.3968125790042657; -1.59278616042508 1.4806980531029132 0.6138122744079125 1.2879179872100552;;; 0.12490107998365688 -0.23352159029945144 -0.9825032730208011 -1.7369695126977303; -0.6469812562180484 0.47494873088737555 1.3365170023978963 -0.8128948626573166;;; -0.7610839014994464 0.79634309532669 1.3467007292528652 -0.22649447122354371; -0.7047114504908131 0.8437573247110217 0.6069260871209716 0.4273777470135001], [-0.8375906022283417 0.21236906542047304 0.4977643568150683 1.1217459141807622; 0.19187056400434663 -1.0131435242658686 -0.6700898826050167 0.8771916231879902;;; 0.6090160811597854 1.7974573307259825 0.46319466666057163 1.509158748167857; 1.3252858082924173 0.5877062800083732 -2.348347109045056 0.4601051139193109;;; 0.7867983841887854 -0.3511947594640807 0.6703618661042485 0.2754142138882824; 0.45856049996940945 -0.021323908289518502 1.4817451787096676 0.08016959248589545;;; -0.5697509678694511 0.06614686206848784 -1.65762588402231 0.5249422437729651; -1.5113418784903592 0.381110146105994 0.6661236057334713 1.1006476775816987], [0.6432135781513527 -1.8052050082622908 -1.2834663867958116 0.2579426903494607; 0.8169795194478969 -1.1514459807215403 -0.9764473615912429 -0.6045668391799215;;; -1.4233126298475502 0.7373764126725 1.3977256590078249 0.5739481172825999; 2.3209158193712764 0.112506434566996 0.4221044384906938 -1.2567606452425781;;; -0.5973554606495237 -1.1650441555907751 -0.44530525589382214 -2.3629587548420017; 0.1541047176286727 -1.11277506967162 -0.1833601202929164 0.6389676934910813;;; 0.24862378091102078 1.2225039942166822 0.8853729655159954 1.7465354910204005; -0.09897642669109437 -2.6859352472180635 -0.10698926604254247 -2.097206838183345], [0.0705848969934586 -1.6500496977033439 -1.1785184369914374 1.0164709396721043; 1.232055105966983 -1.3579501950321247 0.3717468903386871 0.9958527009913976;;; 0.69000113207977 -0.3501344515322816 -0.1029583606070256 0.024149871530057723; 0.23910762795157714 1.1639228900384135 1.6093748835815875 -0.26981023577890473;;; 1.2701177279216604 -0.38058443462597286 1.6101550580510162 1.413231054890856; 1.2979734789266164 0.21662607259414507 0.1553351572684195 0.817649267179267;;; 0.19903897555451835 1.0432192833369922 1.226296469838081 -0.3400474902372215; 0.6032115977802202 -0.41914919175719967 -0.2931235608158647 1.797309621970032], [-0.40455699814601526 -1.5069248380461358 0.4088888089759712 0.38628514946758075; 0.2600245168184691 0.9869423090557207 -0.01603406870135245 1.2803075414784653;;; -0.9560132349573781 0.8133386262163231 0.6507445726846305 -0.1347777680771462; 1.0433899832814186 0.9831492199376658 0.50962995781676 0.26520272997344674;;; -0.16123858015506123 -0.678413113802786 -0.7523995732464247 0.5871511032369294; -0.024357941995003712 0.7417707263579164 0.7061608297201402 1.382074071862347;;; -0.08022622560526912 1.6231601648281393 -0.029681102704251627 0.9036009326409072; 2.3766280178028976 0.7127793390064202 -0.1364912563531093 -0.45154763164593853], [2.274775961210898 -0.19926462418830654 1.136813650089972 -1.2672670753548205; 0.5909953540138357 0.5102810520045472 -0.27643028232892797 0.40902278044056706;;; -0.5486343503707299 -0.38541672169192565 0.07061882351830348 -0.24939787856929466; -1.764280317207768 1.2268610187735534 0.38178025337279914 -0.563825658376422;;; 0.34970748930446854 0.7883500097486659 -0.6296014118008355 0.9056713506272793; -0.9600842842868349 -2.3429254105228896 0.7907809741199539 -0.2288342958014645;;; 0.4748242062334067 0.2239736276721022 0.03639129172554029 0.59605822162363; 0.2857194422325543 -1.0274849714566823 0.3822786001151347 -0.9788756977115111], [0.3031928667044747 -0.4895422547830428 -0.30518592619130014 -1.2387339170606737; 0.134243352833206 0.12224661232035246 0.6077812681898548 -0.9562155200861859;;; -0.31422334452637707 0.722227178599749 -0.6020347148910361 1.0665897975168184; 0.03275847731067926 -0.0376217225334772 0.9957374982135986 0.6023132397472681], [-1.3478522499658563 0.8826812137822158; 1.167295003367125 -2.0650833747176445;;; 0.3651198244913975 -0.9978700243690194; -0.5601806646604413 1.5300353847469663], [1.273691783086637 -1.4382027686172445; -0.07295000776249111 -0.499456742088263;;; -0.8164851083768339 1.7978891913902664; 0.4039875196084027 1.3942366075466488], [-0.846577484114054 0.20320409720376426; -0.7123514330597697 -1.4037236452045496;;; 1.0851139605989415 -0.352151250212872; 0.009359481628092945 -2.246387746554958], [1.542140931674464 0.2326098028332453; 0.8593771985366836 0.670929647714929;;; -0.20343542516088509 -0.043528928887690145; -1.554713234658132 1.1837974956142034], [1.5768745299491642 0.475695680659689; 1.3763980360057189 -1.5652778009461645;;; -0.3202393087143517 -0.8436619892177226; 0.2870965135256433 -0.6270415808555357], [-0.2054767335692034 -0.20896504516837625; 0.658856356423683 -1.650860992867213;;; -0.5339948924582785 -1.0067268815360584; -0.6426647022037975 -2.116924976789127], [-0.16933938149845487 0.8729063264805097; -0.20222726751554204 -0.33602479407228225;;; 0.06987449897351604 -0.7515244395853133; -2.299243637541534 0.5699551799705154], [-0.302113442991112 -0.0809596685410051; -0.9223368498859175 0.10998146505662926;;; -0.847740287828124 -2.003012047737691; -1.1578618841812787 0.18769863107503845], [-1.2235020143346613 0.35764960211595176; 0.3390198820314319 1.2762060049523352;;; 1.0164039145931563 0.23327193178163738; -1.006667965972225 0.5813518175108664], [-0.4845362014958533 0.24532421565212834; -1.4600022690552554 0.13118476751445318;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 4, 4, 4, 4, 4, 4, 4, 4, 4  …  2, 2, 2, 2, 2, 2, 2, 2, 2, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We solve the linear system using DMRG</p><pre><code class="language-julia hljs">x_dmrg = dmrg_linsolve(A, b, initial_guess; sweep_count=50,tol=1e-15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TTvector{Float64, 20}(20, [[-182.27951031038253; -186.62184712154672;;; -106.65941497404994; 104.17765246316127], [-0.6992146515675192 0.5066211326405887; -0.6967123709186631 -0.5103978507850826;;; -0.11146653648652383 -0.4878909182131359; 0.11349062907927449 -0.4910663776829471;;; 0.009687144948623822 0.04259460380981556; 0.010375980785702921 -0.04170956164367194;;; 0.009653612693719251 -0.006480384102766142; -0.009546601727074111 -0.007024480485131978], [-0.7059044479123538 0.3528429607547436 0.04259589092445639 -0.11068541937725764; -0.7052228925751186 -0.3535414395166199 -0.015433874399978313 0.1132728185123134;;; -0.046322229189900914 -0.6100988109317677 -0.2559974302229705 -0.12049619787359817; 0.0465762574485706 -0.6118319169401697 0.28911854818603894 -0.08630118296753987;;; 0.0033378433723971696 0.04451244828416919 -0.491679397124839 -0.5292055932013398; 0.0037491655493107827 -0.04438416964458697 -0.5024743479057808 0.5327424693395518;;; 0.003101674352597119 0.00024139032819763592 -0.4229572496818533 -0.44857316868518987; -0.0031092171322684835 -0.0002192322057357658 0.41916109602822993 -0.43341541810166645;;; 1.0726130322027972e-5 0.0001066505171136347 0.0015619080925524712 -0.0012778984682389443; 6.482978869493911e-6 -0.00010747335421290081 0.0016403375660846166 0.001975418940627924;;; -1.2382435598030703e-5 8.302502184069222e-6 0.00023524108160252117 -0.0016728341333196806; 1.282265834732464e-5 3.166408517793568e-6 -0.00014650619523602878 -0.0015916811021202926;;; 2.3928374626890445e-8 2.684108978417778e-7 3.330085616783123e-7 1.835022394439094e-5; 1.8972789715647287e-8 -2.734189873551072e-7 3.774998949089048e-7 -1.822714183629547e-5;;; 8.820487307279162e-8 -4.024041813004121e-8 9.921068404005145e-7 -2.9238168531796874e-6; -8.4693733323786e-8 -4.025312016951146e-8 -1.0445209258740852e-6 -3.017357969436414e-6], [-0.7068210325349183 0.20191966804521538 … 0.16110393560578343 -0.010183233850045006; -0.7067038877293561 -0.20192511595093485 … -0.1604195972015206 0.015213349986568743;;; -0.022038548901082942 -0.6768558707175761 … 0.034556619103306485 -0.0833204217986303; 0.02199600970383742 -0.6770190524642745 … 0.05712553082441044 0.07027818517144567;;; 0.0010166135220503732 0.03121724725327792 … -0.08528355367216785 -0.05585438066856125; 0.0011900810635801621 -0.031325261199407706 … 0.005730017072044236 0.06576364132809365;;; … ;;; -1.2074542904454824e-10 -1.9254013903634223e-10 … -8.670680404616948e-5 -0.0004965362107068357; 1.6463187187323737e-11 3.962968509225524e-11 … 2.605433027681373e-5 7.877527171218697e-5;;; 3.9684382660342194e-12 3.012804980181092e-10 … -2.4803185814160983e-5 -0.0002206922008524165; 4.791879395947231e-11 6.170256489040582e-11 … -0.00042055801266703774 0.0012295113016005533;;; 3.078392307483779e-11 5.24171397645085e-11 … 7.999255593439862e-5 0.0004573811491111937; -2.003447458747672e-11 -1.230871629318329e-10 … 9.476464093872763e-5 -0.0007814993956642108], [-0.7070242756332342 0.10464329617038574 … 0.005588841629670631 0.010587150527844735; -0.7070173771322602 -0.1046101612448096 … -0.011981133268315673 -0.0069175705063487785;;; 0.011037061188213695 0.6991793548736348 … -0.20164004741414857 0.11633218575819305; -0.011001696150319661 0.6991652307889868 … 0.19643419824550018 -0.1102019498590748;;; -0.00023968897076213344 -0.014335017249133731 … 0.1279047884890656 0.1978286371262608; -0.0002889283552759757 0.014372698833285137 … 0.2892608613361181 -0.28251240907032465;;; … ;;; -1.0390363169812585e-10 -6.155266704988103e-10 … -0.42401226585991847 0.1913576859194567; 4.252034400729763e-11 3.103715522403011e-10 … -0.13930761249639106 0.11926589466719298;;; -5.938328327870196e-11 1.0673161440969689e-10 … -0.0718424872498545 0.43264968750311683; 1.3079376903311034e-13 9.86827418470658e-11 … 0.11229939051323622 0.07083351934460236;;; 2.206060068531655e-11 -2.8897807648571686e-10 … -0.2565600672786607 -0.2157508686991422; 7.148179473203566e-11 1.6735618974515086e-10 … -0.33629340493356097 -0.04287220651498062], [-0.7070852289442989 -0.05256190389327979 … -0.03439519207475137 0.10187984960712046; -0.7070844244484324 0.0525616807347824 … 0.03444562087136267 -0.10250343025784059;;; -0.005571737980925994 0.7051327647941136 … -0.0068889054636546414 0.04816197893856613; 0.005571391161920173 0.705129839585375 … -0.0008983912636704662 -0.029699849153322654;;; 4.265419456116683e-5 -0.0007296261321832814 … 0.09244372117457815 -0.08779207182911246; -4.419917237413121e-5 -0.000717462285997911 … 0.09648951003993383 -0.1290715876691401;;; … ;;; -5.3953865873873394e-11 -3.0509336256836675e-9 … -0.5105030477862302 -0.264160215994149; 5.878906498139935e-12 -9.019707247690001e-10 … 0.02055915186124038 -0.03832739619025666;;; 2.4737359971587526e-11 -2.1055576269876402e-10 … 0.10187661668707566 -0.06506027957767486; -5.341395275542207e-12 -2.688397901242558e-10 … 0.10315682124434673 -0.35172066305744615;;; -9.843551703416479e-13 -6.16938023852076e-11 … -0.0419721733687896 0.038613836329584164; -6.949773441263922e-12 -1.0862392494636033e-10 … -0.07948314232205218 -0.32294811595751854], [-0.7071017933672937 0.026117958375434736 … 0.04381706411148002 -0.06210417065523775; -0.7071006197225778 -0.026379053082096367 … -0.04373376655830637 0.0625340638812931;;; 0.002674058057949053 0.7066218225850927 … 0.008555526846265088 0.05651970217847089; -0.0029352730429876525 0.706611743489256 … -0.01286541167125323 -0.05093903981447729;;; -2.5605730171601655e-5 0.0009395405003701082 … 0.04752897898724476 -0.04054739065005623; -3.190246300794848e-6 0.0009551179316907449 … 0.03215234579537174 -0.04481375040318068;;; … ;;; -7.05227496846073e-10 4.367861736475572e-7 … 0.2643938847764007 0.2658119830882015; -4.5791854241982725e-9 4.4003196772673737e-7 … 0.05172819314193894 0.08962155417139726;;; -5.081507273313804e-10 3.3521561823616337e-7 … -0.019988475114922424 0.20199614979005998; -3.0474309427650536e-9 3.3943639586541475e-7 … 0.050130188942430334 0.12470230892137493;;; 2.6148847354416827e-9 6.789339456224567e-8 … -0.08459037451521441 -0.12444974553740369; 1.934002443362186e-9 6.300762115754825e-8 … -0.05626957383497598 0.04808722967658244], [-0.7071058872028362 -0.012855993022177136 … 0.02131654061359647 0.044845288208767375; -0.70710477558377 0.01340179083572506 … -0.021266945123849853 -0.044854528050684794;;; -0.0011326497720432446 0.7069772045460372 … -0.012145884400805301 0.003092584979632225; 0.001678278735421446 0.7069662891978356 … 0.01294030664222644 -0.0013589749176648035;;; 2.115599780238018e-5 0.003590625345724723 … -0.011328127354621756 -0.015906738376235012; 1.9856498370150196e-5 0.003601111808661554 … 0.009717540237287927 0.006512423053207339;;; … ;;; -7.315936379898805e-10 -6.5404264108805695e-6 … -0.519124810367297 0.29821571981045414; -2.5227652109691737e-8 -6.555433837558701e-6 … 0.10014403371869636 -0.36251953511482166;;; -7.773088781969133e-9 -2.3821813402521326e-7 … -0.5028692211245224 -0.20452043745052254; -8.480929867492723e-9 -2.5378345906657704e-7 … -0.48050030275986166 0.35374375565508176;;; -4.74617276600747e-10 -1.0090325190682509e-6 … 0.2546950358160053 0.2678181422102595; -4.2248385227093806e-9 -1.0138932748170195e-6 … -0.11444156673564708 0.16071954506109493], [-0.7071067810941858 0.005944920659899349 … -0.017928316833211007 -0.08444457472214031; -0.7071054699142159 -0.007263649990558208 … 0.01792587806407695 0.084432507586154;;; 4.2448314647618315e-5 0.7068635923317326 … -0.001119127352949648 -0.005448097029361169; -0.001359389346916122 0.7068513042131874 … 0.0014664953698448166 0.007144188715783363;;; 2.550261624176063e-5 -0.013694582932802669 … 0.0003835607437464106 0.006378162591809809; 4.671793002085897e-5 -0.013699609711622316 … 0.0003847875805821827 -0.0061626378316995585;;; … ;;; -2.8582730058714314e-8 7.639832637153145e-5 … -0.49926123837950115 0.2567427654823656; -1.7863774534930065e-7 7.642339115453919e-5 … -0.6670743218208239 -0.3048464397126109;;; 1.162038254979175e-8 -1.9123759262973382e-5 … 0.11759813681293813 0.09533311665734433; 4.937719588557836e-8 -1.9135601963313237e-5 … 0.17305986334159015 0.023733232041184233;;; -7.938701434321017e-8 1.876711901322998e-6 … -0.26963909503468914 0.1888934770038001; -8.170599621201064e-8 1.8191700074813333e-6 … 0.08747859393546348 0.2956288787838782], [-0.7071061811893848 -0.002130596132965562 … -0.02638174294713455 0.02425295219532226; -0.707104955539434 0.004657632958696811 … 0.026381857398393264 -0.024252966178717195;;; 0.0009148765961932119 0.6990526941526698 … -1.8603117943983967e-5 0.0004709167744440436; 0.001593141705042709 0.6990365203551803 … -0.00018742658195276943 -0.0003224409365210141;;; 4.752396694533419e-5 0.046688679767564724 … -0.0014064971746449494 0.0019219067006028578; 9.175899283174627e-5 0.04669841913796732 … 0.0035712235687056838 -0.0028641972879542388;;; 7.821221715829348e-5 0.07777802242166033 … -0.02726440245278966 0.02405648015254863; 0.0001531020403452134 0.07780373451065337 … 0.0360183870903432 -0.024127360946491632;;; 1.8922914388203389e-6 0.002211144890182321 … 0.44236056904557974 -0.3149739900796678; 3.997438587505089e-6 0.002211649991437974 … -0.6032710856330946 0.31162859228930195;;; -4.957887717965586e-6 -0.004779355257733367 … -0.3107414035058123 -0.44505576328404917; -9.589344209959056e-6 -0.004780083914882342 … 0.5784612983208993 0.3684721465677934;;; 5.525094358853335e-5 0.05534040892478233 … -0.013211196020751327 -0.05076541234796018; 0.00010882750775299634 0.055346465685255065 … 0.02949373894237043 0.048860327038537335;;; -1.382765461263714e-6 -0.001086139386637231 … 0.008440710434772415 0.5419882666209129; -2.4359644041567613e-6 -0.0010863516932787907 … 0.06811997356016283 -0.41081313523800583], [0.1766340116402343 0.12679656687098667 … 0.1663557502930985 0.753610475931224; 0.9837837506445968 -0.0035725066319381945 … -0.01024314964114891 -0.14036532783070213;;; 0.019078615047498824 -0.9919189922360885 … 0.019334943987472052 0.09699750320441158; 0.005765716997977173 2.147193383927895e-5 … 0.0008319410049133002 -0.131364097022596;;; -0.023547131384273483 -0.001837054037049344 … 0.8341857371646177 -0.16040800537368408; 0.004272403270256311 -0.0002240064834859576 … -0.008678253680958639 0.024627640103200316;;; -5.213928880432898e-6 -0.0007684528445691776 … 0.14379000204315945 -0.002724091337117296; 1.0109073841660335e-6 -2.4074994497932885e-5 … 0.0001253893470390971 0.0746528866690045;;; 1.1356228719179169e-7 -0.0007552411376061809 … -0.26659703580757593 -0.07932595719694108; 6.02293964953358e-7 -0.0004226983136738583 … -0.027154801952432167 0.44212242257983847;;; -4.1962941180539486e-7 -0.0013466152349082255 … 0.39227836348939493 0.007028382730873414; 7.081448772680384e-8 1.4476817194744382e-5 … 0.001649351984722842 -0.048274888647579436;;; -5.7949750166202235e-9 -3.666316928252669e-5 … -0.10754332901979188 -0.1922791137003132; 2.396948707688045e-8 -1.2314151795610686e-6 … -0.05733060005883073 0.2654230247866886;;; 2.3530769165973423e-9 1.3025202162314209e-5 … 0.08661846648519068 0.06005659303511954; -7.591398585048866e-9 8.03388513222881e-8 … 0.08472338407291252 -0.19650424829630045], [-0.4079024491919269 0.23077979727556938 … 0.024990363408095777 -0.021064979330792658; -0.9116991615479734 -0.11848039413877338 … -0.0029482754948267783 0.002457034778382762;;; -0.014997523616088866 0.9652895096114643 … -0.00527643910278445 0.0044032712420320206; -0.022670909284149457 -0.001660032288636753 … -0.09153257698235397 0.0811576242448521;;; 0.013591290634703367 0.03001900567007975 … -0.058424636515396464 0.0506290390810056; 0.03868606599831894 0.0038384514162758347 … 0.1588502302239528 -0.1327190141945181;;; -2.024469710896683e-6 0.0002948560710701997 … -0.012977805795150876 0.0112502962332833; 1.906777164138021e-6 1.6183280044654495e-7 … 0.0016536813023761774 0.0003757872774736716;;; -1.5963094636179698e-6 0.00018557457837382006 … -0.002791208235931606 0.0023882600842021757; 2.1835519387747336e-7 6.1851071676328196e-9 … -0.9250430768378272 -0.008923164656891119;;; 5.899543587189898e-6 -0.0006531005737218225 … 0.04134531500553782 -0.03490965515103597; -1.4996582592868267e-7 4.7365119170317927e-8 … -0.06852283757090458 -0.010947680252310214;;; 2.1711009500539307e-6 -0.0002568107790836393 … -0.0008629980793649638 0.0007246343440433889; -3.857592448544966e-7 -1.708678273772786e-8 … -0.3142049418095307 -0.18932789777085848;;; -3.8779425669298905e-8 4.487641727928755e-6 … -8.03920459038308e-6 2.8261919736809085e-5; 4.893288475760377e-9 -2.427508904334014e-10 … 0.036054882774831404 -0.9671455386855436], [-0.5201694246233409 -0.3792079554721314 … 0.16739374038281912 -0.03441261625694496; -0.8519942135456012 0.2557060181327175 … -0.062316707655707314 0.013844301884547324;;; 0.023635495598284074 0.8889430373022915 … 0.0931256739870027 -0.019519586261461885; 0.0299702941188207 0.00822994855797606 … 0.15252807459081177 -0.03273310387532049;;; -0.016954140786984775 0.022037308135243634 … -0.0216974479390583 0.016007827934344746; -0.04225318518380676 0.006531478681469924 … -0.6351857251039343 0.1039263278682571;;; 2.3962215522675958e-6 -3.36442565640203e-6 … -0.01657598792992932 5.1326829772598095e-5; 6.028763075600537e-6 -9.64388616646548e-7 … 0.1337809902439446 -0.022002783228992226;;; -8.726249005139678e-10 -2.9472786017524642e-8 … -0.04978183207530901 0.011269385198442972; -3.7389465863180487e-10 2.793290158325672e-10 … -0.15610138773095672 0.03387534247721522;;; -1.2391653549573982e-9 -4.8692650278219644e-8 … -0.10075097378142929 -0.0013553144898329412; -1.7467049074475795e-10 -2.5626196662374765e-10 … 0.6905149201747647 0.13140457336951306;;; -1.5401689306276478e-11 7.6375415873582e-11 … -0.01109502219815126 -0.0038255225739309; -6.057058508665548e-11 -1.1151072774724979e-10 … 0.002371731415542926 -0.9832317544838899;;; 8.364283939996218e-12 8.407487943065618e-12 … -0.010888241266355818 0.00044412461310408845; 5.6731272411815354e-12 3.4181124792235464e-13 … -0.00043749374240850734 -0.01809773414922043], [-0.5784218006253026 0.5565342543374141 … -0.031899347138691234 0.06497079434645295; -0.8150897409578961 -0.4048363226137296 … 0.027097008534205876 -0.044256970298637045;;; -0.012945617551673973 0.7214223723341857 … 0.022820392622250052 -0.06804194248454842; 0.01205781083339698 0.07566825784439779 … 0.14182015683138083 -0.08367137240616086;;; 0.01027413946983176 0.00975428792584395 … 0.11153450551910679 0.12167272516973719; 0.025266502452166228 0.010300572156354767 … 0.04252343206603931 0.015272828716140592;;; -9.553797434052816e-6 -3.073010275917675e-5 … -0.05497869896549664 -0.033265136189777944; -2.670569212533594e-5 -1.2651871164656167e-5 … -0.04580439141029792 0.06352376657615742;;; -4.633287718714097e-6 4.544487115454534e-5 … -0.007632915033691361 -0.027473480920612085; -4.091259922817862e-6 1.6909792427467797e-6 … 0.372166443382463 -0.10959766876521941;;; 8.158549026889298e-9 -8.604780096951504e-8 … 0.0128276686931489 -0.12549988124375605; 6.066305269042744e-9 -4.123241263455709e-9 … -0.255625428351772 0.06639194597174518;;; 7.380429165516483e-11 -3.3169151261017974e-11 … -0.013171883150282988 0.8728658668429217; 6.972367255036102e-11 -1.0207477917760289e-10 … 0.8680027001044267 0.08126587032513852;;; -2.1531530313346243e-11 -1.6930003063316894e-11 … -0.002604691868917063 -0.38458965560534675; -3.030787719301288e-11 2.4010751215923896e-11 … 0.023697400258565066 0.11259415703774732], [-0.6432441447744252 -0.6283562740622719 … 0.03910132959514163 0.06308237769017097; -0.7647754707435989 0.5280146753091477 … -0.04323379318262536 -0.04604377456288112;;; 0.011806732175345102 0.5359540488256911 … 0.020819436651232547 0.1340289026834808; -0.03326854698376789 0.19731980192495893 … 0.1642584659085581 -0.01293622531864994;;; -0.0035874236882225815 0.008082431086685963 … 0.18048626991001673 -0.3795627823725435; -0.009816220935714715 0.011020834061688264 … 0.21154786133493111 -0.2053570870939489;;; 2.6332036374720437e-5 0.00037222595150781406 … 0.11823994384497157 -0.18647373737028056; -4.173628079256805e-5 0.00014280950769531093 … 0.17491300432582868 0.22967165556479985;;; 9.672682728083633e-5 0.00032414145967868196 … -0.07706282570587142 0.10391793232781563; 0.00012176083160265521 -1.8174004092022988e-5 … 0.3456745477415084 -0.17743543127694195;;; -3.376208758896234e-8 -1.283634590465188e-7 … -0.011466246001363367 0.49943339957875854; -3.8413081654116234e-8 -1.6542943709152742e-9 … -0.5150179826688083 0.24295017919595563;;; -1.6493892944407454e-11 1.4067723041939406e-11 … 0.004412323281464204 0.40085446126198404; -9.359835145347764e-12 1.3914175029440318e-11 … 0.2624244480501589 0.1619903033232979;;; 5.029303859597028e-12 -6.074494566886293e-12 … 0.00834260340496906 0.10506233206588372; 1.5741776442464018e-12 -1.5605203808240983e-11 … -0.6225145540686067 -0.39154118361509793], [-0.688016449823604 0.6233712505144424 … 0.06292543781499592 0.07697767543774035; -0.7254003483220371 -0.5900571341421871 … -0.056876336749127045 -0.07717471655853697;;; -0.010170492670971521 0.4240296667682818 … -0.16832822204578832 -0.08711197521844857; 0.017863664614895167 0.2887114955392187 … -0.018056639915300824 -0.1880490293746223;;; 0.0002630628261205462 0.005931322528296572 … 0.3323446063415488 -0.05027773982858051; 0.0022348474788638204 0.006889179334401407 … 0.22652337359053773 -0.21542018754084127;;; 5.3947595868121504e-5 -0.001231782949099541 … -0.2935932685003005 0.1249727330765155; -0.0002617112581683422 -0.0010881607680261864 … -0.006171034707068786 0.3069674266760917;;; -7.695635729118018e-5 0.0001667816730719586 … -0.6594545195488758 -0.17374502781202458; -9.44510770181909e-5 -7.710841337837634e-5 … -0.16927066258680165 -0.07819039244194559;;; 1.1823175818884846e-7 -3.00927361824583e-7 … 0.3097193763890977 0.12235124204452531; 1.3188659202766123e-7 7.251261587915554e-8 … -0.1824454835542439 0.7255363221084828;;; -5.963976607151173e-13 -1.975135510400881e-11 … -0.350772460700155 -0.14255224104931175; -3.2976076892847916e-12 -1.8269914823698477e-11 … -0.011491890546658449 0.30993204296092564;;; -3.397703183732762e-13 -3.271493156225959e-12 … 0.011254976536244696 0.0038795241396152222; -2.5193788767777217e-12 -1.0325657538353708e-11 … -0.009942309059954874 0.3038400185626043], [-0.7020621924744438 -0.6173144978698104 … 0.05403454275022184 -0.10653256538002281; -0.7120802674322542 0.6080400913229963 … -0.05231208398206498 0.10612379480449934;;; 0.004046412001037628 0.37309251309712904 … 0.17121637333608342 -0.15247701458076093; -0.005815916178853073 0.33166539563490455 … 0.008366697375621053 -0.2195113722328126;;; 0.00011748114703425879 0.0019578483151295885 … -0.20010009525285655 0.08241002195662109; -0.0003654170289848065 0.002110103898640145 … -0.30985857477614714 -0.19764344636759698;;; 9.301424000784812e-5 0.0009778336500143516 … -0.5452272027327277 -0.05064214073024074; -0.00012600171860890528 0.0009257559799130588 … 0.09132611481305565 -0.2955329129022551;;; -1.3604970248677346e-5 -2.2412974221450848e-5 … -0.5806379163595004 0.38114157654516895; -1.599643787940053e-5 2.6061764901704746e-5 … -0.35346005815979226 -0.45796339579518014;;; -9.070635295827807e-8 -1.9655299280351496e-7 … -0.18514271775068802 0.18368057309441807; -9.318665862125682e-8 1.1066567086379561e-7 … 0.15134657450121056 0.6006894005901658;;; 7.998675501710016e-13 2.267483661649929e-11 … 0.06212741521548665 -0.06271070487726454; -1.7626513073655723e-12 2.2114225095445063e-11 … 0.0034978659214084614 0.1286457616070711;;; -7.385627692396628e-12 -5.238385459551514e-12 … -0.012672895733134322 0.011913515048725676; -9.120085697909262e-12 -3.6374760963660184e-12 … 0.001565999735042448 0.002327882712986174], [-0.7056152194798059 0.6184475440314995 … 0.00737757752690748 0.17511034801473188; -0.7085925999155471 -0.6156477473585008 … -0.007602869078596242 -0.174637115929277;;; -0.0011095396659612476 0.35085513680798835 … 0.048176062035693 -0.3165719232630832; 0.001565585732613027 0.3397066537269388 … -0.07608249070115591 -0.30842120281574226;;; 4.688298532760699e-5 -0.0005172385556351539 … 0.12727919614703934 -0.32728983214795004; -6.872611914516642e-5 -0.0005066775654044455 … 0.43743991553370265 0.46645297722718077;;; 1.6329420391590824e-5 -0.0001199225682039449 … 0.6311885546594034 -0.5721062960716458; -7.647941152598583e-6 -0.00010101288310868744 … -0.6211486330823351 -0.3024800730906336], [-0.7066242844352636 -0.6328862940271488 -0.0672826873775854 0.30920882823454887; -0.7075888044953305 0.6319563873018241 0.06661247266625141 -0.3090501363639615;;; -0.0002338029814149059 -0.3177123021006241 0.8224359514267313 -0.4718664474519194; 0.00038695656886426726 -0.3148729211522157 -0.5609232784127837 -0.765650030708769], [-0.706957259532302 -0.7072562712302927; -0.7072562712302927 0.706957259532302;;;]], (2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), [1, 2, 4, 8, 16, 16, 16, 16, 16, 16  …  8, 8, 8, 8, 8, 8, 8, 4, 2, 1], [0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1])</code></pre><p>And we reshape the solution to a 2D array for visualization</p><pre><code class="language-julia hljs">solution = reshape(qtt_to_function(x_dmrg), 2^cores, 2^cores)
xes = collect(range(0,1,length=2^cores))
yes = collect(range(0,1,length=2^cores))
fig = Figure()
cmap = :roma
ax = Axis(fig[1, 1], title = &quot;Laplace Solution&quot;, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hm = heatmap!(ax, xes, yes, solution; colormap = cmap)
Colorbar(fig[1, 2], hm, label = &quot;u(x, y)&quot;)
fig</code></pre><img src="dfcd15e6.png" alt="Example block output"/><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>We can also solve time-dependent PDEs using the QTT framework. In this exampl we will use the explicit Euler method, the implicit Euler method and the Crank-Nicolson scheme.</p><pre><code class="language-julia hljs">using TensorTrainNumerics
using CairoMakie

cores = 8
h = 1/cores^2
A = h^2*toeplitz_to_qtto(-2,1.0,1.0,cores)
xes = collect(range(0.0, 1.0, 2^cores))

u₀ = qtt_sin(cores,λ=π)
init = rand_tt(u₀.ttv_dims, u₀.ttv_rks)
steps = collect(range(0.0,10.0,1000))
solution_explicit, error_explicit = euler_method(A, u₀, steps; return_error=true)

solution_implicit, rel_implicit = implicit_euler_method(A, u₀, init, steps; return_error=true)

solution_crank, rel_crank = crank_nicholson_method(A, u₀, init, steps; return_error=true, tt_solver=&quot;mals&quot;)

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, ylabel = &quot;u(x)&quot;, title = &quot;Comparison of Time-Stepping Methods&quot;)
lines!(ax, xes, qtt_to_function(solution_explicit), label = &quot;Explicit Euler&quot;, linestyle = :solid, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_implicit), label = &quot;Implicit Euler&quot;, linestyle = :dot, linewidth=3)
lines!(ax, xes, qtt_to_function(solution_crank), label = &quot;Crank-Nicolson&quot;, linestyle = :dash, linewidth=3)
axislegend(ax)
fig</code></pre><img src="6fabb0f4.png" alt="Example block output"/><p>And print the relative errors</p><pre><code class="language-julia hljs">println(&quot;Relative error for explicit Euler: &quot;, error_explicit)
println(&quot;Relative error for implicit Euler: &quot;, rel_implicit)
println(&quot;Relative error for Crank-Nicolson: &quot;, rel_crank)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Relative error for explicit Euler: 2.7254393110550548e-5
Relative error for implicit Euler: 4.8313894805405425e-6
Relative error for Crank-Nicolson: 4.831503897045136e-6</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Tensor trains</a><a class="docs-footer-nextpage" href="../resources/">Resources »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 1 August 2025 11:03">Friday 1 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
